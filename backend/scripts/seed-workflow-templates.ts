/**
 * Seed Script for Workflow Templates
 *
 * Populates the workflow_templates table with 80 comprehensive templates
 * across 8 categories: marketing, sales, operations, engineering, support,
 * ecommerce, saas, healthcare
 *
 * Templates feature varying complexity levels:
 * - Advanced (15-20 nodes): parallel paths, routers, conditionals
 * - Intermediate (8-12 nodes): branching, multiple integrations
 * - Simple (5-7 nodes): straightforward flows, quick wins
 *
 * Uses the autoLayoutWorkflow algorithm from @flowmaestro/shared to ensure
 * consistent, visually appealing node positioning across all templates.
 *
 * Run with: npx tsx backend/scripts/seed-workflow-templates.ts
 */

import * as path from "path";
import * as dotenv from "dotenv";
import { Pool } from "pg";
import { autoLayoutWorkflow } from "@flowmaestro/shared";

// Load .env from backend root
dotenv.config({ path: path.resolve(__dirname, "../.env") });

// Template-specific node type (React Flow compatible)
interface TemplateNode {
    id: string;
    type: string;
    position: { x: number; y: number };
    data: Record<string, unknown>;
}

/**
 * Apply auto-layout to template nodes using the shared layout algorithm.
 * Wraps the shared autoLayoutWorkflow function to mutate nodes in place
 * (which is the expected behavior for the seeding script).
 */
function applyAutoLayout(nodes: TemplateNode[], edges: TemplateEdge[]): void {
    // Use the shared layout algorithm
    const positions = autoLayoutWorkflow(nodes, edges);

    // Apply positions back to nodes (shared function returns a Map, doesn't mutate)
    for (const node of nodes) {
        const newPosition = positions.get(node.id);
        if (newPosition) {
            node.position = newPosition;
        }
    }
}

// Template-specific edge type
interface TemplateEdge {
    id: string;
    source: string;
    target: string;
    sourceHandle?: string;
    targetHandle?: string;
}

// Template definition (stored as JSON, compatible with React Flow)
interface TemplateDefinition {
    name: string;
    nodes: TemplateNode[];
    edges: TemplateEdge[];
}

interface TemplateData {
    name: string;
    description: string;
    definition: TemplateDefinition;
    category: string;
    tags: string[];
    required_integrations: string[];
    featured?: boolean;
}

// ============================================================================
// TEMPLATE DEFINITIONS
// ============================================================================

const templates: TemplateData[] = [
    // ========================================================================
    // MARKETING (6 templates)
    // ========================================================================

    // Marketing Advanced 1: Multi-Channel Campaign Orchestrator (18 nodes)
    {
        name: "Multi-Channel Campaign Orchestrator",
        description:
            "Orchestrate content creation across Twitter, LinkedIn, Instagram, and TikTok. AI generates platform-optimized content in parallel, routes through human review, schedules posts, and tracks analytics.",
        category: "marketing",
        tags: ["multi-channel", "social media", "content", "parallel", "automation"],
        required_integrations: ["twitter", "linkedin", "instagram", "tiktok", "hubspot", "slack"],
        featured: true,
        definition: {
            name: "Multi-Channel Campaign Orchestrator",
            nodes: [
                {
                    id: "input-1",
                    type: "input",
                    position: { x: 100, y: 400 },
                    data: {
                        label: "Campaign Brief",
                        inputName: "campaignBrief",
                        inputVariable: "campaignBrief",
                        inputType: "text",
                        description: "Campaign topic, goals, target audience, and key messages"
                    }
                },
                {
                    id: "llm-strategy",
                    type: "llm",
                    position: { x: 480, y: 400 },
                    data: {
                        label: "Create Content Strategy",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Analyze this campaign brief and create a content strategy:\n\n{{campaignBrief}}\n\nDefine: key themes, hashtags, posting schedule, and platform-specific angles for Twitter, LinkedIn, Instagram, and TikTok.",
                        outputVariable: "strategy"
                    }
                },
                {
                    id: "llm-twitter",
                    type: "llm",
                    position: { x: 860, y: 100 },
                    data: {
                        label: "Generate Twitter Content",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Based on this strategy:\n{{strategy.text}}\n\nCreate 5 engaging Twitter posts (max 280 chars each). Include relevant hashtags, make them conversational and shareable.",
                        outputVariable: "twitterContent"
                    }
                },
                {
                    id: "llm-linkedin",
                    type: "llm",
                    position: { x: 860, y: 300 },
                    data: {
                        label: "Generate LinkedIn Content",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Based on this strategy:\n{{strategy.text}}\n\nCreate 3 professional LinkedIn posts (300-500 words each). Include hooks, value-driven content, and calls to action.",
                        outputVariable: "linkedinContent"
                    }
                },
                {
                    id: "llm-instagram",
                    type: "llm",
                    position: { x: 860, y: 500 },
                    data: {
                        label: "Generate Instagram Content",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Based on this strategy:\n{{strategy.text}}\n\nCreate 3 Instagram captions with emoji usage, storytelling hooks, and hashtag sets (up to 30 relevant hashtags per post).",
                        outputVariable: "instagramContent"
                    }
                },
                {
                    id: "llm-tiktok",
                    type: "llm",
                    position: { x: 860, y: 700 },
                    data: {
                        label: "Generate TikTok Scripts",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Based on this strategy:\n{{strategy.text}}\n\nCreate 3 TikTok video scripts (15-60 seconds each). Include hook, main content, and CTA. Add trending sound suggestions.",
                        outputVariable: "tiktokContent"
                    }
                },
                {
                    id: "transform-compile",
                    type: "transform",
                    position: { x: 1240, y: 400 },
                    data: {
                        label: "Compile Content Package",
                        transformType: "template",
                        template:
                            '{"twitter": "{{twitterContent.text}}", "linkedin": "{{linkedinContent.text}}", "instagram": "{{instagramContent.text}}", "tiktok": "{{tiktokContent.text}}"}',
                        outputVariable: "contentPackage"
                    }
                },
                {
                    id: "humanReview-1",
                    type: "humanReview",
                    position: { x: 1620, y: 400 },
                    data: {
                        label: "Review & Approve Content",
                        reviewPrompt:
                            "Review all generated content for brand alignment, accuracy, and quality before scheduling",
                        outputVariable: "approvedContent"
                    }
                },
                {
                    id: "router-quality",
                    type: "router",
                    position: { x: 2000, y: 400 },
                    data: {
                        label: "Quality Check Router",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Based on the review feedback, determine if the content is ready to publish or needs revision:\n\n{{approvedContent}}",
                        routes: [
                            {
                                value: "publish",
                                label: "Ready to Publish",
                                description: "Content approved for scheduling"
                            },
                            {
                                value: "revise",
                                label: "Needs Revision",
                                description: "Content requires changes"
                            }
                        ],
                        defaultRoute: "publish",
                        outputVariable: "qualityDecision"
                    }
                },
                {
                    id: "integration-twitter",
                    type: "integration",
                    position: { x: 2380, y: 100 },
                    data: {
                        label: "Schedule Twitter Posts",
                        provider: "twitter",
                        operation: "createTweet"
                    }
                },
                {
                    id: "integration-linkedin",
                    type: "integration",
                    position: { x: 2380, y: 300 },
                    data: {
                        label: "Schedule LinkedIn Posts",
                        provider: "linkedin",
                        operation: "createPost"
                    }
                },
                {
                    id: "integration-instagram",
                    type: "integration",
                    position: { x: 2380, y: 500 },
                    data: {
                        label: "Schedule Instagram Posts",
                        provider: "instagram",
                        operation: "createMedia"
                    }
                },
                {
                    id: "integration-tiktok",
                    type: "integration",
                    position: { x: 2380, y: 700 },
                    data: {
                        label: "Queue TikTok Content",
                        provider: "tiktok",
                        operation: "createVideo"
                    }
                },
                {
                    id: "transform-summary",
                    type: "transform",
                    position: { x: 2760, y: 400 },
                    data: {
                        label: "Create Campaign Summary",
                        transformType: "template",
                        template:
                            "Campaign scheduled across 4 platforms:\n- Twitter: {{twitterContent.text | truncate: 50}}\n- LinkedIn: {{linkedinContent.text | truncate: 50}}\n- Instagram: {{instagramContent.text | truncate: 50}}\n- TikTok: {{tiktokContent.text | truncate: 50}}",
                        outputVariable: "summary"
                    }
                },
                {
                    id: "integration-hubspot",
                    type: "integration",
                    position: { x: 3140, y: 400 },
                    data: {
                        label: "Log to HubSpot",
                        provider: "hubspot",
                        operation: "createEngagement"
                    }
                },
                {
                    id: "integration-slack",
                    type: "integration",
                    position: { x: 3520, y: 400 },
                    data: {
                        label: "Notify Team",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#marketing-campaigns"
                    }
                },
                {
                    id: "llm-revise",
                    type: "llm",
                    position: { x: 2380, y: 900 },
                    data: {
                        label: "Revise Content",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Revise this content based on the feedback provided:\n\nOriginal: {{contentPackage}}\nFeedback: {{approvedContent}}",
                        outputVariable: "revisedContent"
                    }
                },
                {
                    id: "integration-slack-revision",
                    type: "integration",
                    position: { x: 2760, y: 900 },
                    data: {
                        label: "Notify Revision Needed",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#marketing-campaigns"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 3900, y: 400 },
                    data: {
                        label: "Campaign Results",
                        outputName: "results",
                        value: "{{summary}}"
                    }
                },
                {
                    id: "output-revision",
                    type: "output",
                    position: { x: 3140, y: 900 },
                    data: {
                        label: "Revision Required",
                        outputName: "revision",
                        value: "{{revisedContent}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "input-1", target: "llm-strategy" },
                { id: "e2", source: "llm-strategy", target: "llm-twitter" },
                { id: "e3", source: "llm-strategy", target: "llm-linkedin" },
                { id: "e4", source: "llm-strategy", target: "llm-instagram" },
                { id: "e5", source: "llm-strategy", target: "llm-tiktok" },
                { id: "e6", source: "llm-twitter", target: "transform-compile" },
                { id: "e7", source: "llm-linkedin", target: "transform-compile" },
                { id: "e8", source: "llm-instagram", target: "transform-compile" },
                { id: "e9", source: "llm-tiktok", target: "transform-compile" },
                { id: "e10", source: "transform-compile", target: "humanReview-1" },
                { id: "e11", source: "humanReview-1", target: "router-quality" },
                {
                    id: "e12",
                    source: "router-quality",
                    target: "integration-twitter",
                    sourceHandle: "publish"
                },
                {
                    id: "e13",
                    source: "router-quality",
                    target: "integration-linkedin",
                    sourceHandle: "publish"
                },
                {
                    id: "e14",
                    source: "router-quality",
                    target: "integration-instagram",
                    sourceHandle: "publish"
                },
                {
                    id: "e15",
                    source: "router-quality",
                    target: "integration-tiktok",
                    sourceHandle: "publish"
                },
                {
                    id: "e16",
                    source: "router-quality",
                    target: "llm-revise",
                    sourceHandle: "revise"
                },
                { id: "e17", source: "integration-twitter", target: "transform-summary" },
                { id: "e18", source: "integration-linkedin", target: "transform-summary" },
                { id: "e19", source: "integration-instagram", target: "transform-summary" },
                { id: "e20", source: "integration-tiktok", target: "transform-summary" },
                { id: "e21", source: "transform-summary", target: "integration-hubspot" },
                { id: "e22", source: "integration-hubspot", target: "integration-slack" },
                { id: "e23", source: "integration-slack", target: "output-1" },
                { id: "e24", source: "llm-revise", target: "integration-slack-revision" },
                { id: "e25", source: "integration-slack-revision", target: "output-revision" }
            ]
        }
    },

    // Marketing Advanced 2: Podcast Episode Pipeline (16 nodes)
    {
        name: "Podcast Episode Pipeline",
        description:
            "Complete podcast production workflow: transcribe episodes, generate show notes, timestamps, social clips, audiograms, and publish across multiple platforms with coordinated social announcements.",
        category: "marketing",
        tags: ["podcast", "content repurposing", "transcription", "social media"],
        required_integrations: ["youtube", "notion", "twitter", "linkedin", "buffer", "slack"],
        featured: true,
        definition: {
            name: "Podcast Episode Pipeline",
            nodes: [
                {
                    id: "input-1",
                    type: "input",
                    position: { x: 100, y: 400 },
                    data: {
                        label: "Episode Details",
                        inputName: "episodeDetails",
                        inputVariable: "episodeDetails",
                        inputType: "json",
                        description:
                            '{"title": "", "description": "", "audioUrl": "", "guestName": "", "topics": []}'
                    }
                },
                {
                    id: "url-1",
                    type: "url",
                    position: { x: 480, y: 400 },
                    data: {
                        label: "Fetch Audio/Video",
                        urlVariable: "episodeDetails.audioUrl",
                        outputVariable: "mediaContent"
                    }
                },
                {
                    id: "llm-transcribe",
                    type: "llm",
                    position: { x: 860, y: 400 },
                    data: {
                        label: "Transcribe & Process",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Process this podcast episode:\nTitle: {{episodeDetails.title}}\nGuest: {{episodeDetails.guestName}}\n\nGenerate a detailed transcript with speaker labels and timestamps.",
                        outputVariable: "transcript"
                    }
                },
                {
                    id: "llm-shownotes",
                    type: "llm",
                    position: { x: 1240, y: 100 },
                    data: {
                        label: "Generate Show Notes",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Create comprehensive show notes from this transcript:\n\n{{transcript.text}}\n\nInclude: episode summary, key takeaways, guest bio, resources mentioned, and clickable timestamps.",
                        outputVariable: "showNotes"
                    }
                },
                {
                    id: "llm-timestamps",
                    type: "llm",
                    position: { x: 1240, y: 300 },
                    data: {
                        label: "Create Timestamps",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Create YouTube-style chapter timestamps from this transcript:\n\n{{transcript.text}}\n\nFormat: [MM:SS] Topic Title",
                        outputVariable: "timestamps"
                    }
                },
                {
                    id: "llm-clips",
                    type: "llm",
                    position: { x: 1240, y: 500 },
                    data: {
                        label: "Identify Clip Moments",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Identify 5 best moments for social media clips from this transcript:\n\n{{transcript.text}}\n\nFor each: timestamp, duration (15-60s), hook quote, and suggested caption.",
                        outputVariable: "clipMoments"
                    }
                },
                {
                    id: "llm-quotes",
                    type: "llm",
                    position: { x: 1240, y: 700 },
                    data: {
                        label: "Extract Quotable Moments",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Extract 10 shareable quotes from this transcript:\n\n{{transcript.text}}\n\nMake them punchy, insightful, and formatted for social media graphics.",
                        outputVariable: "quotes"
                    }
                },
                {
                    id: "integration-notion",
                    type: "integration",
                    position: { x: 1620, y: 400 },
                    data: {
                        label: "Save to Notion",
                        provider: "notion",
                        operation: "createPage",
                        database: "Episodes"
                    }
                },
                {
                    id: "llm-twitter-thread",
                    type: "llm",
                    position: { x: 2000, y: 300 },
                    data: {
                        label: "Create Twitter Thread",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Create a Twitter thread (8-10 tweets) announcing this episode:\n\nTitle: {{episodeDetails.title}}\nGuest: {{episodeDetails.guestName}}\nKey points: {{showNotes.text}}\n\nStart with a hook, include key insights, end with CTA.",
                        outputVariable: "twitterThread"
                    }
                },
                {
                    id: "llm-linkedin",
                    type: "llm",
                    position: { x: 2000, y: 500 },
                    data: {
                        label: "Create LinkedIn Post",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Create a LinkedIn post announcing this episode:\n\nTitle: {{episodeDetails.title}}\nGuest: {{episodeDetails.guestName}}\nKey points: {{showNotes.text}}\n\nProfessional tone, value-focused, with clear CTA.",
                        outputVariable: "linkedinPost"
                    }
                },
                {
                    id: "integration-twitter",
                    type: "integration",
                    position: { x: 2380, y: 300 },
                    data: {
                        label: "Post Twitter Thread",
                        provider: "twitter",
                        operation: "createThread"
                    }
                },
                {
                    id: "integration-linkedin",
                    type: "integration",
                    position: { x: 2380, y: 500 },
                    data: {
                        label: "Post to LinkedIn",
                        provider: "linkedin",
                        operation: "createPost"
                    }
                },
                {
                    id: "integration-buffer",
                    type: "integration",
                    position: { x: 2760, y: 400 },
                    data: {
                        label: "Schedule Follow-up Posts",
                        provider: "buffer",
                        operation: "createPost"
                    }
                },
                {
                    id: "transform-summary",
                    type: "transform",
                    position: { x: 3140, y: 400 },
                    data: {
                        label: "Compile Results",
                        transformType: "template",
                        template:
                            "Episode {{episodeDetails.title}} processed:\n- Show notes: Created\n- Timestamps: {{timestamps.text | truncate: 100}}\n- Clips identified: 5\n- Social posts scheduled",
                        outputVariable: "summary"
                    }
                },
                {
                    id: "integration-slack",
                    type: "integration",
                    position: { x: 3520, y: 400 },
                    data: {
                        label: "Notify Team",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#podcast"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 3900, y: 400 },
                    data: {
                        label: "Pipeline Results",
                        outputName: "results",
                        value: "{{summary}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "input-1", target: "url-1" },
                { id: "e2", source: "url-1", target: "llm-transcribe" },
                { id: "e3", source: "llm-transcribe", target: "llm-shownotes" },
                { id: "e4", source: "llm-transcribe", target: "llm-timestamps" },
                { id: "e5", source: "llm-transcribe", target: "llm-clips" },
                { id: "e6", source: "llm-transcribe", target: "llm-quotes" },
                { id: "e7", source: "llm-shownotes", target: "integration-notion" },
                { id: "e8", source: "llm-timestamps", target: "integration-notion" },
                { id: "e9", source: "llm-clips", target: "integration-notion" },
                { id: "e10", source: "llm-quotes", target: "integration-notion" },
                { id: "e11", source: "integration-notion", target: "llm-twitter-thread" },
                { id: "e12", source: "integration-notion", target: "llm-linkedin" },
                { id: "e13", source: "llm-twitter-thread", target: "integration-twitter" },
                { id: "e14", source: "llm-linkedin", target: "integration-linkedin" },
                { id: "e15", source: "integration-twitter", target: "integration-buffer" },
                { id: "e16", source: "integration-linkedin", target: "integration-buffer" },
                { id: "e17", source: "integration-buffer", target: "transform-summary" },
                { id: "e18", source: "transform-summary", target: "integration-slack" },
                { id: "e19", source: "integration-slack", target: "output-1" }
            ]
        }
    },

    // Marketing Advanced 3: Competitive Intelligence Dashboard (15 nodes)
    {
        name: "Competitive Intelligence Dashboard",
        description:
            "Monitor competitors across multiple channels, gather market intelligence, analyze trends with AI, and generate executive briefings with conditional alerts for significant developments.",
        category: "marketing",
        tags: ["competitive intelligence", "monitoring", "analysis", "alerts"],
        required_integrations: ["twitter", "linkedin", "notion", "slack", "google-sheets", "gmail"],
        featured: true,
        definition: {
            name: "Competitive Intelligence Dashboard",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Daily Schedule",
                        triggerType: "schedule",
                        schedule: "0 8 * * *",
                        description: "Runs daily at 8am"
                    }
                },
                {
                    id: "input-1",
                    type: "input",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Competitor List",
                        inputName: "competitors",
                        inputVariable: "competitors",
                        inputType: "json",
                        description: '["competitor1", "competitor2", "competitor3"]'
                    }
                },
                {
                    id: "integration-twitter",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Fetch Twitter Activity",
                        provider: "twitter",
                        operation: "searchTweets"
                    }
                },
                {
                    id: "integration-linkedin",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Fetch LinkedIn Updates",
                        provider: "linkedin",
                        operation: "getCompanyUpdates"
                    }
                },
                {
                    id: "url-1",
                    type: "url",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Scrape News Sources",
                        urlVariable: "newsUrls",
                        outputVariable: "newsContent"
                    }
                },
                {
                    id: "transform-aggregate",
                    type: "transform",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Aggregate Data",
                        transformType: "template",
                        template:
                            '{"twitter": "{{integration-twitter.data}}", "linkedin": "{{integration-linkedin.data}}", "news": "{{newsContent.text}}"}',
                        outputVariable: "aggregatedData"
                    }
                },
                {
                    id: "llm-analyze",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Analyze Intelligence",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Analyze this competitive intelligence data:\n\n{{aggregatedData}}\n\nIdentify:\n1. Key announcements or launches\n2. Messaging changes or pivots\n3. Market positioning shifts\n4. Potential threats or opportunities\n5. Sentiment trends",
                        outputVariable: "analysis"
                    }
                },
                {
                    id: "llm-score",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Score Significance",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: 'Rate the significance of these findings on a scale of 1-10:\n\n{{analysis.text}}\n\nReturn JSON: {"score": N, "reason": "brief explanation"}',
                        outputVariable: "significance"
                    }
                },
                {
                    id: "conditional-1",
                    type: "conditional",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Check Significance",
                        condition: "significance.score >= 7",
                        outputVariable: "isSignificant"
                    }
                },
                {
                    id: "integration-sheets",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Log to Tracker",
                        provider: "google-sheets",
                        operation: "appendRow",
                        spreadsheetId: "",
                        sheetName: "Competitive Intel"
                    }
                },
                {
                    id: "integration-notion",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Update Dashboard",
                        provider: "notion",
                        operation: "updatePage"
                    }
                },
                {
                    id: "llm-briefing",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Executive Briefing",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Create an executive briefing from this analysis:\n\n{{analysis.text}}\n\nFormat: 1-page summary with key findings, strategic implications, and recommended actions.",
                        outputVariable: "briefing"
                    }
                },
                {
                    id: "integration-gmail",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Email Executive Briefing",
                        provider: "gmail",
                        operation: "sendEmail",
                        to: "executives@company.com"
                    }
                },
                {
                    id: "integration-slack",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Alert Team",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#competitive-intel"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Intelligence Report",
                        outputName: "report",
                        value: "{{analysis.text}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "trigger-1", target: "input-1" },
                { id: "e2", source: "input-1", target: "integration-twitter" },
                { id: "e3", source: "input-1", target: "integration-linkedin" },
                { id: "e4", source: "input-1", target: "url-1" },
                { id: "e5", source: "integration-twitter", target: "transform-aggregate" },
                { id: "e6", source: "integration-linkedin", target: "transform-aggregate" },
                { id: "e7", source: "url-1", target: "transform-aggregate" },
                { id: "e8", source: "transform-aggregate", target: "llm-analyze" },
                { id: "e9", source: "llm-analyze", target: "llm-score" },
                { id: "e10", source: "llm-score", target: "conditional-1" },
                {
                    id: "e11",
                    source: "conditional-1",
                    target: "llm-briefing",
                    sourceHandle: "true"
                },
                {
                    id: "e12",
                    source: "conditional-1",
                    target: "integration-sheets",
                    sourceHandle: "false"
                },
                { id: "e13", source: "llm-briefing", target: "integration-gmail" },
                { id: "e14", source: "llm-briefing", target: "integration-slack" },
                { id: "e15", source: "integration-gmail", target: "integration-notion" },
                { id: "e16", source: "integration-slack", target: "integration-notion" },
                { id: "e17", source: "integration-sheets", target: "integration-notion" },
                { id: "e18", source: "integration-notion", target: "output-1" }
            ]
        }
    },

    // Marketing Intermediate 4: Blog Post Amplifier (10 nodes)
    {
        name: "Blog Post Amplifier",
        description:
            "Transform published blog posts into multi-platform social content. Automatically repurposes articles for Twitter threads, LinkedIn posts, and Medium cross-posts.",
        category: "marketing",
        tags: ["content repurposing", "blog", "social media", "amplification"],
        required_integrations: ["notion", "twitter", "linkedin", "medium", "slack"],
        featured: false,
        definition: {
            name: "Blog Post Amplifier",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "New Blog Published",
                        triggerType: "webhook",
                        description: "Triggered when new blog post is published"
                    }
                },
                {
                    id: "url-1",
                    type: "url",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Fetch Blog Content",
                        urlVariable: "trigger.blogUrl",
                        outputVariable: "blogContent"
                    }
                },
                {
                    id: "llm-analyze",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Extract Key Points",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Analyze this blog post and extract:\n1. Main thesis\n2. Key arguments (3-5)\n3. Best quotes\n4. Target audience\n5. Optimal hashtags\n\nContent:\n{{blogContent.text}}",
                        outputVariable: "analysis"
                    }
                },
                {
                    id: "llm-twitter",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Create Twitter Thread",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Create a compelling Twitter thread (8-12 tweets) from:\n\n{{analysis.text}}\n\nStart with a hook, break down key insights, end with CTA to read the full post.",
                        outputVariable: "twitterThread"
                    }
                },
                {
                    id: "llm-linkedin",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Create LinkedIn Post",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Create a LinkedIn post (400-600 words) summarizing:\n\n{{analysis.text}}\n\nProfessional tone, include personal perspective, clear CTA.",
                        outputVariable: "linkedinPost"
                    }
                },
                {
                    id: "integration-twitter",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Post Thread",
                        provider: "twitter",
                        operation: "createThread"
                    }
                },
                {
                    id: "integration-linkedin",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Post to LinkedIn",
                        provider: "linkedin",
                        operation: "createPost"
                    }
                },
                {
                    id: "integration-medium",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Cross-post to Medium",
                        provider: "medium",
                        operation: "createPost"
                    }
                },
                {
                    id: "integration-slack",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Notify Team",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#content"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Amplification Results",
                        outputName: "results",
                        value: "Blog amplified across Twitter, LinkedIn, and Medium"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "trigger-1", target: "url-1" },
                { id: "e2", source: "url-1", target: "llm-analyze" },
                { id: "e3", source: "llm-analyze", target: "llm-twitter" },
                { id: "e4", source: "llm-analyze", target: "llm-linkedin" },
                { id: "e5", source: "llm-twitter", target: "integration-twitter" },
                { id: "e6", source: "llm-linkedin", target: "integration-linkedin" },
                { id: "e7", source: "llm-analyze", target: "integration-medium" },
                { id: "e8", source: "integration-twitter", target: "integration-slack" },
                { id: "e9", source: "integration-linkedin", target: "integration-slack" },
                { id: "e10", source: "integration-medium", target: "integration-slack" },
                { id: "e11", source: "integration-slack", target: "output-1" }
            ]
        }
    },

    // Marketing Intermediate 5: Newsletter Automation (14 nodes)
    {
        name: "Newsletter Automation",
        description:
            "Automated weekly newsletter: curates content from multiple sources, generates engaging copy with AI, routes through review, and sends via Mailchimp with engagement tracking.",
        category: "marketing",
        tags: ["newsletter", "email marketing", "automation", "content curation"],
        required_integrations: ["mailchimp", "notion", "slack", "google-sheets"],
        featured: false,
        definition: {
            name: "Newsletter Automation",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Weekly Schedule",
                        triggerType: "schedule",
                        schedule: "0 9 * * 2",
                        description: "Every Tuesday at 9am"
                    }
                },
                {
                    id: "integration-notion",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Fetch Curated Content",
                        provider: "notion",
                        operation: "queryDatabase",
                        database: "Newsletter Queue"
                    }
                },
                {
                    id: "integration-sheets",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get Subscriber Metrics",
                        provider: "google-sheets",
                        operation: "getValues",
                        spreadsheetId: "subscriber_analytics"
                    }
                },
                {
                    id: "transform-merge",
                    type: "transform",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Merge Content Sources",
                        transformType: "template",
                        template:
                            '{"content": {{integration-notion.data}}, "metrics": {{integration-sheets.data}}}',
                        outputVariable: "mergedData"
                    }
                },
                {
                    id: "llm-body",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Newsletter Body",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Create newsletter body from:\n\n{{mergedData}}\n\nStructure: intro hook, 3-5 highlights, quick tips, CTA.",
                        outputVariable: "newsletterBody"
                    }
                },
                {
                    id: "llm-subject",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Subject Lines",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Generate 3 A/B test subject lines for newsletter about:\n\n{{mergedData}}\n\nOptimize for open rates.",
                        outputVariable: "subjectLines"
                    }
                },
                {
                    id: "transform-compile",
                    type: "transform",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Compile Newsletter",
                        transformType: "template",
                        template:
                            '{"body": "{{newsletterBody.text}}", "subjects": "{{subjectLines.text}}"}',
                        outputVariable: "newsletter"
                    }
                },
                {
                    id: "humanReview-1",
                    type: "humanReview",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Review Newsletter",
                        reviewPrompt: "Review the newsletter content before sending to subscribers",
                        outputVariable: "approved"
                    }
                },
                {
                    id: "integration-mailchimp-active",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Send to Active Subscribers",
                        provider: "mailchimp",
                        operation: "sendCampaign",
                        segment: "active"
                    }
                },
                {
                    id: "integration-mailchimp-dormant",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Send Re-engagement",
                        provider: "mailchimp",
                        operation: "sendCampaign",
                        segment: "dormant"
                    }
                },
                {
                    id: "wait-1",
                    type: "wait",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Wait for Analytics",
                        duration: 86400000,
                        description: "Wait 24 hours for engagement data"
                    }
                },
                {
                    id: "integration-slack",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Report Results",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#marketing"
                    }
                },
                {
                    id: "integration-notion-archive",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Archive Newsletter",
                        provider: "notion",
                        operation: "createPage",
                        database: "Newsletter Archive"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Newsletter Sent",
                        outputName: "status",
                        value: "Newsletter sent successfully"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "trigger-1", target: "integration-notion" },
                { id: "e2", source: "trigger-1", target: "integration-sheets" },
                { id: "e3", source: "integration-notion", target: "transform-merge" },
                { id: "e4", source: "integration-sheets", target: "transform-merge" },
                { id: "e5", source: "transform-merge", target: "llm-body" },
                { id: "e6", source: "transform-merge", target: "llm-subject" },
                { id: "e7", source: "llm-body", target: "transform-compile" },
                { id: "e8", source: "llm-subject", target: "transform-compile" },
                { id: "e9", source: "transform-compile", target: "humanReview-1" },
                { id: "e10", source: "humanReview-1", target: "integration-mailchimp-active" },
                { id: "e11", source: "humanReview-1", target: "integration-mailchimp-dormant" },
                { id: "e12", source: "integration-mailchimp-active", target: "wait-1" },
                { id: "e13", source: "integration-mailchimp-dormant", target: "wait-1" },
                { id: "e14", source: "wait-1", target: "integration-slack" },
                { id: "e15", source: "wait-1", target: "integration-notion-archive" },
                { id: "e16", source: "integration-slack", target: "output-1" },
                { id: "e17", source: "integration-notion-archive", target: "output-1" }
            ]
        }
    },

    // Marketing Simple 6: Social Media Scheduler (6 nodes)
    {
        name: "Social Media Scheduler",
        description:
            "Quick social media post generator. Input a topic brief, get AI-optimized posts for Twitter and LinkedIn, and schedule them via Buffer.",
        category: "marketing",
        tags: ["social media", "scheduling", "quick", "simple"],
        required_integrations: ["twitter", "linkedin", "buffer"],
        featured: false,
        definition: {
            name: "Social Media Scheduler",
            nodes: [
                {
                    id: "input-1",
                    type: "input",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Topic Brief",
                        inputName: "brief",
                        inputVariable: "brief",
                        inputType: "text",
                        description: "What do you want to post about?"
                    }
                },
                {
                    id: "llm-twitter",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Twitter Post",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Create an engaging Twitter post (max 280 chars) about:\n\n{{brief}}\n\nUse relevant hashtags, make it conversational.",
                        outputVariable: "twitterPost"
                    }
                },
                {
                    id: "llm-linkedin",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate LinkedIn Post",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Create a professional LinkedIn post (200-400 words) about:\n\n{{brief}}\n\nInclude a hook, insights, and CTA.",
                        outputVariable: "linkedinPost"
                    }
                },
                {
                    id: "integration-buffer",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Schedule Posts",
                        provider: "buffer",
                        operation: "createPost"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Scheduled Posts",
                        outputName: "posts",
                        value: '{"twitter": "{{twitterPost.text}}", "linkedin": "{{linkedinPost.text}}"}'
                    }
                }
            ],
            edges: [
                { id: "e1", source: "input-1", target: "llm-twitter" },
                { id: "e2", source: "input-1", target: "llm-linkedin" },
                { id: "e3", source: "llm-twitter", target: "integration-buffer" },
                { id: "e4", source: "llm-linkedin", target: "integration-buffer" },
                { id: "e5", source: "integration-buffer", target: "output-1" }
            ]
        }
    },

    // ========================================================================
    // SALES (6 templates)
    // ========================================================================

    // Sales Advanced 1: Enterprise Account Planning System (17 nodes)
    {
        name: "Enterprise Account Planning System",
        description:
            "Comprehensive enterprise deal management: enrich prospect data from multiple sources, build AI-powered stakeholder maps, route by deal size, create engagement calendars, and coordinate outreach.",
        category: "sales",
        tags: ["enterprise", "account planning", "stakeholder mapping", "deal management"],
        required_integrations: [
            "salesforce",
            "linkedin",
            "apollo",
            "notion",
            "slack",
            "gmail",
            "calendly"
        ],
        featured: true,
        definition: {
            name: "Enterprise Account Planning System",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "New Enterprise Opportunity",
                        triggerType: "webhook",
                        webhookProvider: "salesforce",
                        description: "Triggered when new opportunity >$100k is created"
                    }
                },
                {
                    id: "integration-salesforce-get",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get Opportunity Details",
                        provider: "salesforce",
                        operation: "getOpportunity"
                    }
                },
                {
                    id: "integration-apollo",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Enrich Company Data",
                        provider: "apollo",
                        operation: "enrichCompany"
                    }
                },
                {
                    id: "integration-linkedin",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Find Key Stakeholders",
                        provider: "linkedin",
                        operation: "searchPeople"
                    }
                },
                {
                    id: "url-1",
                    type: "url",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Research Company News",
                        urlVariable: "companyWebsite",
                        outputVariable: "companyNews"
                    }
                },
                {
                    id: "transform-aggregate",
                    type: "transform",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Aggregate Intel",
                        transformType: "template",
                        template:
                            '{"opportunity": "{{integration-salesforce-get.data}}", "company": "{{integration-apollo.data}}", "stakeholders": "{{integration-linkedin.data}}", "news": "{{companyNews.text}}"}',
                        outputVariable: "aggregatedIntel"
                    }
                },
                {
                    id: "llm-stakeholder-map",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Build Stakeholder Map",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Create a stakeholder analysis from this data:\n\n{{aggregatedIntel}}\n\nIdentify:\n1. Decision makers (economic buyer)\n2. Champions (internal advocates)\n3. Technical evaluators\n4. Potential blockers\n5. Recommended engagement strategy for each",
                        outputVariable: "stakeholderMap"
                    }
                },
                {
                    id: "llm-account-plan",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Account Plan",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Create a comprehensive account plan:\n\nStakeholders: {{stakeholderMap.text}}\nOpportunity: {{integration-salesforce-get.data}}\n\nInclude:\n1. Executive summary\n2. Value proposition alignment\n3. Competitive positioning\n4. Risk assessment\n5. 90-day action plan",
                        outputVariable: "accountPlan"
                    }
                },
                {
                    id: "router-dealsize",
                    type: "router",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Route by Deal Size",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Classify this deal by size:\n\nAmount: {{integration-salesforce-get.data.amount}}\n\nCategories: strategic (>$500k), enterprise ($100k-$500k), mid-market (<$100k)",
                        routes: [
                            {
                                value: "strategic",
                                label: "Strategic",
                                description: ">$500k deals requiring executive engagement"
                            },
                            {
                                value: "enterprise",
                                label: "Enterprise",
                                description: "$100k-$500k standard enterprise process"
                            },
                            {
                                value: "midmarket",
                                label: "Mid-Market",
                                description: "<$100k accelerated process"
                            }
                        ],
                        defaultRoute: "enterprise",
                        outputVariable: "dealTier"
                    }
                },
                {
                    id: "llm-exec-brief",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Create Exec Brief",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Create an executive briefing for leadership engagement:\n\n{{accountPlan.text}}\n\nFormat for C-level review with clear asks.",
                        outputVariable: "execBrief"
                    }
                },
                {
                    id: "integration-notion",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Save to Account Hub",
                        provider: "notion",
                        operation: "createPage",
                        database: "Account Plans"
                    }
                },
                {
                    id: "integration-salesforce-update",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Update Salesforce",
                        provider: "salesforce",
                        operation: "updateOpportunity"
                    }
                },
                {
                    id: "llm-emails",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Draft Outreach Emails",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Draft personalized outreach emails for key stakeholders:\n\n{{stakeholderMap.text}}\n\nCreate 3 emails: champion, economic buyer, technical evaluator.",
                        outputVariable: "draftEmails"
                    }
                },
                {
                    id: "integration-gmail",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Create Email Drafts",
                        provider: "gmail",
                        operation: "createDraft"
                    }
                },
                {
                    id: "integration-calendly",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Create Meeting Links",
                        provider: "calendly",
                        operation: "createEventType"
                    }
                },
                {
                    id: "integration-slack",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Notify Sales Team",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#enterprise-deals"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Account Plan Ready",
                        outputName: "accountPlan",
                        value: "{{accountPlan.text}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "trigger-1", target: "integration-salesforce-get" },
                { id: "e2", source: "integration-salesforce-get", target: "integration-apollo" },
                { id: "e3", source: "integration-salesforce-get", target: "integration-linkedin" },
                { id: "e4", source: "integration-salesforce-get", target: "url-1" },
                { id: "e5", source: "integration-apollo", target: "transform-aggregate" },
                { id: "e6", source: "integration-linkedin", target: "transform-aggregate" },
                { id: "e7", source: "url-1", target: "transform-aggregate" },
                { id: "e8", source: "transform-aggregate", target: "llm-stakeholder-map" },
                { id: "e9", source: "llm-stakeholder-map", target: "llm-account-plan" },
                { id: "e10", source: "llm-account-plan", target: "router-dealsize" },
                {
                    id: "e11",
                    source: "router-dealsize",
                    target: "llm-exec-brief",
                    sourceHandle: "strategic"
                },
                {
                    id: "e12",
                    source: "router-dealsize",
                    target: "integration-notion",
                    sourceHandle: "enterprise"
                },
                {
                    id: "e13",
                    source: "router-dealsize",
                    target: "llm-emails",
                    sourceHandle: "midmarket"
                },
                { id: "e14", source: "llm-exec-brief", target: "integration-notion" },
                {
                    id: "e15",
                    source: "integration-notion",
                    target: "integration-salesforce-update"
                },
                { id: "e16", source: "llm-emails", target: "integration-gmail" },
                { id: "e17", source: "integration-gmail", target: "integration-calendly" },
                { id: "e18", source: "integration-salesforce-update", target: "integration-slack" },
                { id: "e19", source: "integration-calendly", target: "integration-slack" },
                { id: "e20", source: "integration-slack", target: "output-1" }
            ]
        }
    },

    // Sales Advanced 2: Revenue Intelligence Hub (18 nodes)
    {
        name: "Revenue Intelligence Hub",
        description:
            "AI-powered revenue intelligence: analyze deal health, predict risks, score opportunities, route alerts by severity, provide coaching recommendations, and generate accurate forecasts.",
        category: "sales",
        tags: ["revenue intelligence", "forecasting", "deal health", "risk assessment"],
        required_integrations: [
            "hubspot",
            "slack",
            "notion",
            "google-sheets",
            "gmail",
            "amplitude"
        ],
        featured: true,
        definition: {
            name: "Revenue Intelligence Hub",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Deal Stage Changed",
                        triggerType: "webhook",
                        webhookProvider: "hubspot",
                        description: "Triggered on deal stage changes"
                    }
                },
                {
                    id: "integration-hubspot-deal",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get Deal Details",
                        provider: "hubspot",
                        operation: "getDeal"
                    }
                },
                {
                    id: "integration-hubspot-activities",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get Activities",
                        provider: "hubspot",
                        operation: "getEngagements"
                    }
                },
                {
                    id: "integration-hubspot-contacts",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get Contacts",
                        provider: "hubspot",
                        operation: "getAssociatedContacts"
                    }
                },
                {
                    id: "integration-amplitude",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get Product Usage",
                        provider: "amplitude",
                        operation: "getUserActivity"
                    }
                },
                {
                    id: "transform-aggregate",
                    type: "transform",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Aggregate Deal Data",
                        transformType: "template",
                        template:
                            '{"deal": "{{integration-hubspot-deal.data}}", "activities": "{{integration-hubspot-activities.data}}", "contacts": "{{integration-hubspot-contacts.data}}", "usage": "{{integration-amplitude.data}}"}',
                        outputVariable: "dealData"
                    }
                },
                {
                    id: "llm-analyze",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Analyze Deal Health",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Analyze this deal's health:\n\n{{dealData}}\n\nEvaluate:\n1. Engagement level (meeting frequency, response times)\n2. Multi-threading (stakeholder coverage)\n3. Product usage signals\n4. Timeline alignment\n5. Competitive indicators",
                        outputVariable: "healthAnalysis"
                    }
                },
                {
                    id: "llm-risk-score",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Calculate Risk Score",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: 'Based on this analysis:\n\n{{healthAnalysis.text}}\n\nReturn JSON: {"riskScore": 1-100, "riskFactors": [], "confidenceLevel": "high/medium/low", "predictedClose": "YYYY-MM-DD"}',
                        outputVariable: "riskScore"
                    }
                },
                {
                    id: "router-risk",
                    type: "router",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Route by Risk Level",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Classify risk level:\n\nRisk score: {{riskScore.text}}\n\nCategories: critical (>70), warning (40-70), healthy (<40)",
                        routes: [
                            {
                                value: "critical",
                                label: "Critical",
                                description: "High risk, immediate attention needed"
                            },
                            {
                                value: "warning",
                                label: "Warning",
                                description: "Moderate risk, monitor closely"
                            },
                            {
                                value: "healthy",
                                label: "Healthy",
                                description: "On track, standard process"
                            }
                        ],
                        defaultRoute: "warning",
                        outputVariable: "riskLevel"
                    }
                },
                {
                    id: "llm-coaching",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Coaching",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Generate specific coaching recommendations:\n\nAnalysis: {{healthAnalysis.text}}\nRisk: {{riskScore.text}}\n\nProvide 3-5 actionable next steps with talk tracks.",
                        outputVariable: "coaching"
                    }
                },
                {
                    id: "integration-slack-alert",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Alert Deal Desk",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#deal-desk-alerts"
                    }
                },
                {
                    id: "integration-gmail",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Email Sales Leader",
                        provider: "gmail",
                        operation: "sendEmail"
                    }
                },
                {
                    id: "integration-sheets",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Update Forecast",
                        provider: "google-sheets",
                        operation: "updateRow",
                        spreadsheetId: "",
                        sheetName: "Pipeline Forecast"
                    }
                },
                {
                    id: "integration-hubspot-update",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Update Deal Score",
                        provider: "hubspot",
                        operation: "updateDeal"
                    }
                },
                {
                    id: "integration-notion",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Log Analysis",
                        provider: "notion",
                        operation: "createPage"
                    }
                },
                {
                    id: "integration-slack-update",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Update Rep",
                        provider: "slack",
                        operation: "sendDirectMessage"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Intelligence Report",
                        outputName: "report",
                        value: "{{healthAnalysis.text}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "trigger-1", target: "integration-hubspot-deal" },
                {
                    id: "e2",
                    source: "integration-hubspot-deal",
                    target: "integration-hubspot-activities"
                },
                {
                    id: "e3",
                    source: "integration-hubspot-deal",
                    target: "integration-hubspot-contacts"
                },
                { id: "e4", source: "integration-hubspot-deal", target: "integration-amplitude" },
                {
                    id: "e5",
                    source: "integration-hubspot-activities",
                    target: "transform-aggregate"
                },
                { id: "e6", source: "integration-hubspot-contacts", target: "transform-aggregate" },
                { id: "e7", source: "integration-amplitude", target: "transform-aggregate" },
                { id: "e8", source: "transform-aggregate", target: "llm-analyze" },
                { id: "e9", source: "llm-analyze", target: "llm-risk-score" },
                { id: "e10", source: "llm-risk-score", target: "router-risk" },
                {
                    id: "e11",
                    source: "router-risk",
                    target: "integration-slack-alert",
                    sourceHandle: "critical"
                },
                {
                    id: "e12",
                    source: "router-risk",
                    target: "llm-coaching",
                    sourceHandle: "warning"
                },
                {
                    id: "e13",
                    source: "router-risk",
                    target: "integration-sheets",
                    sourceHandle: "healthy"
                },
                { id: "e14", source: "integration-slack-alert", target: "integration-gmail" },
                { id: "e15", source: "integration-gmail", target: "llm-coaching" },
                { id: "e16", source: "llm-coaching", target: "integration-hubspot-update" },
                { id: "e17", source: "integration-hubspot-update", target: "integration-notion" },
                { id: "e18", source: "integration-sheets", target: "integration-notion" },
                { id: "e19", source: "integration-notion", target: "integration-slack-update" },
                { id: "e20", source: "integration-slack-update", target: "output-1" }
            ]
        }
    },

    // Sales Advanced 3: Quote-to-Cash Accelerator (16 nodes)
    {
        name: "Quote-to-Cash Accelerator",
        description:
            "Streamline the quote-to-cash process: generate quotes, route through approval workflows based on deal terms, collect signatures via DocuSign, and track through to revenue recognition.",
        category: "sales",
        tags: ["quote-to-cash", "cpq", "approvals", "contracts"],
        required_integrations: ["salesforce", "docusign", "quickbooks", "slack", "gmail"],
        featured: true,
        definition: {
            name: "Quote-to-Cash Accelerator",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Quote Requested",
                        triggerType: "webhook",
                        webhookProvider: "salesforce",
                        description: "Triggered when quote is requested"
                    }
                },
                {
                    id: "integration-salesforce-get",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get Opportunity Data",
                        provider: "salesforce",
                        operation: "getOpportunity"
                    }
                },
                {
                    id: "llm-quote",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Quote",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Generate a professional quote document:\n\nOpportunity: {{integration-salesforce-get.data}}\n\nInclude: itemized pricing, terms, validity period, and payment terms.",
                        outputVariable: "quote"
                    }
                },
                {
                    id: "llm-review",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Review Quote",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Review this quote for errors and policy compliance:\n\n{{quote.text}}\n\nCheck: pricing accuracy, discount limits, term compliance.",
                        outputVariable: "quoteReview"
                    }
                },
                {
                    id: "router-approval",
                    type: "router",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Route for Approval",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Determine approval path:\n\nDeal value: {{integration-salesforce-get.data.amount}}\nDiscount: {{integration-salesforce-get.data.discount}}\n\nPaths: auto_approve (<$50k, <10% discount), manager ($50k-$200k or >10%), vp (>$200k or >20%), legal (custom terms)",
                        routes: [
                            {
                                value: "auto_approve",
                                label: "Auto Approve",
                                description: "Standard terms, auto-approved"
                            },
                            {
                                value: "manager",
                                label: "Manager",
                                description: "Manager approval required"
                            },
                            { value: "vp", label: "VP", description: "VP approval required" },
                            { value: "legal", label: "Legal", description: "Legal review required" }
                        ],
                        defaultRoute: "manager",
                        outputVariable: "approvalPath"
                    }
                },
                {
                    id: "humanReview-manager",
                    type: "humanReview",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Manager Review",
                        reviewPrompt: "Review and approve this quote",
                        outputVariable: "managerApproval"
                    }
                },
                {
                    id: "humanReview-vp",
                    type: "humanReview",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "VP Review",
                        reviewPrompt: "Executive approval required for this deal",
                        outputVariable: "vpApproval"
                    }
                },
                {
                    id: "humanReview-legal",
                    type: "humanReview",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Legal Review",
                        reviewPrompt: "Legal review of non-standard terms",
                        outputVariable: "legalApproval"
                    }
                },
                {
                    id: "transform-finalize",
                    type: "transform",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Finalize Quote",
                        transformType: "template",
                        template: "{{quote.text}}",
                        outputVariable: "finalQuote"
                    }
                },
                {
                    id: "integration-docusign",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Send for Signature",
                        provider: "docusign",
                        operation: "createEnvelope"
                    }
                },
                {
                    id: "wait-signature",
                    type: "wait",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Await Signature",
                        duration: 604800000,
                        description: "Wait up to 7 days for signature"
                    }
                },
                {
                    id: "conditional-signed",
                    type: "conditional",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Check Signature",
                        condition: "docusignStatus === 'completed'",
                        outputVariable: "isSigned"
                    }
                },
                {
                    id: "integration-salesforce-update",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Update to Closed Won",
                        provider: "salesforce",
                        operation: "updateOpportunity"
                    }
                },
                {
                    id: "integration-quickbooks",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Create Invoice",
                        provider: "quickbooks",
                        operation: "createInvoice"
                    }
                },
                {
                    id: "integration-slack",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Celebrate Win",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#wins"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Deal Complete",
                        outputName: "status",
                        value: "Quote-to-cash process complete"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "trigger-1", target: "integration-salesforce-get" },
                { id: "e2", source: "integration-salesforce-get", target: "llm-quote" },
                { id: "e3", source: "llm-quote", target: "llm-review" },
                { id: "e4", source: "llm-review", target: "router-approval" },
                {
                    id: "e5",
                    source: "router-approval",
                    target: "transform-finalize",
                    sourceHandle: "auto_approve"
                },
                {
                    id: "e6",
                    source: "router-approval",
                    target: "humanReview-manager",
                    sourceHandle: "manager"
                },
                {
                    id: "e7",
                    source: "router-approval",
                    target: "humanReview-vp",
                    sourceHandle: "vp"
                },
                {
                    id: "e8",
                    source: "router-approval",
                    target: "humanReview-legal",
                    sourceHandle: "legal"
                },
                { id: "e9", source: "humanReview-manager", target: "transform-finalize" },
                { id: "e10", source: "humanReview-vp", target: "transform-finalize" },
                { id: "e11", source: "humanReview-legal", target: "transform-finalize" },
                { id: "e12", source: "transform-finalize", target: "integration-docusign" },
                { id: "e13", source: "integration-docusign", target: "wait-signature" },
                { id: "e14", source: "wait-signature", target: "conditional-signed" },
                {
                    id: "e15",
                    source: "conditional-signed",
                    target: "integration-salesforce-update",
                    sourceHandle: "true"
                },
                {
                    id: "e16",
                    source: "integration-salesforce-update",
                    target: "integration-quickbooks"
                },
                { id: "e17", source: "integration-quickbooks", target: "integration-slack" },
                { id: "e18", source: "integration-slack", target: "output-1" }
            ]
        }
    },

    // Sales Intermediate 4: Lead Scoring & Routing (11 nodes)
    {
        name: "Lead Scoring & Routing",
        description:
            "Intelligent lead qualification: enrich leads with company data, score based on firmographics and behavior, route to appropriate sales rep based on territory and tier.",
        category: "sales",
        tags: ["lead scoring", "routing", "qualification", "assignment"],
        required_integrations: ["hubspot", "apollo", "slack", "gmail"],
        featured: false,
        definition: {
            name: "Lead Scoring & Routing",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "New Lead Created",
                        triggerType: "webhook",
                        webhookProvider: "hubspot"
                    }
                },
                {
                    id: "integration-hubspot-get",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get Lead Details",
                        provider: "hubspot",
                        operation: "getContact"
                    }
                },
                {
                    id: "integration-apollo",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Enrich Lead Data",
                        provider: "apollo",
                        operation: "enrichPerson"
                    }
                },
                {
                    id: "llm-score",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Score Lead",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: 'Score this lead (0-100) based on:\n\nLead data: {{integration-hubspot-get.data}}\nEnriched data: {{integration-apollo.data}}\n\nFactors: company size, industry fit, title seniority, engagement signals.\n\nReturn JSON: {"score": N, "tier": "hot/warm/cold", "reasoning": "..."}',
                        outputVariable: "leadScore"
                    }
                },
                {
                    id: "router-tier",
                    type: "router",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Route by Tier",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Route this lead:\n\n{{leadScore.text}}",
                        routes: [
                            {
                                value: "hot",
                                label: "Hot Lead",
                                description: "High priority, immediate follow-up"
                            },
                            {
                                value: "warm",
                                label: "Warm Lead",
                                description: "Standard qualification process"
                            },
                            { value: "cold", label: "Cold Lead", description: "Nurture sequence" }
                        ],
                        defaultRoute: "warm",
                        outputVariable: "routeDecision"
                    }
                },
                {
                    id: "integration-hubspot-update",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Update Lead Score",
                        provider: "hubspot",
                        operation: "updateContact"
                    }
                },
                {
                    id: "llm-assignment",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Determine Assignment",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Assign this lead to a rep based on:\n\nTerritory: {{integration-apollo.data.location}}\nCompany size: {{integration-apollo.data.employeeCount}}\nIndustry: {{integration-apollo.data.industry}}",
                        outputVariable: "assignment"
                    }
                },
                {
                    id: "integration-hubspot-assign",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Assign to Rep",
                        provider: "hubspot",
                        operation: "updateContactOwner"
                    }
                },
                {
                    id: "integration-slack",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Notify Rep",
                        provider: "slack",
                        operation: "sendDirectMessage"
                    }
                },
                {
                    id: "integration-gmail",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Send Intro Email",
                        provider: "gmail",
                        operation: "sendEmail"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Lead Routed",
                        outputName: "result",
                        value: "{{leadScore.text}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "trigger-1", target: "integration-hubspot-get" },
                { id: "e2", source: "integration-hubspot-get", target: "integration-apollo" },
                { id: "e3", source: "integration-apollo", target: "llm-score" },
                { id: "e4", source: "llm-score", target: "router-tier" },
                {
                    id: "e5",
                    source: "router-tier",
                    target: "integration-hubspot-update",
                    sourceHandle: "hot"
                },
                {
                    id: "e6",
                    source: "router-tier",
                    target: "integration-hubspot-update",
                    sourceHandle: "warm"
                },
                {
                    id: "e7",
                    source: "router-tier",
                    target: "integration-hubspot-update",
                    sourceHandle: "cold"
                },
                { id: "e8", source: "integration-hubspot-update", target: "llm-assignment" },
                { id: "e9", source: "llm-assignment", target: "integration-hubspot-assign" },
                { id: "e10", source: "integration-hubspot-assign", target: "integration-slack" },
                { id: "e11", source: "integration-slack", target: "integration-gmail" },
                { id: "e12", source: "integration-gmail", target: "output-1" }
            ]
        }
    },

    // Sales Intermediate 5: Meeting Follow-up Automation (9 nodes)
    {
        name: "Meeting Follow-up Automation",
        description:
            "Automate post-meeting workflows: generate AI summaries from meeting notes, send personalized follow-up emails, update CRM records, and schedule next steps.",
        category: "sales",
        tags: ["meetings", "follow-up", "automation", "crm"],
        required_integrations: ["calendly", "gmail", "hubspot", "slack"],
        featured: false,
        definition: {
            name: "Meeting Follow-up Automation",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Meeting Ended",
                        triggerType: "webhook",
                        webhookProvider: "calendly",
                        description: "Triggered when scheduled meeting ends"
                    }
                },
                {
                    id: "input-1",
                    type: "input",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Meeting Notes",
                        inputName: "notes",
                        inputVariable: "notes",
                        inputType: "text",
                        description: "Notes from the meeting"
                    }
                },
                {
                    id: "llm-summary",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Summary",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Create a meeting summary:\n\nMeeting: {{trigger-1.data}}\nNotes: {{notes}}\n\nInclude:\n1. Key discussion points\n2. Decisions made\n3. Action items with owners\n4. Next steps",
                        outputVariable: "summary"
                    }
                },
                {
                    id: "llm-followup",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Draft Follow-up Email",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Write a professional follow-up email:\n\n{{summary.text}}\n\nThank them, recap key points, list action items, propose next meeting.",
                        outputVariable: "followupEmail"
                    }
                },
                {
                    id: "integration-gmail",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Send Follow-up",
                        provider: "gmail",
                        operation: "sendEmail"
                    }
                },
                {
                    id: "integration-hubspot",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Log to CRM",
                        provider: "hubspot",
                        operation: "createEngagement"
                    }
                },
                {
                    id: "integration-calendly",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Schedule Next Meeting",
                        provider: "calendly",
                        operation: "createInvite"
                    }
                },
                {
                    id: "integration-slack",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Notify Team",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#sales-activity"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Follow-up Complete",
                        outputName: "summary",
                        value: "{{summary.text}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "trigger-1", target: "input-1" },
                { id: "e2", source: "input-1", target: "llm-summary" },
                { id: "e3", source: "llm-summary", target: "llm-followup" },
                { id: "e4", source: "llm-followup", target: "integration-gmail" },
                { id: "e5", source: "llm-summary", target: "integration-hubspot" },
                { id: "e6", source: "integration-gmail", target: "integration-calendly" },
                { id: "e7", source: "integration-hubspot", target: "integration-slack" },
                { id: "e8", source: "integration-calendly", target: "integration-slack" },
                { id: "e9", source: "integration-slack", target: "output-1" }
            ]
        }
    },

    // Sales Intermediate 6: Deal Stage Notifier (12 nodes)
    {
        name: "Deal Stage Notifier",
        description:
            "Intelligent deal tracking: when a deal changes stage in Salesforce, enrich with context, route by stage type (won/lost/progressed), and notify appropriate channels with AI-formatted summaries.",
        category: "sales",
        tags: ["notifications", "deal tracking", "routing", "alerts"],
        required_integrations: ["salesforce", "slack", "hubspot"],
        featured: false,
        definition: {
            name: "Deal Stage Notifier",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Deal Stage Changed",
                        triggerType: "webhook",
                        webhookProvider: "salesforce"
                    }
                },
                {
                    id: "integration-deal",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get Deal Details",
                        provider: "salesforce",
                        operation: "getOpportunity"
                    }
                },
                {
                    id: "integration-account",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get Account Info",
                        provider: "salesforce",
                        operation: "getAccount"
                    }
                },
                {
                    id: "transform-merge",
                    type: "transform",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Merge Deal Context",
                        transformType: "template",
                        template:
                            '{"deal": {{integration-deal.data}}, "account": {{integration-account.data}}}',
                        outputVariable: "dealContext"
                    }
                },
                {
                    id: "router-stage",
                    type: "router",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Route by Stage",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Classify this deal stage change",
                        routes: [
                            { value: "won", label: "Closed Won" },
                            { value: "lost", label: "Closed Lost" },
                            { value: "progressed", label: "Progressed" }
                        ]
                    }
                },
                {
                    id: "llm-won",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Format Win Announcement",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Create celebratory win announcement:\n\n{{dealContext}}\n\nInclude confetti emoji, deal value, account name, and team kudos!",
                        outputVariable: "winMessage"
                    }
                },
                {
                    id: "llm-lost",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Format Loss Analysis",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Create loss summary:\n\n{{dealContext}}\n\nInclude lessons learned prompt, follow-up timing suggestion.",
                        outputVariable: "lostMessage"
                    }
                },
                {
                    id: "llm-progress",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Format Progress Update",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Format deal progress update:\n\n{{dealContext}}\n\nInclude stage, next steps, timeline.",
                        outputVariable: "progressMessage"
                    }
                },
                {
                    id: "integration-slack-wins",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Post to #wins",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#wins"
                    }
                },
                {
                    id: "integration-slack-pipeline",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Post to #pipeline",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#sales-pipeline"
                    }
                },
                {
                    id: "integration-hubspot",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Log Activity",
                        provider: "hubspot",
                        operation: "createEngagement"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Notification Sent",
                        outputName: "status",
                        value: "Deal update processed"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "trigger-1", target: "integration-deal" },
                { id: "e2", source: "trigger-1", target: "integration-account" },
                { id: "e3", source: "integration-deal", target: "transform-merge" },
                { id: "e4", source: "integration-account", target: "transform-merge" },
                { id: "e5", source: "transform-merge", target: "router-stage" },
                { id: "e6", source: "router-stage", target: "llm-won", sourceHandle: "won" },
                { id: "e7", source: "router-stage", target: "llm-lost", sourceHandle: "lost" },
                {
                    id: "e8",
                    source: "router-stage",
                    target: "llm-progress",
                    sourceHandle: "progressed"
                },
                { id: "e9", source: "llm-won", target: "integration-slack-wins" },
                { id: "e10", source: "llm-lost", target: "integration-slack-pipeline" },
                { id: "e11", source: "llm-progress", target: "integration-slack-pipeline" },
                { id: "e12", source: "integration-slack-wins", target: "integration-hubspot" },
                { id: "e13", source: "integration-slack-pipeline", target: "integration-hubspot" },
                { id: "e14", source: "integration-hubspot", target: "output-1" }
            ]
        }
    },

    // ========================================================================
    // OPERATIONS (5 templates)
    // ========================================================================

    // Operations Advanced 1: Intelligent Vendor Management (15 nodes)
    {
        name: "Intelligent Vendor Management",
        description:
            "Comprehensive vendor lifecycle management: onboard vendors with compliance checks, assess risks with AI, route by risk level, manage contracts, and schedule renewal reviews.",
        category: "operations",
        tags: ["vendor management", "compliance", "risk assessment", "contracts"],
        required_integrations: ["docusign", "google-drive", "notion", "slack", "gmail", "airtable"],
        featured: true,
        definition: {
            name: "Intelligent Vendor Management",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "New Vendor Request",
                        triggerType: "webhook",
                        description: "Triggered when new vendor onboarding is requested"
                    }
                },
                {
                    id: "input-1",
                    type: "input",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Vendor Information",
                        inputName: "vendorInfo",
                        inputVariable: "vendorInfo",
                        inputType: "json",
                        description:
                            '{"name": "", "services": "", "annualSpend": 0, "dataAccess": true}'
                    }
                },
                {
                    id: "url-1",
                    type: "url",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Fetch Company Info",
                        urlVariable: "vendorInfo.website",
                        outputVariable: "companyInfo"
                    }
                },
                {
                    id: "llm-compliance",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Check Compliance",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Evaluate this vendor for compliance:\n\nVendor: {{vendorInfo}}\nCompany info: {{companyInfo.text}}\n\nCheck: SOC2, GDPR, security certifications, insurance requirements.",
                        outputVariable: "complianceCheck"
                    }
                },
                {
                    id: "llm-risk",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Assess Risk",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: 'Perform risk assessment:\n\n{{complianceCheck.text}}\n\nEvaluate: financial stability, operational risk, data security risk, concentration risk.\n\nReturn JSON: {"riskScore": 1-100, "riskLevel": "low/medium/high/critical", "factors": []}',
                        outputVariable: "riskAssessment"
                    }
                },
                {
                    id: "router-risk",
                    type: "router",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Route by Risk",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Route based on risk level: {{riskAssessment.text}}",
                        routes: [
                            { value: "low", label: "Low Risk", description: "Standard onboarding" },
                            {
                                value: "medium",
                                label: "Medium Risk",
                                description: "Enhanced review"
                            },
                            { value: "high", label: "High Risk", description: "Executive approval" }
                        ],
                        defaultRoute: "medium",
                        outputVariable: "riskRoute"
                    }
                },
                {
                    id: "humanReview-1",
                    type: "humanReview",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Executive Review",
                        reviewPrompt: "High-risk vendor requires executive approval",
                        outputVariable: "execApproval"
                    }
                },
                {
                    id: "integration-airtable",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Add to Vendor Registry",
                        provider: "airtable",
                        operation: "createRecord",
                        table: "Vendors"
                    }
                },
                {
                    id: "integration-drive",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Create Vendor Folder",
                        provider: "google-drive",
                        operation: "createFolder"
                    }
                },
                {
                    id: "llm-contract",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Contract",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Generate vendor agreement terms based on:\n\nVendor: {{vendorInfo}}\nRisk: {{riskAssessment.text}}\n\nInclude appropriate SLAs, liability caps, and termination clauses.",
                        outputVariable: "contractTerms"
                    }
                },
                {
                    id: "integration-docusign",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Send for Signature",
                        provider: "docusign",
                        operation: "createEnvelope"
                    }
                },
                {
                    id: "integration-notion",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Create Vendor Page",
                        provider: "notion",
                        operation: "createPage"
                    }
                },
                {
                    id: "integration-gmail",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Send Welcome Email",
                        provider: "gmail",
                        operation: "sendEmail"
                    }
                },
                {
                    id: "integration-slack",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Notify Procurement",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#procurement"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Vendor Onboarded",
                        outputName: "status",
                        value: "Vendor onboarding complete"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "trigger-1", target: "input-1" },
                { id: "e2", source: "input-1", target: "url-1" },
                { id: "e3", source: "url-1", target: "llm-compliance" },
                { id: "e4", source: "llm-compliance", target: "llm-risk" },
                { id: "e5", source: "llm-risk", target: "router-risk" },
                {
                    id: "e6",
                    source: "router-risk",
                    target: "integration-airtable",
                    sourceHandle: "low"
                },
                {
                    id: "e7",
                    source: "router-risk",
                    target: "integration-airtable",
                    sourceHandle: "medium"
                },
                { id: "e8", source: "router-risk", target: "humanReview-1", sourceHandle: "high" },
                { id: "e9", source: "humanReview-1", target: "integration-airtable" },
                { id: "e10", source: "integration-airtable", target: "integration-drive" },
                { id: "e11", source: "integration-drive", target: "llm-contract" },
                { id: "e12", source: "llm-contract", target: "integration-docusign" },
                { id: "e13", source: "integration-docusign", target: "integration-notion" },
                { id: "e14", source: "integration-notion", target: "integration-gmail" },
                { id: "e15", source: "integration-gmail", target: "integration-slack" },
                { id: "e16", source: "integration-slack", target: "output-1" }
            ]
        }
    },

    // Operations Advanced 2: Global Event Coordinator (18 nodes)
    {
        name: "Global Event Coordinator",
        description:
            "End-to-end event management: handle registrations, coordinate speakers, manage materials, send reminders, and execute post-event follow-ups with attendee engagement tracking.",
        category: "operations",
        tags: ["events", "coordination", "registration", "multi-step"],
        required_integrations: [
            "google-calendar",
            "calendly",
            "mailchimp",
            "notion",
            "slack",
            "airtable"
        ],
        featured: true,
        definition: {
            name: "Global Event Coordinator",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Event Created",
                        triggerType: "webhook",
                        description: "New event added to calendar"
                    }
                },
                {
                    id: "integration-calendar-get",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get Event Details",
                        provider: "google-calendar",
                        operation: "getEvent"
                    }
                },
                {
                    id: "llm-plan",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Create Event Plan",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Create an event execution plan:\n\n{{integration-calendar-get.data}}\n\nInclude: timeline, roles, materials needed, communication plan.",
                        outputVariable: "eventPlan"
                    }
                },
                {
                    id: "integration-airtable",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Create Registration",
                        provider: "airtable",
                        operation: "createRecord",
                        table: "Event Registrations"
                    }
                },
                {
                    id: "integration-calendly-speaker1",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Schedule Speaker 1",
                        provider: "calendly",
                        operation: "createEventType"
                    }
                },
                {
                    id: "integration-calendly-speaker2",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Schedule Speaker 2",
                        provider: "calendly",
                        operation: "createEventType"
                    }
                },
                {
                    id: "integration-calendly-speaker3",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Schedule Speaker 3",
                        provider: "calendly",
                        operation: "createEventType"
                    }
                },
                {
                    id: "transform-speakers",
                    type: "transform",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Compile Speaker Schedule",
                        transformType: "template",
                        template:
                            '{"speakers": [{{integration-calendly-speaker1.data}}, {{integration-calendly-speaker2.data}}, {{integration-calendly-speaker3.data}}]}',
                        outputVariable: "speakerSchedule"
                    }
                },
                {
                    id: "llm-materials",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Materials List",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Create materials checklist for:\n\n{{eventPlan.text}}\n{{speakerSchedule}}\n\nInclude: presentations, handouts, setup requirements.",
                        outputVariable: "materials"
                    }
                },
                {
                    id: "integration-notion",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Create Event Hub",
                        provider: "notion",
                        operation: "createPage"
                    }
                },
                {
                    id: "llm-invite",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Create Invitation",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Write an engaging event invitation email:\n\n{{integration-calendar-get.data}}\n\nInclude: value prop, agenda highlights, registration CTA.",
                        outputVariable: "invitation"
                    }
                },
                {
                    id: "integration-mailchimp",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Send Invitations",
                        provider: "mailchimp",
                        operation: "sendCampaign"
                    }
                },
                {
                    id: "wait-1",
                    type: "wait",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Wait Until Event Day",
                        duration: 86400000,
                        description: "Wait until event start"
                    }
                },
                {
                    id: "llm-reminder",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Create Reminder",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Write a reminder email for tomorrow's event:\n\n{{integration-calendar-get.data}}",
                        outputVariable: "reminder"
                    }
                },
                {
                    id: "integration-mailchimp-reminder",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Send Reminders",
                        provider: "mailchimp",
                        operation: "sendCampaign"
                    }
                },
                {
                    id: "llm-followup",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Create Follow-up",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Write post-event follow-up email:\n\n{{integration-calendar-get.data}}\n\nInclude: thank you, recording link, resources, feedback survey.",
                        outputVariable: "followup"
                    }
                },
                {
                    id: "integration-slack",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Notify Team",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#events"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Event Complete",
                        outputName: "status",
                        value: "Event coordination complete"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "trigger-1", target: "integration-calendar-get" },
                { id: "e2", source: "integration-calendar-get", target: "llm-plan" },
                { id: "e3", source: "llm-plan", target: "integration-airtable" },
                { id: "e4", source: "llm-plan", target: "integration-calendly-speaker1" },
                { id: "e5", source: "llm-plan", target: "integration-calendly-speaker2" },
                { id: "e6", source: "llm-plan", target: "integration-calendly-speaker3" },
                { id: "e7", source: "integration-calendly-speaker1", target: "transform-speakers" },
                { id: "e8", source: "integration-calendly-speaker2", target: "transform-speakers" },
                { id: "e9", source: "integration-calendly-speaker3", target: "transform-speakers" },
                { id: "e10", source: "transform-speakers", target: "llm-materials" },
                { id: "e11", source: "llm-materials", target: "integration-notion" },
                { id: "e12", source: "integration-airtable", target: "llm-invite" },
                { id: "e13", source: "llm-invite", target: "integration-mailchimp" },
                { id: "e14", source: "integration-mailchimp", target: "wait-1" },
                { id: "e15", source: "wait-1", target: "llm-reminder" },
                { id: "e16", source: "llm-reminder", target: "integration-mailchimp-reminder" },
                { id: "e17", source: "integration-mailchimp-reminder", target: "llm-followup" },
                { id: "e18", source: "llm-followup", target: "integration-slack" },
                { id: "e19", source: "integration-notion", target: "integration-slack" },
                { id: "e20", source: "integration-slack", target: "output-1" }
            ]
        }
    },

    // Operations Intermediate 3: Expense Approval Workflow (10 nodes)
    {
        name: "Expense Approval Workflow",
        description:
            "Automated expense processing: categorize expenses with AI, route approvals based on amount, track in accounting, and notify stakeholders.",
        category: "finance",
        tags: ["expenses", "approvals", "finance", "automation"],
        required_integrations: ["slack", "google-sheets", "gmail", "quickbooks"],
        featured: false,
        definition: {
            name: "Expense Approval Workflow",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Expense Submitted",
                        triggerType: "webhook",
                        description: "New expense report submitted"
                    }
                },
                {
                    id: "llm-categorize",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Categorize Expense",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: 'Categorize this expense:\n\n{{trigger-1.data}}\n\nCategories: travel, meals, software, equipment, office, marketing, other.\n\nReturn JSON: {"category": "", "taxDeductible": true/false, "requiresReceipt": true/false}',
                        outputVariable: "category"
                    }
                },
                {
                    id: "router-amount",
                    type: "router",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Route by Amount",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Route expense approval:\nAmount: {{trigger-1.data.amount}}\n\nPaths: auto (<$100), manager ($100-$1000), director (>$1000)",
                        routes: [
                            { value: "auto", label: "Auto Approve", description: "Under $100" },
                            { value: "manager", label: "Manager", description: "$100-$1000" },
                            { value: "director", label: "Director", description: "Over $1000" }
                        ],
                        defaultRoute: "manager",
                        outputVariable: "approvalRoute"
                    }
                },
                {
                    id: "humanReview-manager",
                    type: "humanReview",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Manager Approval",
                        reviewPrompt: "Approve this expense?",
                        outputVariable: "managerApproval"
                    }
                },
                {
                    id: "humanReview-director",
                    type: "humanReview",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Director Approval",
                        reviewPrompt: "Large expense requires director approval",
                        outputVariable: "directorApproval"
                    }
                },
                {
                    id: "integration-sheets",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Log to Tracker",
                        provider: "google-sheets",
                        operation: "appendRow",
                        spreadsheetId: "",
                        sheetName: "Expenses"
                    }
                },
                {
                    id: "integration-quickbooks",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Record in QuickBooks",
                        provider: "quickbooks",
                        operation: "createExpense"
                    }
                },
                {
                    id: "integration-gmail",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Notify Submitter",
                        provider: "gmail",
                        operation: "sendEmail"
                    }
                },
                {
                    id: "integration-slack",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Post to Finance",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#finance"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Expense Processed",
                        outputName: "status",
                        value: "Expense approved and recorded"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "trigger-1", target: "llm-categorize" },
                { id: "e2", source: "llm-categorize", target: "router-amount" },
                {
                    id: "e3",
                    source: "router-amount",
                    target: "integration-sheets",
                    sourceHandle: "auto"
                },
                {
                    id: "e4",
                    source: "router-amount",
                    target: "humanReview-manager",
                    sourceHandle: "manager"
                },
                {
                    id: "e5",
                    source: "router-amount",
                    target: "humanReview-director",
                    sourceHandle: "director"
                },
                { id: "e6", source: "humanReview-manager", target: "integration-sheets" },
                { id: "e7", source: "humanReview-director", target: "integration-sheets" },
                { id: "e8", source: "integration-sheets", target: "integration-quickbooks" },
                { id: "e9", source: "integration-quickbooks", target: "integration-gmail" },
                { id: "e10", source: "integration-gmail", target: "integration-slack" },
                { id: "e11", source: "integration-slack", target: "output-1" }
            ]
        }
    },

    // Operations Intermediate 4: Employee Onboarding Orchestrator (12 nodes)
    {
        name: "Employee Onboarding Orchestrator",
        description:
            "Streamlined new hire onboarding: set up accounts, schedule orientation, assign buddy, create onboarding checklist, and track 30-60-90 day progress.",
        category: "hr",
        tags: ["onboarding", "HR", "new hire", "automation"],
        required_integrations: ["notion", "slack", "google-calendar", "gmail"],
        featured: false,
        definition: {
            name: "Employee Onboarding Orchestrator",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "New Hire Added",
                        triggerType: "webhook",
                        description: "Triggered when new employee is added to HRIS"
                    }
                },
                {
                    id: "llm-plan",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Create Onboarding Plan",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Create personalized onboarding plan:\n\nNew hire: {{trigger-1.data}}\n\nInclude: first day checklist, first week goals, 30-60-90 day milestones.",
                        outputVariable: "onboardingPlan"
                    }
                },
                {
                    id: "integration-notion-checklist",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Create Checklist",
                        provider: "notion",
                        operation: "createPage",
                        database: "Onboarding"
                    }
                },
                {
                    id: "integration-slack-channel",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Create Welcome Channel",
                        provider: "slack",
                        operation: "createChannel"
                    }
                },
                {
                    id: "integration-calendar-orientation",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Schedule Orientation",
                        provider: "google-calendar",
                        operation: "createEvent"
                    }
                },
                {
                    id: "integration-calendar-meetings",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Schedule Key Meetings",
                        provider: "google-calendar",
                        operation: "createEvent"
                    }
                },
                {
                    id: "llm-buddy",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Assign Buddy",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Suggest an onboarding buddy based on:\n\nNew hire role: {{trigger-1.data.role}}\nDepartment: {{trigger-1.data.department}}\n\nConsider: similar role, tenure, availability.",
                        outputVariable: "buddyAssignment"
                    }
                },
                {
                    id: "integration-slack-buddy",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Notify Buddy",
                        provider: "slack",
                        operation: "sendDirectMessage"
                    }
                },
                {
                    id: "llm-welcome",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Create Welcome Message",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Write a warm welcome email:\n\nNew hire: {{trigger-1.data}}\nStart date: {{trigger-1.data.startDate}}\n\nInclude: excitement, first day info, key contacts, what to expect.",
                        outputVariable: "welcomeEmail"
                    }
                },
                {
                    id: "integration-gmail",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Send Welcome Email",
                        provider: "gmail",
                        operation: "sendEmail"
                    }
                },
                {
                    id: "integration-slack-announce",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Announce New Hire",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#general"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Onboarding Initiated",
                        outputName: "status",
                        value: "{{onboardingPlan.text}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "trigger-1", target: "llm-plan" },
                { id: "e2", source: "llm-plan", target: "integration-notion-checklist" },
                { id: "e3", source: "llm-plan", target: "integration-slack-channel" },
                { id: "e4", source: "llm-plan", target: "integration-calendar-orientation" },
                { id: "e5", source: "llm-plan", target: "integration-calendar-meetings" },
                { id: "e6", source: "llm-plan", target: "llm-buddy" },
                { id: "e7", source: "llm-buddy", target: "integration-slack-buddy" },
                { id: "e8", source: "integration-notion-checklist", target: "llm-welcome" },
                { id: "e9", source: "integration-slack-channel", target: "llm-welcome" },
                { id: "e10", source: "llm-welcome", target: "integration-gmail" },
                { id: "e11", source: "integration-gmail", target: "integration-slack-announce" },
                {
                    id: "e12",
                    source: "integration-slack-buddy",
                    target: "integration-slack-announce"
                },
                { id: "e13", source: "integration-slack-announce", target: "output-1" }
            ]
        }
    },

    // Operations Intermediate 5: Document Approval Flow (13 nodes)
    {
        name: "Document Approval Flow",
        description:
            "Intelligent document approval: classify document type, route to appropriate reviewer, handle approval/rejection paths, and update archives.",
        category: "operations",
        tags: ["documents", "approval", "routing", "workflow"],
        required_integrations: ["google-drive", "slack", "gmail", "notion"],
        featured: false,
        definition: {
            name: "Document Approval Flow",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Document Uploaded",
                        triggerType: "webhook",
                        webhookProvider: "google-drive"
                    }
                },
                {
                    id: "integration-drive",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get Document",
                        provider: "google-drive",
                        operation: "getFile"
                    }
                },
                {
                    id: "llm-classify",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Classify Document",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Classify this document type: contract, financial, policy, or general:\n\n{{integration-drive.data}}",
                        outputVariable: "docType"
                    }
                },
                {
                    id: "transform-context",
                    type: "transform",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Build Review Context",
                        transformType: "template",
                        template: '{"doc": {{integration-drive.data}}, "type": "{{docType.text}}"}',
                        outputVariable: "reviewContext"
                    }
                },
                {
                    id: "router-type",
                    type: "router",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Route by Type",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Route based on document type",
                        routes: [
                            { value: "legal", label: "Legal Review" },
                            { value: "finance", label: "Finance Review" },
                            { value: "general", label: "General Review" }
                        ]
                    }
                },
                {
                    id: "slack-legal",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Notify Legal",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#legal-review"
                    }
                },
                {
                    id: "slack-finance",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Notify Finance",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#finance-review"
                    }
                },
                {
                    id: "slack-general",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Notify Manager",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#document-review"
                    }
                },
                {
                    id: "humanReview-1",
                    type: "humanReview",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Review Document",
                        reviewPrompt: "Please review and approve this document",
                        outputVariable: "approval"
                    }
                },
                {
                    id: "integration-drive-approved",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Move to Approved",
                        provider: "google-drive",
                        operation: "moveFile",
                        folder: "Approved Documents"
                    }
                },
                {
                    id: "integration-notion",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Log to Archive",
                        provider: "notion",
                        operation: "createPage",
                        database: "Document Archive"
                    }
                },
                {
                    id: "integration-gmail",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Notify Submitter",
                        provider: "gmail",
                        operation: "sendEmail"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Review Complete",
                        outputName: "status",
                        value: "Document review complete"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "trigger-1", target: "integration-drive" },
                { id: "e2", source: "trigger-1", target: "llm-classify" },
                { id: "e3", source: "integration-drive", target: "transform-context" },
                { id: "e4", source: "llm-classify", target: "transform-context" },
                { id: "e5", source: "transform-context", target: "router-type" },
                { id: "e6", source: "router-type", target: "slack-legal", sourceHandle: "legal" },
                {
                    id: "e7",
                    source: "router-type",
                    target: "slack-finance",
                    sourceHandle: "finance"
                },
                {
                    id: "e8",
                    source: "router-type",
                    target: "slack-general",
                    sourceHandle: "general"
                },
                { id: "e9", source: "slack-legal", target: "humanReview-1" },
                { id: "e10", source: "slack-finance", target: "humanReview-1" },
                { id: "e11", source: "slack-general", target: "humanReview-1" },
                { id: "e12", source: "humanReview-1", target: "integration-drive-approved" },
                { id: "e13", source: "humanReview-1", target: "integration-notion" },
                { id: "e14", source: "integration-drive-approved", target: "integration-gmail" },
                { id: "e15", source: "integration-notion", target: "integration-gmail" },
                { id: "e16", source: "integration-gmail", target: "output-1" }
            ]
        }
    },

    // ========================================================================
    // ENGINEERING (6 templates)
    // ========================================================================

    // Engineering Advanced 1: Release Orchestration Platform (19 nodes)
    {
        name: "Release Orchestration Platform",
        description:
            "Complete release management: generate changelogs, route by release type, get approvals, deploy with monitoring, handle rollbacks automatically, and notify stakeholders across channels.",
        category: "engineering",
        tags: ["release", "deployment", "CI/CD", "monitoring", "rollback"],
        required_integrations: [
            "github",
            "linear",
            "datadog",
            "slack",
            "microsoft-teams",
            "notion",
            "pagerduty"
        ],
        featured: true,
        definition: {
            name: "Release Orchestration Platform",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Release Branch Created",
                        triggerType: "webhook",
                        webhookProvider: "github",
                        description: "Triggered when release/* branch is created"
                    }
                },
                {
                    id: "integration-github-commits",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get Commits",
                        provider: "github",
                        operation: "listCommits"
                    }
                },
                {
                    id: "integration-linear",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get Linked Issues",
                        provider: "linear",
                        operation: "getIssues"
                    }
                },
                {
                    id: "llm-changelog",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Changelog",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Generate a changelog from:\n\nCommits: {{integration-github-commits.data}}\nIssues: {{integration-linear.data}}\n\nFormat: conventional changelog with categories (Features, Fixes, Breaking Changes).",
                        outputVariable: "changelog"
                    }
                },
                {
                    id: "router-type",
                    type: "router",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Route by Release Type",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Classify release type:\n\n{{changelog.text}}\n\nTypes: major (breaking changes), minor (features), patch (fixes), hotfix (critical)",
                        routes: [
                            {
                                value: "major",
                                label: "Major",
                                description: "Breaking changes, requires full approval"
                            },
                            {
                                value: "minor",
                                label: "Minor",
                                description: "New features, standard approval"
                            },
                            {
                                value: "patch",
                                label: "Patch",
                                description: "Bug fixes, quick approval"
                            },
                            {
                                value: "hotfix",
                                label: "Hotfix",
                                description: "Critical fix, expedited"
                            }
                        ],
                        defaultRoute: "minor",
                        outputVariable: "releaseType"
                    }
                },
                {
                    id: "humanReview-major",
                    type: "humanReview",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Major Release Approval",
                        reviewPrompt: "Major release with breaking changes requires VP approval",
                        outputVariable: "majorApproval"
                    }
                },
                {
                    id: "humanReview-minor",
                    type: "humanReview",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Release Approval",
                        reviewPrompt: "Approve this release for deployment?",
                        outputVariable: "releaseApproval"
                    }
                },
                {
                    id: "integration-github-release",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Create GitHub Release",
                        provider: "github",
                        operation: "createRelease"
                    }
                },
                {
                    id: "integration-github-deploy",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Trigger Deployment",
                        provider: "github",
                        operation: "createDeployment"
                    }
                },
                {
                    id: "wait-deploy",
                    type: "wait",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Wait for Deploy",
                        duration: 300000,
                        description: "Wait 5 minutes for deployment"
                    }
                },
                {
                    id: "integration-datadog",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Check Health Metrics",
                        provider: "datadog",
                        operation: "queryMetrics"
                    }
                },
                {
                    id: "llm-health",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Analyze Health",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: 'Analyze deployment health:\n\n{{integration-datadog.data}}\n\nCheck: error rates, latency, memory, CPU. Return JSON: {"healthy": true/false, "issues": []}',
                        outputVariable: "healthCheck"
                    }
                },
                {
                    id: "conditional-health",
                    type: "conditional",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Health Check",
                        condition: "healthCheck.healthy === true",
                        outputVariable: "isHealthy"
                    }
                },
                {
                    id: "integration-github-rollback",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Trigger Rollback",
                        provider: "github",
                        operation: "createDeployment"
                    }
                },
                {
                    id: "integration-pagerduty",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Create Incident",
                        provider: "pagerduty",
                        operation: "createIncident"
                    }
                },
                {
                    id: "integration-notion",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Update Release Notes",
                        provider: "notion",
                        operation: "createPage"
                    }
                },
                {
                    id: "integration-slack",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Notify Engineering",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#engineering"
                    }
                },
                {
                    id: "integration-teams",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Notify Stakeholders",
                        provider: "microsoft-teams",
                        operation: "sendMessage"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Release Complete",
                        outputName: "status",
                        value: "{{changelog.text}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "trigger-1", target: "integration-github-commits" },
                { id: "e2", source: "trigger-1", target: "integration-linear" },
                { id: "e3", source: "integration-github-commits", target: "llm-changelog" },
                { id: "e4", source: "integration-linear", target: "llm-changelog" },
                { id: "e5", source: "llm-changelog", target: "router-type" },
                {
                    id: "e6",
                    source: "router-type",
                    target: "humanReview-major",
                    sourceHandle: "major"
                },
                {
                    id: "e7",
                    source: "router-type",
                    target: "humanReview-minor",
                    sourceHandle: "minor"
                },
                {
                    id: "e8",
                    source: "router-type",
                    target: "integration-github-release",
                    sourceHandle: "patch"
                },
                {
                    id: "e9",
                    source: "router-type",
                    target: "integration-github-release",
                    sourceHandle: "hotfix"
                },
                { id: "e10", source: "humanReview-major", target: "integration-github-release" },
                { id: "e11", source: "humanReview-minor", target: "integration-github-release" },
                {
                    id: "e12",
                    source: "integration-github-release",
                    target: "integration-github-deploy"
                },
                { id: "e13", source: "integration-github-deploy", target: "wait-deploy" },
                { id: "e14", source: "wait-deploy", target: "integration-datadog" },
                { id: "e15", source: "integration-datadog", target: "llm-health" },
                { id: "e16", source: "llm-health", target: "conditional-health" },
                {
                    id: "e17",
                    source: "conditional-health",
                    target: "integration-notion",
                    sourceHandle: "true"
                },
                {
                    id: "e18",
                    source: "conditional-health",
                    target: "integration-github-rollback",
                    sourceHandle: "false"
                },
                {
                    id: "e19",
                    source: "integration-github-rollback",
                    target: "integration-pagerduty"
                },
                { id: "e20", source: "integration-pagerduty", target: "integration-slack" },
                { id: "e21", source: "integration-notion", target: "integration-slack" },
                { id: "e22", source: "integration-slack", target: "integration-teams" },
                { id: "e23", source: "integration-teams", target: "output-1" }
            ]
        }
    },

    // Engineering Advanced 2: Infrastructure Cost Optimizer (16 nodes)
    {
        name: "Infrastructure Cost Optimizer",
        description:
            "Automated cloud cost optimization: analyze usage across services, identify savings opportunities with AI, route recommendations by impact, create tickets for implementation, and track results.",
        category: "engineering",
        tags: ["cost optimization", "cloud", "infrastructure", "automation"],
        required_integrations: ["datadog", "slack", "notion", "jira", "google-sheets"],
        featured: true,
        definition: {
            name: "Infrastructure Cost Optimizer",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Weekly Schedule",
                        triggerType: "schedule",
                        schedule: "0 9 * * 1",
                        description: "Every Monday at 9am"
                    }
                },
                {
                    id: "integration-datadog-compute",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get Compute Metrics",
                        provider: "datadog",
                        operation: "queryMetrics",
                        query: "compute costs"
                    }
                },
                {
                    id: "integration-datadog-storage",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get Storage Metrics",
                        provider: "datadog",
                        operation: "queryMetrics",
                        query: "storage costs"
                    }
                },
                {
                    id: "integration-datadog-network",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get Network Metrics",
                        provider: "datadog",
                        operation: "queryMetrics",
                        query: "network costs"
                    }
                },
                {
                    id: "transform-aggregate",
                    type: "transform",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Aggregate Costs",
                        transformType: "template",
                        template:
                            '{"compute": "{{integration-datadog-compute.data}}", "storage": "{{integration-datadog-storage.data}}", "network": "{{integration-datadog-network.data}}"}',
                        outputVariable: "costData"
                    }
                },
                {
                    id: "llm-analyze",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Analyze Costs",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Analyze cloud infrastructure costs:\n\n{{costData}}\n\nIdentify:\n1. Underutilized resources\n2. Reserved instance opportunities\n3. Right-sizing recommendations\n4. Waste elimination\n5. Architecture optimizations",
                        outputVariable: "analysis"
                    }
                },
                {
                    id: "llm-recommend",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Recommendations",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Generate actionable recommendations:\n\n{{analysis.text}}\n\nFor each: estimated savings, effort level, risk assessment, implementation steps.",
                        outputVariable: "recommendations"
                    }
                },
                {
                    id: "router-savings",
                    type: "router",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Route by Savings",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Classify total savings potential:\n\n{{recommendations.text}}\n\nCategories: high (>$10k/mo), medium ($1k-$10k), low (<$1k)",
                        routes: [
                            {
                                value: "high",
                                label: "High Impact",
                                description: ">$10k monthly savings"
                            },
                            {
                                value: "medium",
                                label: "Medium Impact",
                                description: "$1k-$10k monthly"
                            },
                            { value: "low", label: "Low Impact", description: "<$1k monthly" }
                        ],
                        defaultRoute: "medium",
                        outputVariable: "savingsLevel"
                    }
                },
                {
                    id: "integration-jira-high",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Create Priority Epic",
                        provider: "jira",
                        operation: "createIssue",
                        issueType: "Epic"
                    }
                },
                {
                    id: "integration-jira-medium",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Create Stories",
                        provider: "jira",
                        operation: "createIssue",
                        issueType: "Story"
                    }
                },
                {
                    id: "integration-sheets",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Log to Tracker",
                        provider: "google-sheets",
                        operation: "appendRow"
                    }
                },
                {
                    id: "llm-report",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Report",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Create executive cost report:\n\n{{analysis.text}}\n{{recommendations.text}}\n\nFormat: key metrics, trend analysis, top recommendations, projected savings.",
                        outputVariable: "report"
                    }
                },
                {
                    id: "integration-notion",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Update Dashboard",
                        provider: "notion",
                        operation: "updatePage"
                    }
                },
                {
                    id: "integration-slack-alert",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Alert Leadership",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#engineering-leadership"
                    }
                },
                {
                    id: "integration-slack",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Post Summary",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#infrastructure"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Cost Analysis Complete",
                        outputName: "report",
                        value: "{{report.text}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "trigger-1", target: "integration-datadog-compute" },
                { id: "e2", source: "trigger-1", target: "integration-datadog-storage" },
                { id: "e3", source: "trigger-1", target: "integration-datadog-network" },
                { id: "e4", source: "integration-datadog-compute", target: "transform-aggregate" },
                { id: "e5", source: "integration-datadog-storage", target: "transform-aggregate" },
                { id: "e6", source: "integration-datadog-network", target: "transform-aggregate" },
                { id: "e7", source: "transform-aggregate", target: "llm-analyze" },
                { id: "e8", source: "llm-analyze", target: "llm-recommend" },
                { id: "e9", source: "llm-recommend", target: "router-savings" },
                {
                    id: "e10",
                    source: "router-savings",
                    target: "integration-jira-high",
                    sourceHandle: "high"
                },
                {
                    id: "e11",
                    source: "router-savings",
                    target: "integration-jira-medium",
                    sourceHandle: "medium"
                },
                {
                    id: "e12",
                    source: "router-savings",
                    target: "integration-sheets",
                    sourceHandle: "low"
                },
                { id: "e13", source: "integration-jira-high", target: "integration-slack-alert" },
                { id: "e14", source: "integration-jira-medium", target: "llm-report" },
                { id: "e15", source: "integration-sheets", target: "llm-report" },
                { id: "e16", source: "integration-slack-alert", target: "llm-report" },
                { id: "e17", source: "llm-report", target: "integration-notion" },
                { id: "e18", source: "integration-notion", target: "integration-slack" },
                { id: "e19", source: "integration-slack", target: "output-1" }
            ]
        }
    },

    // Engineering Advanced 3: API Health & Documentation Sync (15 nodes)
    {
        name: "API Health & Documentation Sync",
        description:
            "Maintain API quality: monitor spec changes, detect breaking changes with AI, generate migration guides, update documentation, create tickets for issues, and notify affected teams.",
        category: "engineering",
        tags: ["API", "documentation", "monitoring", "breaking changes"],
        required_integrations: ["github", "datadog", "slack", "notion", "linear"],
        featured: true,
        definition: {
            name: "API Health & Documentation Sync",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "API Spec Updated",
                        triggerType: "webhook",
                        webhookProvider: "github",
                        description: "OpenAPI spec file changed"
                    }
                },
                {
                    id: "integration-github-old",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get Previous Spec",
                        provider: "github",
                        operation: "getContent"
                    }
                },
                {
                    id: "integration-github-new",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get New Spec",
                        provider: "github",
                        operation: "getContent"
                    }
                },
                {
                    id: "llm-diff",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Analyze Changes",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Compare these API specs and identify changes:\n\nOld: {{integration-github-old.data}}\nNew: {{integration-github-new.data}}\n\nIdentify: new endpoints, removed endpoints, parameter changes, response changes, breaking changes.",
                        outputVariable: "diffAnalysis"
                    }
                },
                {
                    id: "llm-breaking",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Detect Breaking Changes",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: 'Analyze for breaking changes:\n\n{{diffAnalysis.text}}\n\nReturn JSON: {"hasBreakingChanges": true/false, "breakingChanges": [], "severity": "critical/major/minor/none"}',
                        outputVariable: "breakingCheck"
                    }
                },
                {
                    id: "conditional-breaking",
                    type: "conditional",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Has Breaking Changes?",
                        condition: "breakingCheck.hasBreakingChanges === true",
                        outputVariable: "isBreaking"
                    }
                },
                {
                    id: "llm-migration",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Migration Guide",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Create a migration guide for these breaking changes:\n\n{{breakingCheck.text}}\n\nInclude: affected endpoints, required changes, code examples, timeline recommendations.",
                        outputVariable: "migrationGuide"
                    }
                },
                {
                    id: "integration-linear",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Create Migration Ticket",
                        provider: "linear",
                        operation: "createIssue"
                    }
                },
                {
                    id: "llm-docs",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Update Documentation",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Generate updated API documentation:\n\nChanges: {{diffAnalysis.text}}\n\nFormat for developer portal: endpoint descriptions, parameters, examples, response schemas.",
                        outputVariable: "updatedDocs"
                    }
                },
                {
                    id: "integration-notion",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Update API Docs",
                        provider: "notion",
                        operation: "updatePage"
                    }
                },
                {
                    id: "integration-github-pr",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Create Docs PR",
                        provider: "github",
                        operation: "createPullRequest"
                    }
                },
                {
                    id: "integration-datadog",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Update Monitors",
                        provider: "datadog",
                        operation: "createMonitor"
                    }
                },
                {
                    id: "integration-slack-alert",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Alert API Consumers",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#api-announcements"
                    }
                },
                {
                    id: "integration-slack",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Notify Team",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#engineering"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "API Sync Complete",
                        outputName: "status",
                        value: "{{diffAnalysis.text}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "trigger-1", target: "integration-github-old" },
                { id: "e2", source: "trigger-1", target: "integration-github-new" },
                { id: "e3", source: "integration-github-old", target: "llm-diff" },
                { id: "e4", source: "integration-github-new", target: "llm-diff" },
                { id: "e5", source: "llm-diff", target: "llm-breaking" },
                { id: "e6", source: "llm-breaking", target: "conditional-breaking" },
                {
                    id: "e7",
                    source: "conditional-breaking",
                    target: "llm-migration",
                    sourceHandle: "true"
                },
                {
                    id: "e8",
                    source: "conditional-breaking",
                    target: "llm-docs",
                    sourceHandle: "false"
                },
                { id: "e9", source: "llm-migration", target: "integration-linear" },
                { id: "e10", source: "llm-migration", target: "integration-slack-alert" },
                { id: "e11", source: "integration-linear", target: "llm-docs" },
                { id: "e12", source: "llm-docs", target: "integration-notion" },
                { id: "e13", source: "integration-notion", target: "integration-github-pr" },
                { id: "e14", source: "integration-github-pr", target: "integration-datadog" },
                { id: "e15", source: "integration-datadog", target: "integration-slack" },
                { id: "e16", source: "integration-slack-alert", target: "integration-slack" },
                { id: "e17", source: "integration-slack", target: "output-1" }
            ]
        }
    },

    // Engineering Intermediate 4: CI/CD Pipeline Monitor (11 nodes)
    {
        name: "CI/CD Pipeline Monitor",
        description:
            "Monitor build pipelines: analyze failures with AI, route alerts by severity, create tickets for recurring issues, and provide fix suggestions to developers.",
        category: "engineering",
        tags: ["CI/CD", "monitoring", "build failures", "automation"],
        required_integrations: ["github", "datadog", "slack", "pagerduty"],
        featured: false,
        definition: {
            name: "CI/CD Pipeline Monitor",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Build Failed",
                        triggerType: "webhook",
                        webhookProvider: "github",
                        description: "CI build failure detected"
                    }
                },
                {
                    id: "integration-github",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get Build Logs",
                        provider: "github",
                        operation: "getWorkflowRunLogs"
                    }
                },
                {
                    id: "llm-analyze",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Analyze Failure",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Analyze this build failure:\n\n{{integration-github.data}}\n\nIdentify: root cause, failure category (test/lint/build/deploy), affected files, fix suggestions.",
                        outputVariable: "analysis"
                    }
                },
                {
                    id: "llm-severity",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Assess Severity",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: 'Assess failure severity:\n\n{{analysis.text}}\n\nReturn JSON: {"severity": "critical/high/medium/low", "blocksProduction": true/false, "recurring": true/false}',
                        outputVariable: "severity"
                    }
                },
                {
                    id: "router-severity",
                    type: "router",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Route by Severity",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Route based on: {{severity.text}}",
                        routes: [
                            {
                                value: "critical",
                                label: "Critical",
                                description: "Page on-call immediately"
                            },
                            { value: "high", label: "High", description: "Alert team lead" },
                            { value: "medium", label: "Medium", description: "Notify channel" }
                        ],
                        defaultRoute: "medium",
                        outputVariable: "severityRoute"
                    }
                },
                {
                    id: "integration-pagerduty",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Page On-Call",
                        provider: "pagerduty",
                        operation: "createIncident"
                    }
                },
                {
                    id: "integration-slack-alert",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Alert Team Lead",
                        provider: "slack",
                        operation: "sendDirectMessage"
                    }
                },
                {
                    id: "llm-fix",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Fix Suggestions",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Provide fix suggestions for:\n\n{{analysis.text}}\n\nInclude: specific code changes, commands to run, links to relevant docs.",
                        outputVariable: "fixSuggestions"
                    }
                },
                {
                    id: "integration-github-comment",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Comment on PR",
                        provider: "github",
                        operation: "createComment"
                    }
                },
                {
                    id: "integration-slack",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Post to Channel",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#builds"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Failure Handled",
                        outputName: "analysis",
                        value: "{{analysis.text}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "trigger-1", target: "integration-github" },
                { id: "e2", source: "integration-github", target: "llm-analyze" },
                { id: "e3", source: "llm-analyze", target: "llm-severity" },
                { id: "e4", source: "llm-severity", target: "router-severity" },
                {
                    id: "e5",
                    source: "router-severity",
                    target: "integration-pagerduty",
                    sourceHandle: "critical"
                },
                {
                    id: "e6",
                    source: "router-severity",
                    target: "integration-slack-alert",
                    sourceHandle: "high"
                },
                { id: "e7", source: "router-severity", target: "llm-fix", sourceHandle: "medium" },
                { id: "e8", source: "integration-pagerduty", target: "llm-fix" },
                { id: "e9", source: "integration-slack-alert", target: "llm-fix" },
                { id: "e10", source: "llm-fix", target: "integration-github-comment" },
                { id: "e11", source: "integration-github-comment", target: "integration-slack" },
                { id: "e12", source: "integration-slack", target: "output-1" }
            ]
        }
    },

    // Engineering Intermediate 5: PR Review Automation (12 nodes)
    {
        name: "PR Review Automation",
        description:
            "Automated pull request reviews: analyze code changes with AI, post review comments, flag potential issues, create follow-up tickets, and track review metrics.",
        category: "engineering",
        tags: ["code review", "pull requests", "automation", "quality"],
        required_integrations: ["github", "slack", "linear"],
        featured: false,
        definition: {
            name: "PR Review Automation",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "PR Opened",
                        triggerType: "webhook",
                        webhookProvider: "github"
                    }
                },
                {
                    id: "integration-github-diff",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get PR Diff",
                        provider: "github",
                        operation: "getPullRequestDiff"
                    }
                },
                {
                    id: "integration-github-files",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get Changed Files",
                        provider: "github",
                        operation: "listPullRequestFiles"
                    }
                },
                {
                    id: "llm-review",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "AI Code Review",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Review this pull request:\n\nDiff: {{integration-github-diff.data}}\nFiles: {{integration-github-files.data}}\n\nCheck: bugs, security issues, performance problems, code style, best practices. Provide specific line comments.",
                        outputVariable: "review"
                    }
                },
                {
                    id: "llm-summary",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Summary",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Create PR review summary:\n\n{{review.text}}\n\nInclude: overview of changes, risk assessment, recommended reviewers, approval recommendation.",
                        outputVariable: "summary"
                    }
                },
                {
                    id: "conditional-issues",
                    type: "conditional",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Has Critical Issues?",
                        condition: "review.hasCriticalIssues === true",
                        outputVariable: "hasCritical"
                    }
                },
                {
                    id: "integration-github-comment",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Post Review Comments",
                        provider: "github",
                        operation: "createPullRequestReview"
                    }
                },
                {
                    id: "integration-linear",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Create Follow-up Ticket",
                        provider: "linear",
                        operation: "createIssue"
                    }
                },
                {
                    id: "integration-github-label",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Add Labels",
                        provider: "github",
                        operation: "addLabels"
                    }
                },
                {
                    id: "integration-slack-alert",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Alert Author",
                        provider: "slack",
                        operation: "sendDirectMessage"
                    }
                },
                {
                    id: "integration-slack",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Post to Review Channel",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#code-reviews"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Review Complete",
                        outputName: "summary",
                        value: "{{summary.text}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "trigger-1", target: "integration-github-diff" },
                { id: "e2", source: "trigger-1", target: "integration-github-files" },
                { id: "e3", source: "integration-github-diff", target: "llm-review" },
                { id: "e4", source: "integration-github-files", target: "llm-review" },
                { id: "e5", source: "llm-review", target: "llm-summary" },
                { id: "e6", source: "llm-summary", target: "conditional-issues" },
                {
                    id: "e7",
                    source: "conditional-issues",
                    target: "integration-linear",
                    sourceHandle: "true"
                },
                {
                    id: "e8",
                    source: "conditional-issues",
                    target: "integration-github-comment",
                    sourceHandle: "false"
                },
                { id: "e9", source: "integration-linear", target: "integration-slack-alert" },
                {
                    id: "e10",
                    source: "integration-slack-alert",
                    target: "integration-github-comment"
                },
                {
                    id: "e11",
                    source: "integration-github-comment",
                    target: "integration-github-label"
                },
                { id: "e12", source: "integration-github-label", target: "integration-slack" },
                { id: "e13", source: "integration-slack", target: "output-1" }
            ]
        }
    },

    // Engineering Intermediate 6: Deployment Notifier (12 nodes)
    {
        name: "Deployment Notifier",
        description:
            "Intelligent deployment notifications: classify release type, route to appropriate channels, notify stakeholders, and update changelog.",
        category: "engineering",
        tags: ["deployment", "notifications", "routing", "releases"],
        required_integrations: ["github", "slack", "notion", "linear"],
        featured: false,
        definition: {
            name: "Deployment Notifier",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Deployment Complete",
                        triggerType: "webhook",
                        webhookProvider: "github"
                    }
                },
                {
                    id: "integration-release",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get Release Info",
                        provider: "github",
                        operation: "getRelease"
                    }
                },
                {
                    id: "integration-commits",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get Commit History",
                        provider: "github",
                        operation: "listCommits"
                    }
                },
                {
                    id: "transform-merge",
                    type: "transform",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Merge Release Context",
                        transformType: "template",
                        template:
                            '{"release": {{integration-release.data}}, "commits": {{integration-commits.data}}}',
                        outputVariable: "releaseContext"
                    }
                },
                {
                    id: "router-type",
                    type: "router",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Route by Release Type",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Classify release type from version",
                        routes: [
                            { value: "major", label: "Major Release" },
                            { value: "minor", label: "Minor Release" },
                            { value: "patch", label: "Patch/Hotfix" }
                        ]
                    }
                },
                {
                    id: "llm-major",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Format Major Release",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Create comprehensive release notes for major release:\n\n{{releaseContext}}\n\nInclude: breaking changes, migration guide, feature highlights.",
                        outputVariable: "majorNotes"
                    }
                },
                {
                    id: "llm-minor",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Format Minor Release",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Format minor release notes:\n\n{{releaseContext}}\n\nHighlight new features and improvements.",
                        outputVariable: "minorNotes"
                    }
                },
                {
                    id: "llm-patch",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Format Patch Notes",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Format quick patch notes:\n\n{{releaseContext}}\n\nFocus on bug fixes.",
                        outputVariable: "patchNotes"
                    }
                },
                {
                    id: "integration-slack-eng",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Notify Engineering",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#engineering"
                    }
                },
                {
                    id: "integration-slack-announce",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Company Announcement",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#announcements"
                    }
                },
                {
                    id: "integration-notion",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Update Changelog",
                        provider: "notion",
                        operation: "createPage",
                        database: "Changelog"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Notification Complete",
                        outputName: "status",
                        value: "Deployment notifications sent"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "trigger-1", target: "integration-release" },
                { id: "e2", source: "trigger-1", target: "integration-commits" },
                { id: "e3", source: "integration-release", target: "transform-merge" },
                { id: "e4", source: "integration-commits", target: "transform-merge" },
                { id: "e5", source: "transform-merge", target: "router-type" },
                { id: "e6", source: "router-type", target: "llm-major", sourceHandle: "major" },
                { id: "e7", source: "router-type", target: "llm-minor", sourceHandle: "minor" },
                { id: "e8", source: "router-type", target: "llm-patch", sourceHandle: "patch" },
                { id: "e9", source: "llm-major", target: "integration-slack-eng" },
                { id: "e10", source: "llm-major", target: "integration-slack-announce" },
                { id: "e11", source: "llm-minor", target: "integration-slack-eng" },
                { id: "e12", source: "llm-patch", target: "integration-slack-eng" },
                { id: "e13", source: "integration-slack-eng", target: "integration-notion" },
                { id: "e14", source: "integration-slack-announce", target: "integration-notion" },
                { id: "e15", source: "integration-notion", target: "output-1" }
            ]
        }
    },

    // ========================================================================
    // SUPPORT (6 templates)
    // ========================================================================

    // Support Advanced 1: Customer Health Command Center (20 nodes)
    {
        name: "Customer Health Command Center",
        description:
            "Comprehensive customer health monitoring: aggregate data from multiple sources, calculate AI health scores, route by risk level, trigger appropriate playbooks, and coordinate CSM outreach.",
        category: "support",
        tags: ["customer success", "health scoring", "churn prevention", "automation"],
        required_integrations: [
            "hubspot",
            "intercom",
            "amplitude",
            "notion",
            "slack",
            "gmail",
            "calendly"
        ],
        featured: true,
        definition: {
            name: "Customer Health Command Center",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Health Check Trigger",
                        triggerType: "schedule",
                        schedule: "0 8 * * *",
                        description: "Daily customer health check"
                    }
                },
                {
                    id: "integration-hubspot",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get Customer Data",
                        provider: "hubspot",
                        operation: "getCompany"
                    }
                },
                {
                    id: "integration-intercom-conv",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get Support History",
                        provider: "intercom",
                        operation: "listConversations"
                    }
                },
                {
                    id: "integration-intercom-nps",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get NPS Scores",
                        provider: "intercom",
                        operation: "getSurveyResponses"
                    }
                },
                {
                    id: "integration-amplitude",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get Product Usage",
                        provider: "amplitude",
                        operation: "getUserActivity"
                    }
                },
                {
                    id: "transform-aggregate",
                    type: "transform",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Aggregate Data",
                        transformType: "template",
                        template:
                            '{"crm": "{{integration-hubspot.data}}", "support": "{{integration-intercom-conv.data}}", "nps": "{{integration-intercom-nps.data}}", "usage": "{{integration-amplitude.data}}"}',
                        outputVariable: "customerData"
                    }
                },
                {
                    id: "llm-health",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Calculate Health Score",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: 'Calculate customer health score:\n\n{{customerData}}\n\nFactors: product usage trends, support ticket volume/sentiment, NPS, contract value, engagement.\n\nReturn JSON: {"score": 0-100, "trend": "improving/stable/declining", "risks": [], "opportunities": []}',
                        outputVariable: "healthScore"
                    }
                },
                {
                    id: "router-health",
                    type: "router",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Route by Health",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Route based on health: {{healthScore.text}}\n\nCategories: critical (<40), at_risk (40-60), healthy (60-80), champion (>80)",
                        routes: [
                            {
                                value: "critical",
                                label: "Critical",
                                description: "Immediate intervention needed"
                            },
                            {
                                value: "at_risk",
                                label: "At Risk",
                                description: "Proactive outreach required"
                            },
                            { value: "healthy", label: "Healthy", description: "Standard nurture" },
                            {
                                value: "champion",
                                label: "Champion",
                                description: "Advocacy opportunity"
                            }
                        ],
                        defaultRoute: "healthy",
                        outputVariable: "healthRoute"
                    }
                },
                {
                    id: "llm-playbook-critical",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Critical Playbook",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Create urgent intervention plan:\n\n{{healthScore.text}}\n\nInclude: immediate actions, escalation path, executive involvement, retention offers.",
                        outputVariable: "criticalPlaybook"
                    }
                },
                {
                    id: "llm-playbook-risk",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "At-Risk Playbook",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Create proactive engagement plan:\n\n{{healthScore.text}}\n\nInclude: check-in cadence, value reinforcement, training offers, success milestones.",
                        outputVariable: "riskPlaybook"
                    }
                },
                {
                    id: "llm-playbook-champion",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Champion Playbook",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Create advocacy engagement plan:\n\n{{healthScore.text}}\n\nInclude: case study opportunity, referral program, beta access, speaking opportunities.",
                        outputVariable: "championPlaybook"
                    }
                },
                {
                    id: "integration-hubspot-update",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Update Health Score",
                        provider: "hubspot",
                        operation: "updateCompany"
                    }
                },
                {
                    id: "integration-notion",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Update Customer Hub",
                        provider: "notion",
                        operation: "updatePage"
                    }
                },
                {
                    id: "llm-email",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Draft Outreach Email",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Draft personalized outreach email based on:\n\nHealth: {{healthScore.text}}\n\nMake it personal, value-focused, with clear next steps.",
                        outputVariable: "outreachEmail"
                    }
                },
                {
                    id: "integration-gmail",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Send Email",
                        provider: "gmail",
                        operation: "sendEmail"
                    }
                },
                {
                    id: "integration-calendly",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Schedule Check-in",
                        provider: "calendly",
                        operation: "createInvite"
                    }
                },
                {
                    id: "integration-slack-csm",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Notify CSM",
                        provider: "slack",
                        operation: "sendDirectMessage"
                    }
                },
                {
                    id: "integration-slack-alert",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Alert Leadership",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#customer-alerts"
                    }
                },
                {
                    id: "integration-slack",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Post Summary",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#customer-success"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Health Check Complete",
                        outputName: "healthScore",
                        value: "{{healthScore.text}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "trigger-1", target: "integration-hubspot" },
                { id: "e2", source: "trigger-1", target: "integration-intercom-conv" },
                { id: "e3", source: "trigger-1", target: "integration-intercom-nps" },
                { id: "e4", source: "trigger-1", target: "integration-amplitude" },
                { id: "e5", source: "integration-hubspot", target: "transform-aggregate" },
                { id: "e6", source: "integration-intercom-conv", target: "transform-aggregate" },
                { id: "e7", source: "integration-intercom-nps", target: "transform-aggregate" },
                { id: "e8", source: "integration-amplitude", target: "transform-aggregate" },
                { id: "e9", source: "transform-aggregate", target: "llm-health" },
                { id: "e10", source: "llm-health", target: "router-health" },
                {
                    id: "e11",
                    source: "router-health",
                    target: "llm-playbook-critical",
                    sourceHandle: "critical"
                },
                {
                    id: "e12",
                    source: "router-health",
                    target: "llm-playbook-risk",
                    sourceHandle: "at_risk"
                },
                {
                    id: "e13",
                    source: "router-health",
                    target: "integration-hubspot-update",
                    sourceHandle: "healthy"
                },
                {
                    id: "e14",
                    source: "router-health",
                    target: "llm-playbook-champion",
                    sourceHandle: "champion"
                },
                { id: "e15", source: "llm-playbook-critical", target: "integration-slack-alert" },
                {
                    id: "e16",
                    source: "integration-slack-alert",
                    target: "integration-hubspot-update"
                },
                { id: "e17", source: "llm-playbook-risk", target: "llm-email" },
                { id: "e18", source: "llm-playbook-champion", target: "llm-email" },
                { id: "e19", source: "llm-email", target: "integration-gmail" },
                { id: "e20", source: "integration-gmail", target: "integration-calendly" },
                { id: "e21", source: "integration-hubspot-update", target: "integration-notion" },
                { id: "e22", source: "integration-calendly", target: "integration-slack-csm" },
                { id: "e23", source: "integration-notion", target: "integration-slack" },
                { id: "e24", source: "integration-slack-csm", target: "integration-slack" },
                { id: "e25", source: "integration-slack", target: "output-1" }
            ]
        }
    },

    // Support Intermediate 2: Support Ticket Triage (13 nodes)
    {
        name: "Support Ticket Triage",
        description:
            "Intelligent ticket management: classify incoming tickets with AI, route to appropriate team channel, set priority and SLA, and track resolution metrics.",
        category: "support",
        tags: ["ticketing", "triage", "classification", "automation"],
        required_integrations: ["zendesk", "slack", "notion"],
        featured: false,
        definition: {
            name: "Support Ticket Triage",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "New Ticket",
                        triggerType: "webhook",
                        webhookProvider: "zendesk"
                    }
                },
                {
                    id: "llm-classify",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Classify Ticket",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: 'Classify this support ticket:\n\n{{trigger-1.data}}\n\nReturn JSON: {"category": "technical/billing/general/bug", "priority": "urgent/high/medium/low", "sentiment": "positive/neutral/negative/frustrated", "suggestedTeam": ""}',
                        outputVariable: "classification"
                    }
                },
                {
                    id: "router-category",
                    type: "router",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Route by Category",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Route ticket based on category: {{classification.text}}",
                        routes: [
                            {
                                value: "technical",
                                label: "Technical",
                                description: "Technical support team"
                            },
                            { value: "billing", label: "Billing", description: "Billing team" },
                            { value: "bug", label: "Bug", description: "Engineering team" },
                            { value: "general", label: "General", description: "General support" }
                        ],
                        defaultRoute: "general",
                        outputVariable: "categoryRoute"
                    }
                },
                {
                    id: "slack-tech",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Notify Tech Team",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#tech-support"
                    }
                },
                {
                    id: "slack-billing",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Notify Billing Team",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#billing"
                    }
                },
                {
                    id: "slack-engineering",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Notify Engineering",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#engineering-bugs"
                    }
                },
                {
                    id: "slack-general",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Notify General Support",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#support-general"
                    }
                },
                {
                    id: "integration-zendesk-update",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Update Ticket",
                        provider: "zendesk",
                        operation: "updateTicket"
                    }
                },
                {
                    id: "llm-response",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Draft Response",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Draft initial response for:\n\nTicket: {{trigger-1.data}}\nClassification: {{classification.text}}\n\nBe empathetic, acknowledge the issue, set expectations.",
                        outputVariable: "draftResponse"
                    }
                },
                {
                    id: "integration-zendesk-comment",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Add Internal Note",
                        provider: "zendesk",
                        operation: "createComment"
                    }
                },
                {
                    id: "integration-notion",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Log to Tracker",
                        provider: "notion",
                        operation: "createPage"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Ticket Triaged",
                        outputName: "classification",
                        value: "{{classification.text}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "trigger-1", target: "llm-classify" },
                { id: "e2", source: "llm-classify", target: "router-category" },
                // Fan-out: Route to different team channels
                {
                    id: "e3",
                    source: "router-category",
                    target: "slack-tech",
                    sourceHandle: "technical"
                },
                {
                    id: "e4",
                    source: "router-category",
                    target: "slack-billing",
                    sourceHandle: "billing"
                },
                {
                    id: "e5",
                    source: "router-category",
                    target: "slack-engineering",
                    sourceHandle: "bug"
                },
                {
                    id: "e6",
                    source: "router-category",
                    target: "slack-general",
                    sourceHandle: "general"
                },
                // Fan-in: All paths converge to update ticket
                { id: "e7", source: "slack-tech", target: "integration-zendesk-update" },
                { id: "e8", source: "slack-billing", target: "integration-zendesk-update" },
                { id: "e9", source: "slack-engineering", target: "integration-zendesk-update" },
                { id: "e10", source: "slack-general", target: "integration-zendesk-update" },
                // Continue linear flow
                { id: "e11", source: "integration-zendesk-update", target: "llm-response" },
                { id: "e12", source: "llm-response", target: "integration-zendesk-comment" },
                { id: "e13", source: "integration-zendesk-comment", target: "integration-notion" },
                { id: "e14", source: "integration-notion", target: "output-1" }
            ]
        }
    },

    // Support Intermediate 3: CSAT Follow-up Workflow (9 nodes)
    {
        name: "CSAT Follow-up Workflow",
        description:
            "Handle customer satisfaction feedback: when low scores are received, fetch context, draft personalized recovery responses, and coordinate manager review.",
        category: "support",
        tags: ["CSAT", "feedback", "recovery", "customer satisfaction"],
        required_integrations: ["typeform", "hubspot", "slack", "gmail"],
        featured: false,
        definition: {
            name: "CSAT Follow-up Workflow",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Survey Response",
                        triggerType: "webhook",
                        webhookProvider: "typeform"
                    }
                },
                {
                    id: "conditional-low",
                    type: "conditional",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Is Low Score?",
                        condition: "trigger.score <= 3",
                        outputVariable: "isLowScore"
                    }
                },
                {
                    id: "integration-hubspot",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get Customer Context",
                        provider: "hubspot",
                        operation: "getContact"
                    }
                },
                {
                    id: "llm-analyze",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Analyze Feedback",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Analyze this negative feedback:\n\nScore: {{trigger-1.data.score}}\nFeedback: {{trigger-1.data.feedback}}\nCustomer: {{integration-hubspot.data}}\n\nIdentify: root cause, emotional state, service recovery needs.",
                        outputVariable: "analysis"
                    }
                },
                {
                    id: "llm-response",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Draft Recovery Email",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Draft a service recovery email:\n\nAnalysis: {{analysis.text}}\n\nBe genuine, acknowledge their frustration, offer concrete resolution steps.",
                        outputVariable: "recoveryEmail"
                    }
                },
                {
                    id: "humanReview-1",
                    type: "humanReview",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Manager Review",
                        reviewPrompt: "Review and approve this recovery response",
                        outputVariable: "approval"
                    }
                },
                {
                    id: "integration-gmail",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Send Recovery Email",
                        provider: "gmail",
                        operation: "sendEmail"
                    }
                },
                {
                    id: "integration-slack",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Log Recovery",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#customer-feedback"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Follow-up Complete",
                        outputName: "status",
                        value: "Recovery process initiated"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "trigger-1", target: "conditional-low" },
                {
                    id: "e2",
                    source: "conditional-low",
                    target: "integration-hubspot",
                    sourceHandle: "true"
                },
                { id: "e3", source: "conditional-low", target: "output-1", sourceHandle: "false" },
                { id: "e4", source: "integration-hubspot", target: "llm-analyze" },
                { id: "e5", source: "llm-analyze", target: "llm-response" },
                { id: "e6", source: "llm-response", target: "humanReview-1" },
                { id: "e7", source: "humanReview-1", target: "integration-gmail" },
                { id: "e8", source: "integration-gmail", target: "integration-slack" },
                { id: "e9", source: "integration-slack", target: "output-1" }
            ]
        }
    },

    // Support Intermediate 4: Ticket Status Notifier (12 nodes)
    {
        name: "Ticket Status Notifier",
        description:
            "Intelligent ticket routing: classify ticket priority, route to appropriate team channels, update CRM, and notify stakeholders.",
        category: "support",
        tags: ["tickets", "notifications", "routing", "status"],
        required_integrations: ["zendesk", "slack", "hubspot"],
        featured: false,
        definition: {
            name: "Ticket Status Notifier",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Ticket Updated",
                        triggerType: "webhook",
                        webhookProvider: "zendesk"
                    }
                },
                {
                    id: "integration-ticket",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get Ticket Details",
                        provider: "zendesk",
                        operation: "getTicket"
                    }
                },
                {
                    id: "integration-customer",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get Customer Info",
                        provider: "hubspot",
                        operation: "getContact"
                    }
                },
                {
                    id: "transform-context",
                    type: "transform",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Build Context",
                        transformType: "template",
                        template:
                            '{"ticket": {{integration-ticket.data}}, "customer": {{integration-customer.data}}}',
                        outputVariable: "ticketContext"
                    }
                },
                {
                    id: "router-priority",
                    type: "router",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Route by Priority",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Classify ticket priority",
                        routes: [
                            { value: "urgent", label: "Urgent/Escalated" },
                            { value: "high", label: "High Priority" },
                            { value: "normal", label: "Normal" }
                        ]
                    }
                },
                {
                    id: "llm-urgent",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Format Urgent Alert",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Format urgent ticket alert:\n\n{{ticketContext}}\n\nHighlight: severity, customer tier, SLA breach risk.",
                        outputVariable: "urgentMessage"
                    }
                },
                {
                    id: "llm-standard",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Format Standard Update",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Format ticket update:\n\n{{ticketContext}}\n\nInclude: ID, customer, status, assignee.",
                        outputVariable: "standardMessage"
                    }
                },
                {
                    id: "slack-escalations",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Alert Escalations",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#support-escalations"
                    }
                },
                {
                    id: "slack-general",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Post to Support",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#support-tickets"
                    }
                },
                {
                    id: "integration-hubspot",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Log Activity",
                        provider: "hubspot",
                        operation: "createNote"
                    }
                },
                {
                    id: "integration-zendesk-tag",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Update Tags",
                        provider: "zendesk",
                        operation: "updateTicket"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Notification Complete",
                        outputName: "status",
                        value: "Ticket notifications sent"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "trigger-1", target: "integration-ticket" },
                { id: "e2", source: "trigger-1", target: "integration-customer" },
                { id: "e3", source: "integration-ticket", target: "transform-context" },
                { id: "e4", source: "integration-customer", target: "transform-context" },
                { id: "e5", source: "transform-context", target: "router-priority" },
                {
                    id: "e6",
                    source: "router-priority",
                    target: "llm-urgent",
                    sourceHandle: "urgent"
                },
                {
                    id: "e7",
                    source: "router-priority",
                    target: "llm-standard",
                    sourceHandle: "high"
                },
                {
                    id: "e8",
                    source: "router-priority",
                    target: "llm-standard",
                    sourceHandle: "normal"
                },
                { id: "e9", source: "llm-urgent", target: "slack-escalations" },
                { id: "e10", source: "llm-standard", target: "slack-general" },
                { id: "e11", source: "slack-escalations", target: "integration-hubspot" },
                { id: "e12", source: "slack-general", target: "integration-hubspot" },
                { id: "e13", source: "integration-hubspot", target: "integration-zendesk-tag" },
                { id: "e14", source: "integration-zendesk-tag", target: "output-1" }
            ]
        }
    },

    // ========================================================================
    // E-COMMERCE (5 templates)
    // ========================================================================

    // E-commerce Advanced 1: Order Fulfillment Orchestrator (16 nodes)
    {
        name: "Order Fulfillment Orchestrator",
        description:
            "Complete order management: process new orders, check inventory, route by availability, handle payments, coordinate fulfillment, track shipping, and notify customers throughout.",
        category: "ecommerce",
        tags: ["orders", "fulfillment", "inventory", "shipping"],
        required_integrations: ["shopify", "slack", "gmail", "airtable", "google-sheets"],
        featured: true,
        definition: {
            name: "Order Fulfillment Orchestrator",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "New Order",
                        triggerType: "webhook",
                        webhookProvider: "shopify"
                    }
                },
                {
                    id: "integration-shopify-order",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get Order Details",
                        provider: "shopify",
                        operation: "getOrder"
                    }
                },
                {
                    id: "integration-shopify-inventory",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Check Inventory",
                        provider: "shopify",
                        operation: "getInventoryLevels"
                    }
                },
                {
                    id: "llm-validate",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Validate Order",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: 'Validate this order:\n\nOrder: {{integration-shopify-order.data}}\nInventory: {{integration-shopify-inventory.data}}\n\nReturn JSON: {"valid": true/false, "issues": [], "fulfillmentType": "standard/express/backorder"}',
                        outputVariable: "validation"
                    }
                },
                {
                    id: "router-fulfillment",
                    type: "router",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Route Fulfillment",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Route based on: {{validation.text}}",
                        routes: [
                            {
                                value: "standard",
                                label: "Standard",
                                description: "Normal fulfillment"
                            },
                            {
                                value: "express",
                                label: "Express",
                                description: "Priority processing"
                            },
                            {
                                value: "backorder",
                                label: "Backorder",
                                description: "Items not in stock"
                            }
                        ],
                        defaultRoute: "standard",
                        outputVariable: "fulfillmentRoute"
                    }
                },
                {
                    id: "integration-shopify-fulfill",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Create Fulfillment",
                        provider: "shopify",
                        operation: "createFulfillment"
                    }
                },
                {
                    id: "llm-customer-email",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Draft Confirmation",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Draft order confirmation email:\n\nOrder: {{integration-shopify-order.data}}\nFulfillment: {{validation.fulfillmentType}}\n\nBe friendly, include order details, expected delivery.",
                        outputVariable: "confirmationEmail"
                    }
                },
                {
                    id: "integration-gmail",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Send Confirmation",
                        provider: "gmail",
                        operation: "sendEmail"
                    }
                },
                {
                    id: "integration-airtable",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Log to Orders",
                        provider: "airtable",
                        operation: "createRecord"
                    }
                },
                {
                    id: "integration-sheets",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Update Inventory Log",
                        provider: "google-sheets",
                        operation: "appendRow"
                    }
                },
                {
                    id: "llm-backorder-email",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Draft Backorder Email",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Draft backorder notification:\n\nOrder: {{integration-shopify-order.data}}\n\nBe apologetic, provide ETA, offer alternatives.",
                        outputVariable: "backorderEmail"
                    }
                },
                {
                    id: "integration-gmail-backorder",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Send Backorder Notice",
                        provider: "gmail",
                        operation: "sendEmail"
                    }
                },
                {
                    id: "integration-slack-alert",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Alert Operations",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#operations"
                    }
                },
                {
                    id: "integration-slack",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Post Order Summary",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#orders"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Order Processed",
                        outputName: "status",
                        value: "Order fulfillment complete"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "trigger-1", target: "integration-shopify-order" },
                {
                    id: "e2",
                    source: "integration-shopify-order",
                    target: "integration-shopify-inventory"
                },
                { id: "e3", source: "integration-shopify-inventory", target: "llm-validate" },
                { id: "e4", source: "llm-validate", target: "router-fulfillment" },
                {
                    id: "e5",
                    source: "router-fulfillment",
                    target: "integration-shopify-fulfill",
                    sourceHandle: "standard"
                },
                {
                    id: "e6",
                    source: "router-fulfillment",
                    target: "integration-shopify-fulfill",
                    sourceHandle: "express"
                },
                {
                    id: "e7",
                    source: "router-fulfillment",
                    target: "llm-backorder-email",
                    sourceHandle: "backorder"
                },
                { id: "e8", source: "integration-shopify-fulfill", target: "llm-customer-email" },
                { id: "e9", source: "llm-customer-email", target: "integration-gmail" },
                { id: "e10", source: "integration-gmail", target: "integration-airtable" },
                { id: "e11", source: "integration-airtable", target: "integration-sheets" },
                { id: "e12", source: "llm-backorder-email", target: "integration-gmail-backorder" },
                {
                    id: "e13",
                    source: "integration-gmail-backorder",
                    target: "integration-slack-alert"
                },
                { id: "e14", source: "integration-slack-alert", target: "integration-airtable" },
                { id: "e15", source: "integration-sheets", target: "integration-slack" },
                { id: "e16", source: "integration-slack", target: "output-1" }
            ]
        }
    },

    // E-commerce Intermediate 2: Abandoned Cart Recovery (10 nodes)
    {
        name: "Abandoned Cart Recovery",
        description:
            "Win back abandoned carts: detect abandoned checkouts, wait appropriate time, verify not purchased, generate personalized recovery emails, and track conversion.",
        category: "ecommerce",
        tags: ["abandoned cart", "recovery", "email", "conversion"],
        required_integrations: ["shopify", "mailchimp", "slack"],
        featured: false,
        definition: {
            name: "Abandoned Cart Recovery",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Cart Abandoned",
                        triggerType: "webhook",
                        webhookProvider: "shopify"
                    }
                },
                {
                    id: "wait-1",
                    type: "wait",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Wait 1 Hour",
                        duration: 3600000,
                        description: "Allow time for natural completion"
                    }
                },
                {
                    id: "integration-shopify-check",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Check Order Status",
                        provider: "shopify",
                        operation: "getCheckout"
                    }
                },
                {
                    id: "conditional-purchased",
                    type: "conditional",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Already Purchased?",
                        condition: "checkout.completedAt !== null",
                        outputVariable: "isPurchased"
                    }
                },
                {
                    id: "llm-email",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Recovery Email",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Create a cart recovery email:\n\nCart: {{trigger-1.data}}\n\nBe friendly, remind them what they left, offer help, include direct checkout link.",
                        outputVariable: "recoveryEmail"
                    }
                },
                {
                    id: "integration-shopify-discount",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Create Discount Code",
                        provider: "shopify",
                        operation: "createDiscount"
                    }
                },
                {
                    id: "integration-mailchimp",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Send Recovery Email",
                        provider: "mailchimp",
                        operation: "sendEmail"
                    }
                },
                {
                    id: "integration-slack",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Log Recovery Attempt",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#abandoned-carts"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Recovery Initiated",
                        outputName: "status",
                        value: "Cart recovery email sent"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "trigger-1", target: "wait-1" },
                { id: "e2", source: "wait-1", target: "integration-shopify-check" },
                { id: "e3", source: "integration-shopify-check", target: "conditional-purchased" },
                {
                    id: "e4",
                    source: "conditional-purchased",
                    target: "output-1",
                    sourceHandle: "true"
                },
                {
                    id: "e5",
                    source: "conditional-purchased",
                    target: "llm-email",
                    sourceHandle: "false"
                },
                { id: "e6", source: "llm-email", target: "integration-shopify-discount" },
                {
                    id: "e7",
                    source: "integration-shopify-discount",
                    target: "integration-mailchimp"
                },
                { id: "e8", source: "integration-mailchimp", target: "integration-slack" },
                { id: "e9", source: "integration-slack", target: "output-1" }
            ]
        }
    },

    // E-commerce Intermediate 3: Inventory Alert System (13 nodes)
    {
        name: "Inventory Alert System",
        description:
            "Intelligent inventory management: monitor stock, classify urgency, route critical alerts, generate reorder recommendations, and create purchase orders.",
        category: "ecommerce",
        tags: ["inventory", "alerts", "reordering", "stock"],
        required_integrations: ["shopify", "slack", "airtable", "gmail"],
        featured: false,
        definition: {
            name: "Inventory Alert System",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Low Stock Alert",
                        triggerType: "webhook",
                        webhookProvider: "shopify"
                    }
                },
                {
                    id: "integration-product",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get Product Details",
                        provider: "shopify",
                        operation: "getProduct"
                    }
                },
                {
                    id: "integration-sales",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get Sales Velocity",
                        provider: "shopify",
                        operation: "getAnalytics"
                    }
                },
                {
                    id: "transform-context",
                    type: "transform",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Build Inventory Context",
                        transformType: "template",
                        template:
                            '{"product": {{integration-product.data}}, "sales": {{integration-sales.data}}}',
                        outputVariable: "inventoryContext"
                    }
                },
                {
                    id: "router-urgency",
                    type: "router",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Route by Urgency",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Classify inventory urgency based on stock vs sales velocity",
                        routes: [
                            { value: "critical", label: "Critical (out soon)" },
                            { value: "low", label: "Low Stock" },
                            { value: "monitor", label: "Monitor" }
                        ]
                    }
                },
                {
                    id: "llm-critical",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Critical Alert",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Generate critical inventory alert:\n\n{{inventoryContext}}\n\nHighlight: days until stockout, revenue at risk.",
                        outputVariable: "criticalAlert"
                    }
                },
                {
                    id: "llm-reorder",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Reorder Analysis",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Analyze reorder needs:\n\n{{inventoryContext}}\n\nRecommend: quantity, timing, supplier.",
                        outputVariable: "reorderAnalysis"
                    }
                },
                {
                    id: "slack-critical",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Alert Ops Team",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#ops-critical"
                    }
                },
                {
                    id: "slack-purchasing",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Notify Purchasing",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#purchasing"
                    }
                },
                {
                    id: "integration-airtable",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Create PO Draft",
                        provider: "airtable",
                        operation: "createRecord",
                        table: "Purchase Orders"
                    }
                },
                {
                    id: "integration-gmail",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Draft Supplier Email",
                        provider: "gmail",
                        operation: "createDraft"
                    }
                },
                {
                    id: "integration-sheets",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Log to Inventory Report",
                        provider: "google-sheets",
                        operation: "appendRow"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Alert Processed",
                        outputName: "status",
                        value: "Inventory alert processed"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "trigger-1", target: "integration-product" },
                { id: "e2", source: "trigger-1", target: "integration-sales" },
                { id: "e3", source: "integration-product", target: "transform-context" },
                { id: "e4", source: "integration-sales", target: "transform-context" },
                { id: "e5", source: "transform-context", target: "router-urgency" },
                {
                    id: "e6",
                    source: "router-urgency",
                    target: "llm-critical",
                    sourceHandle: "critical"
                },
                { id: "e7", source: "router-urgency", target: "llm-reorder", sourceHandle: "low" },
                {
                    id: "e8",
                    source: "router-urgency",
                    target: "llm-reorder",
                    sourceHandle: "monitor"
                },
                { id: "e9", source: "llm-critical", target: "slack-critical" },
                { id: "e10", source: "llm-reorder", target: "slack-purchasing" },
                { id: "e11", source: "slack-critical", target: "integration-airtable" },
                { id: "e12", source: "slack-purchasing", target: "integration-airtable" },
                { id: "e13", source: "integration-airtable", target: "integration-gmail" },
                { id: "e14", source: "integration-airtable", target: "integration-sheets" },
                { id: "e15", source: "integration-gmail", target: "output-1" },
                { id: "e16", source: "integration-sheets", target: "output-1" }
            ]
        }
    },

    // E-commerce Intermediate 4: Order Confirmation Sender (11 nodes)
    {
        name: "Order Confirmation Sender",
        description:
            "Multi-channel order confirmation: process new orders, classify by value, send personalized confirmations via email and SMS, and update CRM.",
        category: "ecommerce",
        tags: ["orders", "confirmation", "email", "sms", "routing"],
        required_integrations: ["shopify", "gmail", "twilio", "hubspot"],
        featured: false,
        definition: {
            name: "Order Confirmation Sender",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "New Order",
                        triggerType: "webhook",
                        webhookProvider: "shopify"
                    }
                },
                {
                    id: "integration-order",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get Order Details",
                        provider: "shopify",
                        operation: "getOrder"
                    }
                },
                {
                    id: "integration-customer",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get Customer History",
                        provider: "shopify",
                        operation: "getCustomer"
                    }
                },
                {
                    id: "transform-context",
                    type: "transform",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Build Order Context",
                        transformType: "template",
                        template:
                            '{"order": {{integration-order.data}}, "customer": {{integration-customer.data}}}',
                        outputVariable: "orderContext"
                    }
                },
                {
                    id: "router-value",
                    type: "router",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Route by Order Value",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Classify order value tier",
                        routes: [
                            { value: "vip", label: "VIP Order ($500+)" },
                            { value: "standard", label: "Standard Order" }
                        ]
                    }
                },
                {
                    id: "llm-vip",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "VIP Confirmation",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Create premium VIP order confirmation:\n\n{{orderContext}}\n\nHighlight: exclusive thanks, priority shipping, personal touch.",
                        outputVariable: "vipConfirmation"
                    }
                },
                {
                    id: "llm-standard",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Standard Confirmation",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Create friendly order confirmation:\n\n{{orderContext}}\n\nInclude: thank you, order summary, delivery estimate.",
                        outputVariable: "standardConfirmation"
                    }
                },
                {
                    id: "integration-gmail",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Send Email",
                        provider: "gmail",
                        operation: "sendEmail"
                    }
                },
                {
                    id: "integration-sms",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Send SMS",
                        provider: "twilio",
                        operation: "sendSMS"
                    }
                },
                {
                    id: "integration-hubspot",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Log to CRM",
                        provider: "hubspot",
                        operation: "createDeal"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Confirmation Sent",
                        outputName: "status",
                        value: "Order confirmation sent"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "trigger-1", target: "integration-order" },
                { id: "e2", source: "trigger-1", target: "integration-customer" },
                { id: "e3", source: "integration-order", target: "transform-context" },
                { id: "e4", source: "integration-customer", target: "transform-context" },
                { id: "e5", source: "transform-context", target: "router-value" },
                { id: "e6", source: "router-value", target: "llm-vip", sourceHandle: "vip" },
                {
                    id: "e7",
                    source: "router-value",
                    target: "llm-standard",
                    sourceHandle: "standard"
                },
                { id: "e8", source: "llm-vip", target: "integration-gmail" },
                { id: "e9", source: "llm-vip", target: "integration-sms" },
                { id: "e10", source: "llm-standard", target: "integration-gmail" },
                { id: "e11", source: "integration-gmail", target: "integration-hubspot" },
                { id: "e12", source: "integration-sms", target: "integration-hubspot" },
                { id: "e13", source: "integration-hubspot", target: "output-1" }
            ]
        }
    },

    // ========================================================================
    // SAAS (5 templates)
    // ========================================================================

    // SaaS Advanced 1: User Onboarding Flow (17 nodes)
    {
        name: "User Onboarding Flow",
        description:
            "Guide new users to success: welcome emails, track activation milestones, route by engagement level, trigger automated nurture or CSM outreach, and celebrate achievements.",
        category: "saas",
        tags: ["onboarding", "activation", "engagement", "retention"],
        required_integrations: [
            "hubspot",
            "intercom",
            "mixpanel",
            "slack",
            "gmail",
            "notion",
            "calendly"
        ],
        featured: true,
        definition: {
            name: "User Onboarding Flow",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "New Signup",
                        triggerType: "webhook",
                        description: "New user registration"
                    }
                },
                {
                    id: "integration-hubspot-create",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Create Contact",
                        provider: "hubspot",
                        operation: "createContact"
                    }
                },
                {
                    id: "llm-welcome",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Welcome Email",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Create a warm welcome email for:\n\n{{trigger-1.data}}\n\nInclude: personal greeting, getting started steps, key resources, support contact.",
                        outputVariable: "welcomeEmail"
                    }
                },
                {
                    id: "integration-gmail",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Send Welcome",
                        provider: "gmail",
                        operation: "sendEmail"
                    }
                },
                {
                    id: "integration-intercom",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Start In-App Tour",
                        provider: "intercom",
                        operation: "createMessage"
                    }
                },
                {
                    id: "wait-1",
                    type: "wait",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Wait 3 Days",
                        duration: 259200000,
                        description: "Allow time for initial activation"
                    }
                },
                {
                    id: "integration-mixpanel",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Check Activation",
                        provider: "mixpanel",
                        operation: "getProfile"
                    }
                },
                {
                    id: "llm-score",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Score Engagement",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: 'Score this user\'s engagement:\n\n{{integration-mixpanel.data}}\n\nReturn JSON: {"score": 0-100, "level": "high/medium/low", "completedMilestones": [], "nextMilestone": ""}',
                        outputVariable: "engagementScore"
                    }
                },
                {
                    id: "router-engagement",
                    type: "router",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Route by Engagement",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Route based on: {{engagementScore.text}}",
                        routes: [
                            {
                                value: "high",
                                label: "High",
                                description: "Engaged user, celebrate"
                            },
                            { value: "medium", label: "Medium", description: "Needs nudge" },
                            { value: "low", label: "Low", description: "At risk, CSM outreach" }
                        ],
                        defaultRoute: "medium",
                        outputVariable: "engagementRoute"
                    }
                },
                {
                    id: "llm-celebrate",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Create Celebration",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Create a celebration message for milestone completion:\n\n{{engagementScore.text}}\n\nBe enthusiastic, highlight their progress, suggest next steps.",
                        outputVariable: "celebrationMsg"
                    }
                },
                {
                    id: "llm-nudge",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Create Nudge",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Create a helpful nudge email:\n\n{{engagementScore.text}}\n\nOffer tips, resources, or help to complete next milestone.",
                        outputVariable: "nudgeEmail"
                    }
                },
                {
                    id: "integration-intercom-msg",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Send In-App Message",
                        provider: "intercom",
                        operation: "createMessage"
                    }
                },
                {
                    id: "integration-hubspot-update",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Update Contact",
                        provider: "hubspot",
                        operation: "updateContact"
                    }
                },
                {
                    id: "integration-calendly",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Schedule CSM Call",
                        provider: "calendly",
                        operation: "createInvite"
                    }
                },
                {
                    id: "integration-notion",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Log Progress",
                        provider: "notion",
                        operation: "updatePage"
                    }
                },
                {
                    id: "integration-slack",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Notify Team",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#onboarding"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Onboarding Step Complete",
                        outputName: "status",
                        value: "{{engagementScore.text}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "trigger-1", target: "integration-hubspot-create" },
                { id: "e2", source: "integration-hubspot-create", target: "llm-welcome" },
                { id: "e3", source: "llm-welcome", target: "integration-gmail" },
                { id: "e4", source: "integration-gmail", target: "integration-intercom" },
                { id: "e5", source: "integration-intercom", target: "wait-1" },
                { id: "e6", source: "wait-1", target: "integration-mixpanel" },
                { id: "e7", source: "integration-mixpanel", target: "llm-score" },
                { id: "e8", source: "llm-score", target: "router-engagement" },
                {
                    id: "e9",
                    source: "router-engagement",
                    target: "llm-celebrate",
                    sourceHandle: "high"
                },
                {
                    id: "e10",
                    source: "router-engagement",
                    target: "llm-nudge",
                    sourceHandle: "medium"
                },
                {
                    id: "e11",
                    source: "router-engagement",
                    target: "integration-calendly",
                    sourceHandle: "low"
                },
                { id: "e12", source: "llm-celebrate", target: "integration-intercom-msg" },
                { id: "e13", source: "llm-nudge", target: "integration-intercom-msg" },
                {
                    id: "e14",
                    source: "integration-intercom-msg",
                    target: "integration-hubspot-update"
                },
                { id: "e15", source: "integration-calendly", target: "integration-hubspot-update" },
                { id: "e16", source: "integration-hubspot-update", target: "integration-notion" },
                { id: "e17", source: "integration-notion", target: "integration-slack" },
                { id: "e18", source: "integration-slack", target: "output-1" }
            ]
        }
    },

    // SaaS Intermediate 2: Feature Adoption Tracker (11 nodes)
    {
        name: "Feature Adoption Tracker",
        description:
            "Drive feature adoption: track when users hit feature milestones, generate personalized tips with AI, send in-app guidance, and measure engagement improvements.",
        category: "saas",
        tags: ["feature adoption", "engagement", "in-app", "tracking"],
        required_integrations: ["amplitude", "intercom", "slack", "notion"],
        featured: false,
        definition: {
            name: "Feature Adoption Tracker",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Feature Used",
                        triggerType: "webhook",
                        webhookProvider: "amplitude"
                    }
                },
                {
                    id: "integration-amplitude",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get User Activity",
                        provider: "amplitude",
                        operation: "getUserActivity"
                    }
                },
                {
                    id: "llm-analyze",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Analyze Usage Pattern",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Analyze this user's feature usage:\n\n{{integration-amplitude.data}}\n\nIdentify: adoption stage, next logical feature, potential friction points.",
                        outputVariable: "analysis"
                    }
                },
                {
                    id: "conditional-milestone",
                    type: "conditional",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Hit Milestone?",
                        condition: "analysis.milestone === true",
                        outputVariable: "isMilestone"
                    }
                },
                {
                    id: "llm-tip",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Pro Tip",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Generate a personalized pro tip for:\n\n{{analysis.text}}\n\nMake it specific, actionable, and exciting.",
                        outputVariable: "proTip"
                    }
                },
                {
                    id: "llm-celebrate",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Create Celebration",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Create a milestone celebration message:\n\n{{analysis.text}}\n\nBe enthusiastic and encouraging!",
                        outputVariable: "celebration"
                    }
                },
                {
                    id: "integration-intercom-tip",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Send Pro Tip",
                        provider: "intercom",
                        operation: "createMessage"
                    }
                },
                {
                    id: "integration-intercom-celebrate",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Send Celebration",
                        provider: "intercom",
                        operation: "createMessage"
                    }
                },
                {
                    id: "integration-notion",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Log Adoption",
                        provider: "notion",
                        operation: "updatePage"
                    }
                },
                {
                    id: "integration-slack",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Share Win",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#product-wins"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Tracking Complete",
                        outputName: "status",
                        value: "{{analysis.text}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "trigger-1", target: "integration-amplitude" },
                { id: "e2", source: "integration-amplitude", target: "llm-analyze" },
                { id: "e3", source: "llm-analyze", target: "conditional-milestone" },
                {
                    id: "e4",
                    source: "conditional-milestone",
                    target: "llm-celebrate",
                    sourceHandle: "true"
                },
                {
                    id: "e5",
                    source: "conditional-milestone",
                    target: "llm-tip",
                    sourceHandle: "false"
                },
                { id: "e6", source: "llm-celebrate", target: "integration-intercom-celebrate" },
                { id: "e7", source: "llm-tip", target: "integration-intercom-tip" },
                { id: "e8", source: "integration-intercom-celebrate", target: "integration-slack" },
                { id: "e9", source: "integration-intercom-tip", target: "integration-notion" },
                { id: "e10", source: "integration-slack", target: "integration-notion" },
                { id: "e11", source: "integration-notion", target: "output-1" }
            ]
        }
    },

    // SaaS Intermediate 3: Trial Conversion Workflow (10 nodes)
    {
        name: "Trial Conversion Workflow",
        description:
            "Maximize trial conversions: monitor trial usage, segment by engagement level, deliver personalized outreach, and route to sales for high-value prospects.",
        category: "saas",
        tags: ["trial", "conversion", "sales", "engagement"],
        required_integrations: ["hubspot", "intercom", "slack", "gmail", "calendly"],
        featured: false,
        definition: {
            name: "Trial Conversion Workflow",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Trial Ending Soon",
                        triggerType: "schedule",
                        schedule: "0 9 * * *",
                        description: "Check trials ending in 3 days"
                    }
                },
                {
                    id: "integration-hubspot",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get Trial Users",
                        provider: "hubspot",
                        operation: "searchContacts"
                    }
                },
                {
                    id: "integration-intercom",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get Usage Data",
                        provider: "intercom",
                        operation: "getUser"
                    }
                },
                {
                    id: "llm-segment",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Segment User",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: 'Segment this trial user:\n\n{{integration-hubspot.data}}\n{{integration-intercom.data}}\n\nReturn JSON: {"segment": "hot/warm/cold", "likelihood": 0-100, "objections": [], "approach": ""}',
                        outputVariable: "segment"
                    }
                },
                {
                    id: "router-segment",
                    type: "router",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Route by Segment",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Route: {{segment.text}}",
                        routes: [
                            { value: "hot", label: "Hot", description: "Sales call" },
                            { value: "warm", label: "Warm", description: "Personal email" },
                            { value: "cold", label: "Cold", description: "Automated nurture" }
                        ],
                        defaultRoute: "warm",
                        outputVariable: "segmentRoute"
                    }
                },
                {
                    id: "integration-calendly",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Schedule Sales Call",
                        provider: "calendly",
                        operation: "createInvite"
                    }
                },
                {
                    id: "llm-email",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Draft Personal Email",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Write a personal trial conversion email:\n\n{{segment.text}}\n\nAddress likely objections, highlight value seen, offer help.",
                        outputVariable: "personalEmail"
                    }
                },
                {
                    id: "integration-gmail",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Send Email",
                        provider: "gmail",
                        operation: "sendEmail"
                    }
                },
                {
                    id: "integration-slack",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Notify Sales",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#sales-trials"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Outreach Complete",
                        outputName: "segment",
                        value: "{{segment.text}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "trigger-1", target: "integration-hubspot" },
                { id: "e2", source: "integration-hubspot", target: "integration-intercom" },
                { id: "e3", source: "integration-intercom", target: "llm-segment" },
                { id: "e4", source: "llm-segment", target: "router-segment" },
                {
                    id: "e5",
                    source: "router-segment",
                    target: "integration-calendly",
                    sourceHandle: "hot"
                },
                { id: "e6", source: "router-segment", target: "llm-email", sourceHandle: "warm" },
                {
                    id: "e7",
                    source: "router-segment",
                    target: "integration-slack",
                    sourceHandle: "cold"
                },
                { id: "e8", source: "integration-calendly", target: "integration-slack" },
                { id: "e9", source: "llm-email", target: "integration-gmail" },
                { id: "e10", source: "integration-gmail", target: "integration-slack" },
                { id: "e11", source: "integration-slack", target: "output-1" }
            ]
        }
    },

    // SaaS Intermediate 4: Usage Milestone Celebrator (12 nodes)
    {
        name: "Usage Milestone Celebrator",
        description:
            "Intelligent milestone celebration: classify achievement type, route to appropriate celebration path, send multi-channel notifications, and track engagement.",
        category: "saas",
        tags: ["milestones", "celebration", "engagement", "routing"],
        required_integrations: ["mixpanel", "intercom", "slack", "gmail", "hubspot"],
        featured: false,
        definition: {
            name: "Usage Milestone Celebrator",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Milestone Reached",
                        triggerType: "webhook",
                        webhookProvider: "mixpanel"
                    }
                },
                {
                    id: "integration-user",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get User Profile",
                        provider: "hubspot",
                        operation: "getContact"
                    }
                },
                {
                    id: "integration-analytics",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get User Journey",
                        provider: "mixpanel",
                        operation: "getUserProfile"
                    }
                },
                {
                    id: "transform-context",
                    type: "transform",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Build Context",
                        transformType: "template",
                        template:
                            '{"milestone": {{trigger-1.data}}, "user": {{integration-user.data}}, "journey": {{integration-analytics.data}}}',
                        outputVariable: "milestoneContext"
                    }
                },
                {
                    id: "router-type",
                    type: "router",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Route by Milestone",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Classify milestone significance",
                        routes: [
                            { value: "major", label: "Major Achievement" },
                            { value: "feature", label: "Feature Milestone" },
                            { value: "streak", label: "Usage Streak" }
                        ]
                    }
                },
                {
                    id: "llm-major",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Major Celebration",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Create premium achievement celebration:\n\n{{milestoneContext}}\n\nBe enthusiastic, personalized, suggest exclusive rewards.",
                        outputVariable: "majorCelebration"
                    }
                },
                {
                    id: "llm-standard",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Standard Celebration",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Create fun milestone celebration:\n\n{{milestoneContext}}\n\nEncourage continued engagement.",
                        outputVariable: "standardCelebration"
                    }
                },
                {
                    id: "integration-intercom",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Send In-App",
                        provider: "intercom",
                        operation: "createMessage"
                    }
                },
                {
                    id: "integration-gmail",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Send Email",
                        provider: "gmail",
                        operation: "sendEmail"
                    }
                },
                {
                    id: "integration-slack",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Share in #wins",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#customer-wins"
                    }
                },
                {
                    id: "integration-hubspot",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Log Achievement",
                        provider: "hubspot",
                        operation: "createNote"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Celebration Complete",
                        outputName: "status",
                        value: "Milestone celebrated"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "trigger-1", target: "integration-user" },
                { id: "e2", source: "trigger-1", target: "integration-analytics" },
                { id: "e3", source: "integration-user", target: "transform-context" },
                { id: "e4", source: "integration-analytics", target: "transform-context" },
                { id: "e5", source: "transform-context", target: "router-type" },
                { id: "e6", source: "router-type", target: "llm-major", sourceHandle: "major" },
                {
                    id: "e7",
                    source: "router-type",
                    target: "llm-standard",
                    sourceHandle: "feature"
                },
                { id: "e8", source: "router-type", target: "llm-standard", sourceHandle: "streak" },
                { id: "e9", source: "llm-major", target: "integration-intercom" },
                { id: "e10", source: "llm-major", target: "integration-gmail" },
                { id: "e11", source: "llm-standard", target: "integration-intercom" },
                { id: "e12", source: "integration-intercom", target: "integration-slack" },
                { id: "e13", source: "integration-gmail", target: "integration-slack" },
                { id: "e14", source: "integration-slack", target: "integration-hubspot" },
                { id: "e15", source: "integration-hubspot", target: "output-1" }
            ]
        }
    },

    // ========================================================================
    // HEALTHCARE (3 templates)
    // ========================================================================

    // Healthcare Intermediate 1: Patient Appointment Reminder (9 nodes)
    {
        name: "Patient Appointment Reminder",
        description:
            "Reduce no-shows with automated reminders: send SMS and email reminders before appointments, confirm attendance, and update records accordingly.",
        category: "healthcare",
        tags: ["appointments", "reminders", "patient communication", "healthcare"],
        required_integrations: ["google-calendar", "gmail", "airtable"],
        featured: true,
        definition: {
            name: "Patient Appointment Reminder",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Appointment Tomorrow",
                        triggerType: "schedule",
                        schedule: "0 18 * * *",
                        description: "Check appointments for next day"
                    }
                },
                {
                    id: "integration-calendar",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get Appointments",
                        provider: "google-calendar",
                        operation: "listEvents"
                    }
                },
                {
                    id: "llm-reminder-email",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Create Email Reminder",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Create a friendly appointment reminder email:\n\n{{integration-calendar.data}}\n\nInclude: date/time, location, what to bring, how to reschedule. Keep it HIPAA compliant.",
                        outputVariable: "emailReminder"
                    }
                },
                {
                    id: "llm-reminder-sms",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Create SMS Reminder",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Create a brief SMS appointment reminder (max 160 chars):\n\n{{integration-calendar.data}}\n\nInclude: time and confirm/reschedule options.",
                        outputVariable: "smsReminder"
                    }
                },
                {
                    id: "integration-gmail",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Send Email",
                        provider: "gmail",
                        operation: "sendEmail"
                    }
                },
                {
                    id: "integration-airtable",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Log Reminder Sent",
                        provider: "airtable",
                        operation: "updateRecord"
                    }
                },
                {
                    id: "wait-1",
                    type: "wait",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Wait for Response",
                        duration: 43200000,
                        description: "12 hours for confirmation"
                    }
                },
                {
                    id: "integration-airtable-update",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Update Status",
                        provider: "airtable",
                        operation: "updateRecord"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Reminders Sent",
                        outputName: "status",
                        value: "Appointment reminders delivered"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "trigger-1", target: "integration-calendar" },
                { id: "e2", source: "integration-calendar", target: "llm-reminder-email" },
                { id: "e3", source: "integration-calendar", target: "llm-reminder-sms" },
                { id: "e4", source: "llm-reminder-email", target: "integration-gmail" },
                { id: "e5", source: "integration-gmail", target: "integration-airtable" },
                { id: "e6", source: "llm-reminder-sms", target: "integration-airtable" },
                { id: "e7", source: "integration-airtable", target: "wait-1" },
                { id: "e8", source: "wait-1", target: "integration-airtable-update" },
                { id: "e9", source: "integration-airtable-update", target: "output-1" }
            ]
        }
    },

    // Healthcare Intermediate 2: Medical Records Request Handler (10 nodes)
    {
        name: "Medical Records Request Handler",
        description:
            "Securely process medical records requests: verify identity, locate records, route through compliance approval, and deliver securely with full audit logging.",
        category: "healthcare",
        tags: ["medical records", "compliance", "HIPAA", "secure"],
        required_integrations: ["typeform", "google-drive", "gmail", "slack", "airtable"],
        featured: false,
        definition: {
            name: "Medical Records Request Handler",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Records Request",
                        triggerType: "webhook",
                        webhookProvider: "typeform"
                    }
                },
                {
                    id: "llm-verify",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Verify Identity",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: 'Verify this records request:\n\n{{trigger-1.data}}\n\nCheck: required fields present, ID matches, authorized requester type.\n\nReturn JSON: {"verified": true/false, "issues": [], "riskLevel": "low/medium/high"}',
                        outputVariable: "verification"
                    }
                },
                {
                    id: "conditional-verified",
                    type: "conditional",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Identity Verified?",
                        condition: "verification.verified === true",
                        outputVariable: "isVerified"
                    }
                },
                {
                    id: "integration-drive",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Locate Records",
                        provider: "google-drive",
                        operation: "searchFiles"
                    }
                },
                {
                    id: "humanReview-1",
                    type: "humanReview",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Compliance Review",
                        reviewPrompt:
                            "Review and approve this records release for HIPAA compliance",
                        outputVariable: "complianceApproval"
                    }
                },
                {
                    id: "llm-prepare",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Prepare Delivery",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Prepare secure delivery instructions:\n\nRequest: {{trigger-1.data}}\nRecords: {{integration-drive.data}}\n\nInclude: secure link generation, access expiration, delivery confirmation.",
                        outputVariable: "deliveryInstructions"
                    }
                },
                {
                    id: "integration-gmail",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Send Securely",
                        provider: "gmail",
                        operation: "sendEmail"
                    }
                },
                {
                    id: "integration-airtable",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Log Request",
                        provider: "airtable",
                        operation: "createRecord",
                        table: "Records Requests Audit"
                    }
                },
                {
                    id: "integration-slack",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Notify Compliance",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#compliance"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Request Processed",
                        outputName: "status",
                        value: "Records request processed securely"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "trigger-1", target: "llm-verify" },
                { id: "e2", source: "llm-verify", target: "conditional-verified" },
                {
                    id: "e3",
                    source: "conditional-verified",
                    target: "integration-drive",
                    sourceHandle: "true"
                },
                {
                    id: "e4",
                    source: "conditional-verified",
                    target: "integration-slack",
                    sourceHandle: "false"
                },
                { id: "e5", source: "integration-drive", target: "humanReview-1" },
                { id: "e6", source: "humanReview-1", target: "llm-prepare" },
                { id: "e7", source: "llm-prepare", target: "integration-gmail" },
                { id: "e8", source: "integration-gmail", target: "integration-airtable" },
                { id: "e9", source: "integration-airtable", target: "integration-slack" },
                { id: "e10", source: "integration-slack", target: "output-1" }
            ]
        }
    },

    // Healthcare Intermediate 3: Lab Results Notifier (12 nodes)
    {
        name: "Lab Results Notifier",
        description:
            "Intelligent lab results notification: classify urgency, route to appropriate notification path, and coordinate care team follow-up.",
        category: "healthcare",
        tags: ["lab results", "notifications", "patient communication", "routing"],
        required_integrations: ["gmail", "slack", "twilio", "airtable"],
        featured: false,
        definition: {
            name: "Lab Results Notifier",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Results Ready",
                        triggerType: "webhook",
                        description: "Lab results uploaded to system"
                    }
                },
                {
                    id: "integration-patient",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get Patient Info",
                        provider: "airtable",
                        operation: "getRecord",
                        table: "Patients"
                    }
                },
                {
                    id: "llm-classify",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Classify Urgency",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Classify lab result urgency (DO NOT include PHI in output):\n\n{{trigger-1.data}}\n\nClassify: critical (needs immediate attention), abnormal (needs follow-up), normal (routine notification).",
                        outputVariable: "urgency"
                    }
                },
                {
                    id: "transform-context",
                    type: "transform",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Build Context",
                        transformType: "template",
                        template:
                            '{"patient": {{integration-patient.data}}, "urgency": "{{urgency.text}}"}',
                        outputVariable: "notificationContext"
                    }
                },
                {
                    id: "router-urgency",
                    type: "router",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Route by Urgency",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Route based on urgency classification",
                        routes: [
                            { value: "critical", label: "Critical - Immediate" },
                            { value: "abnormal", label: "Abnormal - Follow-up" },
                            { value: "normal", label: "Normal - Routine" }
                        ]
                    }
                },
                {
                    id: "llm-critical",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Critical Alert",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Create urgent patient notification (HIPAA compliant - no results):\n\n{{notificationContext}}\n\nUrgently request patient contact office immediately.",
                        outputVariable: "criticalMessage"
                    }
                },
                {
                    id: "llm-routine",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Routine Notice",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Create friendly results-ready notification (HIPAA compliant):\n\n{{notificationContext}}\n\nProvide portal login instructions.",
                        outputVariable: "routineMessage"
                    }
                },
                {
                    id: "integration-sms",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Send SMS Alert",
                        provider: "twilio",
                        operation: "sendSMS"
                    }
                },
                {
                    id: "integration-gmail",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Send Email",
                        provider: "gmail",
                        operation: "sendEmail"
                    }
                },
                {
                    id: "slack-care-team",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Alert Care Team",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#care-team-alerts"
                    }
                },
                {
                    id: "integration-airtable",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Log Notification",
                        provider: "airtable",
                        operation: "createRecord",
                        table: "Notification Log"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Notification Complete",
                        outputName: "status",
                        value: "Patient notified"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "trigger-1", target: "integration-patient" },
                { id: "e2", source: "trigger-1", target: "llm-classify" },
                { id: "e3", source: "integration-patient", target: "transform-context" },
                { id: "e4", source: "llm-classify", target: "transform-context" },
                { id: "e5", source: "transform-context", target: "router-urgency" },
                {
                    id: "e6",
                    source: "router-urgency",
                    target: "llm-critical",
                    sourceHandle: "critical"
                },
                {
                    id: "e7",
                    source: "router-urgency",
                    target: "llm-critical",
                    sourceHandle: "abnormal"
                },
                {
                    id: "e8",
                    source: "router-urgency",
                    target: "llm-routine",
                    sourceHandle: "normal"
                },
                { id: "e9", source: "llm-critical", target: "integration-sms" },
                { id: "e10", source: "llm-critical", target: "slack-care-team" },
                { id: "e11", source: "llm-routine", target: "integration-gmail" },
                { id: "e12", source: "integration-sms", target: "integration-airtable" },
                { id: "e13", source: "slack-care-team", target: "integration-airtable" },
                { id: "e14", source: "integration-gmail", target: "integration-airtable" },
                { id: "e15", source: "integration-airtable", target: "output-1" }
            ]
        }
    },

    // ========================================================================
    // PRODUCT MANAGEMENT (3 templates)
    // ========================================================================

    // Product Management 1: Feature Request Triage & Roadmap Sync (14 nodes)
    {
        name: "Feature Request Triage & Roadmap Sync",
        description:
            "Automatically classify and prioritize incoming feature requests using AI, detect duplicates, route to appropriate teams, and sync with your product roadmap.",
        category: "engineering",
        tags: ["product", "triage", "ai-classification", "roadmap", "prioritization"],
        required_integrations: ["intercom", "linear", "notion", "slack"],
        featured: true,
        definition: {
            name: "Feature Request Triage & Roadmap Sync",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "New Feature Request",
                        triggerType: "webhook",
                        webhookProvider: "intercom",
                        description: "Triggered when new feature request is submitted"
                    }
                },
                {
                    id: "integration-intercom",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Fetch Request Details",
                        provider: "intercom",
                        operation: "getConversation"
                    }
                },
                {
                    id: "llm-classify",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Classify Request Type",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Analyze this feature request and classify it:\n\n{{intercomConversation}}\n\nClassify as: bug, feature, improvement, or question. Also identify the product area (e.g., dashboard, api, integrations, billing).",
                        outputVariable: "classification"
                    }
                },
                {
                    id: "llm-priority",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Assess Priority",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Based on this classified request:\n\n{{classification.text}}\n\nAssess priority (P0-Critical, P1-High, P2-Medium, P3-Low) considering: user impact, frequency of request, alignment with product strategy, implementation complexity.",
                        outputVariable: "priority"
                    }
                },
                {
                    id: "integration-linear-search",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Check for Duplicates",
                        provider: "linear",
                        operation: "searchIssues"
                    }
                },
                {
                    id: "llm-dedupe",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Analyze Duplicates",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Compare this new request:\n{{classification.text}}\n\nWith existing issues:\n{{linearIssues}}\n\nIs this a duplicate? If yes, which issue ID? If no, explain why it's unique.",
                        outputVariable: "dupeCheck"
                    }
                },
                {
                    id: "router-priority",
                    type: "router",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Route by Priority",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Based on the priority assessment:\n{{priority.text}}\n\nRoute to appropriate handling.",
                        routes: [
                            {
                                value: "critical",
                                label: "P0 Critical",
                                description: "Immediate attention required"
                            },
                            {
                                value: "high",
                                label: "P1 High",
                                description: "Schedule for next sprint"
                            },
                            {
                                value: "normal",
                                label: "P2/P3 Normal",
                                description: "Add to backlog"
                            }
                        ],
                        defaultRoute: "normal",
                        outputVariable: "routeDecision"
                    }
                },
                {
                    id: "integration-linear-create",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Create Linear Issue",
                        provider: "linear",
                        operation: "createIssue"
                    }
                },
                {
                    id: "integration-notion",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Update Roadmap",
                        provider: "notion",
                        operation: "createPage",
                        database: "Product Roadmap"
                    }
                },
                {
                    id: "llm-response",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Acknowledgment",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Generate a friendly acknowledgment message for this feature request. Include:\n- Thank the user\n- Confirm we received their request\n- Explain next steps based on priority: {{priority.text}}\n- Provide the tracking ID: {{linearIssue.id}}",
                        outputVariable: "acknowledgment"
                    }
                },
                {
                    id: "integration-intercom-reply",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Send Acknowledgment",
                        provider: "intercom",
                        operation: "replyToConversation"
                    }
                },
                {
                    id: "integration-slack-critical",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Alert Team (Critical)",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#product-alerts"
                    }
                },
                {
                    id: "integration-slack-notify",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Notify PM",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#product-requests"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Triage Complete",
                        outputName: "result",
                        value: "{{linearIssue}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "trigger-1", target: "integration-intercom" },
                { id: "e2", source: "integration-intercom", target: "llm-classify" },
                { id: "e3", source: "llm-classify", target: "llm-priority" },
                { id: "e4", source: "llm-priority", target: "integration-linear-search" },
                { id: "e5", source: "integration-linear-search", target: "llm-dedupe" },
                { id: "e6", source: "llm-dedupe", target: "router-priority" },
                {
                    id: "e7",
                    source: "router-priority",
                    target: "integration-slack-critical",
                    sourceHandle: "critical"
                },
                {
                    id: "e8",
                    source: "router-priority",
                    target: "integration-linear-create",
                    sourceHandle: "high"
                },
                {
                    id: "e9",
                    source: "router-priority",
                    target: "integration-linear-create",
                    sourceHandle: "normal"
                },
                {
                    id: "e10",
                    source: "integration-slack-critical",
                    target: "integration-linear-create"
                },
                { id: "e11", source: "integration-linear-create", target: "integration-notion" },
                { id: "e12", source: "integration-notion", target: "llm-response" },
                { id: "e13", source: "llm-response", target: "integration-intercom-reply" },
                {
                    id: "e14",
                    source: "integration-intercom-reply",
                    target: "integration-slack-notify"
                },
                { id: "e15", source: "integration-slack-notify", target: "output-1" }
            ]
        }
    },

    // Product Management 2: Release Notes Generator (15 nodes)
    {
        name: "Release Notes Generator",
        description:
            "Automatically generate user-friendly release notes from merged PRs and issues, create multi-channel announcements for GitHub, Notion, email newsletters, and social media.",
        category: "engineering",
        tags: ["release", "changelog", "automation", "multi-channel", "documentation"],
        required_integrations: ["github", "notion", "mailchimp", "slack"],
        featured: false,
        definition: {
            name: "Release Notes Generator",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "New Release Tagged",
                        triggerType: "webhook",
                        webhookProvider: "github",
                        description: "Triggered when new release is created"
                    }
                },
                {
                    id: "integration-github-prs",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Fetch Merged PRs",
                        provider: "github",
                        operation: "listPullRequests"
                    }
                },
                {
                    id: "integration-github-issues",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Fetch Linked Issues",
                        provider: "github",
                        operation: "listIssues"
                    }
                },
                {
                    id: "llm-categorize",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Categorize Changes",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Analyze these PRs and issues:\n\nPRs: {{githubPRs}}\nIssues: {{githubIssues}}\n\nCategorize each change as: New Features, Improvements, Bug Fixes, Breaking Changes, or Documentation. Group by category.",
                        outputVariable: "categorizedChanges"
                    }
                },
                {
                    id: "llm-release-notes",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Write Release Notes",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Create user-friendly release notes from:\n\n{{categorizedChanges.text}}\n\nWrite in a clear, engaging style. Focus on user benefits, not implementation details. Include emojis for visual appeal.",
                        outputVariable: "releaseNotes"
                    }
                },
                {
                    id: "llm-tweet-thread",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Create Tweet Thread",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Create a Twitter thread (5-7 tweets) announcing this release:\n\n{{releaseNotes.text}}\n\nMake it engaging, highlight top features, include relevant hashtags.",
                        outputVariable: "tweetThread"
                    }
                },
                {
                    id: "llm-email-snippet",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Create Email Snippet",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Create an email newsletter section for this release:\n\n{{releaseNotes.text}}\n\nKeep it concise (150-200 words), focus on key highlights.",
                        outputVariable: "emailSnippet"
                    }
                },
                {
                    id: "humanReview-1",
                    type: "humanReview",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Review Content",
                        reviewPrompt:
                            "Review release notes and announcements for accuracy and tone before publishing",
                        outputVariable: "approvedContent"
                    }
                },
                {
                    id: "integration-github-release",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Update GitHub Release",
                        provider: "github",
                        operation: "updateRelease"
                    }
                },
                {
                    id: "integration-notion",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Add to Changelog",
                        provider: "notion",
                        operation: "createPage",
                        database: "Changelog"
                    }
                },
                {
                    id: "integration-mailchimp",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Queue Newsletter",
                        provider: "mailchimp",
                        operation: "createCampaign"
                    }
                },
                {
                    id: "integration-buffer",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Schedule Social Posts",
                        provider: "buffer",
                        operation: "createUpdate"
                    }
                },
                {
                    id: "transform-summary",
                    type: "transform",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Compile Summary",
                        transformType: "template",
                        template:
                            "Release {{trigger.tag}} published to: GitHub, Notion, Email, Social",
                        outputVariable: "summary"
                    }
                },
                {
                    id: "integration-slack",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Notify Team",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#releases"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Release Published",
                        outputName: "result",
                        value: "{{summary}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "trigger-1", target: "integration-github-prs" },
                { id: "e2", source: "trigger-1", target: "integration-github-issues" },
                { id: "e3", source: "integration-github-prs", target: "llm-categorize" },
                { id: "e4", source: "integration-github-issues", target: "llm-categorize" },
                { id: "e5", source: "llm-categorize", target: "llm-release-notes" },
                { id: "e6", source: "llm-release-notes", target: "llm-tweet-thread" },
                { id: "e7", source: "llm-release-notes", target: "llm-email-snippet" },
                { id: "e8", source: "llm-tweet-thread", target: "humanReview-1" },
                { id: "e9", source: "llm-email-snippet", target: "humanReview-1" },
                { id: "e10", source: "humanReview-1", target: "integration-github-release" },
                { id: "e11", source: "humanReview-1", target: "integration-notion" },
                { id: "e12", source: "humanReview-1", target: "integration-mailchimp" },
                { id: "e13", source: "humanReview-1", target: "integration-buffer" },
                { id: "e14", source: "integration-github-release", target: "transform-summary" },
                { id: "e15", source: "integration-notion", target: "transform-summary" },
                { id: "e16", source: "integration-mailchimp", target: "transform-summary" },
                { id: "e17", source: "integration-buffer", target: "transform-summary" },
                { id: "e18", source: "transform-summary", target: "integration-slack" },
                { id: "e19", source: "integration-slack", target: "output-1" }
            ]
        }
    },

    // Product Management 3: User Feedback Aggregator (18 nodes)
    {
        name: "User Feedback Aggregator",
        description:
            "Collect feedback from multiple sources (support tickets, NPS, reviews, social), analyze sentiment and themes with AI, identify actionable insights, and generate weekly product intelligence reports.",
        category: "engineering",
        tags: ["feedback", "sentiment", "aggregation", "insights", "product-intelligence"],
        required_integrations: ["intercom", "typeform", "zendesk", "notion", "slack"],
        featured: true,
        definition: {
            name: "User Feedback Aggregator",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Weekly Schedule",
                        triggerType: "schedule",
                        schedule: "0 9 * * 1",
                        description: "Every Monday at 9am"
                    }
                },
                {
                    id: "integration-intercom",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Fetch Intercom Conversations",
                        provider: "intercom",
                        operation: "listConversations"
                    }
                },
                {
                    id: "integration-typeform",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Fetch NPS Responses",
                        provider: "typeform",
                        operation: "getResponses"
                    }
                },
                {
                    id: "integration-zendesk",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Fetch Support Tickets",
                        provider: "zendesk",
                        operation: "listTickets"
                    }
                },
                {
                    id: "integration-twitter",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Fetch Twitter Mentions",
                        provider: "twitter",
                        operation: "searchTweets"
                    }
                },
                {
                    id: "transform-normalize",
                    type: "transform",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Normalize Feedback",
                        transformType: "template",
                        template:
                            '{"intercom": {{intercomConversations}}, "nps": {{typeformResponses}}, "support": {{zendeskTickets}}, "social": {{twitterMentions}}}',
                        outputVariable: "allFeedback"
                    }
                },
                {
                    id: "llm-sentiment",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Analyze Sentiment",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Analyze sentiment across all feedback sources:\n\n{{allFeedback}}\n\nFor each piece of feedback, classify as: positive, neutral, negative. Calculate overall sentiment score (-1 to 1).",
                        outputVariable: "sentiment"
                    }
                },
                {
                    id: "llm-themes",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Extract Themes",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Identify recurring themes from this feedback:\n\n{{allFeedback}}\n\nGroup into: Feature Requests, Pain Points, Praise, Questions. Count frequency of each theme.",
                        outputVariable: "themes"
                    }
                },
                {
                    id: "llm-issues",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Identify Top Issues",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Based on themes and sentiment:\n\nThemes: {{themes.text}}\nSentiment: {{sentiment.text}}\n\nIdentify the top 5 issues requiring immediate attention. Rank by impact and frequency.",
                        outputVariable: "topIssues"
                    }
                },
                {
                    id: "llm-insights",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Insights",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Create actionable product insights from:\n\nTop Issues: {{topIssues.text}}\nThemes: {{themes.text}}\nSentiment: {{sentiment.text}}\n\nProvide specific recommendations with expected impact.",
                        outputVariable: "insights"
                    }
                },
                {
                    id: "router-urgency",
                    type: "router",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Check Urgency",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Based on the top issues:\n{{topIssues.text}}\n\nAre there any critical issues requiring immediate action?",
                        routes: [
                            {
                                value: "urgent",
                                label: "Urgent Issues",
                                description: "Critical issues found"
                            },
                            { value: "normal", label: "Normal", description: "No critical issues" }
                        ],
                        defaultRoute: "normal",
                        outputVariable: "urgencyDecision"
                    }
                },
                {
                    id: "integration-linear",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Create Action Items",
                        provider: "linear",
                        operation: "createIssue"
                    }
                },
                {
                    id: "llm-report",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Report",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Create a weekly product intelligence report:\n\nSentiment: {{sentiment.text}}\nThemes: {{themes.text}}\nTop Issues: {{topIssues.text}}\nInsights: {{insights.text}}\n\nFormat as executive summary with key metrics and recommendations.",
                        outputVariable: "report"
                    }
                },
                {
                    id: "integration-notion",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Save Report",
                        provider: "notion",
                        operation: "createPage",
                        database: "Product Insights"
                    }
                },
                {
                    id: "integration-slack-urgent",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Alert Team (Urgent)",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#product-alerts"
                    }
                },
                {
                    id: "integration-gmail",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Email Report",
                        provider: "gmail",
                        operation: "sendEmail"
                    }
                },
                {
                    id: "integration-slack",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Post Weekly Digest",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#product"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Analysis Complete",
                        outputName: "report",
                        value: "{{report}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "trigger-1", target: "integration-intercom" },
                { id: "e2", source: "trigger-1", target: "integration-typeform" },
                { id: "e3", source: "trigger-1", target: "integration-zendesk" },
                { id: "e4", source: "trigger-1", target: "integration-twitter" },
                { id: "e5", source: "integration-intercom", target: "transform-normalize" },
                { id: "e6", source: "integration-typeform", target: "transform-normalize" },
                { id: "e7", source: "integration-zendesk", target: "transform-normalize" },
                { id: "e8", source: "integration-twitter", target: "transform-normalize" },
                { id: "e9", source: "transform-normalize", target: "llm-sentiment" },
                { id: "e10", source: "transform-normalize", target: "llm-themes" },
                { id: "e11", source: "llm-sentiment", target: "llm-issues" },
                { id: "e12", source: "llm-themes", target: "llm-issues" },
                { id: "e13", source: "llm-issues", target: "llm-insights" },
                { id: "e14", source: "llm-insights", target: "router-urgency" },
                {
                    id: "e15",
                    source: "router-urgency",
                    target: "integration-slack-urgent",
                    sourceHandle: "urgent"
                },
                {
                    id: "e16",
                    source: "router-urgency",
                    target: "llm-report",
                    sourceHandle: "normal"
                },
                { id: "e17", source: "integration-slack-urgent", target: "integration-linear" },
                { id: "e18", source: "integration-linear", target: "llm-report" },
                { id: "e19", source: "llm-report", target: "integration-notion" },
                { id: "e20", source: "integration-notion", target: "integration-gmail" },
                { id: "e21", source: "integration-gmail", target: "integration-slack" },
                { id: "e22", source: "integration-slack", target: "output-1" }
            ]
        }
    },

    // ========================================================================
    // ADDITIONAL MARKETING TEMPLATES (3 templates)
    // ========================================================================

    // Marketing: Email Drip Campaign Orchestrator (12 nodes)
    {
        name: "Email Drip Campaign Orchestrator",
        description:
            "Design and execute multi-stage email nurture sequences with behavioral triggers. Track opens, clicks, and conversions to automatically adjust send timing and content.",
        category: "marketing",
        tags: ["email", "drip-campaign", "nurture", "automation", "behavioral"],
        required_integrations: ["mailchimp", "hubspot", "slack"],
        featured: true,
        definition: {
            name: "Email Drip Campaign Orchestrator",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "New Subscriber",
                        triggerType: "webhook",
                        webhookProvider: "mailchimp",
                        description: "Triggered when new subscriber joins list"
                    }
                },
                {
                    id: "integration-hubspot-get",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Enrich Contact",
                        provider: "hubspot",
                        operation: "getContact"
                    }
                },
                {
                    id: "llm-segment",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Segment Subscriber",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Based on this subscriber data:\n\n{{hubspotContact}}\n\nClassify into segment: enterprise, smb, startup, or individual. Consider company size, industry, and role.",
                        outputVariable: "segment"
                    }
                },
                {
                    id: "router-1",
                    type: "router",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Route by Segment",
                        routerType: "llm",
                        routes: ["enterprise", "smb", "startup", "individual"],
                        outputVariable: "selectedRoute"
                    }
                },
                {
                    id: "llm-email-1",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Welcome Email",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Write a personalized welcome email for a {{segment.text}} subscriber. Include their name, acknowledge their industry, and provide relevant value proposition.",
                        outputVariable: "welcomeEmail"
                    }
                },
                {
                    id: "integration-mailchimp-1",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Send Welcome Email",
                        provider: "mailchimp",
                        operation: "sendEmail"
                    }
                },
                {
                    id: "wait-1",
                    type: "wait",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Wait 3 Days",
                        waitType: "duration",
                        duration: 259200,
                        outputVariable: "waitComplete"
                    }
                },
                {
                    id: "integration-mailchimp-check",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Check Engagement",
                        provider: "mailchimp",
                        operation: "getCampaignReport"
                    }
                },
                {
                    id: "conditional-1",
                    type: "conditional",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Opened Email?",
                        condition: "engagement.opened === true",
                        outputVariable: "engagementCheck"
                    }
                },
                {
                    id: "llm-email-2",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Follow-up",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Write a follow-up email for an engaged subscriber. Reference the welcome email, provide a case study or success story, include a soft CTA.",
                        outputVariable: "followupEmail"
                    }
                },
                {
                    id: "integration-mailchimp-2",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Send Follow-up",
                        provider: "mailchimp",
                        operation: "sendEmail"
                    }
                },
                {
                    id: "integration-slack",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Log Campaign Progress",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#marketing-automation"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "trigger-1", target: "integration-hubspot-get" },
                { id: "e2", source: "integration-hubspot-get", target: "llm-segment" },
                { id: "e3", source: "llm-segment", target: "router-1" },
                { id: "e4", source: "router-1", target: "llm-email-1", sourceHandle: "enterprise" },
                { id: "e5", source: "router-1", target: "llm-email-1", sourceHandle: "smb" },
                { id: "e6", source: "router-1", target: "llm-email-1", sourceHandle: "startup" },
                { id: "e7", source: "router-1", target: "llm-email-1", sourceHandle: "individual" },
                { id: "e8", source: "llm-email-1", target: "integration-mailchimp-1" },
                { id: "e9", source: "integration-mailchimp-1", target: "wait-1" },
                { id: "e10", source: "wait-1", target: "integration-mailchimp-check" },
                { id: "e11", source: "integration-mailchimp-check", target: "conditional-1" },
                { id: "e12", source: "conditional-1", target: "llm-email-2", sourceHandle: "true" },
                {
                    id: "e13",
                    source: "conditional-1",
                    target: "integration-slack",
                    sourceHandle: "false"
                },
                { id: "e14", source: "llm-email-2", target: "integration-mailchimp-2" },
                { id: "e15", source: "integration-mailchimp-2", target: "integration-slack" }
            ]
        }
    },

    // Marketing: Webinar Promotion Pipeline (11 nodes)
    {
        name: "Webinar Promotion Pipeline",
        description:
            "Automate webinar promotion from announcement to follow-up. Create event pages, schedule promotional emails, social posts, and reminder sequences with registration tracking.",
        category: "marketing",
        tags: ["webinar", "events", "promotion", "registration", "automation"],
        required_integrations: ["hubspot", "zoom", "mailchimp", "slack"],
        featured: false,
        definition: {
            name: "Webinar Promotion Pipeline",
            nodes: [
                {
                    id: "input-1",
                    type: "input",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Webinar Details",
                        inputName: "webinarDetails",
                        inputVariable: "webinarDetails",
                        inputType: "text",
                        description: "Topic, date, speakers, and key takeaways"
                    }
                },
                {
                    id: "integration-zoom",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Create Zoom Webinar",
                        provider: "zoom",
                        operation: "createMeeting"
                    }
                },
                {
                    id: "llm-promo",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Promo Content",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Create promotional content for this webinar:\n\n{{webinarDetails}}\n\nGenerate: email invitation, 3 social posts (LinkedIn, Twitter, Facebook), and landing page copy.",
                        outputVariable: "promoContent"
                    }
                },
                {
                    id: "integration-hubspot-page",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Create Landing Page",
                        provider: "hubspot",
                        operation: "createLandingPage"
                    }
                },
                {
                    id: "integration-mailchimp-announce",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Send Announcement",
                        provider: "mailchimp",
                        operation: "createCampaign"
                    }
                },
                {
                    id: "wait-1",
                    type: "wait",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Wait Until 1 Day Before",
                        waitType: "duration",
                        duration: 518400,
                        outputVariable: "reminderTime"
                    }
                },
                {
                    id: "integration-hubspot-registrants",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get Registrants",
                        provider: "hubspot",
                        operation: "listContacts"
                    }
                },
                {
                    id: "llm-reminder",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Reminder",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Write a webinar reminder email for tomorrow. Include: what they'll learn, speaker bio snippet, calendar add link, and dial-in details.",
                        outputVariable: "reminderEmail"
                    }
                },
                {
                    id: "integration-mailchimp-remind",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Send Reminders",
                        provider: "mailchimp",
                        operation: "sendEmail"
                    }
                },
                {
                    id: "integration-slack",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Update Team",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#marketing"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Promotion Complete",
                        outputName: "result",
                        value: "Webinar promotion pipeline executed"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "input-1", target: "integration-zoom" },
                { id: "e2", source: "integration-zoom", target: "llm-promo" },
                { id: "e3", source: "llm-promo", target: "integration-hubspot-page" },
                { id: "e4", source: "llm-promo", target: "integration-mailchimp-announce" },
                { id: "e5", source: "integration-hubspot-page", target: "wait-1" },
                { id: "e6", source: "integration-mailchimp-announce", target: "wait-1" },
                { id: "e7", source: "wait-1", target: "integration-hubspot-registrants" },
                { id: "e8", source: "integration-hubspot-registrants", target: "llm-reminder" },
                { id: "e9", source: "llm-reminder", target: "integration-mailchimp-remind" },
                { id: "e10", source: "integration-mailchimp-remind", target: "integration-slack" },
                { id: "e11", source: "integration-slack", target: "output-1" }
            ]
        }
    },

    // Marketing 3: SEO Content Optimizer (15 nodes)
    {
        name: "SEO Content Optimizer",
        description:
            "Analyze existing blog posts for SEO performance, compare against competitors, generate optimization suggestions, and track improvements over time.",
        category: "marketing",
        tags: ["seo", "content-optimization", "analytics", "competitive-analysis"],
        required_integrations: ["wordpress", "google-sheets", "slack"],
        featured: false,
        definition: {
            name: "SEO Content Optimizer",
            nodes: [
                {
                    id: "input-1",
                    type: "input",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Blog Post URL",
                        inputName: "postUrl",
                        inputVariable: "postUrl",
                        inputType: "text",
                        description: "URL of the blog post to optimize"
                    }
                },
                {
                    id: "url-content",
                    type: "url",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Fetch Current Content",
                        urlVariable: "postUrl",
                        outputVariable: "currentContent"
                    }
                },
                {
                    id: "integration-sheets-rankings",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Fetch Search Rankings",
                        provider: "google-sheets",
                        operation: "getValues"
                    }
                },
                {
                    id: "llm-extract-keywords",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Extract Target Keywords",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Analyze this content and identify:\n\n{{currentContent}}\n\n1. Primary keyword\n2. Secondary keywords (3-5)\n3. Long-tail keyword opportunities\n4. Current keyword density",
                        outputVariable: "keywords"
                    }
                },
                {
                    id: "url-competitor",
                    type: "url",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Fetch Competitor Content",
                        urlVariable: "competitorUrls",
                        outputVariable: "competitorContent"
                    }
                },
                {
                    id: "llm-gap-analysis",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Content Gap Analysis",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Compare our content:\n{{currentContent}}\n\nWith competitor content:\n{{competitorContent}}\n\nIdentify: content gaps, missing topics, unique angles competitors have, opportunities to differentiate.",
                        outputVariable: "gapAnalysis"
                    }
                },
                {
                    id: "llm-title-meta",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Optimize Title & Meta",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Based on keywords and gap analysis:\n\nKeywords: {{keywords.text}}\nGaps: {{gapAnalysis.text}}\n\nGenerate 3 optimized title options (max 60 chars) and 3 meta descriptions (max 155 chars) that improve CTR.",
                        outputVariable: "titleMeta"
                    }
                },
                {
                    id: "llm-content-suggestions",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Content Additions",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Based on gap analysis:\n{{gapAnalysis.text}}\n\nSuggest specific content additions:\n1. New sections to add\n2. Questions to answer\n3. Examples to include\n4. Internal/external linking opportunities",
                        outputVariable: "contentSuggestions"
                    }
                },
                {
                    id: "llm-impact",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Calculate Impact Score",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Estimate the potential ranking improvement from implementing these changes:\n\nTitle/Meta: {{titleMeta.text}}\nContent: {{contentSuggestions.text}}\n\nProvide: impact score (1-10), estimated ranking improvement, effort required.",
                        outputVariable: "impactScore"
                    }
                },
                {
                    id: "humanReview-1",
                    type: "humanReview",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Review Suggestions",
                        reviewPrompt: "Review SEO optimization suggestions before implementing",
                        outputVariable: "approvedChanges"
                    }
                },
                {
                    id: "conditional-approved",
                    type: "conditional",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Changes Approved?",
                        condition: "approvedChanges.approved === true",
                        outputVariable: "isApproved"
                    }
                },
                {
                    id: "integration-wordpress",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Update WordPress",
                        provider: "wordpress",
                        operation: "updatePost"
                    }
                },
                {
                    id: "integration-sheets-log",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Log Optimization",
                        provider: "google-sheets",
                        operation: "appendValues"
                    }
                },
                {
                    id: "integration-slack",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Notify Team",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#content"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Optimization Report",
                        outputName: "result",
                        value: "{{impactScore}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "input-1", target: "url-content" },
                { id: "e2", source: "input-1", target: "integration-sheets-rankings" },
                { id: "e3", source: "url-content", target: "llm-extract-keywords" },
                { id: "e4", source: "llm-extract-keywords", target: "url-competitor" },
                { id: "e5", source: "url-competitor", target: "llm-gap-analysis" },
                { id: "e6", source: "llm-gap-analysis", target: "llm-title-meta" },
                { id: "e7", source: "llm-gap-analysis", target: "llm-content-suggestions" },
                { id: "e8", source: "llm-title-meta", target: "llm-impact" },
                { id: "e9", source: "llm-content-suggestions", target: "llm-impact" },
                { id: "e10", source: "llm-impact", target: "humanReview-1" },
                { id: "e11", source: "humanReview-1", target: "conditional-approved" },
                {
                    id: "e12",
                    source: "conditional-approved",
                    target: "integration-wordpress",
                    sourceHandle: "true"
                },
                {
                    id: "e13",
                    source: "conditional-approved",
                    target: "integration-sheets-log",
                    sourceHandle: "false"
                },
                { id: "e14", source: "integration-wordpress", target: "integration-sheets-log" },
                { id: "e15", source: "integration-sheets-log", target: "integration-slack" },
                { id: "e16", source: "integration-slack", target: "output-1" }
            ]
        }
    },

    // ========================================================================
    // ADDITIONAL E-COMMERCE TEMPLATES (3 templates)
    // ========================================================================

    // E-commerce: Returns & Refunds Processor (14 nodes)
    {
        name: "Returns & Refunds Processor",
        description:
            "Automate return requests from submission to resolution. AI assesses return eligibility, routes to appropriate handling, processes refunds, and updates inventory.",
        category: "ecommerce",
        tags: ["returns", "refunds", "customer-service", "automation", "inventory"],
        required_integrations: ["shopify", "stripe", "zendesk", "slack"],
        featured: true,
        definition: {
            name: "Returns & Refunds Processor",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Return Request",
                        triggerType: "webhook",
                        webhookProvider: "shopify",
                        description: "Triggered when customer submits return request"
                    }
                },
                {
                    id: "integration-shopify-order",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Fetch Order Details",
                        provider: "shopify",
                        operation: "getOrder"
                    }
                },
                {
                    id: "llm-assess",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Assess Return Eligibility",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Assess this return request:\n\nOrder: {{orderDetails}}\nReturn reason: {{trigger.reason}}\nDays since delivery: {{trigger.daysSinceDelivery}}\n\nDetermine: eligible (within policy), review_needed (edge case), or denied (outside policy).",
                        outputVariable: "assessment"
                    }
                },
                {
                    id: "router-1",
                    type: "router",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Route by Eligibility",
                        routerType: "llm",
                        routes: ["eligible", "review_needed", "denied"],
                        outputVariable: "returnRoute"
                    }
                },
                {
                    id: "integration-stripe-refund",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Process Refund",
                        provider: "stripe",
                        operation: "createRefund"
                    }
                },
                {
                    id: "integration-shopify-inventory",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Update Inventory",
                        provider: "shopify",
                        operation: "updateInventory"
                    }
                },
                {
                    id: "humanReview-1",
                    type: "humanReview",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Manager Review",
                        reviewPrompt:
                            "Review this edge case return request and decide: approve or deny",
                        outputVariable: "managerDecision"
                    }
                },
                {
                    id: "conditional-1",
                    type: "conditional",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Approved?",
                        condition: "managerDecision.approved === true",
                        outputVariable: "approvalCheck"
                    }
                },
                {
                    id: "llm-denial",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Denial Email",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Write a polite denial email explaining why this return was not approved. Reference the return policy and offer alternatives like store credit.",
                        outputVariable: "denialEmail"
                    }
                },
                {
                    id: "llm-approval",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Approval Email",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Write a return approval email with: confirmation of refund, return shipping instructions, and timeline for refund processing.",
                        outputVariable: "approvalEmail"
                    }
                },
                {
                    id: "integration-zendesk-update",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Update Support Ticket",
                        provider: "zendesk",
                        operation: "updateTicket"
                    }
                },
                {
                    id: "integration-slack",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Log to Returns Channel",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#returns"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Return Processed",
                        outputName: "result",
                        value: "Return request handled"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "trigger-1", target: "integration-shopify-order" },
                { id: "e2", source: "integration-shopify-order", target: "llm-assess" },
                { id: "e3", source: "llm-assess", target: "router-1" },
                {
                    id: "e4",
                    source: "router-1",
                    target: "integration-stripe-refund",
                    sourceHandle: "eligible"
                },
                {
                    id: "e5",
                    source: "router-1",
                    target: "humanReview-1",
                    sourceHandle: "review_needed"
                },
                { id: "e6", source: "router-1", target: "llm-denial", sourceHandle: "denied" },
                {
                    id: "e7",
                    source: "integration-stripe-refund",
                    target: "integration-shopify-inventory"
                },
                { id: "e8", source: "integration-shopify-inventory", target: "llm-approval" },
                { id: "e9", source: "humanReview-1", target: "conditional-1" },
                {
                    id: "e10",
                    source: "conditional-1",
                    target: "integration-stripe-refund",
                    sourceHandle: "true"
                },
                { id: "e11", source: "conditional-1", target: "llm-denial", sourceHandle: "false" },
                { id: "e12", source: "llm-approval", target: "integration-zendesk-update" },
                { id: "e13", source: "llm-denial", target: "integration-zendesk-update" },
                { id: "e14", source: "integration-zendesk-update", target: "integration-slack" },
                { id: "e15", source: "integration-slack", target: "output-1" }
            ]
        }
    },

    // E-commerce: Product Launch Coordinator (13 nodes)
    {
        name: "Product Launch Coordinator",
        description:
            "Orchestrate new product launches across all channels. Coordinate inventory setup, marketing assets, email announcements, social media campaigns, and sales team enablement.",
        category: "ecommerce",
        tags: ["product-launch", "coordination", "marketing", "multi-channel"],
        required_integrations: ["shopify", "mailchimp", "slack", "airtable"],
        featured: false,
        definition: {
            name: "Product Launch Coordinator",
            nodes: [
                {
                    id: "input-1",
                    type: "input",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Product Launch Brief",
                        inputName: "launchBrief",
                        inputVariable: "launchBrief",
                        inputType: "text",
                        description: "Product name, launch date, key features, target audience"
                    }
                },
                {
                    id: "integration-shopify-product",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Create Product Listing",
                        provider: "shopify",
                        operation: "createProduct"
                    }
                },
                {
                    id: "llm-marketing",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Marketing Copy",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Create launch marketing materials for:\n\n{{launchBrief}}\n\nGenerate: product description, email announcement, 5 social posts, and press release outline.",
                        outputVariable: "marketingCopy"
                    }
                },
                {
                    id: "integration-airtable-checklist",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Create Launch Checklist",
                        provider: "airtable",
                        operation: "createRecord"
                    }
                },
                {
                    id: "integration-mailchimp-teaser",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Schedule Teaser Email",
                        provider: "mailchimp",
                        operation: "createCampaign"
                    }
                },
                {
                    id: "integration-slack-sales",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Brief Sales Team",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#sales"
                    }
                },
                {
                    id: "wait-1",
                    type: "wait",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Wait for Launch Date",
                        waitType: "until",
                        outputVariable: "launchTime"
                    }
                },
                {
                    id: "integration-shopify-publish",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Publish Product",
                        provider: "shopify",
                        operation: "updateProduct"
                    }
                },
                {
                    id: "integration-mailchimp-launch",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Send Launch Email",
                        provider: "mailchimp",
                        operation: "sendCampaign"
                    }
                },
                {
                    id: "integration-slack-announce",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Announce Internally",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#general"
                    }
                },
                {
                    id: "integration-airtable-update",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Update Launch Status",
                        provider: "airtable",
                        operation: "updateRecord"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Launch Complete",
                        outputName: "result",
                        value: "Product launch executed successfully"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "input-1", target: "integration-shopify-product" },
                { id: "e2", source: "integration-shopify-product", target: "llm-marketing" },
                { id: "e3", source: "llm-marketing", target: "integration-airtable-checklist" },
                { id: "e4", source: "llm-marketing", target: "integration-mailchimp-teaser" },
                { id: "e5", source: "llm-marketing", target: "integration-slack-sales" },
                { id: "e6", source: "integration-airtable-checklist", target: "wait-1" },
                { id: "e7", source: "integration-mailchimp-teaser", target: "wait-1" },
                { id: "e8", source: "integration-slack-sales", target: "wait-1" },
                { id: "e9", source: "wait-1", target: "integration-shopify-publish" },
                {
                    id: "e10",
                    source: "integration-shopify-publish",
                    target: "integration-mailchimp-launch"
                },
                {
                    id: "e11",
                    source: "integration-shopify-publish",
                    target: "integration-slack-announce"
                },
                {
                    id: "e12",
                    source: "integration-mailchimp-launch",
                    target: "integration-airtable-update"
                },
                {
                    id: "e13",
                    source: "integration-slack-announce",
                    target: "integration-airtable-update"
                },
                { id: "e14", source: "integration-airtable-update", target: "output-1" }
            ]
        }
    },

    // E-commerce: Supplier Order Automation (15 nodes - with parallel data, order size routing, parallel actions)
    {
        name: "Supplier Order Automation",
        description:
            "Automate purchase orders to suppliers based on inventory levels. Generate POs, send to suppliers, track confirmations, and update expected delivery dates.",
        category: "ecommerce",
        tags: ["supplier", "purchase-orders", "inventory", "automation", "procurement"],
        required_integrations: ["shopify", "airtable", "gmail", "slack"],
        featured: false,
        definition: {
            name: "Supplier Order Automation",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Low Inventory Alert",
                        triggerType: "webhook",
                        webhookProvider: "shopify",
                        description: "Triggered when inventory falls below threshold"
                    }
                },
                // Parallel data fetching
                {
                    id: "integration-shopify-product",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get Product Details",
                        provider: "shopify",
                        operation: "getProduct"
                    }
                },
                {
                    id: "integration-airtable-supplier",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Lookup Supplier",
                        provider: "airtable",
                        operation: "getRecord"
                    }
                },
                {
                    id: "integration-airtable-pricing",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get Pricing Tiers",
                        provider: "airtable",
                        operation: "listRecords"
                    }
                },
                {
                    id: "transform-merge",
                    type: "transform",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Merge Order Data",
                        transformType: "merge",
                        outputVariable: "orderContext"
                    }
                },
                {
                    id: "llm-analyze",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Analyze Order",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Analyze reorder requirements:\n\n{{orderContext}}\n\nCalculate optimal quantity, determine order size (standard/bulk/expedited), apply volume discounts.",
                        outputVariable: "orderAnalysis"
                    }
                },
                {
                    id: "router-size",
                    type: "router",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Route by Order Size",
                        routerType: "llm",
                        routes: ["standard", "bulk", "expedited"],
                        prompt: "Based on {{orderAnalysis.text}}, select the appropriate order type."
                    }
                },
                // Standard order path
                {
                    id: "llm-standard",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Standard PO",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Generate standard purchase order:\n\n{{orderAnalysis.text}}\n\nInclude: standard terms, regular lead time, normal pricing.",
                        outputVariable: "standardPO"
                    }
                },
                // Bulk order path
                {
                    id: "llm-bulk",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Bulk PO",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Generate bulk purchase order:\n\n{{orderAnalysis.text}}\n\nInclude: volume discount, extended lead time acceptable, bulk pricing tier.",
                        outputVariable: "bulkPO"
                    }
                },
                // Expedited order path
                {
                    id: "llm-expedited",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Expedited PO",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Generate expedited purchase order:\n\n{{orderAnalysis.text}}\n\nInclude: rush processing, express shipping, expedite fees.",
                        outputVariable: "expeditedPO"
                    }
                },
                {
                    id: "transform-compile",
                    type: "transform",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Compile PO",
                        transformType: "merge",
                        outputVariable: "finalPO"
                    }
                },
                {
                    id: "humanReview-1",
                    type: "humanReview",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Approve PO",
                        reviewPrompt:
                            "Review and approve this purchase order before sending to supplier",
                        outputVariable: "poApproval"
                    }
                },
                // Parallel actions after approval
                {
                    id: "integration-gmail",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Send to Supplier",
                        provider: "gmail",
                        operation: "sendMessage"
                    }
                },
                {
                    id: "integration-airtable-create",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Create PO Record",
                        provider: "airtable",
                        operation: "createRecord"
                    }
                },
                {
                    id: "integration-slack",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Notify Procurement",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#procurement"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "PO Submitted",
                        outputName: "result",
                        value: "{{finalPO}}"
                    }
                }
            ],
            edges: [
                // Parallel data fetching
                { id: "e1", source: "trigger-1", target: "integration-shopify-product" },
                { id: "e2", source: "trigger-1", target: "integration-airtable-supplier" },
                { id: "e3", source: "trigger-1", target: "integration-airtable-pricing" },
                // Fan-in to merge
                { id: "e4", source: "integration-shopify-product", target: "transform-merge" },
                { id: "e5", source: "integration-airtable-supplier", target: "transform-merge" },
                { id: "e6", source: "integration-airtable-pricing", target: "transform-merge" },
                // Analysis and routing
                { id: "e7", source: "transform-merge", target: "llm-analyze" },
                { id: "e8", source: "llm-analyze", target: "router-size" },
                // Fan-out by order size
                {
                    id: "e9",
                    source: "router-size",
                    target: "llm-standard",
                    sourceHandle: "standard"
                },
                { id: "e10", source: "router-size", target: "llm-bulk", sourceHandle: "bulk" },
                {
                    id: "e11",
                    source: "router-size",
                    target: "llm-expedited",
                    sourceHandle: "expedited"
                },
                // Fan-in to compile
                { id: "e12", source: "llm-standard", target: "transform-compile" },
                { id: "e13", source: "llm-bulk", target: "transform-compile" },
                { id: "e14", source: "llm-expedited", target: "transform-compile" },
                // Human review
                { id: "e15", source: "transform-compile", target: "humanReview-1" },
                // Parallel actions after approval
                { id: "e16", source: "humanReview-1", target: "integration-gmail" },
                { id: "e17", source: "humanReview-1", target: "integration-airtable-create" },
                { id: "e18", source: "humanReview-1", target: "integration-slack" },
                // Fan-in to output
                { id: "e19", source: "integration-gmail", target: "output-1" },
                { id: "e20", source: "integration-airtable-create", target: "output-1" },
                { id: "e21", source: "integration-slack", target: "output-1" }
            ]
        }
    },

    // ========================================================================
    // SCHEDULED WORKFLOWS (3 templates)
    // ========================================================================

    // Scheduled 1: Weekly Performance Digest (14 nodes)
    {
        name: "Weekly Performance Digest",
        description:
            "Every Monday, automatically aggregate metrics from analytics, revenue, support, and engineering. Generate an executive summary with AI narrative and distribute to leadership.",
        category: "operations",
        tags: ["reporting", "metrics", "automation", "executive-summary", "scheduled"],
        required_integrations: ["mixpanel", "stripe", "zendesk", "github", "gmail", "google-drive"],
        featured: true,
        definition: {
            name: "Weekly Performance Digest",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Monday 9am",
                        triggerType: "schedule",
                        schedule: "0 9 * * 1",
                        description: "Runs every Monday at 9am"
                    }
                },
                {
                    id: "integration-mixpanel",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Fetch Usage Metrics",
                        provider: "mixpanel",
                        operation: "queryEvents"
                    }
                },
                {
                    id: "integration-stripe",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Fetch Revenue Data",
                        provider: "stripe",
                        operation: "listBalanceTransactions"
                    }
                },
                {
                    id: "integration-zendesk",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Fetch Support Metrics",
                        provider: "zendesk",
                        operation: "getTicketMetrics"
                    }
                },
                {
                    id: "integration-github",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Fetch Engineering Stats",
                        provider: "github",
                        operation: "listCommits"
                    }
                },
                {
                    id: "transform-aggregate",
                    type: "transform",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Aggregate Metrics",
                        transformType: "template",
                        template:
                            '{"usage": {{mixpanelData}}, "revenue": {{stripeData}}, "support": {{zendeskData}}, "engineering": {{githubData}}}',
                        outputVariable: "allMetrics"
                    }
                },
                {
                    id: "llm-summarize",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Summary",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Create an executive summary for weekly metrics:\n\n{{allMetrics}}\n\nInclude: week-over-week comparisons, key highlights, areas of concern, recommended actions.",
                        outputVariable: "summary"
                    }
                },
                {
                    id: "llm-narrative",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Create Narrative",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Write a compelling narrative for leadership based on:\n\n{{summary.text}}\n\nTone: professional, insight-driven. Highlight trends and strategic implications.",
                        outputVariable: "narrative"
                    }
                },
                {
                    id: "transform-report",
                    type: "transform",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Compile Report",
                        transformType: "template",
                        template:
                            "# Weekly Performance Report\n\n{{narrative.text}}\n\n## Key Metrics\n{{summary.text}}",
                        outputVariable: "report"
                    }
                },
                {
                    id: "integration-drive",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Save to Drive",
                        provider: "google-drive",
                        operation: "createFile"
                    }
                },
                {
                    id: "integration-gmail",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Email Leadership",
                        provider: "gmail",
                        operation: "sendEmail"
                    }
                },
                {
                    id: "integration-slack",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Post to Slack",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#leadership"
                    }
                },
                {
                    id: "integration-sheets",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Archive Metrics",
                        provider: "google-sheets",
                        operation: "appendValues"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Digest Sent",
                        outputName: "result",
                        value: "{{report}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "trigger-1", target: "integration-mixpanel" },
                { id: "e2", source: "trigger-1", target: "integration-stripe" },
                { id: "e3", source: "trigger-1", target: "integration-zendesk" },
                { id: "e4", source: "trigger-1", target: "integration-github" },
                { id: "e5", source: "integration-mixpanel", target: "transform-aggregate" },
                { id: "e6", source: "integration-stripe", target: "transform-aggregate" },
                { id: "e7", source: "integration-zendesk", target: "transform-aggregate" },
                { id: "e8", source: "integration-github", target: "transform-aggregate" },
                { id: "e9", source: "transform-aggregate", target: "llm-summarize" },
                { id: "e10", source: "llm-summarize", target: "llm-narrative" },
                { id: "e11", source: "llm-narrative", target: "transform-report" },
                { id: "e12", source: "transform-report", target: "integration-drive" },
                { id: "e13", source: "integration-drive", target: "integration-gmail" },
                { id: "e14", source: "integration-gmail", target: "integration-slack" },
                { id: "e15", source: "integration-slack", target: "integration-sheets" },
                { id: "e16", source: "integration-sheets", target: "output-1" }
            ]
        }
    },

    // Scheduled 2: Daily Data Sync & Cleanup (12 nodes)
    {
        name: "Daily Data Sync & Cleanup",
        description:
            "Nightly synchronization between CRM and database with duplicate detection, data validation, and cleanup. Generates summary reports of sync status.",
        category: "engineering",
        tags: ["sync", "data-cleanup", "automation", "etl", "scheduled"],
        required_integrations: ["airtable", "hubspot", "slack", "datadog"],
        featured: false,
        definition: {
            name: "Daily Data Sync & Cleanup",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Nightly 2am",
                        triggerType: "schedule",
                        schedule: "0 2 * * *",
                        description: "Runs nightly at 2am"
                    }
                },
                {
                    id: "integration-airtable",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Fetch Source Data",
                        provider: "airtable",
                        operation: "listRecords"
                    }
                },
                {
                    id: "integration-hubspot",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Fetch Target Data",
                        provider: "hubspot",
                        operation: "listContacts"
                    }
                },
                {
                    id: "llm-compare",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Compare & Detect",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Compare source and target datasets:\n\nSource: {{airtableRecords}}\nTarget: {{hubspotContacts}}\n\nIdentify: new records, updates needed, duplicates to merge, orphaned records.",
                        outputVariable: "comparison"
                    }
                },
                {
                    id: "router-action",
                    type: "router",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Route by Action",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Based on comparison:\n{{comparison.text}}\n\nWhat actions are needed?",
                        routes: [
                            {
                                value: "create",
                                label: "Create New",
                                description: "New records to add"
                            },
                            { value: "update", label: "Update", description: "Records to update" },
                            { value: "none", label: "No Changes", description: "Already in sync" }
                        ],
                        defaultRoute: "none",
                        outputVariable: "actionType"
                    }
                },
                {
                    id: "integration-hubspot-create",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Create New Records",
                        provider: "hubspot",
                        operation: "createContact"
                    }
                },
                {
                    id: "integration-hubspot-update",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Update Records",
                        provider: "hubspot",
                        operation: "updateContact"
                    }
                },
                {
                    id: "transform-results",
                    type: "transform",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Aggregate Results",
                        transformType: "template",
                        template:
                            '{"created": {{createdCount}}, "updated": {{updatedCount}}, "skipped": {{skippedCount}}}',
                        outputVariable: "syncResults"
                    }
                },
                {
                    id: "integration-datadog",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Log Metrics",
                        provider: "datadog",
                        operation: "submitMetrics"
                    }
                },
                {
                    id: "llm-summary",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Summary",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Create a sync summary for:\n\n{{syncResults}}\n\nFormat as brief status report with any issues flagged.",
                        outputVariable: "syncSummary"
                    }
                },
                {
                    id: "integration-slack",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Post Summary",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#data-ops"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Sync Complete",
                        outputName: "result",
                        value: "{{syncSummary}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "trigger-1", target: "integration-airtable" },
                { id: "e2", source: "trigger-1", target: "integration-hubspot" },
                { id: "e3", source: "integration-airtable", target: "llm-compare" },
                { id: "e4", source: "integration-hubspot", target: "llm-compare" },
                { id: "e5", source: "llm-compare", target: "router-action" },
                {
                    id: "e6",
                    source: "router-action",
                    target: "integration-hubspot-create",
                    sourceHandle: "create"
                },
                {
                    id: "e7",
                    source: "router-action",
                    target: "integration-hubspot-update",
                    sourceHandle: "update"
                },
                {
                    id: "e8",
                    source: "router-action",
                    target: "transform-results",
                    sourceHandle: "none"
                },
                { id: "e9", source: "integration-hubspot-create", target: "transform-results" },
                { id: "e10", source: "integration-hubspot-update", target: "transform-results" },
                { id: "e11", source: "transform-results", target: "integration-datadog" },
                { id: "e12", source: "integration-datadog", target: "llm-summary" },
                { id: "e13", source: "llm-summary", target: "integration-slack" },
                { id: "e14", source: "integration-slack", target: "output-1" }
            ]
        }
    },

    // Scheduled 3: Monthly Invoice Generator (18 nodes)
    {
        name: "Monthly Invoice Generator",
        description:
            "End-of-month automated invoicing: calculate usage-based charges, apply discounts, generate professional invoices, route large invoices for review, and sync with accounting.",
        category: "finance",
        tags: ["invoicing", "billing", "automation", "accounting", "scheduled"],
        required_integrations: ["stripe", "quickbooks", "gmail", "google-docs", "slack"],
        featured: true,
        definition: {
            name: "Monthly Invoice Generator",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "1st of Month",
                        triggerType: "schedule",
                        schedule: "0 6 1 * *",
                        description: "Runs 1st of every month at 6am"
                    }
                },
                {
                    id: "integration-stripe-customers",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Fetch Active Customers",
                        provider: "stripe",
                        operation: "listCustomers"
                    }
                },
                {
                    id: "integration-stripe-usage",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Fetch Usage Data",
                        provider: "stripe",
                        operation: "listUsageRecords"
                    }
                },
                {
                    id: "llm-calculate",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Calculate Charges",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Calculate invoice amounts for each customer:\n\nCustomers: {{stripeCustomers}}\nUsage: {{stripeUsage}}\n\nApply: volume discounts, promotional credits, prorated adjustments.",
                        outputVariable: "charges"
                    }
                },
                {
                    id: "integration-stripe-discounts",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Apply Discounts",
                        provider: "stripe",
                        operation: "listPromotionCodes"
                    }
                },
                {
                    id: "transform-invoices",
                    type: "transform",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Prepare Invoice Data",
                        transformType: "template",
                        template:
                            '{"charges": {{charges}}, "discounts": {{discounts}}, "period": "{{trigger.month}}"}',
                        outputVariable: "invoiceData"
                    }
                },
                {
                    id: "router-amount",
                    type: "router",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Route by Amount",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "For each invoice, determine if it needs review:\n{{invoiceData}}\n\nReview if: >$10,000, first invoice, significant variance from last month.",
                        routes: [
                            {
                                value: "review",
                                label: "Needs Review",
                                description: "Large or unusual invoice"
                            },
                            { value: "auto", label: "Auto-Send", description: "Standard invoice" }
                        ],
                        defaultRoute: "auto",
                        outputVariable: "reviewRoute"
                    }
                },
                {
                    id: "humanReview-1",
                    type: "humanReview",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Finance Review",
                        reviewPrompt: "Review large invoice before sending",
                        outputVariable: "reviewApproval"
                    }
                },
                {
                    id: "integration-docs",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Invoice PDF",
                        provider: "google-docs",
                        operation: "createDocument"
                    }
                },
                {
                    id: "integration-stripe-invoice",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Create Stripe Invoice",
                        provider: "stripe",
                        operation: "createInvoice"
                    }
                },
                {
                    id: "integration-stripe-send",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Send Invoice",
                        provider: "stripe",
                        operation: "sendInvoice"
                    }
                },
                {
                    id: "integration-gmail",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Email Customer",
                        provider: "gmail",
                        operation: "sendEmail"
                    }
                },
                {
                    id: "integration-quickbooks",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Sync to QuickBooks",
                        provider: "quickbooks",
                        operation: "createInvoice"
                    }
                },
                {
                    id: "transform-summary",
                    type: "transform",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Summary",
                        transformType: "template",
                        template:
                            "Monthly invoices generated: {{invoiceCount}}, Total: ${{totalAmount}}",
                        outputVariable: "summary"
                    }
                },
                {
                    id: "integration-sheets",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Update AR Report",
                        provider: "google-sheets",
                        operation: "appendValues"
                    }
                },
                {
                    id: "integration-slack",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Notify Finance",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#finance"
                    }
                },
                {
                    id: "integration-slack-summary",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Post Summary",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#billing"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Invoicing Complete",
                        outputName: "result",
                        value: "{{summary}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "trigger-1", target: "integration-stripe-customers" },
                {
                    id: "e2",
                    source: "integration-stripe-customers",
                    target: "integration-stripe-usage"
                },
                { id: "e3", source: "integration-stripe-usage", target: "llm-calculate" },
                { id: "e4", source: "llm-calculate", target: "integration-stripe-discounts" },
                { id: "e5", source: "integration-stripe-discounts", target: "transform-invoices" },
                { id: "e6", source: "transform-invoices", target: "router-amount" },
                {
                    id: "e7",
                    source: "router-amount",
                    target: "humanReview-1",
                    sourceHandle: "review"
                },
                {
                    id: "e8",
                    source: "router-amount",
                    target: "integration-docs",
                    sourceHandle: "auto"
                },
                { id: "e9", source: "humanReview-1", target: "integration-docs" },
                { id: "e10", source: "integration-docs", target: "integration-stripe-invoice" },
                {
                    id: "e11",
                    source: "integration-stripe-invoice",
                    target: "integration-stripe-send"
                },
                { id: "e12", source: "integration-stripe-send", target: "integration-gmail" },
                { id: "e13", source: "integration-gmail", target: "integration-quickbooks" },
                { id: "e14", source: "integration-quickbooks", target: "transform-summary" },
                { id: "e15", source: "transform-summary", target: "integration-sheets" },
                { id: "e16", source: "integration-sheets", target: "integration-slack" },
                { id: "e17", source: "integration-slack", target: "integration-slack-summary" },
                { id: "e18", source: "integration-slack-summary", target: "output-1" }
            ]
        }
    },

    // ========================================================================
    // DOCUMENT PROCESSING (3 templates)
    // ========================================================================

    // Document 1: Smart Document Router (14 nodes)
    {
        name: "Smart Document Router",
        description:
            "AI-powered document classification that routes uploaded files to appropriate processing pipelines based on content type (invoices, contracts, resumes, receipts).",
        category: "support",
        tags: ["document-processing", "ai-classification", "routing", "automation"],
        required_integrations: ["google-drive", "airtable", "slack"],
        featured: true,
        definition: {
            name: "Smart Document Router",
            nodes: [
                {
                    id: "files-1",
                    type: "files",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Upload Document",
                        inputName: "document",
                        inputVariable: "document",
                        description: "Upload any document for classification"
                    }
                },
                {
                    id: "llm-extract",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Extract Text",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Extract and summarize the text content from this document:\n\n{{document}}\n\nInclude: document structure, key fields, identifiable patterns.",
                        outputVariable: "extractedText"
                    }
                },
                {
                    id: "llm-classify",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Classify Document",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Classify this document:\n\n{{extractedText.text}}\n\nCategories: invoice, contract, resume, receipt, report, correspondence, other. Provide confidence score.",
                        outputVariable: "classification"
                    }
                },
                {
                    id: "router-type",
                    type: "router",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Route by Type",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Based on classification:\n{{classification.text}}\n\nRoute to appropriate handler.",
                        routes: [
                            {
                                value: "invoice",
                                label: "Invoice",
                                description: "Process as invoice"
                            },
                            {
                                value: "contract",
                                label: "Contract",
                                description: "Process as contract"
                            },
                            { value: "resume", label: "Resume", description: "Process as resume" },
                            {
                                value: "receipt",
                                label: "Receipt",
                                description: "Process as receipt"
                            },
                            { value: "other", label: "Other", description: "General document" }
                        ],
                        defaultRoute: "other",
                        outputVariable: "routeType"
                    }
                },
                {
                    id: "llm-invoice",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Extract Invoice Fields",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Extract invoice fields:\n\n{{extractedText.text}}\n\nFields: vendor, invoice number, date, due date, line items, subtotal, tax, total, payment terms.",
                        outputVariable: "invoiceData"
                    }
                },
                {
                    id: "llm-contract",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Extract Contract Terms",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Extract contract terms:\n\n{{extractedText.text}}\n\nFields: parties, effective date, term length, key obligations, termination clauses, payment terms.",
                        outputVariable: "contractData"
                    }
                },
                {
                    id: "llm-resume",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Extract Resume Info",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Extract resume information:\n\n{{extractedText.text}}\n\nFields: name, contact, summary, experience, education, skills, certifications.",
                        outputVariable: "resumeData"
                    }
                },
                {
                    id: "llm-receipt",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Extract Receipt Items",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Extract receipt details:\n\n{{extractedText.text}}\n\nFields: merchant, date, items with prices, subtotal, tax, tip, total, payment method.",
                        outputVariable: "receiptData"
                    }
                },
                {
                    id: "integration-airtable-invoice",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Save to Invoices",
                        provider: "airtable",
                        operation: "createRecord",
                        table: "Invoices"
                    }
                },
                {
                    id: "integration-airtable-contract",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Save to Contracts",
                        provider: "airtable",
                        operation: "createRecord",
                        table: "Contracts"
                    }
                },
                {
                    id: "integration-airtable-resume",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Save to Candidates",
                        provider: "airtable",
                        operation: "createRecord",
                        table: "Candidates"
                    }
                },
                {
                    id: "integration-drive",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Archive Original",
                        provider: "google-drive",
                        operation: "uploadFile"
                    }
                },
                {
                    id: "integration-slack",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Notify Team",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#documents"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Processing Complete",
                        outputName: "result",
                        value: "{{classification}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "files-1", target: "llm-extract" },
                { id: "e2", source: "llm-extract", target: "llm-classify" },
                { id: "e3", source: "llm-classify", target: "router-type" },
                { id: "e4", source: "router-type", target: "llm-invoice", sourceHandle: "invoice" },
                {
                    id: "e5",
                    source: "router-type",
                    target: "llm-contract",
                    sourceHandle: "contract"
                },
                { id: "e6", source: "router-type", target: "llm-resume", sourceHandle: "resume" },
                { id: "e7", source: "router-type", target: "llm-receipt", sourceHandle: "receipt" },
                {
                    id: "e8",
                    source: "router-type",
                    target: "integration-drive",
                    sourceHandle: "other"
                },
                { id: "e9", source: "llm-invoice", target: "integration-airtable-invoice" },
                { id: "e10", source: "llm-contract", target: "integration-airtable-contract" },
                { id: "e11", source: "llm-resume", target: "integration-airtable-resume" },
                { id: "e12", source: "llm-receipt", target: "integration-drive" },
                { id: "e13", source: "integration-airtable-invoice", target: "integration-drive" },
                { id: "e14", source: "integration-airtable-contract", target: "integration-drive" },
                { id: "e15", source: "integration-airtable-resume", target: "integration-drive" },
                { id: "e16", source: "integration-drive", target: "integration-slack" },
                { id: "e17", source: "integration-slack", target: "output-1" }
            ]
        }
    },

    // Document 2: Contract Review Assistant (18 nodes)
    {
        name: "Contract Review Assistant",
        description:
            "AI-powered contract analysis that extracts key terms, identifies risky clauses, compares against templates, and routes high-risk contracts for legal review before DocuSign.",
        category: "operations",
        tags: ["contracts", "legal", "risk-analysis", "ai-review", "docusign"],
        required_integrations: ["google-drive", "docusign", "notion", "slack"],
        featured: true,
        definition: {
            name: "Contract Review Assistant",
            nodes: [
                {
                    id: "files-1",
                    type: "files",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Upload Contract",
                        inputName: "contract",
                        inputVariable: "contract",
                        description: "Upload contract for review"
                    }
                },
                {
                    id: "llm-extract",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Extract Contract Text",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Extract all text from this contract document:\n\n{{contract}}\n\nPreserve structure: sections, clauses, definitions, signatures.",
                        outputVariable: "contractText"
                    }
                },
                {
                    id: "llm-parties",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Extract Parties & Dates",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Extract key contract metadata:\n\n{{contractText.text}}\n\nIdentify: parties involved, effective date, term length, renewal terms, governing law.",
                        outputVariable: "metadata"
                    }
                },
                {
                    id: "llm-terms",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Extract Key Terms",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Extract key contractual terms:\n\n{{contractText.text}}\n\nIdentify: payment terms, deliverables, SLAs, warranties, indemnification, liability limits.",
                        outputVariable: "keyTerms"
                    }
                },
                {
                    id: "llm-risk",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Identify Risky Clauses",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Analyze contract for risky clauses:\n\n{{contractText.text}}\n\nFlag: unlimited liability, one-sided indemnification, auto-renewal traps, non-compete issues, IP assignment concerns, unusual termination terms. Rate risk: High/Medium/Low.",
                        outputVariable: "riskAnalysis"
                    }
                },
                {
                    id: "llm-compare",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Compare to Template",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Compare this contract to standard template:\n\nContract: {{contractText.text}}\n\nIdentify deviations from standard terms. Flag: missing clauses, modified language, non-standard provisions.",
                        outputVariable: "templateComparison"
                    }
                },
                {
                    id: "router-risk",
                    type: "router",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Route by Risk",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Based on risk analysis:\n{{riskAnalysis.text}}\n\nDetermine approval path.",
                        routes: [
                            {
                                value: "high-risk",
                                label: "High Risk",
                                description: "Legal review required"
                            },
                            {
                                value: "needs-review",
                                label: "Needs Review",
                                description: "Manager review"
                            },
                            { value: "standard", label: "Standard", description: "Auto-approve" }
                        ],
                        defaultRoute: "needs-review",
                        outputVariable: "riskRoute"
                    }
                },
                {
                    id: "llm-redlines",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Redlines",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Based on risk analysis, generate suggested redlines:\n\nRisks: {{riskAnalysis.text}}\nTemplate Comparison: {{templateComparison.text}}\n\nProvide specific language changes to mitigate risks.",
                        outputVariable: "redlines"
                    }
                },
                {
                    id: "humanReview-legal",
                    type: "humanReview",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Legal Review",
                        reviewPrompt:
                            "High-risk contract requires legal team review before proceeding",
                        outputVariable: "legalApproval"
                    }
                },
                {
                    id: "humanReview-manager",
                    type: "humanReview",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Manager Review",
                        reviewPrompt: "Contract requires manager approval",
                        outputVariable: "managerApproval"
                    }
                },
                {
                    id: "conditional-approved",
                    type: "conditional",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Approved?",
                        condition: "approval.approved === true",
                        outputVariable: "isApproved"
                    }
                },
                {
                    id: "integration-docusign",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Send to DocuSign",
                        provider: "docusign",
                        operation: "createEnvelope"
                    }
                },
                {
                    id: "llm-rejection",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Rejection Response",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Generate a professional response for contract revision:\n\nRedlines: {{redlines.text}}\n\nExplain required changes politely and professionally.",
                        outputVariable: "rejectionResponse"
                    }
                },
                {
                    id: "integration-notion",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Update Contract DB",
                        provider: "notion",
                        operation: "createPage",
                        database: "Contracts"
                    }
                },
                {
                    id: "integration-slack-legal",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Notify Legal",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#legal"
                    }
                },
                {
                    id: "integration-gmail",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Send Response",
                        provider: "gmail",
                        operation: "sendEmail"
                    }
                },
                {
                    id: "integration-slack",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Notify Team",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#contracts"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Review Complete",
                        outputName: "result",
                        value: "{{riskAnalysis}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "files-1", target: "llm-extract" },
                { id: "e2", source: "llm-extract", target: "llm-parties" },
                { id: "e3", source: "llm-extract", target: "llm-terms" },
                { id: "e4", source: "llm-terms", target: "llm-risk" },
                { id: "e5", source: "llm-risk", target: "llm-compare" },
                { id: "e6", source: "llm-compare", target: "router-risk" },
                {
                    id: "e7",
                    source: "router-risk",
                    target: "llm-redlines",
                    sourceHandle: "high-risk"
                },
                { id: "e8", source: "llm-redlines", target: "humanReview-legal" },
                {
                    id: "e9",
                    source: "router-risk",
                    target: "humanReview-manager",
                    sourceHandle: "needs-review"
                },
                {
                    id: "e10",
                    source: "router-risk",
                    target: "integration-docusign",
                    sourceHandle: "standard"
                },
                { id: "e11", source: "humanReview-legal", target: "conditional-approved" },
                { id: "e12", source: "humanReview-manager", target: "conditional-approved" },
                {
                    id: "e13",
                    source: "conditional-approved",
                    target: "integration-docusign",
                    sourceHandle: "true"
                },
                {
                    id: "e14",
                    source: "conditional-approved",
                    target: "llm-rejection",
                    sourceHandle: "false"
                },
                { id: "e15", source: "llm-rejection", target: "integration-gmail" },
                { id: "e16", source: "integration-docusign", target: "integration-notion" },
                { id: "e17", source: "integration-notion", target: "integration-slack" },
                { id: "e18", source: "integration-gmail", target: "integration-slack-legal" },
                { id: "e19", source: "integration-slack", target: "output-1" },
                { id: "e20", source: "integration-slack-legal", target: "output-1" }
            ]
        }
    },

    // Document 3: Resume Screening Pipeline (15 nodes)
    {
        name: "Resume Screening Pipeline",
        description:
            "Bulk resume processing with AI-powered skill extraction, job requirement matching, candidate scoring, and automatic filtering to identify top candidates.",
        category: "hr",
        tags: ["recruiting", "resume-screening", "ai-scoring", "automation", "hr"],
        required_integrations: ["google-drive", "airtable", "gmail", "slack"],
        featured: false,
        definition: {
            name: "Resume Screening Pipeline",
            nodes: [
                {
                    id: "files-1",
                    type: "files",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Upload Resumes",
                        inputName: "resumes",
                        inputVariable: "resumes",
                        description: "Upload batch of resumes"
                    }
                },
                {
                    id: "input-requirements",
                    type: "input",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Job Requirements",
                        inputName: "requirements",
                        inputVariable: "requirements",
                        inputType: "text",
                        description: "Job requirements and must-have skills"
                    }
                },
                {
                    id: "llm-extract",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Extract Resume Data",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Extract structured data from this resume:\n\n{{resume}}\n\nFields: name, email, phone, summary, years of experience, skills (list), education, certifications, work history.",
                        outputVariable: "resumeData"
                    }
                },
                {
                    id: "llm-skills",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Analyze Skills Match",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Compare candidate skills to job requirements:\n\nCandidate: {{resumeData.text}}\nRequirements: {{requirements}}\n\nIdentify: matching skills, missing skills, bonus skills, skill proficiency level.",
                        outputVariable: "skillsMatch"
                    }
                },
                {
                    id: "llm-score",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Calculate Fit Score",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Score this candidate (0-100) for the role:\n\nSkills Match: {{skillsMatch.text}}\nExperience: {{resumeData.text}}\n\nWeight: skills match (40%), experience (30%), education (15%), certifications (15%). Provide detailed scoring breakdown.",
                        outputVariable: "fitScore"
                    }
                },
                {
                    id: "conditional-threshold",
                    type: "conditional",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Meets Minimum?",
                        condition: "fitScore.score >= 60",
                        outputVariable: "meetsMinimum"
                    }
                },
                {
                    id: "integration-airtable-qualified",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Add to Qualified",
                        provider: "airtable",
                        operation: "createRecord",
                        table: "Qualified Candidates"
                    }
                },
                {
                    id: "llm-rejection-email",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Rejection Email",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Generate a polite rejection email for:\n\nCandidate: {{resumeData.text}}\n\nBe encouraging, mention we'll keep them in mind for future opportunities.",
                        outputVariable: "rejectionEmail"
                    }
                },
                {
                    id: "integration-gmail-reject",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Send Rejection",
                        provider: "gmail",
                        operation: "sendEmail"
                    }
                },
                {
                    id: "transform-aggregate",
                    type: "transform",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Aggregate Results",
                        transformType: "template",
                        template:
                            '{"totalProcessed": {{count}}, "qualified": {{qualifiedCount}}, "rejected": {{rejectedCount}}}',
                        outputVariable: "results"
                    }
                },
                {
                    id: "llm-rank",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Rank Top Candidates",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Rank the qualified candidates:\n\n{{qualifiedCandidates}}\n\nProvide top 10 with reasoning for each ranking.",
                        outputVariable: "rankedCandidates"
                    }
                },
                {
                    id: "integration-drive",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Archive Resumes",
                        provider: "google-drive",
                        operation: "uploadFile"
                    }
                },
                {
                    id: "integration-slack",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Notify Recruiting",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#recruiting"
                    }
                },
                {
                    id: "integration-gmail-summary",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Email Hiring Manager",
                        provider: "gmail",
                        operation: "sendEmail"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Screening Complete",
                        outputName: "result",
                        value: "{{rankedCandidates}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "files-1", target: "llm-extract" },
                { id: "e2", source: "input-requirements", target: "llm-skills" },
                { id: "e3", source: "llm-extract", target: "llm-skills" },
                { id: "e4", source: "llm-skills", target: "llm-score" },
                { id: "e5", source: "llm-score", target: "conditional-threshold" },
                {
                    id: "e6",
                    source: "conditional-threshold",
                    target: "integration-airtable-qualified",
                    sourceHandle: "true"
                },
                {
                    id: "e7",
                    source: "conditional-threshold",
                    target: "llm-rejection-email",
                    sourceHandle: "false"
                },
                { id: "e8", source: "llm-rejection-email", target: "integration-gmail-reject" },
                {
                    id: "e9",
                    source: "integration-airtable-qualified",
                    target: "transform-aggregate"
                },
                { id: "e10", source: "integration-gmail-reject", target: "transform-aggregate" },
                { id: "e11", source: "transform-aggregate", target: "llm-rank" },
                { id: "e12", source: "llm-rank", target: "integration-drive" },
                { id: "e13", source: "integration-drive", target: "integration-slack" },
                { id: "e14", source: "integration-slack", target: "integration-gmail-summary" },
                { id: "e15", source: "integration-gmail-summary", target: "output-1" }
            ]
        }
    },

    // ========================================================================
    // MULTI-STEP APPROVALS (3 templates)
    // ========================================================================

    // Operations: Compliance Audit Trail Generator (14 nodes)
    {
        name: "Compliance Audit Trail Generator",
        description:
            "Automatically generate and maintain audit trails for compliance requirements. Track document access, policy acknowledgments, and generate compliance reports on demand.",
        category: "operations",
        tags: ["compliance", "audit", "documentation", "reporting", "governance"],
        required_integrations: ["google-drive", "airtable", "gmail", "slack"],
        featured: true,
        definition: {
            name: "Compliance Audit Trail Generator",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Audit Request",
                        triggerType: "webhook",
                        description: "Triggered when audit report is requested"
                    }
                },
                {
                    id: "input-1",
                    type: "input",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Audit Parameters",
                        inputName: "auditParams",
                        inputVariable: "auditParams",
                        inputType: "text",
                        description: "Audit type, date range, and scope"
                    }
                },
                {
                    id: "integration-airtable-policies",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Fetch Policy Records",
                        provider: "airtable",
                        operation: "listRecords"
                    }
                },
                {
                    id: "integration-gdrive-access",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get Access Logs",
                        provider: "google-drive",
                        operation: "listFiles"
                    }
                },
                {
                    id: "integration-airtable-training",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Fetch Training Records",
                        provider: "airtable",
                        operation: "listRecords"
                    }
                },
                {
                    id: "transform-aggregate",
                    type: "transform",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Aggregate Compliance Data",
                        transformType: "merge",
                        outputVariable: "complianceData"
                    }
                },
                {
                    id: "llm-analyze",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Analyze Compliance Gaps",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Analyze this compliance data:\n\n{{complianceData}}\n\nIdentify: gaps in policy acknowledgments, overdue training, access anomalies, and risk areas.",
                        outputVariable: "complianceAnalysis"
                    }
                },
                {
                    id: "router-1",
                    type: "router",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Route by Risk Level",
                        routerType: "llm",
                        routes: ["high_risk", "medium_risk", "compliant"],
                        outputVariable: "riskLevel"
                    }
                },
                {
                    id: "llm-report",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Audit Report",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Generate a formal compliance audit report including:\n- Executive summary\n- Findings\n- Risk assessment\n- Recommendations\n- Action items with deadlines",
                        outputVariable: "auditReport"
                    }
                },
                {
                    id: "integration-gdrive-save",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Save Audit Report",
                        provider: "google-drive",
                        operation: "uploadFile"
                    }
                },
                {
                    id: "integration-gmail-urgent",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Alert Compliance Team",
                        provider: "gmail",
                        operation: "sendMessage"
                    }
                },
                {
                    id: "integration-airtable-log",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Log Audit Record",
                        provider: "airtable",
                        operation: "createRecord"
                    }
                },
                {
                    id: "integration-slack",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Notify Stakeholders",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#compliance"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Audit Complete",
                        outputName: "result",
                        value: "Compliance audit report generated"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "trigger-1", target: "input-1" },
                { id: "e2", source: "input-1", target: "integration-airtable-policies" },
                { id: "e3", source: "input-1", target: "integration-gdrive-access" },
                { id: "e4", source: "input-1", target: "integration-airtable-training" },
                {
                    id: "e5",
                    source: "integration-airtable-policies",
                    target: "transform-aggregate"
                },
                { id: "e6", source: "integration-gdrive-access", target: "transform-aggregate" },
                {
                    id: "e7",
                    source: "integration-airtable-training",
                    target: "transform-aggregate"
                },
                { id: "e8", source: "transform-aggregate", target: "llm-analyze" },
                { id: "e9", source: "llm-analyze", target: "router-1" },
                {
                    id: "e10",
                    source: "router-1",
                    target: "integration-gmail-urgent",
                    sourceHandle: "high_risk"
                },
                {
                    id: "e11",
                    source: "router-1",
                    target: "llm-report",
                    sourceHandle: "medium_risk"
                },
                { id: "e12", source: "router-1", target: "llm-report", sourceHandle: "compliant" },
                { id: "e13", source: "integration-gmail-urgent", target: "llm-report" },
                { id: "e14", source: "llm-report", target: "integration-gdrive-save" },
                {
                    id: "e15",
                    source: "integration-gdrive-save",
                    target: "integration-airtable-log"
                },
                { id: "e16", source: "integration-airtable-log", target: "integration-slack" },
                { id: "e17", source: "integration-slack", target: "output-1" }
            ]
        }
    },

    // Approvals 2: Purchase Order Workflow (20 nodes)
    {
        name: "Purchase Order Workflow",
        description:
            "Complete purchase order lifecycle: requisition validation, budget checking, multi-level approval chain, PO generation, vendor notification, and delivery tracking.",
        category: "finance",
        tags: ["procurement", "purchase-order", "approval", "budget", "vendor"],
        required_integrations: ["quickbooks", "docusign", "gmail", "airtable", "slack"],
        featured: false,
        definition: {
            name: "Purchase Order Workflow",
            nodes: [
                {
                    id: "input-1",
                    type: "input",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Requisition Details",
                        inputName: "requisition",
                        inputVariable: "requisition",
                        inputType: "json",
                        description:
                            '{"items": [], "vendor": "", "totalAmount": 0, "justification": ""}'
                    }
                },
                {
                    id: "llm-validate",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Validate Requisition",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Validate this purchase requisition:\n\n{{requisition}}\n\nCheck: complete item details, valid vendor, reasonable pricing, proper justification.",
                        outputVariable: "validation"
                    }
                },
                {
                    id: "integration-quickbooks-budget",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Check Budget",
                        provider: "quickbooks",
                        operation: "getBudget"
                    }
                },
                {
                    id: "conditional-budget",
                    type: "conditional",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Within Budget?",
                        condition: "budget.available >= requisition.totalAmount",
                        outputVariable: "withinBudget"
                    }
                },
                {
                    id: "router-category",
                    type: "router",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Route by Category",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Determine approval path for:\n{{requisition}}\n\nConsider: amount, category (capital vs operational), vendor status.",
                        routes: [
                            {
                                value: "dept",
                                label: "Department",
                                description: "Department head only"
                            },
                            {
                                value: "procurement",
                                label: "Procurement",
                                description: "Procurement review required"
                            },
                            {
                                value: "cfo",
                                label: "CFO",
                                description: "CFO approval for capital expense"
                            }
                        ],
                        defaultRoute: "procurement",
                        outputVariable: "approvalPath"
                    }
                },
                {
                    id: "humanReview-dept",
                    type: "humanReview",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Department Head Approval",
                        reviewPrompt: "Review and approve department purchase request",
                        outputVariable: "deptApproval"
                    }
                },
                {
                    id: "humanReview-procurement",
                    type: "humanReview",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Procurement Review",
                        reviewPrompt: "Review vendor terms, pricing, and alternatives",
                        outputVariable: "procurementApproval"
                    }
                },
                {
                    id: "humanReview-cfo",
                    type: "humanReview",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "CFO Approval",
                        reviewPrompt: "Capital expense requires CFO approval",
                        outputVariable: "cfoApproval"
                    }
                },
                {
                    id: "llm-generate-po",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate PO Document",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Generate a formal Purchase Order document:\n\n{{requisition}}\n\nInclude: PO number, date, vendor details, line items, terms, authorized signatures block.",
                        outputVariable: "poDocument"
                    }
                },
                {
                    id: "integration-docs",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Create PO PDF",
                        provider: "google-docs",
                        operation: "createDocument"
                    }
                },
                {
                    id: "integration-docusign",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Send for Signature",
                        provider: "docusign",
                        operation: "createEnvelope"
                    }
                },
                {
                    id: "integration-gmail-vendor",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Notify Vendor",
                        provider: "gmail",
                        operation: "sendEmail"
                    }
                },
                {
                    id: "integration-quickbooks-po",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Create in Accounting",
                        provider: "quickbooks",
                        operation: "createPurchaseOrder"
                    }
                },
                {
                    id: "integration-airtable",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Track Delivery",
                        provider: "airtable",
                        operation: "createRecord",
                        table: "Purchase Orders"
                    }
                },
                {
                    id: "integration-gmail-rejected",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Send Rejection",
                        provider: "gmail",
                        operation: "sendEmail"
                    }
                },
                {
                    id: "integration-gmail-budget",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Budget Alert",
                        provider: "gmail",
                        operation: "sendEmail"
                    }
                },
                {
                    id: "integration-slack",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Notify Procurement",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#procurement"
                    }
                },
                {
                    id: "transform-summary",
                    type: "transform",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Create Summary",
                        transformType: "template",
                        template: "PO {{poNumber}} created for {{vendor}} - ${{totalAmount}}",
                        outputVariable: "summary"
                    }
                },
                {
                    id: "integration-slack-complete",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Post Completion",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#finance"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "PO Complete",
                        outputName: "result",
                        value: "{{poDocument}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "input-1", target: "llm-validate" },
                { id: "e2", source: "llm-validate", target: "integration-quickbooks-budget" },
                { id: "e3", source: "integration-quickbooks-budget", target: "conditional-budget" },
                {
                    id: "e4",
                    source: "conditional-budget",
                    target: "router-category",
                    sourceHandle: "true"
                },
                {
                    id: "e5",
                    source: "conditional-budget",
                    target: "integration-gmail-budget",
                    sourceHandle: "false"
                },
                {
                    id: "e6",
                    source: "router-category",
                    target: "humanReview-dept",
                    sourceHandle: "dept"
                },
                {
                    id: "e7",
                    source: "router-category",
                    target: "humanReview-procurement",
                    sourceHandle: "procurement"
                },
                {
                    id: "e8",
                    source: "router-category",
                    target: "humanReview-cfo",
                    sourceHandle: "cfo"
                },
                { id: "e9", source: "humanReview-dept", target: "llm-generate-po" },
                { id: "e10", source: "humanReview-procurement", target: "llm-generate-po" },
                { id: "e11", source: "humanReview-cfo", target: "llm-generate-po" },
                { id: "e12", source: "llm-generate-po", target: "integration-docs" },
                { id: "e13", source: "integration-docs", target: "integration-docusign" },
                { id: "e14", source: "integration-docusign", target: "integration-gmail-vendor" },
                {
                    id: "e15",
                    source: "integration-gmail-vendor",
                    target: "integration-quickbooks-po"
                },
                { id: "e16", source: "integration-quickbooks-po", target: "integration-airtable" },
                { id: "e17", source: "integration-airtable", target: "transform-summary" },
                { id: "e18", source: "transform-summary", target: "integration-slack-complete" },
                { id: "e19", source: "integration-gmail-budget", target: "integration-slack" },
                { id: "e20", source: "integration-slack", target: "output-1" },
                { id: "e21", source: "integration-slack-complete", target: "output-1" }
            ]
        }
    },

    // Approvals 3: Content Publishing Approval (14 nodes)
    {
        name: "Content Publishing Approval",
        description:
            "Content review workflow with automatic sensitive content detection, editor review, conditional legal review, and multi-channel publishing with analytics tracking.",
        category: "marketing",
        tags: ["content", "publishing", "approval", "editorial", "compliance"],
        required_integrations: ["notion", "wordpress", "twitter", "linkedin", "slack"],
        featured: false,
        definition: {
            name: "Content Publishing Approval",
            nodes: [
                {
                    id: "input-1",
                    type: "input",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Content Draft",
                        inputName: "content",
                        inputVariable: "content",
                        inputType: "text",
                        description: "Content draft for review and publishing"
                    }
                },
                {
                    id: "llm-check-sensitive",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Check Sensitive Content",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Analyze this content for sensitive topics:\n\n{{content}}\n\nCheck for: legal claims, competitor mentions, financial projections, personal data, regulatory issues. Flag if legal review needed.",
                        outputVariable: "sensitivityCheck"
                    }
                },
                {
                    id: "router-sensitivity",
                    type: "router",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Route by Sensitivity",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Based on sensitivity check:\n{{sensitivityCheck.text}}\n\nDoes this require legal review?",
                        routes: [
                            {
                                value: "legal",
                                label: "Needs Legal",
                                description: "Legal review required"
                            },
                            {
                                value: "standard",
                                label: "Standard",
                                description: "Normal editorial flow"
                            }
                        ],
                        defaultRoute: "standard",
                        outputVariable: "sensitivityRoute"
                    }
                },
                {
                    id: "humanReview-editor",
                    type: "humanReview",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Editor Review",
                        reviewPrompt: "Review content for quality, accuracy, and brand voice",
                        outputVariable: "editorApproval"
                    }
                },
                {
                    id: "humanReview-legal",
                    type: "humanReview",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Legal Review",
                        reviewPrompt: "Review content for legal and compliance issues",
                        outputVariable: "legalApproval"
                    }
                },
                {
                    id: "conditional-approved",
                    type: "conditional",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Approved?",
                        condition: "approval.approved === true",
                        outputVariable: "isApproved"
                    }
                },
                {
                    id: "input-schedule",
                    type: "input",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Publication Date",
                        inputName: "publishDate",
                        inputVariable: "publishDate",
                        inputType: "text",
                        description: "Scheduled publication date"
                    }
                },
                {
                    id: "integration-wordpress",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Publish to CMS",
                        provider: "wordpress",
                        operation: "createPost"
                    }
                },
                {
                    id: "integration-twitter",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Post to Twitter",
                        provider: "twitter",
                        operation: "createTweet"
                    }
                },
                {
                    id: "integration-linkedin",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Post to LinkedIn",
                        provider: "linkedin",
                        operation: "createPost"
                    }
                },
                {
                    id: "integration-notion",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Update Content Calendar",
                        provider: "notion",
                        operation: "updatePage"
                    }
                },
                {
                    id: "integration-slack",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Notify Author",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#content"
                    }
                },
                {
                    id: "integration-slack-rejected",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Notify Rejection",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#content"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Publishing Complete",
                        outputName: "result",
                        value: "Content published successfully"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "input-1", target: "llm-check-sensitive" },
                { id: "e2", source: "llm-check-sensitive", target: "router-sensitivity" },
                {
                    id: "e3",
                    source: "router-sensitivity",
                    target: "humanReview-legal",
                    sourceHandle: "legal"
                },
                {
                    id: "e4",
                    source: "router-sensitivity",
                    target: "humanReview-editor",
                    sourceHandle: "standard"
                },
                { id: "e5", source: "humanReview-legal", target: "humanReview-editor" },
                { id: "e6", source: "humanReview-editor", target: "conditional-approved" },
                {
                    id: "e7",
                    source: "conditional-approved",
                    target: "input-schedule",
                    sourceHandle: "true"
                },
                {
                    id: "e8",
                    source: "conditional-approved",
                    target: "integration-slack-rejected",
                    sourceHandle: "false"
                },
                { id: "e9", source: "input-schedule", target: "integration-wordpress" },
                { id: "e10", source: "integration-wordpress", target: "integration-twitter" },
                { id: "e11", source: "integration-wordpress", target: "integration-linkedin" },
                { id: "e12", source: "integration-twitter", target: "integration-notion" },
                { id: "e13", source: "integration-linkedin", target: "integration-notion" },
                { id: "e14", source: "integration-notion", target: "integration-slack" },
                { id: "e15", source: "integration-slack", target: "output-1" },
                { id: "e16", source: "integration-slack-rejected", target: "output-1" }
            ]
        }
    },

    // ========================================================================
    // FINANCE/ACCOUNTING (2 templates)
    // ========================================================================

    // Finance 1: Invoice Processing & Payment (16 nodes)
    {
        name: "Invoice Processing & Payment",
        description:
            "Automated vendor invoice processing: extract data from email attachments, match to purchase orders, route for approval, schedule payment, and sync with accounting.",
        category: "finance",
        tags: ["invoice", "accounts-payable", "automation", "matching", "payment"],
        required_integrations: ["gmail", "quickbooks", "google-sheets", "slack"],
        featured: true,
        definition: {
            name: "Invoice Processing & Payment",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Invoice Email Received",
                        triggerType: "webhook",
                        webhookProvider: "gmail",
                        description: "Triggered when invoice email is received"
                    }
                },
                {
                    id: "integration-gmail",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get Email & Attachment",
                        provider: "gmail",
                        operation: "getAttachment"
                    }
                },
                {
                    id: "llm-extract",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Extract Invoice Data",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Extract invoice details from this document:\n\n{{attachment}}\n\nFields: vendor name, invoice number, date, due date, PO number (if any), line items, subtotal, tax, total, payment terms.",
                        outputVariable: "invoiceData"
                    }
                },
                {
                    id: "integration-quickbooks-po",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Lookup Purchase Order",
                        provider: "quickbooks",
                        operation: "getPurchaseOrder"
                    }
                },
                {
                    id: "llm-match",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Match to PO",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Compare invoice to purchase order:\n\nInvoice: {{invoiceData.text}}\nPO: {{purchaseOrder}}\n\nCheck: amounts match, quantities match, vendor matches, items match. Flag any discrepancies.",
                        outputVariable: "matchResult"
                    }
                },
                {
                    id: "conditional-match",
                    type: "conditional",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "PO Matches?",
                        condition: "matchResult.isMatch === true",
                        outputVariable: "poMatches"
                    }
                },
                {
                    id: "humanReview-discrepancy",
                    type: "humanReview",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Review Discrepancy",
                        reviewPrompt:
                            "Invoice does not match PO - review and resolve discrepancies",
                        outputVariable: "discrepancyReview"
                    }
                },
                {
                    id: "router-amount",
                    type: "router",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Route for Approval",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Determine approval level for invoice amount: ${{invoiceData.total}}",
                        routes: [
                            { value: "auto", label: "<$500", description: "Auto-approve" },
                            {
                                value: "manager",
                                label: "$500-$5000",
                                description: "Manager approval"
                            },
                            { value: "finance", label: ">$5000", description: "Finance approval" }
                        ],
                        defaultRoute: "manager",
                        outputVariable: "approvalRoute"
                    }
                },
                {
                    id: "humanReview-approval",
                    type: "humanReview",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Approval Review",
                        reviewPrompt: "Review and approve invoice for payment",
                        outputVariable: "paymentApproval"
                    }
                },
                {
                    id: "integration-quickbooks-bill",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Create Bill",
                        provider: "quickbooks",
                        operation: "createBill"
                    }
                },
                {
                    id: "integration-quickbooks-payment",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Schedule Payment",
                        provider: "quickbooks",
                        operation: "createBillPayment"
                    }
                },
                {
                    id: "integration-sheets",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Update AP Log",
                        provider: "google-sheets",
                        operation: "appendValues"
                    }
                },
                {
                    id: "integration-gmail-confirm",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Confirm to Vendor",
                        provider: "gmail",
                        operation: "sendEmail"
                    }
                },
                {
                    id: "integration-drive",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Archive Invoice",
                        provider: "google-drive",
                        operation: "uploadFile"
                    }
                },
                {
                    id: "integration-slack",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Notify Finance",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#accounts-payable"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Invoice Processed",
                        outputName: "result",
                        value: "{{invoiceData.invoiceNumber}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "trigger-1", target: "integration-gmail" },
                { id: "e2", source: "integration-gmail", target: "llm-extract" },
                { id: "e3", source: "llm-extract", target: "integration-quickbooks-po" },
                { id: "e4", source: "integration-quickbooks-po", target: "llm-match" },
                { id: "e5", source: "llm-match", target: "conditional-match" },
                {
                    id: "e6",
                    source: "conditional-match",
                    target: "router-amount",
                    sourceHandle: "true"
                },
                {
                    id: "e7",
                    source: "conditional-match",
                    target: "humanReview-discrepancy",
                    sourceHandle: "false"
                },
                { id: "e8", source: "humanReview-discrepancy", target: "router-amount" },
                {
                    id: "e9",
                    source: "router-amount",
                    target: "integration-quickbooks-bill",
                    sourceHandle: "auto"
                },
                {
                    id: "e10",
                    source: "router-amount",
                    target: "humanReview-approval",
                    sourceHandle: "manager"
                },
                {
                    id: "e11",
                    source: "router-amount",
                    target: "humanReview-approval",
                    sourceHandle: "finance"
                },
                {
                    id: "e12",
                    source: "humanReview-approval",
                    target: "integration-quickbooks-bill"
                },
                {
                    id: "e13",
                    source: "integration-quickbooks-bill",
                    target: "integration-quickbooks-payment"
                },
                {
                    id: "e14",
                    source: "integration-quickbooks-payment",
                    target: "integration-sheets"
                },
                { id: "e15", source: "integration-sheets", target: "integration-gmail-confirm" },
                { id: "e16", source: "integration-gmail-confirm", target: "integration-drive" },
                { id: "e17", source: "integration-drive", target: "integration-slack" },
                { id: "e18", source: "integration-slack", target: "output-1" }
            ]
        }
    },

    // Finance 2: Financial Reconciliation Bot (18 nodes)
    {
        name: "Financial Reconciliation Bot",
        description:
            "Daily automated bank reconciliation: fetch transactions, match against accounting entries, flag discrepancies, create investigation tasks, and generate reconciliation reports.",
        category: "finance",
        tags: ["reconciliation", "accounting", "automation", "bank", "matching"],
        required_integrations: ["quickbooks", "google-sheets", "gmail", "slack"],
        featured: false,
        definition: {
            name: "Financial Reconciliation Bot",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Daily 6am",
                        triggerType: "schedule",
                        schedule: "0 6 * * *",
                        description: "Runs daily at 6am"
                    }
                },
                {
                    id: "integration-plaid",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Fetch Bank Transactions",
                        provider: "http",
                        operation: "get",
                        description: "Plaid bank feed API"
                    }
                },
                {
                    id: "integration-quickbooks",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Fetch Accounting Entries",
                        provider: "quickbooks",
                        operation: "queryTransactions"
                    }
                },
                {
                    id: "llm-match",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Match Transactions",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Match bank transactions to accounting entries:\n\nBank: {{bankTransactions}}\nAccounting: {{accountingEntries}}\n\nFor each transaction, find matching entry by: amount, date (within 3 days), description similarity. Classify as: matched, unmatched-bank, unmatched-accounting.",
                        outputVariable: "matchResults"
                    }
                },
                {
                    id: "router-status",
                    type: "router",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Route by Match Status",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Categorize overall reconciliation status:\n{{matchResults.text}}",
                        routes: [
                            {
                                value: "matched",
                                label: "All Matched",
                                description: "Full reconciliation"
                            },
                            {
                                value: "partial",
                                label: "Partial Match",
                                description: "Some discrepancies"
                            },
                            {
                                value: "major",
                                label: "Major Issues",
                                description: "Significant discrepancies"
                            }
                        ],
                        defaultRoute: "partial",
                        outputVariable: "matchStatus"
                    }
                },
                {
                    id: "integration-quickbooks-reconcile",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Mark Reconciled",
                        provider: "quickbooks",
                        operation: "reconcileTransactions"
                    }
                },
                {
                    id: "llm-investigate",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Investigation Tasks",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Create investigation tasks for unmatched items:\n\n{{matchResults.text}}\n\nFor each: describe the discrepancy, suggest investigation steps, assign priority.",
                        outputVariable: "investigations"
                    }
                },
                {
                    id: "integration-airtable",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Create Tasks",
                        provider: "airtable",
                        operation: "createRecord",
                        table: "Reconciliation Tasks"
                    }
                },
                {
                    id: "llm-clarification",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Request Clarification",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Generate clarification requests for partial matches:\n\n{{matchResults.text}}\n\nAsk specific questions to resolve ambiguity.",
                        outputVariable: "clarifications"
                    }
                },
                {
                    id: "integration-gmail-clarify",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Send Clarification Requests",
                        provider: "gmail",
                        operation: "sendEmail"
                    }
                },
                {
                    id: "transform-results",
                    type: "transform",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Aggregate Results",
                        transformType: "template",
                        template:
                            '{"matched": {{matchedCount}}, "unmatched": {{unmatchedCount}}, "investigating": {{investigatingCount}}}',
                        outputVariable: "aggregatedResults"
                    }
                },
                {
                    id: "llm-report",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Report",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Create a daily reconciliation report:\n\n{{aggregatedResults}}\n{{matchResults.text}}\n\nInclude: summary stats, discrepancy details, recommended actions, trend analysis if patterns detected.",
                        outputVariable: "report"
                    }
                },
                {
                    id: "integration-sheets",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Log Results",
                        provider: "google-sheets",
                        operation: "appendValues"
                    }
                },
                {
                    id: "integration-gmail",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Email Report",
                        provider: "gmail",
                        operation: "sendEmail"
                    }
                },
                {
                    id: "integration-slack-alert",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Alert Major Issues",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#finance-alerts"
                    }
                },
                {
                    id: "integration-slack",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Post Daily Summary",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#finance"
                    }
                },
                {
                    id: "integration-datadog",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Track Metrics",
                        provider: "datadog",
                        operation: "submitMetrics"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Reconciliation Complete",
                        outputName: "result",
                        value: "{{report}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "trigger-1", target: "integration-plaid" },
                { id: "e2", source: "trigger-1", target: "integration-quickbooks" },
                { id: "e3", source: "integration-plaid", target: "llm-match" },
                { id: "e4", source: "integration-quickbooks", target: "llm-match" },
                { id: "e5", source: "llm-match", target: "router-status" },
                {
                    id: "e6",
                    source: "router-status",
                    target: "integration-quickbooks-reconcile",
                    sourceHandle: "matched"
                },
                {
                    id: "e7",
                    source: "router-status",
                    target: "llm-clarification",
                    sourceHandle: "partial"
                },
                {
                    id: "e8",
                    source: "router-status",
                    target: "llm-investigate",
                    sourceHandle: "major"
                },
                {
                    id: "e9",
                    source: "integration-quickbooks-reconcile",
                    target: "transform-results"
                },
                { id: "e10", source: "llm-clarification", target: "integration-gmail-clarify" },
                { id: "e11", source: "integration-gmail-clarify", target: "transform-results" },
                { id: "e12", source: "llm-investigate", target: "integration-airtable" },
                { id: "e13", source: "integration-airtable", target: "integration-slack-alert" },
                { id: "e14", source: "integration-slack-alert", target: "transform-results" },
                { id: "e15", source: "transform-results", target: "llm-report" },
                { id: "e16", source: "llm-report", target: "integration-sheets" },
                { id: "e17", source: "integration-sheets", target: "integration-gmail" },
                { id: "e18", source: "integration-gmail", target: "integration-slack" },
                { id: "e19", source: "integration-slack", target: "integration-datadog" },
                { id: "e20", source: "integration-datadog", target: "output-1" }
            ]
        }
    },

    // ========================================================================
    // RECRUITING/HR (2 templates)
    // ========================================================================

    // HR 1: Interview Scheduling Coordinator (14 nodes)
    {
        name: "Interview Scheduling Coordinator",
        description:
            "Automate interview scheduling: find interviewer availability, propose times to candidates, create calendar events, and send preparation materials to all participants.",
        category: "hr",
        tags: ["recruiting", "scheduling", "interviews", "automation", "hr"],
        required_integrations: ["calendly", "google-calendar", "gmail", "airtable", "slack"],
        featured: true,
        definition: {
            name: "Interview Scheduling Coordinator",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Candidate Qualified",
                        triggerType: "webhook",
                        webhookProvider: "airtable",
                        description: "Triggered when candidate moves to interview stage"
                    }
                },
                {
                    id: "integration-airtable",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get Candidate Details",
                        provider: "airtable",
                        operation: "getRecord"
                    }
                },
                {
                    id: "llm-requirements",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Determine Interview Panel",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Based on this candidate and role:\n\n{{candidate}}\n\nDetermine: interview type (technical/culture/executive), required interviewers, interview duration, special requirements.",
                        outputVariable: "interviewPlan"
                    }
                },
                {
                    id: "integration-calendar-check",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Check Interviewer Availability",
                        provider: "google-calendar",
                        operation: "getFreeBusy"
                    }
                },
                {
                    id: "llm-slots",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Find Optimal Slots",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Find the best interview slots based on:\n\nAvailability: {{availability}}\nInterview Plan: {{interviewPlan.text}}\n\nPropose 3 time slots that work for all required interviewers. Consider time zones if candidate is remote.",
                        outputVariable: "proposedSlots"
                    }
                },
                {
                    id: "integration-gmail-propose",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Send Time Options",
                        provider: "gmail",
                        operation: "sendEmail"
                    }
                },
                {
                    id: "wait-response",
                    type: "wait",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Wait for Response",
                        waitType: "webhook",
                        timeout: 172800000,
                        outputVariable: "candidateResponse"
                    }
                },
                {
                    id: "integration-calendar-create",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Create Calendar Event",
                        provider: "google-calendar",
                        operation: "createEvent"
                    }
                },
                {
                    id: "llm-prep-interviewer",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Interviewer Prep",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Create interview preparation materials for the interviewer:\n\nCandidate: {{candidate}}\nInterview Type: {{interviewPlan.text}}\n\nInclude: resume highlights, suggested questions, evaluation criteria, red/green flags to watch for.",
                        outputVariable: "interviewerPrep"
                    }
                },
                {
                    id: "llm-prep-candidate",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Candidate Guide",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Create interview preparation guide for the candidate:\n\nRole: {{candidate.role}}\nInterview Type: {{interviewPlan.text}}\n\nInclude: what to expect, how to prepare, logistics, interviewer background.",
                        outputVariable: "candidatePrep"
                    }
                },
                {
                    id: "integration-gmail-prep",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Send Prep Materials",
                        provider: "gmail",
                        operation: "sendEmail"
                    }
                },
                {
                    id: "integration-airtable-update",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Update Candidate Record",
                        provider: "airtable",
                        operation: "updateRecord"
                    }
                },
                {
                    id: "integration-slack",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Notify Recruiting",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#recruiting"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Interview Scheduled",
                        outputName: "result",
                        value: "Interview scheduled for {{candidateResponse.selectedSlot}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "trigger-1", target: "integration-airtable" },
                { id: "e2", source: "integration-airtable", target: "llm-requirements" },
                { id: "e3", source: "llm-requirements", target: "integration-calendar-check" },
                { id: "e4", source: "integration-calendar-check", target: "llm-slots" },
                { id: "e5", source: "llm-slots", target: "integration-gmail-propose" },
                { id: "e6", source: "integration-gmail-propose", target: "wait-response" },
                { id: "e7", source: "wait-response", target: "integration-calendar-create" },
                { id: "e8", source: "integration-calendar-create", target: "llm-prep-interviewer" },
                { id: "e9", source: "integration-calendar-create", target: "llm-prep-candidate" },
                { id: "e10", source: "llm-prep-interviewer", target: "integration-gmail-prep" },
                { id: "e11", source: "llm-prep-candidate", target: "integration-gmail-prep" },
                {
                    id: "e12",
                    source: "integration-gmail-prep",
                    target: "integration-airtable-update"
                },
                { id: "e13", source: "integration-airtable-update", target: "integration-slack" },
                { id: "e14", source: "integration-slack", target: "output-1" }
            ]
        }
    },

    // HR 2: Employee Offboarding Orchestrator (16 nodes)
    {
        name: "Employee Offboarding Orchestrator",
        description:
            "Comprehensive employee offboarding: coordinate IT access revocation, HR paperwork, final pay processing, exit interview scheduling, and knowledge transfer across departments.",
        category: "hr",
        tags: ["offboarding", "hr", "security", "automation", "compliance"],
        required_integrations: ["slack", "google-calendar", "gmail", "airtable"],
        featured: false,
        definition: {
            name: "Employee Offboarding Orchestrator",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Offboarding Initiated",
                        triggerType: "webhook",
                        webhookProvider: "airtable",
                        description: "Triggered when employee offboarding is initiated"
                    }
                },
                {
                    id: "integration-airtable",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get Employee Details",
                        provider: "airtable",
                        operation: "getRecord"
                    }
                },
                {
                    id: "llm-calculate",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Calculate Last Day",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Calculate offboarding timeline:\n\nEmployee: {{employee}}\nNotice date: {{trigger.date}}\n\nDetermine: last working day, final pay date, benefits end date, access revocation date.",
                        outputVariable: "timeline"
                    }
                },
                {
                    id: "integration-slack-it",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Notify IT",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#it-support"
                    }
                },
                {
                    id: "integration-slack-hr",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Notify HR",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#hr"
                    }
                },
                {
                    id: "integration-slack-finance",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Notify Finance",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#finance"
                    }
                },
                {
                    id: "integration-slack-manager",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Notify Manager",
                        provider: "slack",
                        operation: "sendMessage"
                    }
                },
                {
                    id: "integration-calendar",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Schedule Exit Interview",
                        provider: "google-calendar",
                        operation: "createEvent"
                    }
                },
                {
                    id: "llm-checklist",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Checklist",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Create offboarding checklist for:\n\n{{employee}}\n\nInclude: IT items to return/revoke, HR documents needed, knowledge transfer items, project handoff tasks.",
                        outputVariable: "checklist"
                    }
                },
                {
                    id: "integration-airtable-checklist",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Create Checklist Tasks",
                        provider: "airtable",
                        operation: "createRecord",
                        table: "Offboarding Checklists"
                    }
                },
                {
                    id: "wait-lastday",
                    type: "wait",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Wait Until Last Day",
                        waitType: "until",
                        untilDate: "{{timeline.lastDay}}",
                        outputVariable: "lastDayReached"
                    }
                },
                {
                    id: "integration-slack-revoke",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Trigger Access Revocation",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#it-support"
                    }
                },
                {
                    id: "integration-gmail-survey",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Send Exit Survey",
                        provider: "gmail",
                        operation: "sendEmail"
                    }
                },
                {
                    id: "integration-airtable-archive",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Archive Employee Record",
                        provider: "airtable",
                        operation: "updateRecord"
                    }
                },
                {
                    id: "integration-sheets",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Log Completion",
                        provider: "google-sheets",
                        operation: "appendValues"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Offboarding Complete",
                        outputName: "result",
                        value: "Offboarding completed for {{employee.name}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "trigger-1", target: "integration-airtable" },
                { id: "e2", source: "integration-airtable", target: "llm-calculate" },
                { id: "e3", source: "llm-calculate", target: "integration-slack-it" },
                { id: "e4", source: "llm-calculate", target: "integration-slack-hr" },
                { id: "e5", source: "llm-calculate", target: "integration-slack-finance" },
                { id: "e6", source: "llm-calculate", target: "integration-slack-manager" },
                { id: "e7", source: "integration-slack-it", target: "integration-calendar" },
                { id: "e8", source: "integration-slack-hr", target: "integration-calendar" },
                { id: "e9", source: "integration-slack-finance", target: "integration-calendar" },
                { id: "e10", source: "integration-slack-manager", target: "integration-calendar" },
                { id: "e11", source: "integration-calendar", target: "llm-checklist" },
                { id: "e12", source: "llm-checklist", target: "integration-airtable-checklist" },
                { id: "e13", source: "integration-airtable-checklist", target: "wait-lastday" },
                { id: "e14", source: "wait-lastday", target: "integration-slack-revoke" },
                {
                    id: "e15",
                    source: "integration-slack-revoke",
                    target: "integration-gmail-survey"
                },
                {
                    id: "e16",
                    source: "integration-gmail-survey",
                    target: "integration-airtable-archive"
                },
                { id: "e17", source: "integration-airtable-archive", target: "integration-sheets" },
                { id: "e18", source: "integration-sheets", target: "output-1" }
            ]
        }
    },

    // ========================================================================
    // CUSTOMER SUCCESS (2 templates)
    // ========================================================================

    // CS 1: Customer Health Score & Alert (20 nodes)
    {
        name: "Customer Health Score & Alert",
        description:
            "Aggregate customer signals from product usage, support, billing, and NPS to calculate health scores. Automatically trigger interventions for at-risk accounts.",
        category: "saas",
        tags: ["customer-success", "health-score", "churn-prevention", "automation"],
        required_integrations: ["mixpanel", "zendesk", "stripe", "hubspot", "slack"],
        featured: true,
        definition: {
            name: "Customer Health Score & Alert",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Daily Check",
                        triggerType: "schedule",
                        schedule: "0 8 * * *",
                        description: "Runs daily at 8am"
                    }
                },
                {
                    id: "input-account",
                    type: "input",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Account ID",
                        inputName: "accountId",
                        inputVariable: "accountId",
                        inputType: "text",
                        description: "Customer account to analyze (or 'all' for batch)"
                    }
                },
                {
                    id: "integration-mixpanel",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Fetch Usage Data",
                        provider: "mixpanel",
                        operation: "queryEvents"
                    }
                },
                {
                    id: "integration-zendesk",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Fetch Support Tickets",
                        provider: "zendesk",
                        operation: "listTickets"
                    }
                },
                {
                    id: "integration-stripe",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Fetch Billing Status",
                        provider: "stripe",
                        operation: "getCustomer"
                    }
                },
                {
                    id: "integration-typeform",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Fetch NPS Score",
                        provider: "typeform",
                        operation: "getResponses"
                    }
                },
                {
                    id: "llm-usage-score",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Calculate Usage Score",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Analyze product usage and calculate score (0-100):\n\n{{usageData}}\n\nConsider: login frequency, feature adoption, engagement trends, comparison to healthy accounts.",
                        outputVariable: "usageScore"
                    }
                },
                {
                    id: "llm-support-score",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Calculate Support Score",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Analyze support interactions and calculate score (0-100):\n\n{{supportTickets}}\n\nConsider: ticket volume, severity, resolution time, sentiment, recurring issues.",
                        outputVariable: "supportScore"
                    }
                },
                {
                    id: "llm-billing-score",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Calculate Billing Score",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Analyze billing status and calculate score (0-100):\n\n{{billingData}}\n\nConsider: payment history, plan type, expansion/contraction, invoice issues.",
                        outputVariable: "billingScore"
                    }
                },
                {
                    id: "llm-composite",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Calculate Health Score",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Calculate composite customer health score:\n\nUsage: {{usageScore.text}}\nSupport: {{supportScore.text}}\nBilling: {{billingScore.text}}\nNPS: {{npsData}}\n\nWeight: Usage 40%, Support 25%, Billing 20%, NPS 15%. Provide overall score and risk assessment.",
                        outputVariable: "healthScore"
                    }
                },
                {
                    id: "router-health",
                    type: "router",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Route by Health",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Based on health score:\n{{healthScore.text}}\n\nDetermine intervention level.",
                        routes: [
                            {
                                value: "healthy",
                                label: "Score >80",
                                description: "Healthy - log only"
                            },
                            {
                                value: "warning",
                                label: "Score 50-80",
                                description: "Warning - CSM task"
                            },
                            {
                                value: "critical",
                                label: "Score <50",
                                description: "Critical - immediate action"
                            }
                        ],
                        defaultRoute: "warning",
                        outputVariable: "healthRoute"
                    }
                },
                {
                    id: "integration-hubspot-update",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Update CRM Health",
                        provider: "hubspot",
                        operation: "updateCompany"
                    }
                },
                {
                    id: "integration-hubspot-task",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Create CSM Task",
                        provider: "hubspot",
                        operation: "createTask"
                    }
                },
                {
                    id: "integration-zendesk-ticket",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Create Urgent Ticket",
                        provider: "zendesk",
                        operation: "createTicket"
                    }
                },
                {
                    id: "integration-slack-critical",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Alert CSM & Manager",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#customer-success-alerts"
                    }
                },
                {
                    id: "integration-sheets",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Log Health Score",
                        provider: "google-sheets",
                        operation: "appendValues"
                    }
                },
                {
                    id: "llm-report",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Trend Report",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Generate weekly health trend report:\n\n{{healthScore.text}}\n\nInclude: score changes, risk factors, recommended actions, success predictions.",
                        outputVariable: "trendReport"
                    }
                },
                {
                    id: "integration-slack",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Post Summary",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#customer-success"
                    }
                },
                {
                    id: "integration-gmail",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Email Weekly Report",
                        provider: "gmail",
                        operation: "sendEmail"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Health Check Complete",
                        outputName: "result",
                        value: "{{healthScore}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "trigger-1", target: "input-account" },
                { id: "e2", source: "input-account", target: "integration-mixpanel" },
                { id: "e3", source: "input-account", target: "integration-zendesk" },
                { id: "e4", source: "input-account", target: "integration-stripe" },
                { id: "e5", source: "input-account", target: "integration-typeform" },
                { id: "e6", source: "integration-mixpanel", target: "llm-usage-score" },
                { id: "e7", source: "integration-zendesk", target: "llm-support-score" },
                { id: "e8", source: "integration-stripe", target: "llm-billing-score" },
                { id: "e9", source: "llm-usage-score", target: "llm-composite" },
                { id: "e10", source: "llm-support-score", target: "llm-composite" },
                { id: "e11", source: "llm-billing-score", target: "llm-composite" },
                { id: "e12", source: "integration-typeform", target: "llm-composite" },
                { id: "e13", source: "llm-composite", target: "router-health" },
                {
                    id: "e14",
                    source: "router-health",
                    target: "integration-hubspot-update",
                    sourceHandle: "healthy"
                },
                {
                    id: "e15",
                    source: "router-health",
                    target: "integration-hubspot-task",
                    sourceHandle: "warning"
                },
                {
                    id: "e16",
                    source: "router-health",
                    target: "integration-slack-critical",
                    sourceHandle: "critical"
                },
                {
                    id: "e17",
                    source: "integration-slack-critical",
                    target: "integration-zendesk-ticket"
                },
                {
                    id: "e18",
                    source: "integration-zendesk-ticket",
                    target: "integration-hubspot-task"
                },
                { id: "e19", source: "integration-hubspot-update", target: "integration-sheets" },
                { id: "e20", source: "integration-hubspot-task", target: "integration-sheets" },
                { id: "e21", source: "integration-sheets", target: "llm-report" },
                { id: "e22", source: "llm-report", target: "integration-slack" },
                { id: "e23", source: "integration-slack", target: "integration-gmail" },
                { id: "e24", source: "integration-gmail", target: "output-1" }
            ]
        }
    },

    // CS 2: Renewal Pipeline Manager (18 nodes)
    {
        name: "Renewal Pipeline Manager",
        description:
            "Proactive renewal management: identify accounts 90 days before renewal, assess health and expansion potential, generate personalized outreach, and track to close.",
        category: "saas",
        tags: ["renewals", "customer-success", "pipeline", "automation", "retention"],
        required_integrations: ["hubspot", "stripe", "mixpanel", "gmail", "slack"],
        featured: true,
        definition: {
            name: "Renewal Pipeline Manager",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Daily Renewal Check",
                        triggerType: "schedule",
                        schedule: "0 7 * * *",
                        description: "Runs daily at 7am"
                    }
                },
                {
                    id: "integration-hubspot",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Fetch Upcoming Renewals",
                        provider: "hubspot",
                        operation: "searchDeals"
                    }
                },
                {
                    id: "integration-stripe-sub",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get Subscription Details",
                        provider: "stripe",
                        operation: "getSubscription"
                    }
                },
                {
                    id: "integration-mixpanel",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Fetch Usage Trends",
                        provider: "mixpanel",
                        operation: "queryEvents"
                    }
                },
                {
                    id: "integration-hubspot-health",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get Health Score",
                        provider: "hubspot",
                        operation: "getCompany"
                    }
                },
                {
                    id: "llm-assess",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Assess Renewal Risk",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Assess renewal likelihood for this account:\n\nSubscription: {{subscription}}\nUsage: {{usageTrends}}\nHealth: {{healthScore}}\n\nConsider: usage trends, support history, engagement, expansion signals, competitive threats.",
                        outputVariable: "riskAssessment"
                    }
                },
                {
                    id: "llm-message",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Outreach",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Generate personalized renewal outreach:\n\nAccount: {{account}}\nRisk: {{riskAssessment.text}}\n\nCreate message that: acknowledges their usage, highlights value delivered, addresses potential concerns, offers expansion opportunities if appropriate.",
                        outputVariable: "outreachMessage"
                    }
                },
                {
                    id: "router-strategy",
                    type: "router",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Route by Strategy",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Based on assessment:\n{{riskAssessment.text}}\n\nDetermine renewal strategy.",
                        routes: [
                            {
                                value: "auto",
                                label: "Auto-Renew",
                                description: "Healthy account, send reminder"
                            },
                            {
                                value: "sales",
                                label: "Sales Touch",
                                description: "Expansion opportunity"
                            },
                            {
                                value: "risk",
                                label: "At-Risk",
                                description: "Executive escalation needed"
                            }
                        ],
                        defaultRoute: "sales",
                        outputVariable: "strategyRoute"
                    }
                },
                {
                    id: "integration-gmail-auto",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Send Renewal Reminder",
                        provider: "gmail",
                        operation: "sendEmail"
                    }
                },
                {
                    id: "integration-hubspot-opp",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Create Opportunity",
                        provider: "hubspot",
                        operation: "createDeal"
                    }
                },
                {
                    id: "integration-hubspot-task",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Create CSM Task",
                        provider: "hubspot",
                        operation: "createTask"
                    }
                },
                {
                    id: "integration-slack-escalate",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Executive Escalation",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#executive-alerts"
                    }
                },
                {
                    id: "integration-gmail-outreach",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Send Outreach",
                        provider: "gmail",
                        operation: "sendEmail"
                    }
                },
                {
                    id: "integration-sheets",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Update Pipeline",
                        provider: "google-sheets",
                        operation: "appendValues"
                    }
                },
                {
                    id: "llm-forecast",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Forecast",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Generate weekly renewal forecast:\n\nPipeline: {{renewalPipeline}}\n\nInclude: expected renewals, at-risk amount, expansion opportunities, recommended actions.",
                        outputVariable: "forecast"
                    }
                },
                {
                    id: "integration-slack",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Post Forecast",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#customer-success"
                    }
                },
                {
                    id: "integration-gmail-report",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Email Report",
                        provider: "gmail",
                        operation: "sendEmail"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Renewal Check Complete",
                        outputName: "result",
                        value: "{{forecast}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "trigger-1", target: "integration-hubspot" },
                { id: "e2", source: "integration-hubspot", target: "integration-stripe-sub" },
                { id: "e3", source: "integration-hubspot", target: "integration-mixpanel" },
                { id: "e4", source: "integration-hubspot", target: "integration-hubspot-health" },
                { id: "e5", source: "integration-stripe-sub", target: "llm-assess" },
                { id: "e6", source: "integration-mixpanel", target: "llm-assess" },
                { id: "e7", source: "integration-hubspot-health", target: "llm-assess" },
                { id: "e8", source: "llm-assess", target: "llm-message" },
                { id: "e9", source: "llm-message", target: "router-strategy" },
                {
                    id: "e10",
                    source: "router-strategy",
                    target: "integration-gmail-auto",
                    sourceHandle: "auto"
                },
                {
                    id: "e11",
                    source: "router-strategy",
                    target: "integration-hubspot-opp",
                    sourceHandle: "sales"
                },
                {
                    id: "e12",
                    source: "router-strategy",
                    target: "integration-slack-escalate",
                    sourceHandle: "risk"
                },
                {
                    id: "e13",
                    source: "integration-hubspot-opp",
                    target: "integration-hubspot-task"
                },
                {
                    id: "e14",
                    source: "integration-hubspot-task",
                    target: "integration-gmail-outreach"
                },
                {
                    id: "e15",
                    source: "integration-slack-escalate",
                    target: "integration-gmail-outreach"
                },
                { id: "e16", source: "integration-gmail-auto", target: "integration-sheets" },
                { id: "e17", source: "integration-gmail-outreach", target: "integration-sheets" },
                { id: "e18", source: "integration-sheets", target: "llm-forecast" },
                { id: "e19", source: "llm-forecast", target: "integration-slack" },
                { id: "e20", source: "integration-slack", target: "integration-gmail-report" },
                { id: "e21", source: "integration-gmail-report", target: "output-1" }
            ]
        }
    },

    // ========================================================================
    // ADDITIONAL SALES TEMPLATES (2 templates to reach 10)
    // ========================================================================

    // Sales: Proposal Generator
    {
        name: "AI Proposal Generator",
        description:
            "Generate customized sales proposals using AI. Analyze deal context, company info, and requirements to create professional, tailored proposals with dynamic pricing.",
        category: "sales",
        tags: ["proposals", "ai-generation", "sales-automation", "documents"],
        required_integrations: ["salesforce", "google-docs", "gmail", "slack"],
        featured: true,
        definition: {
            name: "AI Proposal Generator",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Proposal Requested",
                        triggerType: "webhook",
                        webhookProvider: "salesforce",
                        description: "Triggered when proposal is requested for an opportunity"
                    }
                },
                {
                    id: "integration-salesforce",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get Opportunity Data",
                        provider: "salesforce",
                        operation: "getOpportunity"
                    }
                },
                {
                    id: "integration-salesforce-account",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get Account Info",
                        provider: "salesforce",
                        operation: "getAccount"
                    }
                },
                {
                    id: "llm-analyze",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Analyze Requirements",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Analyze the deal context and identify key requirements:\n\nOpportunity: {{opportunity}}\nAccount: {{account}}\n\nIdentify: pain points, desired outcomes, decision criteria, budget considerations.",
                        outputVariable: "analysis"
                    }
                },
                {
                    id: "llm-proposal",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Proposal",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Create a professional sales proposal:\n\n{{analysis.text}}\n\nInclude: executive summary, solution overview, implementation timeline, pricing options, ROI projections, next steps.",
                        outputVariable: "proposal"
                    }
                },
                {
                    id: "llm-pricing",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Calculate Pricing",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Generate pricing options based on:\n\nRequirements: {{analysis.text}}\nBudget signals: {{opportunity.budget}}\n\nCreate 3 tiers: Good, Better, Best with clear value differentiation.",
                        outputVariable: "pricing"
                    }
                },
                {
                    id: "integration-docs",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Create Proposal Doc",
                        provider: "google-docs",
                        operation: "createDocument"
                    }
                },
                {
                    id: "humanReview-1",
                    type: "humanReview",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Review Proposal",
                        reviewPrompt:
                            "Review generated proposal for accuracy and customize as needed",
                        outputVariable: "approvedProposal"
                    }
                },
                {
                    id: "integration-gmail",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Send Proposal",
                        provider: "gmail",
                        operation: "sendEmail"
                    }
                },
                {
                    id: "integration-salesforce-update",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Update Opportunity",
                        provider: "salesforce",
                        operation: "updateOpportunity"
                    }
                },
                {
                    id: "integration-slack",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Notify Sales Team",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#sales"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Proposal Sent",
                        outputName: "result",
                        value: "{{proposal}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "trigger-1", target: "integration-salesforce" },
                {
                    id: "e2",
                    source: "integration-salesforce",
                    target: "integration-salesforce-account"
                },
                { id: "e3", source: "integration-salesforce-account", target: "llm-analyze" },
                { id: "e4", source: "llm-analyze", target: "llm-proposal" },
                { id: "e5", source: "llm-analyze", target: "llm-pricing" },
                { id: "e6", source: "llm-proposal", target: "integration-docs" },
                { id: "e7", source: "llm-pricing", target: "integration-docs" },
                { id: "e8", source: "integration-docs", target: "humanReview-1" },
                { id: "e9", source: "humanReview-1", target: "integration-gmail" },
                { id: "e10", source: "integration-gmail", target: "integration-salesforce-update" },
                { id: "e11", source: "integration-salesforce-update", target: "integration-slack" },
                { id: "e12", source: "integration-slack", target: "output-1" }
            ]
        }
    },

    // Sales: Win/Loss Analysis (15 nodes - with parallel data, outcome routing, parallel outputs)
    {
        name: "Win/Loss Analysis Pipeline",
        description:
            "Analyze closed deals to identify patterns. Aggregate feedback, interview transcripts, and deal data to generate actionable insights for improving win rates.",
        category: "sales",
        tags: ["analytics", "win-loss", "insights", "sales-intelligence"],
        required_integrations: ["salesforce", "hubspot", "notion", "slack", "gmail"],
        featured: false,
        definition: {
            name: "Win/Loss Analysis Pipeline",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Deal Closed",
                        triggerType: "webhook",
                        webhookProvider: "salesforce",
                        description: "Triggered when opportunity is closed won or lost"
                    }
                },
                // Parallel data fetching
                {
                    id: "integration-salesforce",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get Deal Details",
                        provider: "salesforce",
                        operation: "getOpportunity"
                    }
                },
                {
                    id: "integration-hubspot",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get Engagement History",
                        provider: "hubspot",
                        operation: "listEmails"
                    }
                },
                {
                    id: "integration-hubspot-notes",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get Call Notes",
                        provider: "hubspot",
                        operation: "listNotes"
                    }
                },
                {
                    id: "transform-merge",
                    type: "transform",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Merge Deal Data",
                        transformType: "merge",
                        outputVariable: "dealContext"
                    }
                },
                {
                    id: "llm-analyze",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Analyze Deal Factors",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Analyze this closed deal:\n\n{{dealContext}}\n\nIdentify: outcome (won/lost), key factors, decision influences, competitive dynamics.",
                        outputVariable: "analysis"
                    }
                },
                {
                    id: "router-outcome",
                    type: "router",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Route by Outcome",
                        routerType: "llm",
                        routes: ["won", "lost", "no_decision"],
                        prompt: "Based on {{analysis.text}}, what was the deal outcome?"
                    }
                },
                // Won path - success factors
                {
                    id: "llm-won",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Win Factors",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Analyze winning factors:\n\n{{analysis.text}}\n\nIdentify: what worked, rep behaviors to replicate, messaging that resonated.",
                        outputVariable: "winFactors"
                    }
                },
                // Lost path - improvement opportunities
                {
                    id: "llm-lost",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Loss Analysis",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Analyze loss factors:\n\n{{analysis.text}}\n\nIdentify: what went wrong, objections not handled, competitive gaps, process improvements.",
                        outputVariable: "lossFactors"
                    }
                },
                // No decision path
                {
                    id: "llm-nodecision",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Stall Analysis",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Analyze stalled deal:\n\n{{analysis.text}}\n\nIdentify: why no decision, stakeholder gaps, timing issues, re-engagement opportunities.",
                        outputVariable: "stallFactors"
                    }
                },
                {
                    id: "transform-compile",
                    type: "transform",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Compile Insights",
                        transformType: "merge",
                        outputVariable: "insights"
                    }
                },
                // Parallel outputs
                {
                    id: "integration-notion",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Save Analysis",
                        provider: "notion",
                        operation: "createPage",
                        database: "Win/Loss Analysis"
                    }
                },
                {
                    id: "integration-slack",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Share Insights",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#sales-insights"
                    }
                },
                {
                    id: "integration-gmail",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Email Rep",
                        provider: "gmail",
                        operation: "sendMessage"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Analysis Complete",
                        outputName: "result",
                        value: "{{insights}}"
                    }
                }
            ],
            edges: [
                // Parallel data fetching
                { id: "e1", source: "trigger-1", target: "integration-salesforce" },
                { id: "e2", source: "trigger-1", target: "integration-hubspot" },
                { id: "e3", source: "trigger-1", target: "integration-hubspot-notes" },
                // Fan-in to merge
                { id: "e4", source: "integration-salesforce", target: "transform-merge" },
                { id: "e5", source: "integration-hubspot", target: "transform-merge" },
                { id: "e6", source: "integration-hubspot-notes", target: "transform-merge" },
                // Analysis and routing
                { id: "e7", source: "transform-merge", target: "llm-analyze" },
                { id: "e8", source: "llm-analyze", target: "router-outcome" },
                // Fan-out by outcome
                { id: "e9", source: "router-outcome", target: "llm-won", sourceHandle: "won" },
                { id: "e10", source: "router-outcome", target: "llm-lost", sourceHandle: "lost" },
                {
                    id: "e11",
                    source: "router-outcome",
                    target: "llm-nodecision",
                    sourceHandle: "no_decision"
                },
                // Fan-in to compile
                { id: "e12", source: "llm-won", target: "transform-compile" },
                { id: "e13", source: "llm-lost", target: "transform-compile" },
                { id: "e14", source: "llm-nodecision", target: "transform-compile" },
                // Parallel outputs
                { id: "e15", source: "transform-compile", target: "integration-notion" },
                { id: "e16", source: "transform-compile", target: "integration-slack" },
                { id: "e17", source: "transform-compile", target: "integration-gmail" },
                // Fan-in to output
                { id: "e18", source: "integration-notion", target: "output-1" },
                { id: "e19", source: "integration-slack", target: "output-1" },
                { id: "e20", source: "integration-gmail", target: "output-1" }
            ]
        }
    },

    // ========================================================================
    // ADDITIONAL SUPPORT TEMPLATES (5 templates to reach 10)
    // ========================================================================

    // Support: Knowledge Base Auto-Updater
    {
        name: "Knowledge Base Auto-Updater",
        description:
            "Automatically update knowledge base articles based on resolved support tickets. Identify new solutions, update existing articles, and flag gaps in documentation.",
        category: "support",
        tags: ["knowledge-base", "documentation", "automation", "self-service"],
        required_integrations: ["zendesk", "notion", "slack"],
        featured: true,
        definition: {
            name: "Knowledge Base Auto-Updater",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Ticket Resolved",
                        triggerType: "webhook",
                        webhookProvider: "zendesk",
                        description: "Triggered when support ticket is resolved"
                    }
                },
                {
                    id: "integration-zendesk",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get Ticket Details",
                        provider: "zendesk",
                        operation: "getTicket"
                    }
                },
                {
                    id: "llm-extract",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Extract Solution",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Extract the solution from this resolved ticket:\n\n{{ticket}}\n\nIdentify: problem description, solution steps, root cause, keywords for searchability.",
                        outputVariable: "solution"
                    }
                },
                {
                    id: "integration-notion-search",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Search Existing Articles",
                        provider: "notion",
                        operation: "searchPages"
                    }
                },
                {
                    id: "llm-compare",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Compare to Existing",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Compare new solution to existing KB articles:\n\nNew: {{solution.text}}\nExisting: {{existingArticles}}\n\nDetermine: is this new content, update to existing, or duplicate?",
                        outputVariable: "comparison"
                    }
                },
                {
                    id: "router-action",
                    type: "router",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Determine Action",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Based on comparison:\n{{comparison.text}}\n\nWhat action is needed?",
                        routes: [
                            {
                                value: "new",
                                label: "Create New",
                                description: "Create new KB article"
                            },
                            {
                                value: "update",
                                label: "Update Existing",
                                description: "Update existing article"
                            },
                            { value: "skip", label: "Skip", description: "Already documented" }
                        ],
                        defaultRoute: "skip",
                        outputVariable: "actionRoute"
                    }
                },
                {
                    id: "llm-article",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Article",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Create a knowledge base article from:\n\n{{solution.text}}\n\nFormat: title, summary, step-by-step solution, related articles, keywords.",
                        outputVariable: "article"
                    }
                },
                {
                    id: "integration-notion-create",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Create KB Article",
                        provider: "notion",
                        operation: "createPage",
                        database: "Knowledge Base"
                    }
                },
                {
                    id: "integration-notion-update",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Update KB Article",
                        provider: "notion",
                        operation: "updatePage"
                    }
                },
                {
                    id: "integration-slack",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Notify Team",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#knowledge-base"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "KB Updated",
                        outputName: "result",
                        value: "{{article}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "trigger-1", target: "integration-zendesk" },
                { id: "e2", source: "integration-zendesk", target: "llm-extract" },
                { id: "e3", source: "llm-extract", target: "integration-notion-search" },
                { id: "e4", source: "integration-notion-search", target: "llm-compare" },
                { id: "e5", source: "llm-compare", target: "router-action" },
                { id: "e6", source: "router-action", target: "llm-article", sourceHandle: "new" },
                {
                    id: "e7",
                    source: "router-action",
                    target: "llm-article",
                    sourceHandle: "update"
                },
                { id: "e8", source: "router-action", target: "output-1", sourceHandle: "skip" },
                { id: "e9", source: "llm-article", target: "integration-notion-create" },
                { id: "e10", source: "integration-notion-create", target: "integration-slack" },
                { id: "e11", source: "integration-slack", target: "output-1" }
            ]
        }
    },

    // Support: Smart Escalation Manager
    {
        name: "Smart Escalation Manager",
        description:
            "Intelligent ticket escalation with context preservation. Analyze ticket history, customer sentiment, and urgency to route escalations with full context to the right team.",
        category: "support",
        tags: ["escalation", "routing", "context", "priority"],
        required_integrations: ["zendesk", "slack", "pagerduty"],
        featured: false,
        definition: {
            name: "Smart Escalation Manager",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Escalation Triggered",
                        triggerType: "webhook",
                        webhookProvider: "zendesk",
                        description: "Triggered when ticket is escalated"
                    }
                },
                {
                    id: "integration-zendesk",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get Full Ticket History",
                        provider: "zendesk",
                        operation: "getTicket"
                    }
                },
                {
                    id: "llm-analyze",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Analyze Escalation",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Analyze this escalation:\n\n{{ticket}}\n\nIdentify: root cause, customer sentiment, urgency level, technical complexity, business impact, previous resolution attempts.",
                        outputVariable: "analysis"
                    }
                },
                {
                    id: "llm-summary",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Context Summary",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Create an executive summary for the escalation team:\n\n{{analysis.text}}\n\nInclude: customer background, issue timeline, impact, what's been tried, recommended next steps.",
                        outputVariable: "summary"
                    }
                },
                {
                    id: "router-team",
                    type: "router",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Route to Team",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Based on analysis:\n{{analysis.text}}\n\nWhich team should handle this?",
                        routes: [
                            {
                                value: "engineering",
                                label: "Engineering",
                                description: "Technical issue"
                            },
                            {
                                value: "senior-support",
                                label: "Senior Support",
                                description: "Complex support issue"
                            },
                            {
                                value: "management",
                                label: "Management",
                                description: "Executive escalation"
                            }
                        ],
                        defaultRoute: "senior-support",
                        outputVariable: "teamRoute"
                    }
                },
                {
                    id: "integration-pagerduty",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Page On-Call",
                        provider: "pagerduty",
                        operation: "createIncident"
                    }
                },
                {
                    id: "integration-zendesk-update",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Update Ticket",
                        provider: "zendesk",
                        operation: "updateTicket"
                    }
                },
                {
                    id: "integration-slack",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Alert Team",
                        provider: "slack",
                        operation: "sendMessage"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Escalation Routed",
                        outputName: "result",
                        value: "{{summary}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "trigger-1", target: "integration-zendesk" },
                { id: "e2", source: "integration-zendesk", target: "llm-analyze" },
                { id: "e3", source: "llm-analyze", target: "llm-summary" },
                { id: "e4", source: "llm-summary", target: "router-team" },
                {
                    id: "e5",
                    source: "router-team",
                    target: "integration-pagerduty",
                    sourceHandle: "engineering"
                },
                {
                    id: "e6",
                    source: "router-team",
                    target: "integration-slack",
                    sourceHandle: "senior-support"
                },
                {
                    id: "e7",
                    source: "router-team",
                    target: "integration-slack",
                    sourceHandle: "management"
                },
                { id: "e8", source: "integration-pagerduty", target: "integration-zendesk-update" },
                { id: "e9", source: "integration-slack", target: "integration-zendesk-update" },
                { id: "e10", source: "integration-zendesk-update", target: "output-1" }
            ]
        }
    },

    // Support: Proactive Outreach
    {
        name: "Proactive Support Outreach",
        description:
            "Reach out to customers before they experience issues. Monitor usage patterns, detect anomalies, and trigger proactive support conversations.",
        category: "support",
        tags: ["proactive", "monitoring", "customer-success", "prevention"],
        required_integrations: ["mixpanel", "intercom", "slack"],
        featured: false,
        definition: {
            name: "Proactive Support Outreach",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Daily Check",
                        triggerType: "schedule",
                        schedule: "0 10 * * *",
                        description: "Runs daily at 10am"
                    }
                },
                {
                    id: "integration-mixpanel",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Fetch Usage Patterns",
                        provider: "mixpanel",
                        operation: "queryEvents"
                    }
                },
                {
                    id: "llm-analyze",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Detect Anomalies",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Analyze usage patterns for anomalies:\n\n{{usageData}}\n\nIdentify: sudden drop in usage, error patterns, feature abandonment, unusual behavior. List customers at risk.",
                        outputVariable: "anomalies"
                    }
                },
                {
                    id: "conditional-issues",
                    type: "conditional",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Issues Detected?",
                        condition: "anomalies.atRiskCustomers.length > 0",
                        outputVariable: "hasIssues"
                    }
                },
                {
                    id: "llm-message",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Outreach",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Create personalized outreach messages for at-risk customers:\n\n{{anomalies.text}}\n\nTone: helpful, not intrusive. Offer assistance without alarming them.",
                        outputVariable: "outreach"
                    }
                },
                {
                    id: "integration-intercom",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Send Messages",
                        provider: "intercom",
                        operation: "sendMessage"
                    }
                },
                {
                    id: "integration-slack",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Notify Team",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#customer-success"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Outreach Complete",
                        outputName: "result",
                        value: "{{outreach}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "trigger-1", target: "integration-mixpanel" },
                { id: "e2", source: "integration-mixpanel", target: "llm-analyze" },
                { id: "e3", source: "llm-analyze", target: "conditional-issues" },
                {
                    id: "e4",
                    source: "conditional-issues",
                    target: "llm-message",
                    sourceHandle: "true"
                },
                {
                    id: "e5",
                    source: "conditional-issues",
                    target: "output-1",
                    sourceHandle: "false"
                },
                { id: "e6", source: "llm-message", target: "integration-intercom" },
                { id: "e7", source: "integration-intercom", target: "integration-slack" },
                { id: "e8", source: "integration-slack", target: "output-1" }
            ]
        }
    },

    // Support: SLA Monitor & Alert
    {
        name: "SLA Monitor & Alert",
        description:
            "Real-time SLA monitoring with proactive alerts. Track response and resolution times, predict breaches before they happen, and escalate automatically.",
        category: "support",
        tags: ["sla", "monitoring", "alerts", "compliance"],
        required_integrations: ["zendesk", "slack", "pagerduty"],
        featured: false,
        definition: {
            name: "SLA Monitor & Alert",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Every 15 Minutes",
                        triggerType: "schedule",
                        schedule: "*/15 * * * *",
                        description: "Runs every 15 minutes"
                    }
                },
                {
                    id: "integration-zendesk",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get Open Tickets",
                        provider: "zendesk",
                        operation: "listTickets"
                    }
                },
                {
                    id: "llm-analyze",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Analyze SLA Status",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Analyze SLA status for tickets:\n\n{{tickets}}\n\nFor each ticket: time remaining, breach risk (high/medium/low), predicted breach time, recommended action.",
                        outputVariable: "slaStatus"
                    }
                },
                {
                    id: "router-risk",
                    type: "router",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Route by Risk",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Based on SLA analysis:\n{{slaStatus.text}}\n\nDetermine alert level needed.",
                        routes: [
                            {
                                value: "critical",
                                label: "Critical",
                                description: "Breach imminent"
                            },
                            { value: "warning", label: "Warning", description: "At risk" },
                            { value: "ok", label: "OK", description: "On track" }
                        ],
                        defaultRoute: "ok",
                        outputVariable: "riskRoute"
                    }
                },
                {
                    id: "integration-pagerduty",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Page Supervisor",
                        provider: "pagerduty",
                        operation: "createIncident"
                    }
                },
                {
                    id: "integration-slack-warning",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Send Warning",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#support-alerts"
                    }
                },
                {
                    id: "integration-sheets",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Log Metrics",
                        provider: "google-sheets",
                        operation: "appendValues"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Check Complete",
                        outputName: "result",
                        value: "{{slaStatus}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "trigger-1", target: "integration-zendesk" },
                { id: "e2", source: "integration-zendesk", target: "llm-analyze" },
                { id: "e3", source: "llm-analyze", target: "router-risk" },
                {
                    id: "e4",
                    source: "router-risk",
                    target: "integration-pagerduty",
                    sourceHandle: "critical"
                },
                {
                    id: "e5",
                    source: "router-risk",
                    target: "integration-slack-warning",
                    sourceHandle: "warning"
                },
                {
                    id: "e6",
                    source: "router-risk",
                    target: "integration-sheets",
                    sourceHandle: "ok"
                },
                { id: "e7", source: "integration-pagerduty", target: "integration-sheets" },
                { id: "e8", source: "integration-slack-warning", target: "integration-sheets" },
                { id: "e9", source: "integration-sheets", target: "output-1" }
            ]
        }
    },

    // Support: Bug Report Handler (15 nodes - with parallel data, priority routing, parallel actions)
    {
        name: "Bug Report Handler",
        description:
            "Intelligent bug report processing. Validate, deduplicate, prioritize, and route bug reports to engineering with full context and reproduction steps.",
        category: "support",
        tags: ["bugs", "triage", "engineering", "routing"],
        required_integrations: ["zendesk", "github", "slack", "gmail"],
        featured: false,
        definition: {
            name: "Bug Report Handler",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Bug Report Received",
                        triggerType: "webhook",
                        webhookProvider: "zendesk",
                        description: "Triggered when ticket is tagged as bug"
                    }
                },
                // Parallel data fetching
                {
                    id: "integration-zendesk",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get Report Details",
                        provider: "zendesk",
                        operation: "getTicket"
                    }
                },
                {
                    id: "integration-github-search",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Search Existing Issues",
                        provider: "github",
                        operation: "listIssues"
                    }
                },
                {
                    id: "integration-zendesk-history",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get User History",
                        provider: "zendesk",
                        operation: "listTickets"
                    }
                },
                {
                    id: "transform-merge",
                    type: "transform",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Merge Bug Context",
                        transformType: "merge",
                        outputVariable: "bugContext"
                    }
                },
                {
                    id: "llm-analyze",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Analyze Bug",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Analyze this bug report:\n\n{{bugContext}}\n\nValidate: is it a real bug? Check duplicates. Determine priority (P0-critical, P1-high, P2-medium, P3-low).",
                        outputVariable: "analysis"
                    }
                },
                {
                    id: "router-priority",
                    type: "router",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Route by Priority",
                        routerType: "llm",
                        routes: ["critical", "high", "normal"],
                        prompt: "Based on {{analysis.text}}, what is the bug priority level?"
                    }
                },
                // Critical path - immediate escalation
                {
                    id: "llm-critical",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Critical Bug Alert",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Create critical bug alert:\n\n{{analysis.text}}\n\nFormat for immediate engineering attention. Include: impact scope, affected users, potential workaround.",
                        outputVariable: "criticalAlert"
                    }
                },
                // High priority path
                {
                    id: "llm-high",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "High Priority Issue",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Create high priority issue:\n\n{{analysis.text}}\n\nFormat for sprint planning. Include: repro steps, expected vs actual, suggested fix.",
                        outputVariable: "highPriority"
                    }
                },
                // Normal priority path
                {
                    id: "llm-normal",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Standard Issue",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Create standard bug issue:\n\n{{analysis.text}}\n\nFormat for backlog. Include: clear description, repro steps, acceptance criteria.",
                        outputVariable: "normalIssue"
                    }
                },
                {
                    id: "transform-compile",
                    type: "transform",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Compile Issue",
                        transformType: "merge",
                        outputVariable: "issueContent"
                    }
                },
                // Parallel actions
                {
                    id: "integration-github-create",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Create GitHub Issue",
                        provider: "github",
                        operation: "createIssue"
                    }
                },
                {
                    id: "integration-zendesk-update",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Update Ticket",
                        provider: "zendesk",
                        operation: "updateTicket"
                    }
                },
                {
                    id: "integration-slack",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Notify Engineering",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#engineering-bugs"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Bug Routed",
                        outputName: "result",
                        value: "{{issueContent}}"
                    }
                }
            ],
            edges: [
                // Parallel data fetching
                { id: "e1", source: "trigger-1", target: "integration-zendesk" },
                { id: "e2", source: "trigger-1", target: "integration-github-search" },
                { id: "e3", source: "trigger-1", target: "integration-zendesk-history" },
                // Fan-in to merge
                { id: "e4", source: "integration-zendesk", target: "transform-merge" },
                { id: "e5", source: "integration-github-search", target: "transform-merge" },
                { id: "e6", source: "integration-zendesk-history", target: "transform-merge" },
                // Analysis and routing
                { id: "e7", source: "transform-merge", target: "llm-analyze" },
                { id: "e8", source: "llm-analyze", target: "router-priority" },
                // Fan-out by priority
                {
                    id: "e9",
                    source: "router-priority",
                    target: "llm-critical",
                    sourceHandle: "critical"
                },
                { id: "e10", source: "router-priority", target: "llm-high", sourceHandle: "high" },
                {
                    id: "e11",
                    source: "router-priority",
                    target: "llm-normal",
                    sourceHandle: "normal"
                },
                // Fan-in to compile
                { id: "e12", source: "llm-critical", target: "transform-compile" },
                { id: "e13", source: "llm-high", target: "transform-compile" },
                { id: "e14", source: "llm-normal", target: "transform-compile" },
                // Parallel actions
                { id: "e15", source: "transform-compile", target: "integration-github-create" },
                { id: "e16", source: "transform-compile", target: "integration-zendesk-update" },
                { id: "e17", source: "transform-compile", target: "integration-slack" },
                // Fan-in to output
                { id: "e18", source: "integration-github-create", target: "output-1" },
                { id: "e19", source: "integration-zendesk-update", target: "output-1" },
                { id: "e20", source: "integration-slack", target: "output-1" }
            ]
        }
    },

    // ========================================================================
    // ADDITIONAL E-COMMERCE TEMPLATES (3 templates to reach 10)
    // ========================================================================

    // E-commerce: Product Review Analyzer
    {
        name: "Product Review Analyzer",
        description:
            "Analyze product reviews at scale. Extract sentiment, identify common themes, flag quality issues, and generate actionable product improvement insights.",
        category: "ecommerce",
        tags: ["reviews", "sentiment", "analytics", "product-insights"],
        required_integrations: ["shopify", "airtable", "slack"],
        featured: true,
        definition: {
            name: "Product Review Analyzer",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Daily Analysis",
                        triggerType: "schedule",
                        schedule: "0 6 * * *",
                        description: "Runs daily at 6am"
                    }
                },
                {
                    id: "integration-shopify",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Fetch New Reviews",
                        provider: "shopify",
                        operation: "listProductReviews"
                    }
                },
                {
                    id: "llm-sentiment",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Analyze Sentiment",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Analyze sentiment for each review:\n\n{{reviews}}\n\nClassify: positive/neutral/negative. Identify specific praise and complaints.",
                        outputVariable: "sentiment"
                    }
                },
                {
                    id: "llm-themes",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Extract Themes",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Identify recurring themes:\n\n{{sentiment.text}}\n\nGroup by: quality issues, shipping problems, sizing feedback, feature requests, praise categories.",
                        outputVariable: "themes"
                    }
                },
                {
                    id: "llm-insights",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Insights",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Generate actionable insights:\n\n{{themes.text}}\n\nProvide: priority improvements, quick wins, response templates for common issues.",
                        outputVariable: "insights"
                    }
                },
                {
                    id: "conditional-urgent",
                    type: "conditional",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Urgent Issues?",
                        condition: "insights.urgentIssues.length > 0",
                        outputVariable: "hasUrgent"
                    }
                },
                {
                    id: "integration-airtable",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Save Analysis",
                        provider: "airtable",
                        operation: "createRecord",
                        table: "Review Analysis"
                    }
                },
                {
                    id: "integration-slack",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Share Insights",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#product"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Analysis Complete",
                        outputName: "result",
                        value: "{{insights}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "trigger-1", target: "integration-shopify" },
                { id: "e2", source: "integration-shopify", target: "llm-sentiment" },
                { id: "e3", source: "llm-sentiment", target: "llm-themes" },
                { id: "e4", source: "llm-themes", target: "llm-insights" },
                { id: "e5", source: "llm-insights", target: "conditional-urgent" },
                {
                    id: "e6",
                    source: "conditional-urgent",
                    target: "integration-slack",
                    sourceHandle: "true"
                },
                {
                    id: "e7",
                    source: "conditional-urgent",
                    target: "integration-airtable",
                    sourceHandle: "false"
                },
                { id: "e8", source: "integration-slack", target: "integration-airtable" },
                { id: "e9", source: "integration-airtable", target: "output-1" }
            ]
        }
    },

    // E-commerce: Dynamic Pricing Engine
    {
        name: "Dynamic Pricing Engine",
        description:
            "Intelligent pricing automation. Monitor competitor prices, analyze demand signals, and suggest optimal pricing adjustments to maximize revenue.",
        category: "ecommerce",
        tags: ["pricing", "dynamic", "competitive", "revenue-optimization"],
        required_integrations: ["shopify", "google-sheets", "slack"],
        featured: false,
        definition: {
            name: "Dynamic Pricing Engine",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Hourly Check",
                        triggerType: "schedule",
                        schedule: "0 * * * *",
                        description: "Runs every hour"
                    }
                },
                {
                    id: "integration-shopify-products",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get Product Data",
                        provider: "shopify",
                        operation: "listProducts"
                    }
                },
                {
                    id: "integration-sheets-competitors",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get Competitor Prices",
                        provider: "google-sheets",
                        operation: "getValues"
                    }
                },
                {
                    id: "integration-shopify-analytics",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get Sales Data",
                        provider: "shopify",
                        operation: "getAnalytics"
                    }
                },
                {
                    id: "llm-analyze",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Analyze Pricing",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Analyze pricing opportunities:\n\nProducts: {{products}}\nCompetitor Prices: {{competitorPrices}}\nSales Data: {{salesData}}\n\nIdentify: underpriced items, overpriced items, demand elasticity, competitive gaps.",
                        outputVariable: "analysis"
                    }
                },
                {
                    id: "llm-recommendations",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Recommendations",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Generate pricing recommendations:\n\n{{analysis.text}}\n\nFor each product: current price, recommended price, expected revenue impact, confidence level.",
                        outputVariable: "recommendations"
                    }
                },
                {
                    id: "humanReview-1",
                    type: "humanReview",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Review Changes",
                        reviewPrompt: "Review and approve pricing changes before applying",
                        outputVariable: "approvedChanges"
                    }
                },
                {
                    id: "integration-shopify-update",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Update Prices",
                        provider: "shopify",
                        operation: "updateProduct"
                    }
                },
                {
                    id: "integration-slack",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Notify Team",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#pricing"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Pricing Updated",
                        outputName: "result",
                        value: "{{recommendations}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "trigger-1", target: "integration-shopify-products" },
                { id: "e2", source: "trigger-1", target: "integration-sheets-competitors" },
                { id: "e3", source: "trigger-1", target: "integration-shopify-analytics" },
                { id: "e4", source: "integration-shopify-products", target: "llm-analyze" },
                { id: "e5", source: "integration-sheets-competitors", target: "llm-analyze" },
                { id: "e6", source: "integration-shopify-analytics", target: "llm-analyze" },
                { id: "e7", source: "llm-analyze", target: "llm-recommendations" },
                { id: "e8", source: "llm-recommendations", target: "humanReview-1" },
                { id: "e9", source: "humanReview-1", target: "integration-shopify-update" },
                { id: "e10", source: "integration-shopify-update", target: "integration-slack" },
                { id: "e11", source: "integration-slack", target: "output-1" }
            ]
        }
    },

    // E-commerce: Customer Segmentation (15 nodes - with parallel data, segment routing, parallel outputs)
    {
        name: "Customer Segmentation Engine",
        description:
            "Automatically segment customers based on behavior, purchase history, and engagement. Generate targeted marketing lists and personalized recommendations.",
        category: "ecommerce",
        tags: ["segmentation", "personalization", "marketing", "analytics"],
        required_integrations: ["shopify", "klaviyo", "airtable", "slack", "gmail"],
        featured: false,
        definition: {
            name: "Customer Segmentation Engine",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Weekly Segmentation",
                        triggerType: "schedule",
                        schedule: "0 3 * * 0",
                        description: "Runs weekly on Sunday"
                    }
                },
                // Parallel data fetching
                {
                    id: "integration-shopify-customers",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get Customer Data",
                        provider: "shopify",
                        operation: "listCustomers"
                    }
                },
                {
                    id: "integration-shopify-orders",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get Order History",
                        provider: "shopify",
                        operation: "listOrders"
                    }
                },
                {
                    id: "integration-klaviyo-engagement",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get Email Engagement",
                        provider: "klaviyo",
                        operation: "getListProfiles"
                    }
                },
                {
                    id: "transform-merge",
                    type: "transform",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Merge Customer Data",
                        transformType: "merge",
                        outputVariable: "customerData"
                    }
                },
                {
                    id: "llm-analyze",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Analyze Behavior",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Analyze customer behavior:\n\n{{customerData}}\n\nCalculate RFM scores, lifetime value, churn risk. Categorize: vip, at_risk, growth_potential.",
                        outputVariable: "analysis"
                    }
                },
                {
                    id: "router-segment",
                    type: "router",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Route by Segment",
                        routerType: "llm",
                        routes: ["vip", "at_risk", "growth_potential"],
                        prompt: "Based on {{analysis.text}}, what is the primary segment focus for campaigns?"
                    }
                },
                // VIP path
                {
                    id: "llm-vip",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "VIP Campaign",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Create VIP customer campaign:\n\n{{analysis.text}}\n\nFocus: exclusive offers, early access, loyalty rewards, personalized recommendations.",
                        outputVariable: "vipCampaign"
                    }
                },
                // At-risk path
                {
                    id: "llm-atrisk",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Win-Back Campaign",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Create win-back campaign:\n\n{{analysis.text}}\n\nFocus: re-engagement offers, we miss you messaging, special discounts, feedback requests.",
                        outputVariable: "winbackCampaign"
                    }
                },
                // Growth potential path
                {
                    id: "llm-growth",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Growth Campaign",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Create growth campaign:\n\n{{analysis.text}}\n\nFocus: upsell, cross-sell, category expansion, subscription offers.",
                        outputVariable: "growthCampaign"
                    }
                },
                {
                    id: "transform-compile",
                    type: "transform",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Compile Campaigns",
                        transformType: "merge",
                        outputVariable: "campaigns"
                    }
                },
                // Parallel outputs
                {
                    id: "integration-klaviyo",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Update Lists",
                        provider: "klaviyo",
                        operation: "addProfilesToList"
                    }
                },
                {
                    id: "integration-airtable",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Save Segments",
                        provider: "airtable",
                        operation: "batchUpdateRecords"
                    }
                },
                {
                    id: "integration-slack",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Share Insights",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#marketing"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Segmentation Complete",
                        outputName: "result",
                        value: "{{campaigns}}"
                    }
                }
            ],
            edges: [
                // Parallel data fetching
                { id: "e1", source: "trigger-1", target: "integration-shopify-customers" },
                { id: "e2", source: "trigger-1", target: "integration-shopify-orders" },
                { id: "e3", source: "trigger-1", target: "integration-klaviyo-engagement" },
                // Fan-in to merge
                { id: "e4", source: "integration-shopify-customers", target: "transform-merge" },
                { id: "e5", source: "integration-shopify-orders", target: "transform-merge" },
                { id: "e6", source: "integration-klaviyo-engagement", target: "transform-merge" },
                // Analysis and routing
                { id: "e7", source: "transform-merge", target: "llm-analyze" },
                { id: "e8", source: "llm-analyze", target: "router-segment" },
                // Fan-out by segment
                { id: "e9", source: "router-segment", target: "llm-vip", sourceHandle: "vip" },
                {
                    id: "e10",
                    source: "router-segment",
                    target: "llm-atrisk",
                    sourceHandle: "at_risk"
                },
                {
                    id: "e11",
                    source: "router-segment",
                    target: "llm-growth",
                    sourceHandle: "growth_potential"
                },
                // Fan-in to compile
                { id: "e12", source: "llm-vip", target: "transform-compile" },
                { id: "e13", source: "llm-atrisk", target: "transform-compile" },
                { id: "e14", source: "llm-growth", target: "transform-compile" },
                // Parallel outputs
                { id: "e15", source: "transform-compile", target: "integration-klaviyo" },
                { id: "e16", source: "transform-compile", target: "integration-airtable" },
                { id: "e17", source: "transform-compile", target: "integration-slack" },
                // Fan-in to output
                { id: "e18", source: "integration-klaviyo", target: "output-1" },
                { id: "e19", source: "integration-airtable", target: "output-1" },
                { id: "e20", source: "integration-slack", target: "output-1" }
            ]
        }
    },

    // ========================================================================
    // ADDITIONAL SAAS TEMPLATE (1 template to reach 10)
    // ========================================================================

    // SaaS: Churn Prediction Pipeline
    {
        name: "Churn Prediction Pipeline",
        description:
            "Predict customer churn before it happens. Analyze usage patterns, engagement signals, and account health to identify at-risk customers and trigger retention workflows.",
        category: "saas",
        tags: ["churn", "prediction", "retention", "customer-success"],
        required_integrations: ["mixpanel", "hubspot", "intercom", "slack"],
        featured: true,
        definition: {
            name: "Churn Prediction Pipeline",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Daily Prediction",
                        triggerType: "schedule",
                        schedule: "0 7 * * *",
                        description: "Runs daily at 7am"
                    }
                },
                {
                    id: "integration-mixpanel",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get Usage Data",
                        provider: "mixpanel",
                        operation: "queryEvents"
                    }
                },
                {
                    id: "integration-hubspot",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get Account Health",
                        provider: "hubspot",
                        operation: "listCompanies"
                    }
                },
                {
                    id: "integration-intercom",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get Support History",
                        provider: "intercom",
                        operation: "listConversations"
                    }
                },
                {
                    id: "llm-predict",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Predict Churn Risk",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Predict churn risk for each account:\n\nUsage: {{usageData}}\nHealth: {{accountHealth}}\nSupport: {{supportHistory}}\n\nScore 0-100 churn probability. Identify top risk factors.",
                        outputVariable: "predictions"
                    }
                },
                {
                    id: "router-risk",
                    type: "router",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Route by Risk",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Based on churn predictions:\n{{predictions.text}}\n\nDetermine intervention level.",
                        routes: [
                            {
                                value: "high",
                                label: "High Risk",
                                description: ">70% churn probability"
                            },
                            {
                                value: "medium",
                                label: "Medium Risk",
                                description: "40-70% probability"
                            },
                            { value: "low", label: "Low Risk", description: "<40% probability" }
                        ],
                        defaultRoute: "low",
                        outputVariable: "riskRoute"
                    }
                },
                {
                    id: "llm-intervention",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Plan Intervention",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Plan retention intervention:\n\n{{predictions.text}}\n\nSuggest: outreach strategy, offer to make, talking points, best contact method.",
                        outputVariable: "intervention"
                    }
                },
                {
                    id: "integration-hubspot-task",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Create CSM Task",
                        provider: "hubspot",
                        operation: "createTask"
                    }
                },
                {
                    id: "integration-slack",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Alert CS Team",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#customer-success"
                    }
                },
                {
                    id: "integration-sheets",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Log Predictions",
                        provider: "google-sheets",
                        operation: "appendValues"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Predictions Complete",
                        outputName: "result",
                        value: "{{predictions}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "trigger-1", target: "integration-mixpanel" },
                { id: "e2", source: "trigger-1", target: "integration-hubspot" },
                { id: "e3", source: "trigger-1", target: "integration-intercom" },
                { id: "e4", source: "integration-mixpanel", target: "llm-predict" },
                { id: "e5", source: "integration-hubspot", target: "llm-predict" },
                { id: "e6", source: "integration-intercom", target: "llm-predict" },
                { id: "e7", source: "llm-predict", target: "router-risk" },
                {
                    id: "e8",
                    source: "router-risk",
                    target: "llm-intervention",
                    sourceHandle: "high"
                },
                {
                    id: "e9",
                    source: "router-risk",
                    target: "integration-hubspot-task",
                    sourceHandle: "medium"
                },
                {
                    id: "e10",
                    source: "router-risk",
                    target: "integration-sheets",
                    sourceHandle: "low"
                },
                { id: "e11", source: "llm-intervention", target: "integration-slack" },
                { id: "e12", source: "integration-slack", target: "integration-hubspot-task" },
                { id: "e13", source: "integration-hubspot-task", target: "integration-sheets" },
                { id: "e14", source: "integration-sheets", target: "output-1" }
            ]
        }
    },

    // ========================================================================
    // ADDITIONAL HEALTHCARE TEMPLATES (7 templates to reach 10)
    // ========================================================================

    // Healthcare: Prescription Refill Workflow
    {
        name: "Prescription Refill Workflow",
        description:
            "Automate prescription refill requests. Validate eligibility, check for interactions, route to pharmacy or physician, and notify patients of status.",
        category: "healthcare",
        tags: ["prescriptions", "pharmacy", "automation", "patient-care"],
        required_integrations: ["gmail", "google-sheets", "slack"],
        featured: true,
        definition: {
            name: "Prescription Refill Workflow",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Refill Request",
                        triggerType: "webhook",
                        description: "Triggered when patient requests refill"
                    }
                },
                {
                    id: "llm-validate",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Validate Request",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Validate refill request:\n\n{{request}}\n\nCheck: prescription still valid, refills remaining, too early for refill, patient identity confirmed.",
                        outputVariable: "validation"
                    }
                },
                {
                    id: "router-status",
                    type: "router",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Route Request",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Based on validation:\n{{validation.text}}\n\nDetermine next step.",
                        routes: [
                            {
                                value: "approved",
                                label: "Auto-Approve",
                                description: "Eligible for automatic refill"
                            },
                            {
                                value: "review",
                                label: "Physician Review",
                                description: "Needs physician approval"
                            },
                            { value: "denied", label: "Denied", description: "Cannot be refilled" }
                        ],
                        defaultRoute: "review",
                        outputVariable: "statusRoute"
                    }
                },
                {
                    id: "humanReview-1",
                    type: "humanReview",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Physician Review",
                        reviewPrompt:
                            "Review prescription refill request for medical appropriateness",
                        outputVariable: "physicianApproval"
                    }
                },
                {
                    id: "integration-sheets",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Update Records",
                        provider: "google-sheets",
                        operation: "appendValues"
                    }
                },
                {
                    id: "integration-gmail",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Notify Patient",
                        provider: "gmail",
                        operation: "sendEmail"
                    }
                },
                {
                    id: "integration-slack",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Alert Pharmacy",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#pharmacy"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Request Processed",
                        outputName: "result",
                        value: "{{validation}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "trigger-1", target: "llm-validate" },
                { id: "e2", source: "llm-validate", target: "router-status" },
                {
                    id: "e3",
                    source: "router-status",
                    target: "integration-slack",
                    sourceHandle: "approved"
                },
                {
                    id: "e4",
                    source: "router-status",
                    target: "humanReview-1",
                    sourceHandle: "review"
                },
                {
                    id: "e5",
                    source: "router-status",
                    target: "integration-gmail",
                    sourceHandle: "denied"
                },
                { id: "e6", source: "humanReview-1", target: "integration-slack" },
                { id: "e7", source: "integration-slack", target: "integration-sheets" },
                { id: "e8", source: "integration-sheets", target: "integration-gmail" },
                { id: "e9", source: "integration-gmail", target: "output-1" }
            ]
        }
    },

    // Healthcare: Insurance Verification
    {
        name: "Insurance Verification Bot",
        description:
            "Verify patient insurance coverage before appointments. Check eligibility, coverage limits, and pre-authorization requirements automatically.",
        category: "healthcare",
        tags: ["insurance", "verification", "billing", "automation"],
        required_integrations: ["gmail", "google-sheets", "slack"],
        featured: false,
        definition: {
            name: "Insurance Verification Bot",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Appointment Scheduled",
                        triggerType: "webhook",
                        description: "Triggered 48 hours before appointment"
                    }
                },
                {
                    id: "llm-extract",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Extract Insurance Info",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Extract insurance information:\n\n{{appointment}}\n\nIdentify: insurance provider, policy number, group number, subscriber info.",
                        outputVariable: "insuranceInfo"
                    }
                },
                {
                    id: "llm-verify",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Verify Coverage",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Verify insurance coverage:\n\n{{insuranceInfo.text}}\n\nCheck: active status, procedure coverage, deductible status, co-pay amount, pre-auth required.",
                        outputVariable: "verification"
                    }
                },
                {
                    id: "conditional-preauth",
                    type: "conditional",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Pre-Auth Needed?",
                        condition: "verification.preAuthRequired === true",
                        outputVariable: "needsPreAuth"
                    }
                },
                {
                    id: "integration-sheets",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Log Verification",
                        provider: "google-sheets",
                        operation: "appendValues"
                    }
                },
                {
                    id: "integration-gmail",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Notify Billing",
                        provider: "gmail",
                        operation: "sendEmail"
                    }
                },
                {
                    id: "integration-slack",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Alert Pre-Auth Team",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#billing"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Verification Complete",
                        outputName: "result",
                        value: "{{verification}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "trigger-1", target: "llm-extract" },
                { id: "e2", source: "llm-extract", target: "llm-verify" },
                { id: "e3", source: "llm-verify", target: "conditional-preauth" },
                {
                    id: "e4",
                    source: "conditional-preauth",
                    target: "integration-slack",
                    sourceHandle: "true"
                },
                {
                    id: "e5",
                    source: "conditional-preauth",
                    target: "integration-sheets",
                    sourceHandle: "false"
                },
                { id: "e6", source: "integration-slack", target: "integration-sheets" },
                { id: "e7", source: "integration-sheets", target: "integration-gmail" },
                { id: "e8", source: "integration-gmail", target: "output-1" }
            ]
        }
    },

    // Healthcare: Care Coordination Hub (14 nodes - with parallel data, change type routing, parallel notifications)
    {
        name: "Care Coordination Hub",
        description:
            "Coordinate care across multiple providers. Sync treatment plans, share updates, and ensure all providers have current patient information.",
        category: "healthcare",
        tags: ["care-coordination", "multi-provider", "collaboration", "patient-care"],
        required_integrations: ["gmail", "google-docs", "slack", "google-sheets"],
        featured: false,
        definition: {
            name: "Care Coordination Hub",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Care Plan Updated",
                        triggerType: "webhook",
                        description: "Triggered when care plan is modified"
                    }
                },
                // Parallel data fetching
                {
                    id: "integration-docs-plan",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get Care Plan",
                        provider: "google-docs",
                        operation: "getDocument"
                    }
                },
                {
                    id: "integration-sheets-providers",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get Provider List",
                        provider: "google-sheets",
                        operation: "getValues"
                    }
                },
                {
                    id: "transform-merge",
                    type: "transform",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Merge Context",
                        transformType: "merge",
                        outputVariable: "careContext"
                    }
                },
                {
                    id: "llm-analyze",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Analyze Changes",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Analyze care plan changes:\n\n{{careContext}}\n\nIdentify: change type (medication, therapy, referral), urgency level, affected providers.",
                        outputVariable: "changeAnalysis"
                    }
                },
                {
                    id: "router-change",
                    type: "router",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Route by Change Type",
                        routerType: "llm",
                        routes: ["medication", "therapy", "referral"],
                        prompt: "Based on {{changeAnalysis.text}}, select the primary change type."
                    }
                },
                // Medication change path
                {
                    id: "llm-medication",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Medication Alert",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Create medication change notification:\n\n{{changeAnalysis.text}}\n\nInclude: drug interactions, dosage changes, pharmacy notification requirements.",
                        outputVariable: "medAlert"
                    }
                },
                // Therapy change path
                {
                    id: "llm-therapy",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Therapy Update",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Create therapy update notification:\n\n{{changeAnalysis.text}}\n\nInclude: new treatment protocols, session adjustments, goals update.",
                        outputVariable: "therapyUpdate"
                    }
                },
                // Referral path
                {
                    id: "llm-referral",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Referral Notice",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Create specialist referral notification:\n\n{{changeAnalysis.text}}\n\nInclude: referral reason, urgency, patient history summary.",
                        outputVariable: "referralNotice"
                    }
                },
                {
                    id: "transform-compile",
                    type: "transform",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Compile Notifications",
                        transformType: "merge",
                        outputVariable: "notifications"
                    }
                },
                // Parallel notifications
                {
                    id: "integration-docs-update",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Update Care Doc",
                        provider: "google-docs",
                        operation: "appendText"
                    }
                },
                {
                    id: "integration-gmail",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Notify Providers",
                        provider: "gmail",
                        operation: "sendMessage"
                    }
                },
                {
                    id: "integration-slack",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Alert Care Team",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#care-coordination"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Coordination Complete",
                        outputName: "result",
                        value: "{{notifications}}"
                    }
                }
            ],
            edges: [
                // Parallel data fetching
                { id: "e1", source: "trigger-1", target: "integration-docs-plan" },
                { id: "e2", source: "trigger-1", target: "integration-sheets-providers" },
                // Fan-in to merge
                { id: "e3", source: "integration-docs-plan", target: "transform-merge" },
                { id: "e4", source: "integration-sheets-providers", target: "transform-merge" },
                // Analysis and routing
                { id: "e5", source: "transform-merge", target: "llm-analyze" },
                { id: "e6", source: "llm-analyze", target: "router-change" },
                // Fan-out by change type
                {
                    id: "e7",
                    source: "router-change",
                    target: "llm-medication",
                    sourceHandle: "medication"
                },
                {
                    id: "e8",
                    source: "router-change",
                    target: "llm-therapy",
                    sourceHandle: "therapy"
                },
                {
                    id: "e9",
                    source: "router-change",
                    target: "llm-referral",
                    sourceHandle: "referral"
                },
                // Fan-in to compile
                { id: "e10", source: "llm-medication", target: "transform-compile" },
                { id: "e11", source: "llm-therapy", target: "transform-compile" },
                { id: "e12", source: "llm-referral", target: "transform-compile" },
                // Parallel notifications
                { id: "e13", source: "transform-compile", target: "integration-docs-update" },
                { id: "e14", source: "transform-compile", target: "integration-gmail" },
                { id: "e15", source: "transform-compile", target: "integration-slack" },
                // Fan-in to output
                { id: "e16", source: "integration-docs-update", target: "output-1" },
                { id: "e17", source: "integration-gmail", target: "output-1" },
                { id: "e18", source: "integration-slack", target: "output-1" }
            ]
        }
    },

    // Healthcare: Discharge Planning
    {
        name: "Discharge Planning Coordinator",
        description:
            "Coordinate patient discharge from hospital. Arrange follow-up care, medication instructions, home health services, and post-discharge monitoring.",
        category: "healthcare",
        tags: ["discharge", "planning", "transitions", "post-acute"],
        required_integrations: ["gmail", "google-docs", "slack"],
        featured: false,
        definition: {
            name: "Discharge Planning Coordinator",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Discharge Initiated",
                        triggerType: "webhook",
                        description: "Triggered when discharge is ordered"
                    }
                },
                {
                    id: "llm-assess",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Assess Discharge Needs",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Assess discharge needs:\n\n{{patient}}\n\nIdentify: required follow-ups, medication needs, home care requirements, equipment needs, transportation.",
                        outputVariable: "needs"
                    }
                },
                {
                    id: "llm-instructions",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Instructions",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Create discharge instructions:\n\n{{needs.text}}\n\nInclude: medication schedule, activity restrictions, warning signs, follow-up appointments.",
                        outputVariable: "instructions"
                    }
                },
                {
                    id: "integration-docs",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Create Discharge Doc",
                        provider: "google-docs",
                        operation: "createDocument"
                    }
                },
                {
                    id: "integration-gmail-patient",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Email Patient",
                        provider: "gmail",
                        operation: "sendEmail"
                    }
                },
                {
                    id: "integration-gmail-pcp",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Notify PCP",
                        provider: "gmail",
                        operation: "sendEmail"
                    }
                },
                {
                    id: "integration-slack",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Alert Care Team",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#discharges"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Discharge Planned",
                        outputName: "result",
                        value: "{{instructions}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "trigger-1", target: "llm-assess" },
                { id: "e2", source: "llm-assess", target: "llm-instructions" },
                { id: "e3", source: "llm-instructions", target: "integration-docs" },
                { id: "e4", source: "integration-docs", target: "integration-gmail-patient" },
                { id: "e5", source: "integration-docs", target: "integration-gmail-pcp" },
                { id: "e6", source: "integration-gmail-patient", target: "integration-slack" },
                { id: "e7", source: "integration-gmail-pcp", target: "integration-slack" },
                { id: "e8", source: "integration-slack", target: "output-1" }
            ]
        }
    },

    // Healthcare: Follow-up Scheduler (12 nodes - with parallel data fetching, urgency routing, parallel notifications)
    {
        name: "Patient Follow-up Scheduler",
        description:
            "Automatically schedule and manage patient follow-up appointments. Track compliance, send reminders, and reschedule missed appointments.",
        category: "healthcare",
        tags: ["scheduling", "follow-up", "reminders", "compliance"],
        required_integrations: ["google-calendar", "gmail", "slack", "google-sheets"],
        featured: false,
        definition: {
            name: "Patient Follow-up Scheduler",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Follow-up Needed",
                        triggerType: "webhook",
                        description: "Triggered when follow-up is required"
                    }
                },
                // Parallel data fetching
                {
                    id: "integration-calendar",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get Provider Availability",
                        provider: "google-calendar",
                        operation: "getFreeBusy"
                    }
                },
                {
                    id: "integration-sheets",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get Patient History",
                        provider: "google-sheets",
                        operation: "getValues"
                    }
                },
                {
                    id: "transform-merge",
                    type: "transform",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Merge Data",
                        transformType: "merge",
                        outputVariable: "patientContext"
                    }
                },
                {
                    id: "llm-analyze",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Analyze Urgency",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Analyze follow-up urgency:\n\n{{patientContext}}\n\nConsider: condition type, treatment phase, missed appointments, compliance history. Return urgency: urgent, routine, or flexible.",
                        outputVariable: "urgencyAnalysis"
                    }
                },
                {
                    id: "router-urgency",
                    type: "router",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Route by Urgency",
                        routerType: "llm",
                        routes: ["urgent", "routine", "flexible"],
                        prompt: "Based on analysis: {{urgencyAnalysis.text}}, select the appropriate urgency level."
                    }
                },
                // Urgent path - immediate scheduling
                {
                    id: "llm-urgent",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Priority Scheduling",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Create urgent appointment message:\n\n{{patientContext}}\n\nEmphasize importance, offer earliest available slots, include direct booking link.",
                        outputVariable: "urgentMessage"
                    }
                },
                // Routine path - standard scheduling
                {
                    id: "llm-routine",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Standard Scheduling",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Create routine follow-up message:\n\n{{patientContext}}\n\nOffer convenient time options, include self-scheduling link.",
                        outputVariable: "routineMessage"
                    }
                },
                // Flexible path - patient-driven
                {
                    id: "llm-flexible",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Flexible Scheduling",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Create flexible scheduling message:\n\n{{patientContext}}\n\nAllow patient to choose timing, provide scheduling portal access.",
                        outputVariable: "flexibleMessage"
                    }
                },
                {
                    id: "transform-compile",
                    type: "transform",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Compile Message",
                        transformType: "merge",
                        outputVariable: "finalMessage"
                    }
                },
                // Parallel notifications
                {
                    id: "integration-gmail",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Send to Patient",
                        provider: "gmail",
                        operation: "sendMessage"
                    }
                },
                {
                    id: "integration-slack",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Notify Staff",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#scheduling"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Follow-up Scheduled",
                        outputName: "result",
                        value: "{{finalMessage}}"
                    }
                }
            ],
            edges: [
                // Parallel data fetching from trigger
                { id: "e1", source: "trigger-1", target: "integration-calendar" },
                { id: "e2", source: "trigger-1", target: "integration-sheets" },
                // Fan-in to merge
                { id: "e3", source: "integration-calendar", target: "transform-merge" },
                { id: "e4", source: "integration-sheets", target: "transform-merge" },
                // Analysis and routing
                { id: "e5", source: "transform-merge", target: "llm-analyze" },
                { id: "e6", source: "llm-analyze", target: "router-urgency" },
                // Fan-out by urgency
                {
                    id: "e7",
                    source: "router-urgency",
                    target: "llm-urgent",
                    sourceHandle: "urgent"
                },
                {
                    id: "e8",
                    source: "router-urgency",
                    target: "llm-routine",
                    sourceHandle: "routine"
                },
                {
                    id: "e9",
                    source: "router-urgency",
                    target: "llm-flexible",
                    sourceHandle: "flexible"
                },
                // Fan-in to compile
                { id: "e10", source: "llm-urgent", target: "transform-compile" },
                { id: "e11", source: "llm-routine", target: "transform-compile" },
                { id: "e12", source: "llm-flexible", target: "transform-compile" },
                // Parallel notifications
                { id: "e13", source: "transform-compile", target: "integration-gmail" },
                { id: "e14", source: "transform-compile", target: "integration-slack" },
                // Fan-in to output
                { id: "e15", source: "integration-gmail", target: "output-1" },
                { id: "e16", source: "integration-slack", target: "output-1" }
            ]
        }
    },

    // Healthcare: Health Screening Reminder (14 nodes - with parallel data, screening type routing, parallel outreach)
    {
        name: "Health Screening Reminder",
        description:
            "Proactive preventive care reminders. Track patient age, history, and guidelines to send timely reminders for recommended health screenings.",
        category: "healthcare",
        tags: ["preventive", "screenings", "reminders", "wellness"],
        required_integrations: ["gmail", "google-sheets", "slack", "google-calendar"],
        featured: false,
        definition: {
            name: "Health Screening Reminder",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Monthly Check",
                        triggerType: "schedule",
                        schedule: "0 8 1 * *",
                        description: "Runs monthly on the 1st"
                    }
                },
                // Parallel data fetching
                {
                    id: "integration-sheets-patients",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get Patient Records",
                        provider: "google-sheets",
                        operation: "getValues"
                    }
                },
                {
                    id: "integration-sheets-history",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get Screening History",
                        provider: "google-sheets",
                        operation: "getValues"
                    }
                },
                {
                    id: "integration-calendar",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get Available Slots",
                        provider: "google-calendar",
                        operation: "getFreeBusy"
                    }
                },
                {
                    id: "transform-merge",
                    type: "transform",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Merge Patient Data",
                        transformType: "merge",
                        outputVariable: "patientData"
                    }
                },
                {
                    id: "llm-analyze",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Identify Due Screenings",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Identify patients due for screenings:\n\n{{patientData}}\n\nCheck against guidelines based on age, gender, risk factors. Categorize by screening type.",
                        outputVariable: "dueScreenings"
                    }
                },
                {
                    id: "router-type",
                    type: "router",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Route by Type",
                        routerType: "llm",
                        routes: ["cancer_screening", "cardiovascular", "general_wellness"],
                        prompt: "Based on screening analysis, categorize the primary screening type for this batch."
                    }
                },
                // Cancer screening path
                {
                    id: "llm-cancer",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Cancer Screening Message",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Create cancer screening reminder:\n\n{{dueScreenings.text}}\n\nInclude: mammogram, colonoscopy, skin check info. Emphasize early detection importance.",
                        outputVariable: "cancerMessage"
                    }
                },
                // Cardiovascular path
                {
                    id: "llm-cardio",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Heart Health Message",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Create cardiovascular screening reminder:\n\n{{dueScreenings.text}}\n\nInclude: cholesterol, blood pressure, diabetes screening. Focus on heart health.",
                        outputVariable: "cardioMessage"
                    }
                },
                // General wellness path
                {
                    id: "llm-wellness",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Wellness Check Message",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Create general wellness reminder:\n\n{{dueScreenings.text}}\n\nInclude: annual physical, vision, hearing. Friendly wellness focus.",
                        outputVariable: "wellnessMessage"
                    }
                },
                {
                    id: "transform-compile",
                    type: "transform",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Compile Messages",
                        transformType: "merge",
                        outputVariable: "allMessages"
                    }
                },
                // Parallel outreach
                {
                    id: "integration-gmail",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Send Patient Reminders",
                        provider: "gmail",
                        operation: "sendMessage"
                    }
                },
                {
                    id: "integration-sheets-log",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Log Outreach",
                        provider: "google-sheets",
                        operation: "appendValues"
                    }
                },
                {
                    id: "integration-slack",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Notify Care Team",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#preventive-care"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Reminders Sent",
                        outputName: "result",
                        value: "{{allMessages}}"
                    }
                }
            ],
            edges: [
                // Parallel data fetching
                { id: "e1", source: "trigger-1", target: "integration-sheets-patients" },
                { id: "e2", source: "trigger-1", target: "integration-sheets-history" },
                { id: "e3", source: "trigger-1", target: "integration-calendar" },
                // Fan-in to merge
                { id: "e4", source: "integration-sheets-patients", target: "transform-merge" },
                { id: "e5", source: "integration-sheets-history", target: "transform-merge" },
                { id: "e6", source: "integration-calendar", target: "transform-merge" },
                // Analysis and routing
                { id: "e7", source: "transform-merge", target: "llm-analyze" },
                { id: "e8", source: "llm-analyze", target: "router-type" },
                // Fan-out by screening type
                {
                    id: "e9",
                    source: "router-type",
                    target: "llm-cancer",
                    sourceHandle: "cancer_screening"
                },
                {
                    id: "e10",
                    source: "router-type",
                    target: "llm-cardio",
                    sourceHandle: "cardiovascular"
                },
                {
                    id: "e11",
                    source: "router-type",
                    target: "llm-wellness",
                    sourceHandle: "general_wellness"
                },
                // Fan-in to compile
                { id: "e12", source: "llm-cancer", target: "transform-compile" },
                { id: "e13", source: "llm-cardio", target: "transform-compile" },
                { id: "e14", source: "llm-wellness", target: "transform-compile" },
                // Parallel outreach
                { id: "e15", source: "transform-compile", target: "integration-gmail" },
                { id: "e16", source: "transform-compile", target: "integration-sheets-log" },
                { id: "e17", source: "transform-compile", target: "integration-slack" },
                // Fan-in to output
                { id: "e18", source: "integration-gmail", target: "output-1" },
                { id: "e19", source: "integration-sheets-log", target: "output-1" },
                { id: "e20", source: "integration-slack", target: "output-1" }
            ]
        }
    },

    // Healthcare: Clinical Trial Matching
    {
        name: "Clinical Trial Matcher",
        description:
            "Match patients to eligible clinical trials. Analyze patient criteria against trial requirements and notify research coordinators of potential matches.",
        category: "healthcare",
        tags: ["clinical-trials", "research", "matching", "recruitment"],
        required_integrations: ["gmail", "google-sheets", "slack"],
        featured: false,
        definition: {
            name: "Clinical Trial Matcher",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Weekly Matching",
                        triggerType: "schedule",
                        schedule: "0 9 * * 1",
                        description: "Runs weekly on Monday"
                    }
                },
                {
                    id: "integration-sheets-patients",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get Patient Pool",
                        provider: "google-sheets",
                        operation: "getValues"
                    }
                },
                {
                    id: "integration-sheets-trials",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get Active Trials",
                        provider: "google-sheets",
                        operation: "getValues"
                    }
                },
                {
                    id: "llm-match",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Match Patients to Trials",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Match patients to clinical trials:\n\nPatients: {{patients}}\nTrials: {{trials}}\n\nCheck inclusion/exclusion criteria. List matches with confidence score.",
                        outputVariable: "matches"
                    }
                },
                {
                    id: "llm-summary",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Summary",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Create matching summary:\n\n{{matches.text}}\n\nFormat: by trial, list potential patients with key qualifying criteria.",
                        outputVariable: "summary"
                    }
                },
                {
                    id: "integration-gmail",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Notify Coordinators",
                        provider: "gmail",
                        operation: "sendEmail"
                    }
                },
                {
                    id: "integration-slack",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Post to Research",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#clinical-research"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Matching Complete",
                        outputName: "result",
                        value: "{{summary}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "trigger-1", target: "integration-sheets-patients" },
                { id: "e2", source: "trigger-1", target: "integration-sheets-trials" },
                { id: "e3", source: "integration-sheets-patients", target: "llm-match" },
                { id: "e4", source: "integration-sheets-trials", target: "llm-match" },
                { id: "e5", source: "llm-match", target: "llm-summary" },
                { id: "e6", source: "llm-summary", target: "integration-gmail" },
                { id: "e7", source: "integration-gmail", target: "integration-slack" },
                { id: "e8", source: "integration-slack", target: "output-1" }
            ]
        }
    },

    // ========================================================================
    // MICROSOFT ECOSYSTEM (4 templates)
    // ========================================================================

    // Microsoft Ecosystem: Teams Meeting Intelligence Hub (Featured)
    {
        name: "Teams Meeting Intelligence Hub",
        description:
            "Automatically process Teams meeting transcripts with AI. Categorize by meeting type (strategy, standup, client, other), extract action items, save notes to SharePoint, and send follow-up emails via Outlook.",
        category: "operations",
        tags: ["microsoft", "teams", "meetings", "ai", "transcription", "automation"],
        required_integrations: [
            "microsoft-teams",
            "microsoft-outlook",
            "sharepoint",
            "notion",
            "slack"
        ],
        featured: true,
        definition: {
            name: "Teams Meeting Intelligence Hub",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Teams Meeting Ended",
                        triggerType: "webhook",
                        provider: "microsoft-teams",
                        event: "meeting.ended",
                        description: "Triggered when a Teams meeting ends"
                    }
                },
                {
                    id: "integration-teams-transcript",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get Transcript",
                        provider: "microsoft-teams",
                        operation: "getTranscript",
                        outputVariable: "transcript"
                    }
                },
                {
                    id: "llm-summarize",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Summary",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Analyze this meeting transcript and generate a comprehensive summary:\n\n{{transcript}}\n\nInclude: key discussion points, decisions made, action items with owners, and next steps.",
                        outputVariable: "summary"
                    }
                },
                {
                    id: "router-content",
                    type: "router",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Content Type Router",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Based on this meeting summary, classify the meeting type:\n\n{{summary.text}}\n\nCategories: strategy (planning, roadmap), standup (daily sync, blockers), client (external stakeholders), other (general)",
                        routes: [
                            {
                                value: "strategy",
                                label: "Strategy Meeting",
                                description: "Planning and roadmap discussions"
                            },
                            {
                                value: "standup",
                                label: "Standup",
                                description: "Daily sync and blockers"
                            },
                            {
                                value: "client",
                                label: "Client Meeting",
                                description: "External stakeholders"
                            },
                            { value: "other", label: "Other", description: "General meetings" }
                        ],
                        defaultRoute: "other",
                        outputVariable: "meetingType"
                    }
                },
                {
                    id: "llm-strategy",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Extract Decisions",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Extract strategic decisions and roadmap items from this strategy meeting:\n\n{{summary.text}}\n\nFormat as: Decision, Rationale, Owner, Timeline",
                        outputVariable: "strategyNotes"
                    }
                },
                {
                    id: "llm-standup",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Extract Blockers",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Extract blockers and updates from this standup:\n\n{{summary.text}}\n\nFormat as: Person, Yesterday, Today, Blockers",
                        outputVariable: "standupNotes"
                    }
                },
                {
                    id: "llm-client",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Extract CRM Updates",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Extract client-related updates from this meeting:\n\n{{summary.text}}\n\nFormat as: Client concerns, Commitments made, Follow-up required, Relationship notes",
                        outputVariable: "clientNotes"
                    }
                },
                {
                    id: "llm-general",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Basic Notes",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Create concise meeting notes from:\n\n{{summary.text}}\n\nFormat as: Attendees, Topics discussed, Key points, Action items",
                        outputVariable: "generalNotes"
                    }
                },
                {
                    id: "router-actions",
                    type: "router",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Has Actions?",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Does this summary contain action items that need follow-up?\n\n{{summary.text}}",
                        routes: [
                            {
                                value: "yes",
                                label: "Has Actions",
                                description: "Action items identified"
                            },
                            { value: "no", label: "No Actions", description: "No follow-up needed" }
                        ],
                        defaultRoute: "no",
                        outputVariable: "hasActions"
                    }
                },
                {
                    id: "sharepoint-save",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Save Notes",
                        provider: "sharepoint",
                        operation: "uploadFile"
                    }
                },
                {
                    id: "outlook-send",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Send Follow-up",
                        provider: "microsoft-outlook",
                        operation: "sendEmail"
                    }
                },
                {
                    id: "notion-tasks",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Create Tasks",
                        provider: "notion",
                        operation: "createPage",
                        database: "Action Items"
                    }
                },
                {
                    id: "sharepoint-archive",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Archive Notes",
                        provider: "sharepoint",
                        operation: "uploadFile"
                    }
                },
                {
                    id: "teams-post",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Post Summary",
                        provider: "microsoft-teams",
                        operation: "sendMessage",
                        channel: "#meeting-notes"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Meeting Processed",
                        outputName: "result",
                        value: "{{summary}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "trigger-1", target: "integration-teams-transcript" },
                { id: "e2", source: "integration-teams-transcript", target: "llm-summarize" },
                { id: "e3", source: "llm-summarize", target: "router-content" },
                {
                    id: "e4",
                    source: "router-content",
                    target: "llm-strategy",
                    sourceHandle: "strategy"
                },
                {
                    id: "e5",
                    source: "router-content",
                    target: "llm-standup",
                    sourceHandle: "standup"
                },
                {
                    id: "e6",
                    source: "router-content",
                    target: "llm-client",
                    sourceHandle: "client"
                },
                {
                    id: "e7",
                    source: "router-content",
                    target: "llm-general",
                    sourceHandle: "other"
                },
                { id: "e8", source: "llm-strategy", target: "router-actions" },
                { id: "e9", source: "llm-standup", target: "router-actions" },
                { id: "e10", source: "llm-client", target: "router-actions" },
                { id: "e11", source: "llm-general", target: "sharepoint-archive" },
                {
                    id: "e12",
                    source: "router-actions",
                    target: "sharepoint-save",
                    sourceHandle: "yes"
                },
                {
                    id: "e13",
                    source: "router-actions",
                    target: "outlook-send",
                    sourceHandle: "yes"
                },
                {
                    id: "e14",
                    source: "router-actions",
                    target: "notion-tasks",
                    sourceHandle: "yes"
                },
                {
                    id: "e15",
                    source: "router-actions",
                    target: "sharepoint-archive",
                    sourceHandle: "no"
                },
                { id: "e16", source: "sharepoint-save", target: "teams-post" },
                { id: "e17", source: "outlook-send", target: "teams-post" },
                { id: "e18", source: "notion-tasks", target: "teams-post" },
                { id: "e19", source: "sharepoint-archive", target: "teams-post" },
                { id: "e20", source: "teams-post", target: "output-1" }
            ]
        }
    },

    // Microsoft Ecosystem: Microsoft 365 Document Approval Hub
    {
        name: "Microsoft 365 Document Approval Hub",
        description:
            "Route SharePoint documents through AI classification and department-specific approval workflows. Contracts go to legal, policies to HR, technical docs to engineering, with automated Teams notifications.",
        category: "operations",
        tags: ["microsoft", "sharepoint", "approval", "documents", "workflow"],
        required_integrations: [
            "sharepoint",
            "microsoft-teams",
            "microsoft-outlook",
            "microsoft-onedrive"
        ],
        featured: false,
        definition: {
            name: "Microsoft 365 Document Approval Hub",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "SharePoint New File",
                        triggerType: "webhook",
                        provider: "sharepoint",
                        event: "file.created",
                        description: "Triggered when a new file is uploaded"
                    }
                },
                {
                    id: "integration-sharepoint-get",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get Metadata",
                        provider: "sharepoint",
                        operation: "getFile",
                        outputVariable: "fileMetadata"
                    }
                },
                {
                    id: "llm-classify",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Classify Document",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Analyze this document metadata and classify it:\n\nFilename: {{fileMetadata.name}}\nPath: {{fileMetadata.path}}\n\nClassify as: contract, policy, technical, general",
                        outputVariable: "classification"
                    }
                },
                {
                    id: "router-type",
                    type: "router",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Document Type",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Route this document based on classification:\n\n{{classification.text}}",
                        routes: [
                            {
                                value: "contract",
                                label: "Contract",
                                description: "Legal documents"
                            },
                            { value: "policy", label: "Policy", description: "HR policies" },
                            {
                                value: "technical",
                                label: "Technical",
                                description: "Engineering docs"
                            },
                            { value: "general", label: "General", description: "Other documents" }
                        ],
                        defaultRoute: "general",
                        outputVariable: "docType"
                    }
                },
                {
                    id: "teams-legal",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Notify Legal",
                        provider: "microsoft-teams",
                        operation: "sendMessage",
                        channel: "#legal"
                    }
                },
                {
                    id: "teams-hr",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Notify HR",
                        provider: "microsoft-teams",
                        operation: "sendMessage",
                        channel: "#hr"
                    }
                },
                {
                    id: "teams-eng",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Notify Engineering",
                        provider: "microsoft-teams",
                        operation: "sendMessage",
                        channel: "#engineering"
                    }
                },
                {
                    id: "teams-ops",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Notify Operations",
                        provider: "microsoft-teams",
                        operation: "sendMessage",
                        channel: "#operations"
                    }
                },
                {
                    id: "humanReview-1",
                    type: "humanReview",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Approve/Reject",
                        reviewPrompt: "Review document for approval",
                        outputVariable: "reviewDecision"
                    }
                },
                {
                    id: "router-decision",
                    type: "router",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Decision Router",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Route based on review decision:\n\n{{reviewDecision}}",
                        routes: [
                            {
                                value: "approve",
                                label: "Approved",
                                description: "Document approved"
                            },
                            { value: "reject", label: "Rejected", description: "Document rejected" }
                        ],
                        defaultRoute: "approve",
                        outputVariable: "finalDecision"
                    }
                },
                {
                    id: "onedrive-move",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Move to Approved",
                        provider: "microsoft-onedrive",
                        operation: "moveFile"
                    }
                },
                {
                    id: "outlook-notify",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Notify Author",
                        provider: "microsoft-outlook",
                        operation: "sendEmail"
                    }
                },
                {
                    id: "outlook-revisions",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Request Changes",
                        provider: "microsoft-outlook",
                        operation: "sendEmail"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Document Processed",
                        outputName: "result",
                        value: "{{finalDecision}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "trigger-1", target: "integration-sharepoint-get" },
                { id: "e2", source: "integration-sharepoint-get", target: "llm-classify" },
                { id: "e3", source: "llm-classify", target: "router-type" },
                {
                    id: "e4",
                    source: "router-type",
                    target: "teams-legal",
                    sourceHandle: "contract"
                },
                { id: "e5", source: "router-type", target: "teams-hr", sourceHandle: "policy" },
                { id: "e6", source: "router-type", target: "teams-eng", sourceHandle: "technical" },
                { id: "e7", source: "router-type", target: "teams-ops", sourceHandle: "general" },
                { id: "e8", source: "teams-legal", target: "humanReview-1" },
                { id: "e9", source: "teams-hr", target: "humanReview-1" },
                { id: "e10", source: "teams-eng", target: "humanReview-1" },
                { id: "e11", source: "teams-ops", target: "humanReview-1" },
                { id: "e12", source: "humanReview-1", target: "router-decision" },
                {
                    id: "e13",
                    source: "router-decision",
                    target: "onedrive-move",
                    sourceHandle: "approve"
                },
                {
                    id: "e14",
                    source: "router-decision",
                    target: "outlook-notify",
                    sourceHandle: "approve"
                },
                {
                    id: "e15",
                    source: "router-decision",
                    target: "outlook-revisions",
                    sourceHandle: "reject"
                },
                { id: "e16", source: "onedrive-move", target: "output-1" },
                { id: "e17", source: "outlook-notify", target: "output-1" },
                { id: "e18", source: "outlook-revisions", target: "output-1" }
            ]
        }
    },

    // Microsoft Ecosystem: Outlook Smart Inbox Manager
    {
        name: "Outlook Smart Inbox Manager",
        description:
            "AI-powered email triage for shared mailboxes. Categorize incoming emails by intent and urgency, route to appropriate Teams channels, draft responses, and log interactions to SharePoint.",
        category: "support",
        tags: ["microsoft", "outlook", "email", "triage", "ai", "automation"],
        required_integrations: ["microsoft-outlook", "microsoft-teams", "sharepoint", "hubspot"],
        featured: false,
        definition: {
            name: "Outlook Smart Inbox Manager",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "New Email",
                        triggerType: "webhook",
                        provider: "microsoft-outlook",
                        event: "mail.received",
                        description: "New email in shared mailbox"
                    }
                },
                {
                    id: "llm-analyze",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Analyze Email",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Analyze this email and determine:\n1. Category: support, sales, billing, inquiry, spam\n2. Urgency: urgent, normal\n3. Sentiment: positive, neutral, negative\n\nEmail: {{trigger.email}}",
                        outputVariable: "analysis"
                    }
                },
                {
                    id: "router-category",
                    type: "router",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Email Category",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Route this email based on analysis:\n\n{{analysis.text}}",
                        routes: [
                            { value: "support", label: "Support", description: "Support requests" },
                            { value: "sales", label: "Sales", description: "Sales inquiries" },
                            { value: "billing", label: "Billing", description: "Billing issues" },
                            {
                                value: "inquiry",
                                label: "Inquiry",
                                description: "General questions"
                            },
                            { value: "spam", label: "Spam", description: "Junk mail" }
                        ],
                        defaultRoute: "inquiry",
                        outputVariable: "category"
                    }
                },
                {
                    id: "router-urgency",
                    type: "router",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Support Urgency",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Is this support request urgent?\n\n{{analysis.text}}",
                        routes: [
                            {
                                value: "urgent",
                                label: "Urgent",
                                description: "Requires immediate attention"
                            },
                            { value: "normal", label: "Normal", description: "Standard priority" }
                        ],
                        defaultRoute: "normal",
                        outputVariable: "urgency"
                    }
                },
                {
                    id: "hubspot-lead",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Create Lead",
                        provider: "hubspot",
                        operation: "createContact"
                    }
                },
                {
                    id: "teams-finance",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Notify Finance",
                        provider: "microsoft-teams",
                        operation: "sendMessage",
                        channel: "#finance"
                    }
                },
                {
                    id: "teams-info",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "General Info",
                        provider: "microsoft-teams",
                        operation: "sendMessage",
                        channel: "#general"
                    }
                },
                {
                    id: "outlook-archive",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Archive Spam",
                        provider: "microsoft-outlook",
                        operation: "moveEmail"
                    }
                },
                {
                    id: "teams-urgent",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Urgent Support",
                        provider: "microsoft-teams",
                        operation: "sendMessage",
                        channel: "#support-urgent"
                    }
                },
                {
                    id: "teams-support",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Normal Support",
                        provider: "microsoft-teams",
                        operation: "sendMessage",
                        channel: "#support"
                    }
                },
                {
                    id: "llm-draft",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Draft Response",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Draft a professional response to this email:\n\n{{trigger.email}}\n\nAnalysis: {{analysis.text}}",
                        outputVariable: "draftResponse"
                    }
                },
                {
                    id: "humanReview-1",
                    type: "humanReview",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Review & Edit",
                        reviewPrompt: "Review and edit the draft response before sending",
                        outputVariable: "finalResponse"
                    }
                },
                {
                    id: "outlook-send",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Send Reply",
                        provider: "microsoft-outlook",
                        operation: "sendEmail"
                    }
                },
                {
                    id: "sharepoint-log",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Log Interaction",
                        provider: "sharepoint",
                        operation: "createListItem"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Email Processed",
                        outputName: "result",
                        value: "{{category}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "trigger-1", target: "llm-analyze" },
                { id: "e2", source: "llm-analyze", target: "router-category" },
                {
                    id: "e3",
                    source: "router-category",
                    target: "router-urgency",
                    sourceHandle: "support"
                },
                {
                    id: "e4",
                    source: "router-category",
                    target: "hubspot-lead",
                    sourceHandle: "sales"
                },
                {
                    id: "e5",
                    source: "router-category",
                    target: "teams-finance",
                    sourceHandle: "billing"
                },
                {
                    id: "e6",
                    source: "router-category",
                    target: "teams-info",
                    sourceHandle: "inquiry"
                },
                {
                    id: "e7",
                    source: "router-category",
                    target: "outlook-archive",
                    sourceHandle: "spam"
                },
                {
                    id: "e8",
                    source: "router-urgency",
                    target: "teams-urgent",
                    sourceHandle: "urgent"
                },
                {
                    id: "e9",
                    source: "router-urgency",
                    target: "teams-support",
                    sourceHandle: "normal"
                },
                { id: "e10", source: "teams-urgent", target: "llm-draft" },
                { id: "e11", source: "teams-support", target: "llm-draft" },
                { id: "e12", source: "llm-draft", target: "humanReview-1" },
                { id: "e13", source: "humanReview-1", target: "outlook-send" },
                { id: "e14", source: "outlook-send", target: "sharepoint-log" },
                { id: "e15", source: "hubspot-lead", target: "output-1" },
                { id: "e16", source: "teams-finance", target: "output-1" },
                { id: "e17", source: "teams-info", target: "output-1" },
                { id: "e18", source: "outlook-archive", target: "output-1" },
                { id: "e19", source: "sharepoint-log", target: "output-1" }
            ]
        }
    },

    // Microsoft Ecosystem: SharePoint Site Provisioning Orchestrator
    {
        name: "SharePoint Site Provisioning Orchestrator",
        description:
            "Automate SharePoint site creation with parallel folder setup, Teams channel linking, and personalized welcome guides. Includes notifications to site owners and team announcements.",
        category: "operations",
        tags: ["microsoft", "sharepoint", "provisioning", "automation", "teams"],
        required_integrations: [
            "sharepoint",
            "microsoft-onedrive",
            "microsoft-teams",
            "microsoft-outlook"
        ],
        featured: false,
        definition: {
            name: "SharePoint Site Provisioning Orchestrator",
            nodes: [
                {
                    id: "input-1",
                    type: "input",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Site Request",
                        inputName: "siteRequest",
                        inputVariable: "siteRequest",
                        inputType: "json",
                        description: '{"name": "", "type": "", "owner": "", "description": ""}'
                    }
                },
                {
                    id: "llm-plan",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Site Plan",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Generate a site structure plan for:\n\nName: {{siteRequest.name}}\nType: {{siteRequest.type}}\nOwner: {{siteRequest.owner}}\n\nInclude: folder structure, permissions, and recommended document libraries.",
                        outputVariable: "sitePlan"
                    }
                },
                {
                    id: "sharepoint-create",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Create Site",
                        provider: "sharepoint",
                        operation: "createSite"
                    }
                },
                {
                    id: "onedrive-folders",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Create Folders",
                        provider: "microsoft-onedrive",
                        operation: "createFolder"
                    }
                },
                {
                    id: "teams-channel",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Link Channel",
                        provider: "microsoft-teams",
                        operation: "createChannel"
                    }
                },
                {
                    id: "transform-compile",
                    type: "transform",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Compile Details",
                        transformType: "template",
                        template:
                            '{"siteUrl": "{{sharepoint.url}}", "folders": "{{onedrive.folders}}", "channel": "{{teams.channel}}"}',
                        outputVariable: "siteDetails"
                    }
                },
                {
                    id: "llm-welcome",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Welcome Guide",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Create a welcome guide for the new SharePoint site:\n\nSite: {{siteRequest.name}}\nDetails: {{siteDetails}}\n\nInclude: getting started steps, key features, and best practices.",
                        outputVariable: "welcomeGuide"
                    }
                },
                {
                    id: "outlook-owner",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Email Owner",
                        provider: "microsoft-outlook",
                        operation: "sendEmail"
                    }
                },
                {
                    id: "teams-announce",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Announce Site",
                        provider: "microsoft-teams",
                        operation: "sendMessage",
                        channel: "#announcements"
                    }
                },
                {
                    id: "sharepoint-doc",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Save Guide",
                        provider: "sharepoint",
                        operation: "uploadFile"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Site Provisioned",
                        outputName: "result",
                        value: "{{siteDetails}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "input-1", target: "llm-plan" },
                { id: "e2", source: "llm-plan", target: "sharepoint-create" },
                { id: "e3", source: "llm-plan", target: "onedrive-folders" },
                { id: "e4", source: "llm-plan", target: "teams-channel" },
                { id: "e5", source: "sharepoint-create", target: "transform-compile" },
                { id: "e6", source: "onedrive-folders", target: "transform-compile" },
                { id: "e7", source: "teams-channel", target: "transform-compile" },
                { id: "e8", source: "transform-compile", target: "llm-welcome" },
                { id: "e9", source: "llm-welcome", target: "outlook-owner" },
                { id: "e10", source: "llm-welcome", target: "teams-announce" },
                { id: "e11", source: "llm-welcome", target: "sharepoint-doc" },
                { id: "e12", source: "outlook-owner", target: "output-1" },
                { id: "e13", source: "teams-announce", target: "output-1" },
                { id: "e14", source: "sharepoint-doc", target: "output-1" }
            ]
        }
    },

    // ========================================================================
    // HR & PEOPLE OPS (4 templates)
    // ========================================================================

    // HR: BambooHR Employee Lifecycle Hub (Featured)
    {
        name: "BambooHR Employee Lifecycle Hub",
        description:
            "Comprehensive employee lifecycle automation. Detect status changes (new hire, promotion, termination) and trigger appropriate workflows with onboarding tasks, announcements, and offboarding checklists.",
        category: "hr",
        tags: ["hr", "bamboohr", "employee", "lifecycle", "onboarding", "offboarding"],
        required_integrations: ["bamboohr", "slack", "google-calendar", "gmail", "notion"],
        featured: true,
        definition: {
            name: "BambooHR Employee Lifecycle Hub",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Employee Status Change",
                        triggerType: "webhook",
                        provider: "bamboohr",
                        event: "employee.updated",
                        description: "Triggered when employee status changes"
                    }
                },
                {
                    id: "integration-bamboo-get",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get Employee Details",
                        provider: "bamboohr",
                        operation: "getEmployee",
                        outputVariable: "employee"
                    }
                },
                {
                    id: "llm-analyze",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Analyze Change Type",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Analyze this employee status change:\n\n{{employee}}\n\nDetermine: Is this a new_hire, promotion, or termination?",
                        outputVariable: "changeAnalysis"
                    }
                },
                {
                    id: "router-lifecycle",
                    type: "router",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Status Type",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Route based on employee lifecycle event:\n\n{{changeAnalysis.text}}",
                        routes: [
                            {
                                value: "new_hire",
                                label: "New Hire",
                                description: "Employee onboarding"
                            },
                            { value: "promotion", label: "Promotion", description: "Role change" },
                            {
                                value: "termination",
                                label: "Termination",
                                description: "Offboarding"
                            }
                        ],
                        defaultRoute: "new_hire",
                        outputVariable: "lifecycleType"
                    }
                },
                {
                    id: "llm-onboard",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Onboarding Plan",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Create an onboarding plan for:\n\n{{employee}}\n\nInclude: first week schedule, required training, team introductions, equipment setup.",
                        outputVariable: "onboardingPlan"
                    }
                },
                {
                    id: "llm-promo",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Transition Plan",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Create a promotion transition plan for:\n\n{{employee}}\n\nInclude: knowledge transfer, new responsibilities, announcement draft.",
                        outputVariable: "transitionPlan"
                    }
                },
                {
                    id: "llm-offboard",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Offboarding Plan",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Create an offboarding checklist for:\n\n{{employee}}\n\nInclude: knowledge transfer, access revocation, equipment return, exit interview.",
                        outputVariable: "offboardingPlan"
                    }
                },
                {
                    id: "slack-welcome",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Welcome Message",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#general"
                    }
                },
                {
                    id: "calendar-orient",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Schedule Orientation",
                        provider: "google-calendar",
                        operation: "createEvent"
                    }
                },
                {
                    id: "gmail-welcome",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Welcome Email",
                        provider: "gmail",
                        operation: "sendEmail"
                    }
                },
                {
                    id: "slack-announce",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Announce Promotion",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#announcements"
                    }
                },
                {
                    id: "gmail-congrats",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Congratulations Email",
                        provider: "gmail",
                        operation: "sendEmail"
                    }
                },
                {
                    id: "slack-it",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "IT Notification",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#it-ops"
                    }
                },
                {
                    id: "calendar-exit",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Exit Interview",
                        provider: "google-calendar",
                        operation: "createEvent"
                    }
                },
                {
                    id: "notion-checklist",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Offboarding Checklist",
                        provider: "notion",
                        operation: "createPage",
                        database: "Offboarding"
                    }
                },
                {
                    id: "notion-onboard-tasks",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Onboarding Tasks",
                        provider: "notion",
                        operation: "createPage",
                        database: "Onboarding"
                    }
                },
                {
                    id: "bamboo-update-promo",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Update Promotion Record",
                        provider: "bamboohr",
                        operation: "updateEmployee"
                    }
                },
                {
                    id: "bamboo-update-term",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Update Term Record",
                        provider: "bamboohr",
                        operation: "updateEmployee"
                    }
                },
                {
                    id: "integration-bamboo-final",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Update Status",
                        provider: "bamboohr",
                        operation: "updateEmployee"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Lifecycle Complete",
                        outputName: "result",
                        value: "{{lifecycleType}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "trigger-1", target: "integration-bamboo-get" },
                { id: "e2", source: "integration-bamboo-get", target: "llm-analyze" },
                { id: "e3", source: "llm-analyze", target: "router-lifecycle" },
                {
                    id: "e4",
                    source: "router-lifecycle",
                    target: "llm-onboard",
                    sourceHandle: "new_hire"
                },
                {
                    id: "e5",
                    source: "router-lifecycle",
                    target: "llm-promo",
                    sourceHandle: "promotion"
                },
                {
                    id: "e6",
                    source: "router-lifecycle",
                    target: "llm-offboard",
                    sourceHandle: "termination"
                },
                { id: "e7", source: "llm-onboard", target: "slack-welcome" },
                { id: "e8", source: "llm-onboard", target: "calendar-orient" },
                { id: "e9", source: "llm-onboard", target: "gmail-welcome" },
                { id: "e10", source: "llm-promo", target: "slack-announce" },
                { id: "e11", source: "llm-promo", target: "gmail-congrats" },
                { id: "e12", source: "llm-offboard", target: "slack-it" },
                { id: "e13", source: "llm-offboard", target: "calendar-exit" },
                { id: "e14", source: "llm-offboard", target: "notion-checklist" },
                { id: "e15", source: "slack-welcome", target: "notion-onboard-tasks" },
                { id: "e16", source: "calendar-orient", target: "notion-onboard-tasks" },
                { id: "e17", source: "gmail-welcome", target: "notion-onboard-tasks" },
                { id: "e18", source: "slack-announce", target: "bamboo-update-promo" },
                { id: "e19", source: "gmail-congrats", target: "bamboo-update-promo" },
                { id: "e20", source: "slack-it", target: "bamboo-update-term" },
                { id: "e21", source: "calendar-exit", target: "bamboo-update-term" },
                { id: "e22", source: "notion-checklist", target: "bamboo-update-term" },
                { id: "e23", source: "notion-onboard-tasks", target: "integration-bamboo-final" },
                { id: "e24", source: "bamboo-update-promo", target: "integration-bamboo-final" },
                { id: "e25", source: "bamboo-update-term", target: "integration-bamboo-final" },
                { id: "e26", source: "integration-bamboo-final", target: "output-1" }
            ]
        }
    },

    // HR: Workday Payroll Exception Command Center
    {
        name: "Workday Payroll Exception Command Center",
        description:
            "Daily payroll exception monitoring with severity-based routing. Critical issues page on-call, high severity alerts go to Slack, and all exceptions are logged with automated daily reports.",
        category: "hr",
        tags: ["hr", "workday", "payroll", "monitoring", "alerts", "automation"],
        required_integrations: ["workday", "slack", "gmail", "google-sheets", "pagerduty"],
        featured: false,
        definition: {
            name: "Workday Payroll Exception Command Center",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Daily Check",
                        triggerType: "schedule",
                        schedule: "0 6 * * *",
                        description: "Runs daily at 6 AM"
                    }
                },
                {
                    id: "integration-workday",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get Exceptions",
                        provider: "workday",
                        operation: "getPayrollExceptions",
                        outputVariable: "exceptions"
                    }
                },
                {
                    id: "router-hasExceptions",
                    type: "router",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Has Exceptions?",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Are there any payroll exceptions?\n\n{{exceptions}}",
                        routes: [
                            {
                                value: "yes",
                                label: "Has Exceptions",
                                description: "Exceptions found"
                            },
                            { value: "no", label: "All Clear", description: "No exceptions" }
                        ],
                        defaultRoute: "no",
                        outputVariable: "hasExceptions"
                    }
                },
                {
                    id: "slack-allclear",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "All Clear",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#payroll"
                    }
                },
                {
                    id: "llm-categorize",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Categorize & Prioritize",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Categorize these payroll exceptions by severity:\n\n{{exceptions}}\n\nCategories: critical (payment failures), high (missing data), warning (pending approvals), info (notifications)",
                        outputVariable: "categorized"
                    }
                },
                {
                    id: "router-severity",
                    type: "router",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "By Severity",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "What is the highest severity in these exceptions?\n\n{{categorized.text}}",
                        routes: [
                            {
                                value: "critical",
                                label: "Critical",
                                description: "Payment failures"
                            },
                            { value: "high", label: "High", description: "Missing data" },
                            {
                                value: "warning",
                                label: "Warning",
                                description: "Pending approvals"
                            },
                            { value: "info", label: "Info", description: "Notifications only" }
                        ],
                        defaultRoute: "info",
                        outputVariable: "severity"
                    }
                },
                {
                    id: "pagerduty",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Page On-Call",
                        provider: "pagerduty",
                        operation: "createIncident"
                    }
                },
                {
                    id: "slack-incident",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Critical Alert",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#payroll-urgent"
                    }
                },
                {
                    id: "slack-high",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "High Priority",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#payroll"
                    }
                },
                {
                    id: "slack-warn",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Warning",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#payroll"
                    }
                },
                {
                    id: "sheets-log",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Log Exceptions",
                        provider: "google-sheets",
                        operation: "appendRow"
                    }
                },
                {
                    id: "gmail-director",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Email HR Director",
                        provider: "gmail",
                        operation: "sendEmail"
                    }
                },
                {
                    id: "llm-report",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Daily Report",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Generate a daily payroll exception report:\n\n{{categorized.text}}\n\nInclude: summary stats, trends, recommended actions.",
                        outputVariable: "dailyReport"
                    }
                },
                {
                    id: "slack-summary",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Post Summary",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#payroll"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Check Complete",
                        outputName: "result",
                        value: "{{dailyReport}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "trigger-1", target: "integration-workday" },
                { id: "e2", source: "integration-workday", target: "router-hasExceptions" },
                {
                    id: "e3",
                    source: "router-hasExceptions",
                    target: "slack-allclear",
                    sourceHandle: "no"
                },
                {
                    id: "e4",
                    source: "router-hasExceptions",
                    target: "llm-categorize",
                    sourceHandle: "yes"
                },
                { id: "e5", source: "llm-categorize", target: "router-severity" },
                {
                    id: "e6",
                    source: "router-severity",
                    target: "pagerduty",
                    sourceHandle: "critical"
                },
                {
                    id: "e7",
                    source: "router-severity",
                    target: "slack-incident",
                    sourceHandle: "critical"
                },
                { id: "e8", source: "router-severity", target: "slack-high", sourceHandle: "high" },
                {
                    id: "e9",
                    source: "router-severity",
                    target: "slack-warn",
                    sourceHandle: "warning"
                },
                {
                    id: "e10",
                    source: "router-severity",
                    target: "sheets-log",
                    sourceHandle: "info"
                },
                { id: "e11", source: "pagerduty", target: "gmail-director" },
                { id: "e12", source: "slack-incident", target: "gmail-director" },
                { id: "e13", source: "slack-high", target: "sheets-log" },
                { id: "e14", source: "slack-warn", target: "sheets-log" },
                { id: "e15", source: "gmail-director", target: "sheets-log" },
                { id: "e16", source: "sheets-log", target: "llm-report" },
                { id: "e17", source: "llm-report", target: "slack-summary" },
                { id: "e18", source: "slack-allclear", target: "output-1" },
                { id: "e19", source: "slack-summary", target: "output-1" }
            ]
        }
    },

    // HR: Gusto PTO Request Orchestrator
    {
        name: "Gusto PTO Request Orchestrator",
        description:
            "Streamline PTO approvals with AI-powered coverage analysis. Notify managers, check team availability, route through approval workflow, and automatically update calendars upon approval.",
        category: "hr",
        tags: ["hr", "gusto", "pto", "time-off", "approval", "calendar"],
        required_integrations: ["gusto", "slack", "google-calendar", "gmail", "notion"],
        featured: false,
        definition: {
            name: "Gusto PTO Request Orchestrator",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "PTO Request Submitted",
                        triggerType: "webhook",
                        provider: "gusto",
                        event: "time_off.requested",
                        description: "Triggered when PTO is requested"
                    }
                },
                {
                    id: "integration-gusto-get",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get Request Details",
                        provider: "gusto",
                        operation: "getTimeOffRequest",
                        outputVariable: "ptoRequest"
                    }
                },
                {
                    id: "llm-coverage",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Analyze Coverage",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Analyze team coverage for this PTO request:\n\n{{ptoRequest}}\n\nCheck: overlapping requests, critical dates, minimum coverage requirements.",
                        outputVariable: "coverageAnalysis"
                    }
                },
                {
                    id: "slack-manager",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Notify Manager",
                        provider: "slack",
                        operation: "sendMessage"
                    }
                },
                {
                    id: "notion-log",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Log Request",
                        provider: "notion",
                        operation: "createPage",
                        database: "PTO Requests"
                    }
                },
                {
                    id: "humanReview-1",
                    type: "humanReview",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Manager Approval",
                        reviewPrompt: "Review PTO request with coverage analysis",
                        outputVariable: "managerDecision"
                    }
                },
                {
                    id: "router-decision",
                    type: "router",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Approved?",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Was this PTO request approved?\n\n{{managerDecision}}",
                        routes: [
                            {
                                value: "approved",
                                label: "Approved",
                                description: "Request approved"
                            },
                            { value: "denied", label: "Denied", description: "Request denied" }
                        ],
                        defaultRoute: "approved",
                        outputVariable: "decision"
                    }
                },
                {
                    id: "calendar-block",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Block Calendar",
                        provider: "google-calendar",
                        operation: "createEvent"
                    }
                },
                {
                    id: "gmail-confirm",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Confirmation Email",
                        provider: "gmail",
                        operation: "sendEmail"
                    }
                },
                {
                    id: "gmail-deny",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Denial Email",
                        provider: "gmail",
                        operation: "sendEmail"
                    }
                },
                {
                    id: "integration-gusto-approve",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Approve in Gusto",
                        provider: "gusto",
                        operation: "approveTimeOff"
                    }
                },
                {
                    id: "integration-gusto-update",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Update Status",
                        provider: "gusto",
                        operation: "updateTimeOff"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Request Processed",
                        outputName: "result",
                        value: "{{decision}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "trigger-1", target: "integration-gusto-get" },
                { id: "e2", source: "integration-gusto-get", target: "llm-coverage" },
                { id: "e3", source: "llm-coverage", target: "slack-manager" },
                { id: "e4", source: "llm-coverage", target: "notion-log" },
                { id: "e5", source: "slack-manager", target: "humanReview-1" },
                { id: "e6", source: "notion-log", target: "humanReview-1" },
                { id: "e7", source: "humanReview-1", target: "router-decision" },
                {
                    id: "e8",
                    source: "router-decision",
                    target: "calendar-block",
                    sourceHandle: "approved"
                },
                {
                    id: "e9",
                    source: "router-decision",
                    target: "gmail-confirm",
                    sourceHandle: "approved"
                },
                {
                    id: "e10",
                    source: "router-decision",
                    target: "gmail-deny",
                    sourceHandle: "denied"
                },
                { id: "e11", source: "calendar-block", target: "integration-gusto-approve" },
                { id: "e12", source: "gmail-confirm", target: "integration-gusto-approve" },
                { id: "e13", source: "gmail-deny", target: "integration-gusto-update" },
                { id: "e14", source: "integration-gusto-approve", target: "output-1" },
                { id: "e15", source: "integration-gusto-update", target: "output-1" }
            ]
        }
    },

    // HR: Quarterly Review Cycle Coordinator
    {
        name: "Quarterly Review Cycle Coordinator",
        description:
            "Automate performance review cycles. Create department review pages, notify managers, send reminders for incomplete reviews, and generate leadership summaries when the cycle completes.",
        category: "hr",
        tags: ["hr", "performance", "reviews", "quarterly", "automation", "bamboohr"],
        required_integrations: ["bamboohr", "slack", "gmail", "notion", "google-calendar"],
        featured: false,
        definition: {
            name: "Quarterly Review Cycle Coordinator",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Quarterly Trigger",
                        triggerType: "schedule",
                        schedule: "0 9 1 1,4,7,10 *",
                        description: "Runs quarterly on the 1st"
                    }
                },
                {
                    id: "integration-bamboo-employees",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get Active Employees",
                        provider: "bamboohr",
                        operation: "listEmployees",
                        outputVariable: "employees"
                    }
                },
                {
                    id: "llm-schedule",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Schedule",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Create a review schedule by department:\n\n{{employees}}\n\nGroup by: Engineering, Sales, Operations, Customer Success. Set deadlines 2 weeks out.",
                        outputVariable: "reviewSchedule"
                    }
                },
                {
                    id: "notion-eng",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Engineering Reviews",
                        provider: "notion",
                        operation: "createPage",
                        database: "Performance Reviews"
                    }
                },
                {
                    id: "notion-sales",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Sales Reviews",
                        provider: "notion",
                        operation: "createPage",
                        database: "Performance Reviews"
                    }
                },
                {
                    id: "notion-ops",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Ops Reviews",
                        provider: "notion",
                        operation: "createPage",
                        database: "Performance Reviews"
                    }
                },
                {
                    id: "notion-cs",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "CS Reviews",
                        provider: "notion",
                        operation: "createPage",
                        database: "Performance Reviews"
                    }
                },
                {
                    id: "gmail-eng",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Email Eng Managers",
                        provider: "gmail",
                        operation: "sendEmail"
                    }
                },
                {
                    id: "gmail-sales",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Email Sales Managers",
                        provider: "gmail",
                        operation: "sendEmail"
                    }
                },
                {
                    id: "gmail-ops",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Email Ops Managers",
                        provider: "gmail",
                        operation: "sendEmail"
                    }
                },
                {
                    id: "gmail-cs",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Email CS Managers",
                        provider: "gmail",
                        operation: "sendEmail"
                    }
                },
                {
                    id: "delay-1",
                    type: "wait",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Wait 2 Weeks",
                        delayType: "fixed",
                        duration: 1209600000,
                        description: "Wait for review completion"
                    }
                },
                {
                    id: "integration-bamboo-check",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Check Completion",
                        provider: "bamboohr",
                        operation: "getPerformanceReviews",
                        outputVariable: "reviewStatus"
                    }
                },
                {
                    id: "router-complete",
                    type: "router",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "All Complete?",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Are all reviews complete?\n\n{{reviewStatus}}",
                        routes: [
                            { value: "yes", label: "Complete", description: "All reviews done" },
                            {
                                value: "no",
                                label: "Incomplete",
                                description: "Some reviews pending"
                            }
                        ],
                        defaultRoute: "no",
                        outputVariable: "isComplete"
                    }
                },
                {
                    id: "slack-reminder",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Send Reminders",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#managers"
                    }
                },
                {
                    id: "llm-report",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Summary",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Generate a quarterly review cycle summary:\n\n{{reviewStatus}}\n\nInclude: completion rates by department, key themes, promotion recommendations.",
                        outputVariable: "cycleSummary"
                    }
                },
                {
                    id: "slack-leadership",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Leadership Summary",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#leadership"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Cycle Complete",
                        outputName: "result",
                        value: "{{cycleSummary}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "trigger-1", target: "integration-bamboo-employees" },
                { id: "e2", source: "integration-bamboo-employees", target: "llm-schedule" },
                { id: "e3", source: "llm-schedule", target: "notion-eng" },
                { id: "e4", source: "llm-schedule", target: "notion-sales" },
                { id: "e5", source: "llm-schedule", target: "notion-ops" },
                { id: "e6", source: "llm-schedule", target: "notion-cs" },
                { id: "e7", source: "notion-eng", target: "gmail-eng" },
                { id: "e8", source: "notion-sales", target: "gmail-sales" },
                { id: "e9", source: "notion-ops", target: "gmail-ops" },
                { id: "e10", source: "notion-cs", target: "gmail-cs" },
                { id: "e11", source: "gmail-eng", target: "delay-1" },
                { id: "e12", source: "gmail-sales", target: "delay-1" },
                { id: "e13", source: "gmail-ops", target: "delay-1" },
                { id: "e14", source: "gmail-cs", target: "delay-1" },
                { id: "e15", source: "delay-1", target: "integration-bamboo-check" },
                { id: "e16", source: "integration-bamboo-check", target: "router-complete" },
                {
                    id: "e17",
                    source: "router-complete",
                    target: "slack-reminder",
                    sourceHandle: "no"
                },
                { id: "e18", source: "router-complete", target: "llm-report", sourceHandle: "yes" },
                { id: "e19", source: "slack-reminder", target: "output-1" },
                { id: "e20", source: "llm-report", target: "slack-leadership" },
                { id: "e21", source: "slack-leadership", target: "output-1" }
            ]
        }
    },

    // ========================================================================
    // FORMS & SURVEYS (4 templates)
    // ========================================================================

    // Forms: Typeform Lead Intelligence Engine (Featured)
    {
        name: "Typeform Lead Intelligence Engine",
        description:
            "Transform Typeform submissions into qualified leads. Enrich data with Apollo, score leads with AI, route hot leads to sales immediately, and nurture others with automated sequences.",
        category: "sales",
        tags: ["typeform", "leads", "scoring", "apollo", "hubspot", "automation"],
        required_integrations: ["typeform", "hubspot", "slack", "gmail", "apollo"],
        featured: true,
        definition: {
            name: "Typeform Lead Intelligence Engine",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Typeform Submission",
                        triggerType: "webhook",
                        provider: "typeform",
                        event: "form.submitted",
                        description: "Triggered when form is submitted"
                    }
                },
                {
                    id: "integration-typeform",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get Responses",
                        provider: "typeform",
                        operation: "getResponse",
                        outputVariable: "formData"
                    }
                },
                {
                    id: "integration-apollo",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Enrich Lead",
                        provider: "apollo",
                        operation: "enrichPerson",
                        outputVariable: "enrichedData"
                    }
                },
                {
                    id: "llm-score",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Score Lead",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Score this lead 0-100 and analyze intent:\n\nForm Data: {{formData}}\nEnriched Data: {{enrichedData}}\n\nConsider: company size, role seniority, engagement signals, budget indicators.",
                        outputVariable: "leadScore"
                    }
                },
                {
                    id: "integration-hubspot-create",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Create Contact",
                        provider: "hubspot",
                        operation: "createContact"
                    }
                },
                {
                    id: "router-score",
                    type: "router",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Lead Score",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Route this lead based on score:\n\n{{leadScore.text}}\n\nCategories: hot (80+), warm (50-79), cold (20-49), nurture (<20)",
                        routes: [
                            { value: "hot", label: "Hot (80+)", description: "High intent leads" },
                            {
                                value: "warm",
                                label: "Warm (50-79)",
                                description: "Medium interest"
                            },
                            { value: "cold", label: "Cold (20-49)", description: "Low interest" },
                            {
                                value: "nurture",
                                label: "Nurture (<20)",
                                description: "Long-term nurture"
                            }
                        ],
                        defaultRoute: "warm",
                        outputVariable: "scoreCategory"
                    }
                },
                {
                    id: "slack-hot",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Alert Sales",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#sales-hot"
                    }
                },
                {
                    id: "gmail-vip",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "VIP Email",
                        provider: "gmail",
                        operation: "sendEmail"
                    }
                },
                {
                    id: "hubspot-seq",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Nurture Sequence",
                        provider: "hubspot",
                        operation: "enrollInSequence"
                    }
                },
                {
                    id: "hubspot-news",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Add to Newsletter",
                        provider: "hubspot",
                        operation: "addToList"
                    }
                },
                {
                    id: "hubspot-drip",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Long Nurture",
                        provider: "hubspot",
                        operation: "enrollInSequence"
                    }
                },
                {
                    id: "router-enterprise",
                    type: "router",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Company Size",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Is this an enterprise company (500+ employees)?\n\n{{enrichedData}}",
                        routes: [
                            {
                                value: "enterprise",
                                label: "Enterprise",
                                description: "500+ employees"
                            },
                            { value: "smb", label: "SMB", description: "Under 500 employees" }
                        ],
                        defaultRoute: "smb",
                        outputVariable: "companySize"
                    }
                },
                {
                    id: "slack-ae",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Notify AE Team",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#ae-team"
                    }
                },
                {
                    id: "slack-sdr",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Notify SDR Team",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#sdr-team"
                    }
                },
                {
                    id: "llm-personalize",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Personalize Thank You",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Create a personalized thank you message for:\n\n{{formData}}\n{{enrichedData}}\n\nMake it warm, relevant to their industry, and include next steps.",
                        outputVariable: "thankYouMessage"
                    }
                },
                {
                    id: "gmail-thankyou",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Send Thank You",
                        provider: "gmail",
                        operation: "sendEmail"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Lead Processed",
                        outputName: "result",
                        value: "{{scoreCategory}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "trigger-1", target: "integration-typeform" },
                { id: "e2", source: "integration-typeform", target: "integration-apollo" },
                { id: "e3", source: "integration-apollo", target: "llm-score" },
                { id: "e4", source: "llm-score", target: "integration-hubspot-create" },
                { id: "e5", source: "integration-hubspot-create", target: "router-score" },
                { id: "e6", source: "router-score", target: "slack-hot", sourceHandle: "hot" },
                { id: "e7", source: "router-score", target: "gmail-vip", sourceHandle: "hot" },
                { id: "e8", source: "router-score", target: "hubspot-seq", sourceHandle: "warm" },
                { id: "e9", source: "router-score", target: "hubspot-news", sourceHandle: "cold" },
                {
                    id: "e10",
                    source: "router-score",
                    target: "hubspot-drip",
                    sourceHandle: "nurture"
                },
                { id: "e11", source: "slack-hot", target: "router-enterprise" },
                { id: "e12", source: "gmail-vip", target: "router-enterprise" },
                {
                    id: "e13",
                    source: "router-enterprise",
                    target: "slack-ae",
                    sourceHandle: "enterprise"
                },
                {
                    id: "e14",
                    source: "router-enterprise",
                    target: "slack-sdr",
                    sourceHandle: "smb"
                },
                { id: "e15", source: "slack-ae", target: "llm-personalize" },
                { id: "e16", source: "slack-sdr", target: "llm-personalize" },
                { id: "e17", source: "hubspot-seq", target: "llm-personalize" },
                { id: "e18", source: "hubspot-news", target: "llm-personalize" },
                { id: "e19", source: "hubspot-drip", target: "llm-personalize" },
                { id: "e20", source: "llm-personalize", target: "gmail-thankyou" },
                { id: "e21", source: "gmail-thankyou", target: "output-1" }
            ]
        }
    },

    // Forms: SurveyMonkey NPS Command Center
    {
        name: "SurveyMonkey NPS Command Center",
        description:
            "Process NPS survey responses with sentiment analysis. Route promoters to referral programs, engage passives with improvement ideas, and trigger recovery workflows for detractors.",
        category: "support",
        tags: ["surveymonkey", "nps", "feedback", "sentiment", "customer-success"],
        required_integrations: [
            "surveymonkey",
            "slack",
            "google-sheets",
            "gmail",
            "hubspot",
            "linear"
        ],
        featured: false,
        definition: {
            name: "SurveyMonkey NPS Command Center",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Survey Response",
                        triggerType: "webhook",
                        provider: "surveymonkey",
                        event: "response.completed",
                        description: "Triggered when survey is completed"
                    }
                },
                {
                    id: "integration-survey",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get Response",
                        provider: "surveymonkey",
                        operation: "getResponse",
                        outputVariable: "surveyResponse"
                    }
                },
                {
                    id: "llm-analyze",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Analyze Sentiment",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Analyze this NPS survey response:\n\n{{surveyResponse}}\n\nExtract: NPS score, sentiment, key themes, specific feedback, improvement suggestions.",
                        outputVariable: "sentimentAnalysis"
                    }
                },
                {
                    id: "router-nps",
                    type: "router",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "NPS Category",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Categorize this NPS response:\n\n{{sentimentAnalysis.text}}\n\nCategories: promoter (9-10), passive (7-8), detractor (0-6)",
                        routes: [
                            {
                                value: "promoter",
                                label: "Promoter (9-10)",
                                description: "Highly satisfied"
                            },
                            {
                                value: "passive",
                                label: "Passive (7-8)",
                                description: "Satisfied but not enthusiastic"
                            },
                            {
                                value: "detractor",
                                label: "Detractor (0-6)",
                                description: "Unsatisfied"
                            }
                        ],
                        defaultRoute: "passive",
                        outputVariable: "npsCategory"
                    }
                },
                {
                    id: "gmail-ref",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Referral Request",
                        provider: "gmail",
                        operation: "sendEmail"
                    }
                },
                {
                    id: "hubspot-tag",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Tag Promoter",
                        provider: "hubspot",
                        operation: "updateContact"
                    }
                },
                {
                    id: "llm-improve",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Extract Ideas",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Extract actionable improvement ideas from this passive feedback:\n\n{{surveyResponse}}\n\nFormat as feature requests or improvement suggestions.",
                        outputVariable: "improvementIdeas"
                    }
                },
                {
                    id: "slack-prod",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Product Ideas",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#product"
                    }
                },
                {
                    id: "linear-feature",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Create Feature",
                        provider: "linear",
                        operation: "createIssue"
                    }
                },
                {
                    id: "slack-cs",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "CS Alert",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#cs-urgent"
                    }
                },
                {
                    id: "llm-recovery",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Recovery Strategy",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Create a recovery strategy for this detractor:\n\n{{surveyResponse}}\n{{sentimentAnalysis.text}}\n\nInclude: immediate actions, talking points, compensation options if appropriate.",
                        outputVariable: "recoveryStrategy"
                    }
                },
                {
                    id: "gmail-recover",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Recovery Email",
                        provider: "gmail",
                        operation: "sendEmail"
                    }
                },
                {
                    id: "hubspot-task",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "CS Follow-up",
                        provider: "hubspot",
                        operation: "createTask"
                    }
                },
                {
                    id: "sheets-log",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Log Response",
                        provider: "google-sheets",
                        operation: "appendRow"
                    }
                },
                {
                    id: "transform-weekly",
                    type: "transform",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Aggregate Weekly",
                        transformType: "template",
                        template:
                            '{"npsScore": "{{npsCategory}}", "sentiment": "{{sentimentAnalysis}}"}',
                        outputVariable: "weeklyData"
                    }
                },
                {
                    id: "llm-report",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Weekly Report",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Generate a weekly NPS insights report:\n\n{{weeklyData}}\n\nInclude: NPS trend, common themes, top concerns, recommended actions.",
                        outputVariable: "weeklyReport"
                    }
                },
                {
                    id: "slack-leadership",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Leadership Report",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#leadership"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Response Processed",
                        outputName: "result",
                        value: "{{npsCategory}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "trigger-1", target: "integration-survey" },
                { id: "e2", source: "integration-survey", target: "llm-analyze" },
                { id: "e3", source: "llm-analyze", target: "router-nps" },
                { id: "e4", source: "router-nps", target: "gmail-ref", sourceHandle: "promoter" },
                { id: "e5", source: "router-nps", target: "hubspot-tag", sourceHandle: "promoter" },
                { id: "e6", source: "router-nps", target: "llm-improve", sourceHandle: "passive" },
                { id: "e7", source: "router-nps", target: "slack-prod", sourceHandle: "passive" },
                { id: "e8", source: "router-nps", target: "slack-cs", sourceHandle: "detractor" },
                {
                    id: "e9",
                    source: "router-nps",
                    target: "llm-recovery",
                    sourceHandle: "detractor"
                },
                { id: "e10", source: "llm-improve", target: "linear-feature" },
                { id: "e11", source: "llm-recovery", target: "gmail-recover" },
                { id: "e12", source: "llm-recovery", target: "hubspot-task" },
                { id: "e13", source: "gmail-ref", target: "sheets-log" },
                { id: "e14", source: "hubspot-tag", target: "sheets-log" },
                { id: "e15", source: "slack-prod", target: "sheets-log" },
                { id: "e16", source: "linear-feature", target: "sheets-log" },
                { id: "e17", source: "slack-cs", target: "sheets-log" },
                { id: "e18", source: "gmail-recover", target: "sheets-log" },
                { id: "e19", source: "hubspot-task", target: "sheets-log" },
                { id: "e20", source: "sheets-log", target: "transform-weekly" },
                { id: "e21", source: "transform-weekly", target: "llm-report" },
                { id: "e22", source: "llm-report", target: "slack-leadership" },
                { id: "e23", source: "slack-leadership", target: "output-1" }
            ]
        }
    },

    // Forms: Google Forms Event Registration Hub
    {
        name: "Google Forms Event Registration Hub",
        description:
            "Automate event registration with capacity management. Send personalized confirmations, add attendees to calendar and Zoom, manage waitlists, and alert organizers when capacity is near.",
        category: "operations",
        tags: ["google-forms", "events", "registration", "calendar", "zoom", "automation"],
        required_integrations: [
            "google-forms",
            "google-calendar",
            "gmail",
            "slack",
            "google-sheets",
            "zoom"
        ],
        featured: false,
        definition: {
            name: "Google Forms Event Registration Hub",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Form Submission",
                        triggerType: "webhook",
                        provider: "google-forms",
                        event: "form.submitted",
                        description: "Triggered when registration form is submitted"
                    }
                },
                {
                    id: "integration-forms",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get Registration",
                        provider: "google-forms",
                        operation: "getResponse",
                        outputVariable: "registration"
                    }
                },
                {
                    id: "sheets-attendees",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Add to List",
                        provider: "google-sheets",
                        operation: "appendRow"
                    }
                },
                {
                    id: "llm-personalize",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Personalize Confirmation",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Create a personalized event confirmation for:\n\n{{registration}}\n\nInclude: warm welcome, event details, what to bring, how to prepare.",
                        outputVariable: "confirmationMessage"
                    }
                },
                {
                    id: "calendar-invite",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Send Invite",
                        provider: "google-calendar",
                        operation: "createEvent"
                    }
                },
                {
                    id: "gmail-confirm",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Confirmation Email",
                        provider: "gmail",
                        operation: "sendEmail"
                    }
                },
                {
                    id: "zoom-add",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Add to Zoom",
                        provider: "zoom",
                        operation: "addRegistrant"
                    }
                },
                {
                    id: "transform-capacity",
                    type: "transform",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Check Capacity",
                        transformType: "template",
                        template:
                            '{"currentCount": {{sheets.rowCount}}, "maxCapacity": 100, "percentFull": {{sheets.rowCount / 100 * 100}}}',
                        outputVariable: "capacityStatus"
                    }
                },
                {
                    id: "router-capacity",
                    type: "router",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Capacity Status",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Determine capacity status:\n\n{{capacityStatus}}\n\nCategories: available (<80%), near_full (80-99%), waitlist (100%)",
                        routes: [
                            {
                                value: "available",
                                label: "Available",
                                description: "Spots available"
                            },
                            {
                                value: "near_full",
                                label: "Near Full",
                                description: "80-99% capacity"
                            },
                            { value: "waitlist", label: "Waitlist", description: "At capacity" }
                        ],
                        defaultRoute: "available",
                        outputVariable: "capacityCategory"
                    }
                },
                {
                    id: "slack-organizer",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Alert Organizer",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#events"
                    }
                },
                {
                    id: "sheets-status",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Update Status",
                        provider: "google-sheets",
                        operation: "updateCell"
                    }
                },
                {
                    id: "gmail-waitlist",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Waitlist Email",
                        provider: "gmail",
                        operation: "sendEmail"
                    }
                },
                {
                    id: "sheets-waitlist",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Add to Waitlist",
                        provider: "google-sheets",
                        operation: "appendRow"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Registration Complete",
                        outputName: "result",
                        value: "{{capacityCategory}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "trigger-1", target: "integration-forms" },
                { id: "e2", source: "integration-forms", target: "sheets-attendees" },
                { id: "e3", source: "sheets-attendees", target: "llm-personalize" },
                { id: "e4", source: "llm-personalize", target: "calendar-invite" },
                { id: "e5", source: "llm-personalize", target: "gmail-confirm" },
                { id: "e6", source: "llm-personalize", target: "zoom-add" },
                { id: "e7", source: "calendar-invite", target: "transform-capacity" },
                { id: "e8", source: "gmail-confirm", target: "transform-capacity" },
                { id: "e9", source: "zoom-add", target: "transform-capacity" },
                { id: "e10", source: "transform-capacity", target: "router-capacity" },
                {
                    id: "e11",
                    source: "router-capacity",
                    target: "output-1",
                    sourceHandle: "available"
                },
                {
                    id: "e12",
                    source: "router-capacity",
                    target: "slack-organizer",
                    sourceHandle: "near_full"
                },
                {
                    id: "e13",
                    source: "router-capacity",
                    target: "gmail-waitlist",
                    sourceHandle: "waitlist"
                },
                { id: "e14", source: "slack-organizer", target: "sheets-status" },
                { id: "e15", source: "gmail-waitlist", target: "sheets-waitlist" },
                { id: "e16", source: "sheets-status", target: "output-1" },
                { id: "e17", source: "sheets-waitlist", target: "output-1" }
            ]
        }
    },

    // Forms: Multi-Channel Feedback Aggregator
    {
        name: "Multi-Channel Feedback Aggregator",
        description:
            "Aggregate feedback from Typeform, SurveyMonkey, and Google Forms into a unified database. AI categorizes and extracts themes, routes critical feedback to support, and generates daily insights.",
        category: "support",
        tags: ["feedback", "aggregation", "typeform", "surveymonkey", "google-forms", "insights"],
        required_integrations: [
            "typeform",
            "surveymonkey",
            "google-forms",
            "notion",
            "slack",
            "linear"
        ],
        featured: false,
        definition: {
            name: "Multi-Channel Feedback Aggregator",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Daily Aggregation",
                        triggerType: "schedule",
                        schedule: "0 8 * * *",
                        description: "Runs daily at 8 AM"
                    }
                },
                {
                    id: "integration-typeform",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Fetch Typeform",
                        provider: "typeform",
                        operation: "listResponses",
                        outputVariable: "typeformResponses"
                    }
                },
                {
                    id: "integration-survey",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Fetch SurveyMonkey",
                        provider: "surveymonkey",
                        operation: "listResponses",
                        outputVariable: "surveyResponses"
                    }
                },
                {
                    id: "integration-forms",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Fetch Google Forms",
                        provider: "google-forms",
                        operation: "listResponses",
                        outputVariable: "formsResponses"
                    }
                },
                {
                    id: "transform-normalize",
                    type: "transform",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Unify Format",
                        transformType: "template",
                        template:
                            '{"allFeedback": [{{typeformResponses}}, {{surveyResponses}}, {{formsResponses}}]}',
                        outputVariable: "unifiedFeedback"
                    }
                },
                {
                    id: "llm-categorize",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Categorize & Theme",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Categorize and extract themes from this feedback:\n\n{{unifiedFeedback}}\n\nFor each item: category (critical, feature, normal), sentiment, key theme, actionable insight.",
                        outputVariable: "categorizedFeedback"
                    }
                },
                {
                    id: "notion-database",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Update Database",
                        provider: "notion",
                        operation: "createPage",
                        database: "Feedback"
                    }
                },
                {
                    id: "router-critical",
                    type: "router",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Has Critical?",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Does this feedback contain critical issues, feature requests, or just normal feedback?\n\n{{categorizedFeedback.text}}",
                        routes: [
                            { value: "critical", label: "Critical", description: "Urgent issues" },
                            { value: "feature", label: "Feature", description: "Feature requests" },
                            { value: "normal", label: "Normal", description: "Regular feedback" }
                        ],
                        defaultRoute: "normal",
                        outputVariable: "feedbackType"
                    }
                },
                {
                    id: "slack-urgent",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Urgent Alert",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#support-urgent"
                    }
                },
                {
                    id: "llm-escalate",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Escalation Brief",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Create an escalation brief for critical feedback:\n\n{{categorizedFeedback.text}}\n\nInclude: issue summary, customer impact, recommended resolution.",
                        outputVariable: "escalationBrief"
                    }
                },
                {
                    id: "linear-feature",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Create Feature",
                        provider: "linear",
                        operation: "createIssue"
                    }
                },
                {
                    id: "slack-product",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Product Ideas",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#product-ideas"
                    }
                },
                {
                    id: "notion-archive",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Archive Normal",
                        provider: "notion",
                        operation: "updatePage"
                    }
                },
                {
                    id: "llm-insights",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Daily Insights",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Generate daily feedback insights:\n\n{{categorizedFeedback.text}}\n\nInclude: volume stats, trending themes, sentiment distribution, top requests.",
                        outputVariable: "dailyInsights"
                    }
                },
                {
                    id: "slack-insights",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Post Insights",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#product-insights"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Aggregation Complete",
                        outputName: "result",
                        value: "{{dailyInsights}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "trigger-1", target: "integration-typeform" },
                { id: "e2", source: "trigger-1", target: "integration-survey" },
                { id: "e3", source: "trigger-1", target: "integration-forms" },
                { id: "e4", source: "integration-typeform", target: "transform-normalize" },
                { id: "e5", source: "integration-survey", target: "transform-normalize" },
                { id: "e6", source: "integration-forms", target: "transform-normalize" },
                { id: "e7", source: "transform-normalize", target: "llm-categorize" },
                { id: "e8", source: "llm-categorize", target: "notion-database" },
                { id: "e9", source: "notion-database", target: "router-critical" },
                {
                    id: "e10",
                    source: "router-critical",
                    target: "slack-urgent",
                    sourceHandle: "critical"
                },
                {
                    id: "e11",
                    source: "router-critical",
                    target: "linear-feature",
                    sourceHandle: "feature"
                },
                {
                    id: "e12",
                    source: "router-critical",
                    target: "notion-archive",
                    sourceHandle: "normal"
                },
                { id: "e13", source: "slack-urgent", target: "llm-escalate" },
                { id: "e14", source: "linear-feature", target: "slack-product" },
                { id: "e15", source: "llm-escalate", target: "llm-insights" },
                { id: "e16", source: "slack-product", target: "llm-insights" },
                { id: "e17", source: "notion-archive", target: "llm-insights" },
                { id: "e18", source: "llm-insights", target: "slack-insights" },
                { id: "e19", source: "slack-insights", target: "output-1" }
            ]
        }
    },

    // ========================================================================
    // ALTERNATIVE DEVOPS (4 templates)
    // ========================================================================

    // DevOps: GitLab CI/CD Command Center (Featured)
    {
        name: "GitLab CI/CD Command Center",
        description:
            "Monitor GitLab pipelines with intelligent failure diagnosis. AI analyzes logs, suggests fixes, routes by severity (critical to PagerDuty, others to Slack), and tracks deployment metrics in Datadog.",
        category: "engineering",
        tags: ["gitlab", "ci-cd", "devops", "monitoring", "automation", "pagerduty"],
        required_integrations: ["gitlab", "slack", "pagerduty", "notion", "datadog"],
        featured: true,
        definition: {
            name: "GitLab CI/CD Command Center",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Pipeline Event",
                        triggerType: "webhook",
                        provider: "gitlab",
                        event: "pipeline",
                        description: "Triggered on pipeline status change"
                    }
                },
                {
                    id: "integration-gitlab",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get Pipeline",
                        provider: "gitlab",
                        operation: "getPipeline",
                        outputVariable: "pipelineDetails"
                    }
                },
                {
                    id: "router-status",
                    type: "router",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Pipeline Status",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "What is the pipeline status?\n\n{{pipelineDetails}}",
                        routes: [
                            { value: "failed", label: "Failed", description: "Pipeline failed" },
                            {
                                value: "success",
                                label: "Success",
                                description: "Pipeline succeeded"
                            }
                        ],
                        defaultRoute: "success",
                        outputVariable: "pipelineStatus"
                    }
                },
                {
                    id: "llm-diagnose",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Diagnose Failure",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Analyze this pipeline failure:\n\n{{pipelineDetails}}\n\nIdentify: root cause, affected jobs, error messages, and recommended fix.",
                        outputVariable: "diagnosis"
                    }
                },
                {
                    id: "router-severity",
                    type: "router",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Failure Severity",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Rate the severity of this failure:\n\n{{diagnosis.text}}\n\nCategories: critical (production down), high (blocking release), low (non-blocking)",
                        routes: [
                            {
                                value: "critical",
                                label: "Critical",
                                description: "Production impact"
                            },
                            { value: "high", label: "High", description: "Release blocking" },
                            { value: "low", label: "Low", description: "Non-blocking" }
                        ],
                        defaultRoute: "low",
                        outputVariable: "severity"
                    }
                },
                {
                    id: "pagerduty",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Page On-Call",
                        provider: "pagerduty",
                        operation: "createIncident"
                    }
                },
                {
                    id: "slack-incident",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Critical Alert",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#incidents"
                    }
                },
                {
                    id: "slack-eng",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "High Alert",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#engineering"
                    }
                },
                {
                    id: "slack-team",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Team Notice",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#team"
                    }
                },
                {
                    id: "notion-incident",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Create Incident",
                        provider: "notion",
                        operation: "createPage",
                        database: "Incidents"
                    }
                },
                {
                    id: "llm-suggest",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Suggest Fix",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Based on this diagnosis:\n\n{{diagnosis.text}}\n\nSuggest specific code or config changes to fix the issue.",
                        outputVariable: "suggestedFix"
                    }
                },
                {
                    id: "gitlab-comment",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Post Fix",
                        provider: "gitlab",
                        operation: "createMergeRequestNote"
                    }
                },
                {
                    id: "slack-oncall",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Notify On-Call",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#oncall"
                    }
                },
                {
                    id: "datadog-event",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Record Incident",
                        provider: "datadog",
                        operation: "createEvent"
                    }
                },
                {
                    id: "router-env",
                    type: "router",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Environment",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "What environment was this deployment to?\n\n{{pipelineDetails}}",
                        routes: [
                            {
                                value: "production",
                                label: "Production",
                                description: "Prod deploy"
                            },
                            { value: "staging", label: "Staging", description: "Staging/preview" }
                        ],
                        defaultRoute: "staging",
                        outputVariable: "environment"
                    }
                },
                {
                    id: "slack-rel",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Release Announce",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#releases"
                    }
                },
                {
                    id: "notion-log",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Changelog",
                        provider: "notion",
                        operation: "createPage",
                        database: "Changelog"
                    }
                },
                {
                    id: "integration-datadog",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Deploy Metric",
                        provider: "datadog",
                        operation: "submitMetric"
                    }
                },
                {
                    id: "github-comment",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Preview URL",
                        provider: "gitlab",
                        operation: "createMergeRequestNote"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Pipeline Processed",
                        outputName: "result",
                        value: "{{pipelineStatus}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "trigger-1", target: "integration-gitlab" },
                { id: "e2", source: "integration-gitlab", target: "router-status" },
                {
                    id: "e3",
                    source: "router-status",
                    target: "llm-diagnose",
                    sourceHandle: "failed"
                },
                {
                    id: "e4",
                    source: "router-status",
                    target: "router-env",
                    sourceHandle: "success"
                },
                { id: "e5", source: "llm-diagnose", target: "router-severity" },
                {
                    id: "e6",
                    source: "router-severity",
                    target: "pagerduty",
                    sourceHandle: "critical"
                },
                {
                    id: "e7",
                    source: "router-severity",
                    target: "slack-incident",
                    sourceHandle: "critical"
                },
                { id: "e8", source: "router-severity", target: "slack-eng", sourceHandle: "high" },
                { id: "e9", source: "router-severity", target: "slack-team", sourceHandle: "low" },
                { id: "e10", source: "pagerduty", target: "notion-incident" },
                { id: "e11", source: "slack-incident", target: "notion-incident" },
                { id: "e12", source: "notion-incident", target: "llm-suggest" },
                { id: "e13", source: "slack-eng", target: "llm-suggest" },
                { id: "e14", source: "slack-team", target: "llm-suggest" },
                { id: "e15", source: "llm-suggest", target: "gitlab-comment" },
                { id: "e16", source: "gitlab-comment", target: "slack-oncall" },
                { id: "e17", source: "gitlab-comment", target: "datadog-event" },
                {
                    id: "e18",
                    source: "router-env",
                    target: "slack-rel",
                    sourceHandle: "production"
                },
                {
                    id: "e19",
                    source: "router-env",
                    target: "notion-log",
                    sourceHandle: "production"
                },
                {
                    id: "e20",
                    source: "router-env",
                    target: "github-comment",
                    sourceHandle: "staging"
                },
                { id: "e21", source: "slack-rel", target: "integration-datadog" },
                { id: "e22", source: "notion-log", target: "integration-datadog" },
                { id: "e23", source: "slack-oncall", target: "output-1" },
                { id: "e24", source: "datadog-event", target: "output-1" },
                { id: "e25", source: "integration-datadog", target: "output-1" },
                { id: "e26", source: "github-comment", target: "output-1" }
            ]
        }
    },

    // DevOps: CircleCI Build Intelligence Hub
    {
        name: "CircleCI Build Intelligence Hub",
        description:
            "Diagnose CircleCI build failures with AI-powered analysis. Route by failure type (tests, dependencies, infrastructure, timeouts), suggest fixes, and create Linear issues for recurring problems.",
        category: "engineering",
        tags: ["circleci", "ci-cd", "builds", "devops", "automation", "linear"],
        required_integrations: ["circleci", "github", "slack", "linear", "notion"],
        featured: false,
        definition: {
            name: "CircleCI Build Intelligence Hub",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Build Failed",
                        triggerType: "webhook",
                        provider: "circleci",
                        event: "job.failed",
                        description: "Triggered when build fails"
                    }
                },
                {
                    id: "integration-circleci",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get Build Logs",
                        provider: "circleci",
                        operation: "getJob",
                        outputVariable: "buildDetails"
                    }
                },
                {
                    id: "llm-diagnose",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Diagnose Failure",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Analyze this build failure:\n\n{{buildDetails}}\n\nIdentify: failure type, root cause, affected tests/modules, and recommended fix.",
                        outputVariable: "diagnosis"
                    }
                },
                {
                    id: "router-type",
                    type: "router",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Failure Type",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "What type of failure is this?\n\n{{diagnosis.text}}\n\nCategories: test_failure, dependency, infra, timeout",
                        routes: [
                            {
                                value: "test_failure",
                                label: "Test Failure",
                                description: "Tests failed"
                            },
                            {
                                value: "dependency",
                                label: "Dependency",
                                description: "Package issues"
                            },
                            {
                                value: "infra",
                                label: "Infrastructure",
                                description: "CI system issue"
                            },
                            { value: "timeout", label: "Timeout", description: "Build timeout" }
                        ],
                        defaultRoute: "test_failure",
                        outputVariable: "failureType"
                    }
                },
                {
                    id: "github-comment",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Comment Tests",
                        provider: "github",
                        operation: "createComment"
                    }
                },
                {
                    id: "slack-author",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Notify Author",
                        provider: "slack",
                        operation: "sendMessage"
                    }
                },
                {
                    id: "linear-task",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Create Task",
                        provider: "linear",
                        operation: "createIssue"
                    }
                },
                {
                    id: "slack-platform",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Platform Alert",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#platform"
                    }
                },
                {
                    id: "slack-devops",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "DevOps Alert",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#devops"
                    }
                },
                {
                    id: "slack-platform-timeout",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Timeout Alert",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#platform"
                    }
                },
                {
                    id: "llm-scale",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Suggest Scaling",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "This build timed out:\n\n{{buildDetails}}\n\nSuggest: resource scaling, parallelization, or optimization strategies.",
                        outputVariable: "scalingSuggestion"
                    }
                },
                {
                    id: "llm-fix",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Fix",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Based on this diagnosis:\n\n{{diagnosis.text}}\n\nGenerate a specific code fix or configuration change.",
                        outputVariable: "suggestedFix"
                    }
                },
                {
                    id: "github-suggest",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Post Fix",
                        provider: "github",
                        operation: "createComment"
                    }
                },
                {
                    id: "notion-log",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Log Failure",
                        provider: "notion",
                        operation: "createPage",
                        database: "Build Failures"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Build Processed",
                        outputName: "result",
                        value: "{{failureType}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "trigger-1", target: "integration-circleci" },
                { id: "e2", source: "integration-circleci", target: "llm-diagnose" },
                { id: "e3", source: "llm-diagnose", target: "router-type" },
                {
                    id: "e4",
                    source: "router-type",
                    target: "github-comment",
                    sourceHandle: "test_failure"
                },
                {
                    id: "e5",
                    source: "router-type",
                    target: "slack-author",
                    sourceHandle: "test_failure"
                },
                {
                    id: "e6",
                    source: "router-type",
                    target: "linear-task",
                    sourceHandle: "dependency"
                },
                {
                    id: "e7",
                    source: "router-type",
                    target: "slack-platform",
                    sourceHandle: "dependency"
                },
                { id: "e8", source: "router-type", target: "slack-devops", sourceHandle: "infra" },
                {
                    id: "e9",
                    source: "router-type",
                    target: "slack-platform-timeout",
                    sourceHandle: "timeout"
                },
                { id: "e10", source: "slack-platform-timeout", target: "llm-scale" },
                { id: "e11", source: "github-comment", target: "llm-fix" },
                { id: "e12", source: "slack-author", target: "llm-fix" },
                { id: "e13", source: "linear-task", target: "llm-fix" },
                { id: "e14", source: "slack-platform", target: "llm-fix" },
                { id: "e15", source: "slack-devops", target: "llm-fix" },
                { id: "e16", source: "llm-scale", target: "llm-fix" },
                { id: "e17", source: "llm-fix", target: "github-suggest" },
                { id: "e18", source: "github-suggest", target: "notion-log" },
                { id: "e19", source: "notion-log", target: "output-1" }
            ]
        }
    },

    // DevOps: Vercel Deploy Intelligence
    {
        name: "Vercel Deploy Intelligence",
        description:
            "Track Vercel deployments with environment-aware routing. Post preview URLs to PRs, announce production releases, monitor health metrics, and auto-rollback on degraded performance.",
        category: "engineering",
        tags: ["vercel", "deployment", "devops", "monitoring", "preview", "rollback"],
        required_integrations: ["vercel", "slack", "github", "notion", "datadog"],
        featured: false,
        definition: {
            name: "Vercel Deploy Intelligence",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Deploy Complete",
                        triggerType: "webhook",
                        provider: "vercel",
                        event: "deployment.succeeded",
                        description: "Triggered when deployment completes"
                    }
                },
                {
                    id: "integration-vercel",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get Deployment",
                        provider: "vercel",
                        operation: "getDeployment",
                        outputVariable: "deployDetails"
                    }
                },
                {
                    id: "llm-analyze",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Analyze Deploy",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Analyze this deployment:\n\n{{deployDetails}}\n\nExtract: environment, changes summary, build time, bundle size changes.",
                        outputVariable: "deployAnalysis"
                    }
                },
                {
                    id: "router-env",
                    type: "router",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Environment",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "What environment is this deployment?\n\n{{deployDetails}}",
                        routes: [
                            {
                                value: "production",
                                label: "Production",
                                description: "Prod deploy"
                            },
                            { value: "preview", label: "Preview", description: "Preview/staging" },
                            {
                                value: "development",
                                label: "Development",
                                description: "Dev deploy"
                            }
                        ],
                        defaultRoute: "preview",
                        outputVariable: "environment"
                    }
                },
                {
                    id: "slack-release",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Release Announce",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#releases"
                    }
                },
                {
                    id: "notion-changelog",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Update Changelog",
                        provider: "notion",
                        operation: "createPage",
                        database: "Changelog"
                    }
                },
                {
                    id: "github-preview",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Post Preview URL",
                        provider: "github",
                        operation: "createComment"
                    }
                },
                {
                    id: "slack-dev",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Dev Notice",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#dev"
                    }
                },
                {
                    id: "datadog-deploy",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Record Deploy",
                        provider: "datadog",
                        operation: "createEvent"
                    }
                },
                {
                    id: "vercel-analytics",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get Baseline",
                        provider: "vercel",
                        operation: "getAnalytics",
                        outputVariable: "baseline"
                    }
                },
                {
                    id: "delay-5min",
                    type: "wait",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Wait for Traffic",
                        delayType: "fixed",
                        duration: 300000,
                        description: "Wait 5 minutes for metrics"
                    }
                },
                {
                    id: "integration-datadog-check",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Check Error Rate",
                        provider: "datadog",
                        operation: "queryMetrics",
                        outputVariable: "errorRate"
                    }
                },
                {
                    id: "router-health",
                    type: "router",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Health Check",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Is this deployment healthy based on error rates?\n\nBaseline: {{baseline}}\nCurrent: {{errorRate}}",
                        routes: [
                            {
                                value: "healthy",
                                label: "Healthy",
                                description: "Normal error rate"
                            },
                            { value: "degraded", label: "Degraded", description: "Elevated errors" }
                        ],
                        defaultRoute: "healthy",
                        outputVariable: "healthStatus"
                    }
                },
                {
                    id: "notion-success",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Mark Success",
                        provider: "notion",
                        operation: "updatePage"
                    }
                },
                {
                    id: "slack-oncall",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Alert On-Call",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#oncall"
                    }
                },
                {
                    id: "vercel-rollback",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Trigger Rollback",
                        provider: "vercel",
                        operation: "rollback"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Deploy Processed",
                        outputName: "result",
                        value: "{{healthStatus}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "trigger-1", target: "integration-vercel" },
                { id: "e2", source: "integration-vercel", target: "llm-analyze" },
                { id: "e3", source: "llm-analyze", target: "router-env" },
                {
                    id: "e4",
                    source: "router-env",
                    target: "slack-release",
                    sourceHandle: "production"
                },
                {
                    id: "e5",
                    source: "router-env",
                    target: "notion-changelog",
                    sourceHandle: "production"
                },
                {
                    id: "e6",
                    source: "router-env",
                    target: "github-preview",
                    sourceHandle: "preview"
                },
                {
                    id: "e7",
                    source: "router-env",
                    target: "slack-dev",
                    sourceHandle: "development"
                },
                { id: "e8", source: "slack-release", target: "datadog-deploy" },
                { id: "e9", source: "notion-changelog", target: "datadog-deploy" },
                { id: "e10", source: "datadog-deploy", target: "vercel-analytics" },
                { id: "e11", source: "vercel-analytics", target: "delay-5min" },
                { id: "e12", source: "delay-5min", target: "integration-datadog-check" },
                { id: "e13", source: "integration-datadog-check", target: "router-health" },
                {
                    id: "e14",
                    source: "router-health",
                    target: "notion-success",
                    sourceHandle: "healthy"
                },
                {
                    id: "e15",
                    source: "router-health",
                    target: "slack-oncall",
                    sourceHandle: "degraded"
                },
                {
                    id: "e16",
                    source: "router-health",
                    target: "vercel-rollback",
                    sourceHandle: "degraded"
                },
                { id: "e17", source: "notion-success", target: "output-1" },
                { id: "e18", source: "slack-oncall", target: "output-1" },
                { id: "e19", source: "vercel-rollback", target: "output-1" },
                { id: "e20", source: "github-preview", target: "output-1" },
                { id: "e21", source: "slack-dev", target: "output-1" }
            ]
        }
    },

    // DevOps: Bitbucket PR Review Orchestrator
    {
        name: "Bitbucket PR Review Orchestrator",
        description:
            "Streamline Bitbucket PR reviews with AI-powered code analysis. Identify reviewers, send Slack notifications, track review progress with reminders, and escalate stale PRs to managers.",
        category: "engineering",
        tags: ["bitbucket", "code-review", "pull-requests", "devops", "automation"],
        required_integrations: ["bitbucket", "slack", "jira", "gmail", "notion"],
        featured: false,
        definition: {
            name: "Bitbucket PR Review Orchestrator",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "PR Created",
                        triggerType: "webhook",
                        provider: "bitbucket",
                        event: "pullrequest.created",
                        description: "Triggered when PR is created"
                    }
                },
                {
                    id: "integration-bitbucket-pr",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get PR Details",
                        provider: "bitbucket",
                        operation: "getPullRequest",
                        outputVariable: "prDetails"
                    }
                },
                {
                    id: "llm-analyze",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Analyze Changes",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Analyze this pull request:\n\n{{prDetails}}\n\nDetermine: complexity (1-10), risk areas, test coverage needs, review priority.",
                        outputVariable: "prAnalysis"
                    }
                },
                {
                    id: "llm-reviewers",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Identify Reviewers",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Based on the files changed in this PR:\n\n{{prDetails}}\n\nSuggest appropriate reviewers based on code ownership patterns.",
                        outputVariable: "suggestedReviewers"
                    }
                },
                {
                    id: "bitbucket-reviewers",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Request Reviews",
                        provider: "bitbucket",
                        operation: "addReviewers"
                    }
                },
                {
                    id: "slack-reviewers",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Notify Reviewers",
                        provider: "slack",
                        operation: "sendMessage"
                    }
                },
                {
                    id: "jira-link",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Link to JIRA",
                        provider: "jira",
                        operation: "addComment"
                    }
                },
                {
                    id: "delay-24h",
                    type: "wait",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Wait 24 Hours",
                        delayType: "fixed",
                        duration: 86400000,
                        description: "Wait for reviews"
                    }
                },
                {
                    id: "integration-bitbucket-check",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Check Status",
                        provider: "bitbucket",
                        operation: "getPullRequest",
                        outputVariable: "reviewStatus"
                    }
                },
                {
                    id: "router-reviewed",
                    type: "router",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Review Status",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "What is the review status?\n\n{{reviewStatus}}\n\nCategories: none (no reviews), some (partial reviews), approved (all approved)",
                        routes: [
                            { value: "none", label: "No Reviews", description: "No reviews yet" },
                            { value: "some", label: "Partial", description: "Some reviews in" },
                            { value: "approved", label: "Approved", description: "All approved" }
                        ],
                        defaultRoute: "none",
                        outputVariable: "reviewState"
                    }
                },
                {
                    id: "slack-reminder",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Urgent Reminder",
                        provider: "slack",
                        operation: "sendMessage"
                    }
                },
                {
                    id: "gmail-escalate",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Email Manager",
                        provider: "gmail",
                        operation: "sendEmail"
                    }
                },
                {
                    id: "slack-update",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Progress Update",
                        provider: "slack",
                        operation: "sendMessage"
                    }
                },
                {
                    id: "delay-12h",
                    type: "wait",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Wait 12 More Hours",
                        delayType: "fixed",
                        duration: 43200000,
                        description: "Additional wait time"
                    }
                },
                {
                    id: "jira-update",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Ready to Merge",
                        provider: "jira",
                        operation: "updateIssue"
                    }
                },
                {
                    id: "notion-log",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Log Approval",
                        provider: "notion",
                        operation: "createPage",
                        database: "PR Reviews"
                    }
                },
                {
                    id: "llm-summary",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Review Summary",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Generate a review summary for this PR:\n\n{{reviewStatus}}\n\nInclude: key feedback themes, approval status, remaining concerns.",
                        outputVariable: "reviewSummary"
                    }
                },
                {
                    id: "bitbucket-comment",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Post Summary",
                        provider: "bitbucket",
                        operation: "createComment"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "PR Processed",
                        outputName: "result",
                        value: "{{reviewState}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "trigger-1", target: "integration-bitbucket-pr" },
                { id: "e2", source: "integration-bitbucket-pr", target: "llm-analyze" },
                { id: "e3", source: "llm-analyze", target: "llm-reviewers" },
                { id: "e4", source: "llm-reviewers", target: "bitbucket-reviewers" },
                { id: "e5", source: "llm-reviewers", target: "slack-reviewers" },
                { id: "e6", source: "llm-reviewers", target: "jira-link" },
                { id: "e7", source: "bitbucket-reviewers", target: "delay-24h" },
                { id: "e8", source: "slack-reviewers", target: "delay-24h" },
                { id: "e9", source: "jira-link", target: "delay-24h" },
                { id: "e10", source: "delay-24h", target: "integration-bitbucket-check" },
                { id: "e11", source: "integration-bitbucket-check", target: "router-reviewed" },
                {
                    id: "e12",
                    source: "router-reviewed",
                    target: "slack-reminder",
                    sourceHandle: "none"
                },
                {
                    id: "e13",
                    source: "router-reviewed",
                    target: "slack-update",
                    sourceHandle: "some"
                },
                {
                    id: "e14",
                    source: "router-reviewed",
                    target: "jira-update",
                    sourceHandle: "approved"
                },
                { id: "e15", source: "slack-reminder", target: "gmail-escalate" },
                { id: "e16", source: "gmail-escalate", target: "llm-summary" },
                { id: "e17", source: "slack-update", target: "delay-12h" },
                { id: "e18", source: "delay-12h", target: "llm-summary" },
                { id: "e19", source: "jira-update", target: "notion-log" },
                { id: "e20", source: "notion-log", target: "llm-summary" },
                { id: "e21", source: "llm-summary", target: "bitbucket-comment" },
                { id: "e22", source: "bitbucket-comment", target: "output-1" }
            ]
        }
    },

    // ========================================================================
    // MULTIMODAL AI (10 templates)
    // ========================================================================

    // Multimodal AI 1: Product Photo Analyzer
    {
        name: "Product Photo Analyzer",
        description:
            "Analyze product images for e-commerce optimization. Uses vision AI to extract features, quality issues, and generate SEO-optimized descriptions and tags.",
        category: "multimodal-ai",
        tags: ["vision", "ecommerce", "product", "seo", "image-analysis"],
        required_integrations: [],
        featured: true,
        definition: {
            name: "Product Photo Analyzer",
            nodes: [
                {
                    id: "input-1",
                    type: "input",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Product Image",
                        inputName: "productImage",
                        inputVariable: "productImage",
                        inputType: "file",
                        description: "Upload product image to analyze"
                    }
                },
                {
                    id: "vision-analyze",
                    type: "vision",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Analyze Product Image",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Analyze this product image in detail. Identify:\n1. Product type and category\n2. Key visual features (color, material, size indicators)\n3. Quality issues (blur, lighting, background)\n4. Styling suggestions for improvement\n5. Competitor comparison points",
                        outputVariable: "imageAnalysis"
                    }
                },
                {
                    id: "llm-description",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate SEO Description",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Based on this product image analysis:\n\n{{imageAnalysis.text}}\n\nGenerate:\n1. SEO-optimized product title (60 chars max)\n2. Product description (150-200 words)\n3. Key features bullet points (5-7 items)\n4. Search keywords (10-15 terms)\n5. Category tags",
                        outputVariable: "productContent"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Product Data",
                        outputName: "result",
                        value: "{{productContent}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "input-1", target: "vision-analyze" },
                { id: "e2", source: "vision-analyze", target: "llm-description" },
                { id: "e3", source: "llm-description", target: "output-1" }
            ]
        }
    },

    // Multimodal AI 2: Brand Asset Validator
    {
        name: "Brand Asset Validator",
        description:
            "Validate uploaded brand assets against brand guidelines. Checks colors, logo placement, typography, and provides detailed compliance feedback.",
        category: "multimodal-ai",
        tags: ["vision", "brand", "validation", "compliance", "design"],
        required_integrations: ["slack"],
        featured: false,
        definition: {
            name: "Brand Asset Validator",
            nodes: [
                {
                    id: "files-1",
                    type: "files",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Upload Brand Assets",
                        inputVariable: "brandAssets",
                        allowedTypes: ["image/*"],
                        description: "Upload images to validate against brand guidelines"
                    }
                },
                {
                    id: "input-guidelines",
                    type: "input",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Brand Guidelines",
                        inputName: "brandGuidelines",
                        inputVariable: "brandGuidelines",
                        inputType: "text",
                        description:
                            "Describe your brand guidelines: colors (hex codes), logo rules, typography, tone"
                    }
                },
                {
                    id: "loop-assets",
                    type: "loop",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Process Each Asset",
                        loopType: "forEach",
                        collection: "{{brandAssets}}",
                        itemVariable: "currentAsset",
                        indexVariable: "assetIndex"
                    }
                },
                {
                    id: "vision-check",
                    type: "vision",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Check Brand Compliance",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Analyze this brand asset against these guidelines:\n\n{{brandGuidelines}}\n\nCheck:\n1. Color accuracy (identify hex codes used)\n2. Logo placement and sizing\n3. Typography consistency\n4. Overall brand alignment\n5. Quality issues\n\nProvide a compliance score (0-100) and specific feedback.",
                        outputVariable: "complianceCheck"
                    }
                },
                {
                    id: "conditional-pass",
                    type: "conditional",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Passes Guidelines?",
                        condition:
                            "complianceCheck.text.includes('score: 8') || complianceCheck.text.includes('score: 9') || complianceCheck.text.includes('score: 10')",
                        outputVariable: "passesGuidelines"
                    }
                },
                {
                    id: "shared-memory-pass",
                    type: "shared-memory",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Store Approved",
                        operation: "set",
                        key: "approved_{{assetIndex}}",
                        value: "{{currentAsset}}"
                    }
                },
                {
                    id: "llm-feedback",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Improvement Feedback",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Based on this compliance check:\n\n{{complianceCheck.text}}\n\nGenerate specific, actionable feedback for the designer to fix the brand compliance issues. Be constructive and prioritize the most impactful changes.",
                        outputVariable: "designFeedback"
                    }
                },
                {
                    id: "integration-slack",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Alert Design Team",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#design-reviews"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Validation Results",
                        outputName: "result",
                        value: "{{complianceCheck}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "files-1", target: "loop-assets" },
                { id: "e2", source: "input-guidelines", target: "loop-assets" },
                { id: "e3", source: "loop-assets", target: "vision-check" },
                { id: "e4", source: "vision-check", target: "conditional-pass" },
                {
                    id: "e5",
                    source: "conditional-pass",
                    target: "shared-memory-pass",
                    sourceHandle: "true"
                },
                {
                    id: "e6",
                    source: "conditional-pass",
                    target: "llm-feedback",
                    sourceHandle: "false"
                },
                { id: "e7", source: "llm-feedback", target: "integration-slack" },
                { id: "e8", source: "shared-memory-pass", target: "output-1" },
                { id: "e9", source: "integration-slack", target: "output-1" }
            ]
        }
    },

    // Multimodal AI 3: Social Media Image Generator
    {
        name: "Social Media Image Generator",
        description:
            "Generate platform-optimized social media images from text briefs. Creates visuals for Instagram, Twitter, LinkedIn, and Facebook with proper sizing.",
        category: "multimodal-ai",
        tags: ["image-generation", "social-media", "marketing", "ai-art", "content"],
        required_integrations: [],
        featured: true,
        definition: {
            name: "Social Media Image Generator",
            nodes: [
                {
                    id: "input-1",
                    type: "input",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Campaign Brief",
                        inputName: "campaignBrief",
                        inputVariable: "campaignBrief",
                        inputType: "text",
                        description:
                            "Describe the campaign: theme, message, style preferences, brand colors"
                    }
                },
                {
                    id: "llm-prompts",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Image Prompts",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Based on this campaign brief:\n\n{{campaignBrief}}\n\nCreate detailed image generation prompts for:\n1. Instagram Post (1080x1080) - visually striking, lifestyle-focused\n2. Instagram Story (1080x1920) - vertical, attention-grabbing\n3. Twitter/X Post (1200x675) - clean, shareable\n4. LinkedIn Post (1200x627) - professional, trustworthy\n\nFor each, provide a detailed prompt describing composition, style, colors, and mood.",
                        outputVariable: "imagePrompts"
                    }
                },
                {
                    id: "llm-instagram-post",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Create Instagram Post Image",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Extract the Instagram Post prompt from:\n\n{{imagePrompts.text}}\n\nReturn just the image prompt for DALL-E.",
                        outputVariable: "instagramPostPrompt"
                    }
                },
                {
                    id: "llm-twitter",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Create Twitter Image",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Extract the Twitter/X Post prompt from:\n\n{{imagePrompts.text}}\n\nReturn just the image prompt for DALL-E.",
                        outputVariable: "twitterPrompt"
                    }
                },
                {
                    id: "transform-compile",
                    type: "transform",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Compile Image Package",
                        transformType: "template",
                        template:
                            "Social Media Image Package:\n\nInstagram: {{instagramPostPrompt.text}}\nTwitter: {{twitterPrompt.text}}\n\nReady for image generation with your preferred tool.",
                        outputVariable: "imagePackage"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Image Prompts",
                        outputName: "result",
                        value: "{{imagePackage}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "input-1", target: "llm-prompts" },
                { id: "e2", source: "llm-prompts", target: "llm-instagram-post" },
                { id: "e3", source: "llm-prompts", target: "llm-twitter" },
                { id: "e4", source: "llm-instagram-post", target: "transform-compile" },
                { id: "e5", source: "llm-twitter", target: "transform-compile" },
                { id: "e6", source: "transform-compile", target: "output-1" }
            ]
        }
    },

    // Multimodal AI 4: Visual Content Moderator
    {
        name: "Visual Content Moderator",
        description:
            "Automatically moderate user-uploaded images using AI vision. Classifies content as safe, warning, or blocked with multi-path routing for each case.",
        category: "multimodal-ai",
        tags: ["vision", "moderation", "safety", "content", "switch"],
        required_integrations: ["slack"],
        featured: false,
        definition: {
            name: "Visual Content Moderator",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Image Upload Webhook",
                        triggerType: "webhook",
                        description: "Triggered when user uploads an image"
                    }
                },
                {
                    id: "vision-moderate",
                    type: "vision",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Analyze Content Safety",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: 'Analyze this image for content moderation. Classify as:\n- SAFE: Appropriate for all audiences\n- WARNING: May need human review (suggestive but not explicit)\n- BLOCK: Violates content policies (explicit, violent, illegal)\n\nProvide classification and reasoning. Return JSON: {"classification": "SAFE|WARNING|BLOCK", "reason": "...", "confidence": 0-100}',
                        outputVariable: "moderationResult"
                    }
                },
                {
                    id: "code-parse",
                    type: "code",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Parse Classification",
                        language: "javascript",
                        code: "const result = JSON.parse(inputs.moderationResult.text);\nreturn { classification: result.classification, reason: result.reason, confidence: result.confidence };",
                        outputVariable: "parsed"
                    }
                },
                {
                    id: "switch-classify",
                    type: "switch",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Route by Classification",
                        expression: "{{parsed.classification}}",
                        cases: [
                            { value: "SAFE", label: "Safe Content" },
                            { value: "WARNING", label: "Needs Review" },
                            { value: "BLOCK", label: "Block Content" }
                        ],
                        defaultCase: "SAFE"
                    }
                },
                {
                    id: "llm-approve",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Log Approval",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Content approved. Reason: {{parsed.reason}}. Generate a brief log entry.",
                        outputVariable: "approvalLog"
                    }
                },
                {
                    id: "humanReview-1",
                    type: "humanReview",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Human Review Required",
                        reviewPrompt:
                            "This content was flagged for review.\n\nReason: {{parsed.reason}}\nConfidence: {{parsed.confidence}}%\n\nPlease approve or reject.",
                        outputVariable: "humanDecision"
                    }
                },
                {
                    id: "integration-slack-block",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Notify Content Blocked",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#content-moderation"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Moderation Result",
                        outputName: "result",
                        value: "{{parsed}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "trigger-1", target: "vision-moderate" },
                { id: "e2", source: "vision-moderate", target: "code-parse" },
                { id: "e3", source: "code-parse", target: "switch-classify" },
                {
                    id: "e4",
                    source: "switch-classify",
                    target: "llm-approve",
                    sourceHandle: "SAFE"
                },
                {
                    id: "e5",
                    source: "switch-classify",
                    target: "humanReview-1",
                    sourceHandle: "WARNING"
                },
                {
                    id: "e6",
                    source: "switch-classify",
                    target: "integration-slack-block",
                    sourceHandle: "BLOCK"
                },
                { id: "e7", source: "llm-approve", target: "output-1" },
                { id: "e8", source: "humanReview-1", target: "output-1" },
                { id: "e9", source: "integration-slack-block", target: "output-1" }
            ]
        }
    },

    // Multimodal AI 5: Infographic Generator
    {
        name: "Infographic Generator",
        description:
            "Create data-driven infographics from raw data. Extracts insights, generates charts, designs visual elements, and compiles into a polished infographic.",
        category: "multimodal-ai",
        tags: ["chart", "visualization", "data", "design", "pdf"],
        required_integrations: [],
        featured: true,
        definition: {
            name: "Infographic Generator",
            nodes: [
                {
                    id: "input-data",
                    type: "input",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Data Input",
                        inputName: "rawData",
                        inputVariable: "rawData",
                        inputType: "text",
                        description: "Paste your data (CSV, JSON, or plain text statistics)"
                    }
                },
                {
                    id: "input-topic",
                    type: "input",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Infographic Topic",
                        inputName: "topic",
                        inputVariable: "topic",
                        inputType: "text",
                        description: "What is this infographic about?"
                    }
                },
                {
                    id: "llm-insights",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Extract Key Insights",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Analyze this data about {{topic}}:\n\n{{rawData}}\n\nExtract:\n1. 5-7 key statistics/insights\n2. Trends and patterns\n3. Surprising findings\n4. Recommended chart types for each insight (bar, pie, line, etc.)\n5. Suggested infographic structure",
                        outputVariable: "insights"
                    }
                },
                {
                    id: "llm-chart-specs",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Chart Specifications",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Based on these insights:\n\n{{insights.text}}\n\nCreate detailed specifications for 3-4 charts including:\n- Chart type\n- Data labels and values\n- Colors (hex codes)\n- Title and subtitle\n\nReturn as JSON array.",
                        outputVariable: "chartSpecs"
                    }
                },
                {
                    id: "llm-design",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Design Infographic Layout",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Design an infographic layout for:\nTopic: {{topic}}\nInsights: {{insights.text}}\nCharts: {{chartSpecs.text}}\n\nProvide:\n1. Title and subtitle text\n2. Section layout (top to bottom)\n3. Color palette (3-4 colors)\n4. Icon suggestions for each section\n5. Call-to-action text",
                        outputVariable: "designSpec"
                    }
                },
                {
                    id: "templateOutput-1",
                    type: "templateOutput",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Infographic HTML",
                        templateType: "html",
                        template:
                            "<html><head><style>body{font-family:Arial;max-width:800px;margin:0 auto;}</style></head><body><h1>{{topic}}</h1><div>{{designSpec.text}}</div><div>{{chartSpecs.text}}</div></body></html>",
                        outputVariable: "infographicHtml"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Infographic Output",
                        outputName: "result",
                        value: "{{infographicHtml}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "input-data", target: "llm-insights" },
                { id: "e2", source: "input-topic", target: "llm-insights" },
                { id: "e3", source: "llm-insights", target: "llm-chart-specs" },
                { id: "e4", source: "llm-chart-specs", target: "llm-design" },
                { id: "e5", source: "llm-design", target: "templateOutput-1" },
                { id: "e6", source: "templateOutput-1", target: "output-1" }
            ]
        }
    },

    // Multimodal AI 6: Video Script to Storyboard
    {
        name: "Video Script to Storyboard",
        description:
            "Convert video scripts into visual storyboards. Parses script into scenes, generates frame descriptions, and compiles into a storyboard document.",
        category: "multimodal-ai",
        tags: ["video", "storyboard", "script", "creative", "loop"],
        required_integrations: [],
        featured: false,
        definition: {
            name: "Video Script to Storyboard",
            nodes: [
                {
                    id: "input-1",
                    type: "input",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Video Script",
                        inputName: "videoScript",
                        inputVariable: "videoScript",
                        inputType: "text",
                        description: "Paste your video script with scene descriptions"
                    }
                },
                {
                    id: "llm-parse",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Parse Into Scenes",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Parse this video script into individual scenes:\n\n{{videoScript}}\n\nFor each scene, extract:\n1. Scene number\n2. Duration (seconds)\n3. Visual description\n4. Dialogue/voiceover\n5. Camera direction\n6. Mood/tone\n\nReturn as JSON array of scenes.",
                        outputVariable: "scenes"
                    }
                },
                {
                    id: "loop-scenes",
                    type: "loop",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Process Each Scene",
                        loopType: "forEach",
                        collection: "{{scenes.text}}",
                        itemVariable: "currentScene",
                        indexVariable: "sceneIndex"
                    }
                },
                {
                    id: "llm-frame",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Frame Description",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Create a detailed storyboard frame for this scene:\n\n{{currentScene}}\n\nDescribe:\n1. Frame composition (rule of thirds, focal point)\n2. Character positions and expressions\n3. Background elements\n4. Lighting and color mood\n5. Motion arrows if applicable\n6. Technical notes (lens, angle)",
                        outputVariable: "frameDescription"
                    }
                },
                {
                    id: "shared-memory-frame",
                    type: "shared-memory",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Store Frame",
                        operation: "set",
                        key: "frame_{{sceneIndex}}",
                        value: "{{frameDescription.text}}"
                    }
                },
                {
                    id: "transform-compile",
                    type: "transform",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Compile Storyboard",
                        transformType: "template",
                        template:
                            "# Video Storyboard\n\n{{scenes.text}}\n\n## Frames\n\nGenerated storyboard frames are stored and ready for visual rendering.",
                        outputVariable: "storyboard"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Storyboard Document",
                        outputName: "result",
                        value: "{{storyboard}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "input-1", target: "llm-parse" },
                { id: "e2", source: "llm-parse", target: "loop-scenes" },
                { id: "e3", source: "loop-scenes", target: "llm-frame" },
                { id: "e4", source: "llm-frame", target: "shared-memory-frame" },
                { id: "e5", source: "shared-memory-frame", target: "transform-compile" },
                { id: "e6", source: "transform-compile", target: "output-1" }
            ]
        }
    },

    // Multimodal AI 7: Screenshot Comparison Monitor
    {
        name: "Screenshot Comparison Monitor",
        description:
            "Monitor websites for visual changes. Captures screenshots on schedule, uses vision AI to detect and summarize changes, and alerts on significant differences.",
        category: "multimodal-ai",
        tags: ["vision", "monitoring", "screenshot", "schedule", "alerts"],
        required_integrations: ["slack"],
        featured: false,
        definition: {
            name: "Screenshot Comparison Monitor",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Daily Check",
                        triggerType: "schedule",
                        schedule: "0 9 * * *",
                        description: "Run daily at 9 AM"
                    }
                },
                {
                    id: "input-url",
                    type: "input",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Target URL",
                        inputName: "targetUrl",
                        inputVariable: "targetUrl",
                        inputType: "text",
                        defaultValue: "https://example.com"
                    }
                },
                {
                    id: "url-fetch",
                    type: "url",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Capture Page",
                        urlVariable: "targetUrl",
                        scrapingMode: "screenshot",
                        outputVariable: "currentScreenshot"
                    }
                },
                {
                    id: "shared-memory-get",
                    type: "shared-memory",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get Previous Screenshot",
                        operation: "get",
                        key: "baseline_screenshot",
                        outputVariable: "previousScreenshot"
                    }
                },
                {
                    id: "vision-compare",
                    type: "vision",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Compare Screenshots",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Compare these two website screenshots and identify changes:\n\nCurrent: {{currentScreenshot}}\nPrevious: {{previousScreenshot}}\n\nDescribe:\n1. Layout changes\n2. Content changes (text, images)\n3. Style changes (colors, fonts)\n4. New or removed elements\n5. Significance score (1-10)\n\nIf this is the first capture, just describe the current page.",
                        outputVariable: "comparison"
                    }
                },
                {
                    id: "conditional-significant",
                    type: "conditional",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Significant Changes?",
                        condition:
                            "comparison.text.includes('significance: 7') || comparison.text.includes('significance: 8') || comparison.text.includes('significance: 9') || comparison.text.includes('significance: 10')",
                        outputVariable: "isSignificant"
                    }
                },
                {
                    id: "llm-summary",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Summarize Changes",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Create a brief alert summary of these website changes:\n\n{{comparison.text}}\n\nFormat as a Slack message with key changes highlighted.",
                        outputVariable: "alertSummary"
                    }
                },
                {
                    id: "integration-slack",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Send Alert",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#website-monitoring"
                    }
                },
                {
                    id: "shared-memory-set",
                    type: "shared-memory",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Update Baseline",
                        operation: "set",
                        key: "baseline_screenshot",
                        value: "{{currentScreenshot}}"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Monitor Result",
                        outputName: "result",
                        value: "{{comparison}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "trigger-1", target: "input-url" },
                { id: "e2", source: "input-url", target: "url-fetch" },
                { id: "e3", source: "url-fetch", target: "shared-memory-get" },
                { id: "e4", source: "shared-memory-get", target: "vision-compare" },
                { id: "e5", source: "vision-compare", target: "conditional-significant" },
                {
                    id: "e6",
                    source: "conditional-significant",
                    target: "llm-summary",
                    sourceHandle: "true"
                },
                {
                    id: "e7",
                    source: "conditional-significant",
                    target: "shared-memory-set",
                    sourceHandle: "false"
                },
                { id: "e8", source: "llm-summary", target: "integration-slack" },
                { id: "e9", source: "integration-slack", target: "shared-memory-set" },
                { id: "e10", source: "shared-memory-set", target: "output-1" }
            ]
        }
    },

    // Multimodal AI 8: Accessibility Image Auditor
    {
        name: "Accessibility Image Auditor",
        description:
            "Audit website images for accessibility compliance. Crawls pages, analyzes images for alt text quality, contrast issues, and generates a detailed accessibility report.",
        category: "multimodal-ai",
        tags: ["vision", "accessibility", "audit", "web", "compliance"],
        required_integrations: [],
        featured: false,
        definition: {
            name: "Accessibility Image Auditor",
            nodes: [
                {
                    id: "input-1",
                    type: "input",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Website URL",
                        inputName: "websiteUrl",
                        inputVariable: "websiteUrl",
                        inputType: "text",
                        description: "Enter the website URL to audit"
                    }
                },
                {
                    id: "url-fetch",
                    type: "url",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Fetch Page Content",
                        urlVariable: "websiteUrl",
                        scrapingMode: "full",
                        outputVariable: "pageContent"
                    }
                },
                {
                    id: "llm-extract",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Extract Image Info",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "From this page content, extract all images:\n\n{{pageContent.text}}\n\nFor each image, identify:\n1. Image source/URL\n2. Current alt text (if any)\n3. Context (surrounding text, purpose)\n4. Image type (decorative, informative, functional)\n\nReturn as JSON array.",
                        outputVariable: "imageList"
                    }
                },
                {
                    id: "loop-images",
                    type: "loop",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Audit Each Image",
                        loopType: "forEach",
                        collection: "{{imageList.text}}",
                        itemVariable: "currentImage",
                        indexVariable: "imageIndex"
                    }
                },
                {
                    id: "llm-audit",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Audit Image Accessibility",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Audit this image for accessibility:\n\n{{currentImage}}\n\nCheck:\n1. Alt text quality (descriptive, accurate, appropriate length)\n2. Missing alt text issues\n3. Decorative images that should have empty alt\n4. Functional images (buttons, links) with proper labels\n5. Text in images (should be avoided)\n\nProvide:\n- Issues found\n- Severity (critical, major, minor)\n- Recommended fix\n- Suggested alt text if missing/poor",
                        outputVariable: "auditResult"
                    }
                },
                {
                    id: "shared-memory-store",
                    type: "shared-memory",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Store Audit Result",
                        operation: "set",
                        key: "audit_{{imageIndex}}",
                        value: "{{auditResult.text}}"
                    }
                },
                {
                    id: "llm-report",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Accessibility Report",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Generate a comprehensive accessibility report based on these image audits:\n\nImages audited: {{imageList.text}}\n\nCreate a report with:\n1. Executive summary\n2. Overall accessibility score\n3. Critical issues (must fix)\n4. Major issues (should fix)\n5. Minor issues (nice to fix)\n6. Recommendations prioritized by impact",
                        outputVariable: "accessibilityReport"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Audit Report",
                        outputName: "result",
                        value: "{{accessibilityReport}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "input-1", target: "url-fetch" },
                { id: "e2", source: "url-fetch", target: "llm-extract" },
                { id: "e3", source: "llm-extract", target: "loop-images" },
                { id: "e4", source: "loop-images", target: "llm-audit" },
                { id: "e5", source: "llm-audit", target: "shared-memory-store" },
                { id: "e6", source: "shared-memory-store", target: "llm-report" },
                { id: "e7", source: "llm-report", target: "output-1" }
            ]
        }
    },

    // Multimodal AI 9: Real Estate Listing Enhancer
    {
        name: "Real Estate Listing Enhancer",
        description:
            "Enhance property listings with AI. Analyzes property photos, generates compelling descriptions, suggests virtual staging, and creates optimized listing copy.",
        category: "multimodal-ai",
        tags: ["vision", "real-estate", "listings", "copywriting", "marketing"],
        required_integrations: [],
        featured: false,
        definition: {
            name: "Real Estate Listing Enhancer",
            nodes: [
                {
                    id: "files-1",
                    type: "files",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Property Photos",
                        inputVariable: "propertyPhotos",
                        allowedTypes: ["image/*"],
                        description: "Upload property photos"
                    }
                },
                {
                    id: "input-details",
                    type: "input",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Property Details",
                        inputName: "propertyDetails",
                        inputVariable: "propertyDetails",
                        inputType: "text",
                        description: "Beds, baths, sqft, price, address, special features"
                    }
                },
                {
                    id: "vision-analyze",
                    type: "vision",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Analyze Property Photos",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Analyze these property photos and identify:\n\n1. Room types visible (living room, kitchen, bedroom, etc.)\n2. Key features (fireplace, hardwood floors, views, etc.)\n3. Style/design aesthetic (modern, traditional, farmhouse, etc.)\n4. Natural lighting quality\n5. Staging suggestions (furniture placement, decor)\n6. Photo quality issues (lighting, angles to improve)\n7. Unique selling points visible",
                        outputVariable: "photoAnalysis"
                    }
                },
                {
                    id: "llm-description",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Listing Description",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Create a compelling real estate listing based on:\n\nProperty Details: {{propertyDetails}}\nPhoto Analysis: {{photoAnalysis.text}}\n\nWrite:\n1. Attention-grabbing headline (10 words max)\n2. Full listing description (200-300 words)\n3. Feature highlights (bullet points)\n4. Neighborhood selling points\n5. Call-to-action\n\nUse emotional, descriptive language that helps buyers envision living there.",
                        outputVariable: "listingDescription"
                    }
                },
                {
                    id: "llm-staging",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Virtual Staging Suggestions",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Based on the photo analysis:\n\n{{photoAnalysis.text}}\n\nProvide virtual staging recommendations:\n1. Which rooms need staging?\n2. Furniture style recommendations\n3. Color palette suggestions\n4. Decor items to add\n5. Items to remove/declutter\n\nFor each room, describe the staging in enough detail for a virtual staging service.",
                        outputVariable: "stagingSuggestions"
                    }
                },
                {
                    id: "transform-package",
                    type: "transform",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Compile Listing Package",
                        transformType: "template",
                        template:
                            "# Enhanced Property Listing\n\n## Listing Copy\n{{listingDescription.text}}\n\n## Photo Analysis\n{{photoAnalysis.text}}\n\n## Virtual Staging Recommendations\n{{stagingSuggestions.text}}",
                        outputVariable: "listingPackage"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Enhanced Listing",
                        outputName: "result",
                        value: "{{listingPackage}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "files-1", target: "vision-analyze" },
                { id: "e2", source: "input-details", target: "llm-description" },
                { id: "e3", source: "vision-analyze", target: "llm-description" },
                { id: "e4", source: "vision-analyze", target: "llm-staging" },
                { id: "e5", source: "llm-description", target: "transform-package" },
                { id: "e6", source: "llm-staging", target: "transform-package" },
                { id: "e7", source: "transform-package", target: "output-1" }
            ]
        }
    },

    // Multimodal AI 10: Document OCR Pipeline
    {
        name: "Document OCR Pipeline",
        description:
            "Extract and structure text from scanned documents and images. Uses OCR to digitize documents, then AI to structure and validate the extracted data.",
        category: "multimodal-ai",
        tags: ["vision", "ocr", "documents", "extraction", "digitization"],
        required_integrations: [],
        featured: true,
        definition: {
            name: "Document OCR Pipeline",
            nodes: [
                {
                    id: "files-1",
                    type: "files",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Upload Documents",
                        inputVariable: "documents",
                        allowedTypes: ["image/*", "application/pdf"],
                        description: "Upload scanned documents or images"
                    }
                },
                {
                    id: "input-doctype",
                    type: "input",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Document Type",
                        inputName: "documentType",
                        inputVariable: "documentType",
                        inputType: "text",
                        description: "Type of document (invoice, receipt, form, contract, etc.)"
                    }
                },
                {
                    id: "vision-ocr",
                    type: "vision",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Extract Text (OCR)",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Extract ALL text from this {{documentType}} document. Preserve the layout structure as much as possible. Include:\n1. Headers and titles\n2. Form fields and values\n3. Tables (format as markdown)\n4. Handwritten text (mark as [handwritten])\n5. Stamps or signatures (describe)\n\nReturn the complete extracted text.",
                        outputVariable: "rawText"
                    }
                },
                {
                    id: "llm-structure",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Structure Extracted Data",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Structure this extracted {{documentType}} text into a clean JSON format:\n\n{{rawText.text}}\n\nIdentify and extract:\n1. Key fields (dates, amounts, names, addresses)\n2. Line items or table data\n3. Reference numbers\n4. Any validation concerns (unclear text, missing data)\n\nReturn well-structured JSON.",
                        outputVariable: "structuredData"
                    }
                },
                {
                    id: "llm-validate",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Validate Extracted Data",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Validate this extracted {{documentType}} data:\n\n{{structuredData.text}}\n\nCheck for:\n1. Mathematical accuracy (totals, calculations)\n2. Date format consistency\n3. Required fields present\n4. Logical consistency\n5. Confidence score for each field\n\nReturn validation results with any issues found.",
                        outputVariable: "validation"
                    }
                },
                {
                    id: "conditional-valid",
                    type: "conditional",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Data Valid?",
                        condition:
                            "!validation.text.includes('ERROR') && !validation.text.includes('CRITICAL')",
                        outputVariable: "isValid"
                    }
                },
                {
                    id: "output-success",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Extracted Data",
                        outputName: "result",
                        value: "{{structuredData}}"
                    }
                },
                {
                    id: "humanReview-1",
                    type: "humanReview",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Review Required",
                        reviewPrompt:
                            "OCR extraction needs review.\n\nValidation Issues:\n{{validation.text}}\n\nExtracted Data:\n{{structuredData.text}}\n\nPlease verify and correct.",
                        outputVariable: "reviewedData"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "files-1", target: "vision-ocr" },
                { id: "e2", source: "input-doctype", target: "vision-ocr" },
                { id: "e3", source: "vision-ocr", target: "llm-structure" },
                { id: "e4", source: "llm-structure", target: "llm-validate" },
                { id: "e5", source: "llm-validate", target: "conditional-valid" },
                {
                    id: "e6",
                    source: "conditional-valid",
                    target: "output-success",
                    sourceHandle: "true"
                },
                {
                    id: "e7",
                    source: "conditional-valid",
                    target: "humanReview-1",
                    sourceHandle: "false"
                },
                { id: "e8", source: "humanReview-1", target: "output-success" }
            ]
        }
    },

    // ========================================================================
    // KNOWLEDGE & RESEARCH (10 templates)
    // ========================================================================

    // Knowledge & Research 1: Document Q&A Assistant
    {
        name: "Document Q&A Assistant",
        description:
            "Answer questions using your knowledge base. Performs semantic search across uploaded documents and generates accurate answers with citations.",
        category: "knowledge-research",
        tags: ["kb-query", "rag", "q&a", "documents", "semantic-search"],
        required_integrations: [],
        featured: true,
        definition: {
            name: "Document Q&A Assistant",
            nodes: [
                {
                    id: "input-1",
                    type: "input",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Your Question",
                        inputName: "userQuestion",
                        inputVariable: "userQuestion",
                        inputType: "text",
                        description: "Ask a question about your documents"
                    }
                },
                {
                    id: "input-kb",
                    type: "input",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Knowledge Base ID",
                        inputName: "knowledgeBaseId",
                        inputVariable: "knowledgeBaseId",
                        inputType: "text",
                        description: "ID of the knowledge base to search"
                    }
                },
                {
                    id: "kb-query-1",
                    type: "knowledgeBaseQuery",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Search Knowledge Base",
                        knowledgeBaseId: "{{knowledgeBaseId}}",
                        query: "{{userQuestion}}",
                        topK: 5,
                        outputVariable: "relevantChunks"
                    }
                },
                {
                    id: "llm-answer",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Answer",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Answer this question using ONLY the provided context. If the answer is not in the context, say so.\n\nQuestion: {{userQuestion}}\n\nContext from documents:\n{{relevantChunks}}\n\nProvide:\n1. A clear, accurate answer\n2. Citations referencing specific documents\n3. Confidence level (high/medium/low)\n4. Related topics the user might want to explore",
                        outputVariable: "answer"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Answer",
                        outputName: "result",
                        value: "{{answer}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "input-1", target: "kb-query-1" },
                { id: "e2", source: "input-kb", target: "kb-query-1" },
                { id: "e3", source: "kb-query-1", target: "llm-answer" },
                { id: "e4", source: "llm-answer", target: "output-1" }
            ]
        }
    },

    // Knowledge & Research 2: Research Report Generator
    {
        name: "Research Report Generator",
        description:
            "Generate comprehensive research reports on any topic. Searches the web, aggregates sources, synthesizes findings, and produces a formatted report.",
        category: "knowledge-research",
        tags: ["web-search", "research", "report", "synthesis", "academic"],
        required_integrations: [],
        featured: true,
        definition: {
            name: "Research Report Generator",
            nodes: [
                {
                    id: "input-1",
                    type: "input",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Research Topic",
                        inputName: "researchTopic",
                        inputVariable: "researchTopic",
                        inputType: "text",
                        description: "What topic do you want to research?"
                    }
                },
                {
                    id: "llm-queries",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Search Queries",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Generate 5 diverse search queries to research this topic comprehensively:\n\n{{researchTopic}}\n\nInclude queries for:\n1. Overview/definition\n2. Recent developments\n3. Expert opinions\n4. Statistics/data\n5. Controversies or debates\n\nReturn as JSON array of query strings.",
                        outputVariable: "searchQueries"
                    }
                },
                {
                    id: "loop-queries",
                    type: "loop",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Execute Searches",
                        loopType: "forEach",
                        collection: "{{searchQueries.text}}",
                        itemVariable: "currentQuery",
                        indexVariable: "queryIndex"
                    }
                },
                {
                    id: "http-search",
                    type: "http",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Web Search",
                        method: "GET",
                        url: "https://api.search.example.com/search",
                        queryParams: { q: "{{currentQuery}}" },
                        outputVariable: "searchResults"
                    }
                },
                {
                    id: "llm-extract",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Extract Key Points",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Extract key findings from these search results for the query '{{currentQuery}}':\n\n{{searchResults}}\n\nProvide:\n1. Main points (bullet list)\n2. Source URLs\n3. Reliability assessment",
                        outputVariable: "extractedPoints"
                    }
                },
                {
                    id: "shared-memory-store",
                    type: "shared-memory",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Store Findings",
                        operation: "set",
                        key: "findings_{{queryIndex}}",
                        value: "{{extractedPoints.text}}"
                    }
                },
                {
                    id: "llm-synthesize",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Synthesize Report",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Create a comprehensive research report on '{{researchTopic}}' using all gathered findings.\n\nStructure:\n1. Executive Summary\n2. Introduction\n3. Key Findings (organized by theme)\n4. Analysis & Insights\n5. Conclusion\n6. Sources & References\n\nWrite in an academic but accessible style. Include citations.",
                        outputVariable: "researchReport"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Research Report",
                        outputName: "result",
                        value: "{{researchReport}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "input-1", target: "llm-queries" },
                { id: "e2", source: "llm-queries", target: "loop-queries" },
                { id: "e3", source: "loop-queries", target: "http-search" },
                { id: "e4", source: "http-search", target: "llm-extract" },
                { id: "e5", source: "llm-extract", target: "shared-memory-store" },
                { id: "e6", source: "shared-memory-store", target: "llm-synthesize" },
                { id: "e7", source: "llm-synthesize", target: "output-1" }
            ]
        }
    },

    // Knowledge & Research 3: Competitor Intelligence Crawler
    {
        name: "Competitor Intelligence Crawler",
        description:
            "Monitor competitor websites for pricing, features, and content changes. Crawls target pages, extracts data, compares to baseline, and alerts on changes.",
        category: "knowledge-research",
        tags: ["web-browse", "competitor", "intelligence", "monitoring", "alerts"],
        required_integrations: ["slack"],
        featured: false,
        definition: {
            name: "Competitor Intelligence Crawler",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Weekly Check",
                        triggerType: "schedule",
                        schedule: "0 9 * * 1",
                        description: "Run every Monday at 9 AM"
                    }
                },
                {
                    id: "input-urls",
                    type: "input",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Competitor URLs",
                        inputName: "competitorUrls",
                        inputVariable: "competitorUrls",
                        inputType: "text",
                        description: "Comma-separated list of competitor URLs to monitor"
                    }
                },
                {
                    id: "loop-urls",
                    type: "loop",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Crawl Each Competitor",
                        loopType: "forEach",
                        collection: "{{competitorUrls}}",
                        itemVariable: "currentUrl",
                        indexVariable: "urlIndex"
                    }
                },
                {
                    id: "url-fetch",
                    type: "url",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Fetch Page",
                        urlVariable: "currentUrl",
                        scrapingMode: "full",
                        outputVariable: "pageContent"
                    }
                },
                {
                    id: "llm-extract",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Extract Intelligence",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Extract competitive intelligence from this page:\n\n{{pageContent.text}}\n\nCapture:\n1. Pricing information (plans, tiers, amounts)\n2. Features listed\n3. New announcements or updates\n4. Customer testimonials or case studies\n5. Positioning and messaging themes\n\nReturn structured JSON.",
                        outputVariable: "extractedIntel"
                    }
                },
                {
                    id: "shared-memory-get",
                    type: "shared-memory",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get Previous Data",
                        operation: "get",
                        key: "competitor_{{urlIndex}}",
                        outputVariable: "previousIntel"
                    }
                },
                {
                    id: "llm-compare",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Compare Changes",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Compare current vs previous competitor data:\n\nCurrent: {{extractedIntel.text}}\nPrevious: {{previousIntel}}\n\nIdentify:\n1. Pricing changes\n2. New features added\n3. Features removed\n4. Messaging shifts\n5. Significance score (1-10)",
                        outputVariable: "comparison"
                    }
                },
                {
                    id: "shared-memory-set",
                    type: "shared-memory",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Update Baseline",
                        operation: "set",
                        key: "competitor_{{urlIndex}}",
                        value: "{{extractedIntel.text}}"
                    }
                },
                {
                    id: "llm-report",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Intel Report",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Create a competitive intelligence summary from all comparisons.\n\nFormat as a Slack-friendly report with:\n1. Key changes this week\n2. Pricing movements\n3. Feature gaps/opportunities\n4. Recommended actions",
                        outputVariable: "intelReport"
                    }
                },
                {
                    id: "integration-slack",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Post to Slack",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#competitive-intel"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Intelligence Report",
                        outputName: "result",
                        value: "{{intelReport}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "trigger-1", target: "input-urls" },
                { id: "e2", source: "input-urls", target: "loop-urls" },
                { id: "e3", source: "loop-urls", target: "url-fetch" },
                { id: "e4", source: "url-fetch", target: "llm-extract" },
                { id: "e5", source: "llm-extract", target: "shared-memory-get" },
                { id: "e6", source: "shared-memory-get", target: "llm-compare" },
                { id: "e7", source: "llm-compare", target: "shared-memory-set" },
                { id: "e8", source: "shared-memory-set", target: "llm-report" },
                { id: "e9", source: "llm-report", target: "integration-slack" },
                { id: "e10", source: "integration-slack", target: "output-1" }
            ]
        }
    },

    // Knowledge & Research 4: Academic Paper Summarizer
    {
        name: "Academic Paper Summarizer",
        description:
            "Summarize academic papers with context from related work. Extracts PDF content, queries knowledge base for related papers, and generates comprehensive summaries.",
        category: "knowledge-research",
        tags: ["pdf", "academic", "summary", "kb-query", "research"],
        required_integrations: [],
        featured: false,
        definition: {
            name: "Academic Paper Summarizer",
            nodes: [
                {
                    id: "files-1",
                    type: "files",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Upload Paper PDF",
                        inputVariable: "paperPdf",
                        allowedTypes: ["application/pdf"],
                        description: "Upload academic paper to summarize"
                    }
                },
                {
                    id: "llm-extract-pdf",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Extract PDF Content",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Extract the full content from this academic paper PDF. Identify:\n1. Title and authors\n2. Abstract\n3. Key sections (Introduction, Methods, Results, Discussion, Conclusion)\n4. Key figures and tables (describe)\n5. References",
                        outputVariable: "paperContent"
                    }
                },
                {
                    id: "llm-keywords",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Extract Keywords",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Extract key terms and concepts from this paper for semantic search:\n\n{{paperContent.text}}\n\nReturn 10-15 keywords/phrases that capture the main topics.",
                        outputVariable: "keywords"
                    }
                },
                {
                    id: "kb-query-1",
                    type: "knowledgeBaseQuery",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Find Related Papers",
                        query: "{{keywords.text}}",
                        topK: 5,
                        outputVariable: "relatedPapers"
                    }
                },
                {
                    id: "llm-summary",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Summary",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Create a comprehensive summary of this academic paper:\n\n{{paperContent.text}}\n\nRelated work in the knowledge base:\n{{relatedPapers}}\n\nProvide:\n1. One-paragraph summary\n2. Key contributions (3-5 points)\n3. Methodology overview\n4. Main findings\n5. Limitations noted\n6. How this relates to other papers in the field\n7. Potential follow-up research questions",
                        outputVariable: "paperSummary"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Paper Summary",
                        outputName: "result",
                        value: "{{paperSummary}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "files-1", target: "llm-extract-pdf" },
                { id: "e2", source: "llm-extract-pdf", target: "llm-keywords" },
                { id: "e3", source: "llm-keywords", target: "kb-query-1" },
                { id: "e4", source: "kb-query-1", target: "llm-summary" },
                { id: "e5", source: "llm-extract-pdf", target: "llm-summary" },
                { id: "e6", source: "llm-summary", target: "output-1" }
            ]
        }
    },

    // Knowledge & Research 5: News Aggregator & Analyzer
    {
        name: "News Aggregator & Analyzer",
        description:
            "Aggregate and analyze industry news daily. Searches multiple sources, clusters articles by topic, identifies trends, and generates a digest.",
        category: "knowledge-research",
        tags: ["news", "aggregation", "analysis", "embeddings", "digest"],
        required_integrations: ["slack"],
        featured: false,
        definition: {
            name: "News Aggregator & Analyzer",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Daily 6 AM",
                        triggerType: "schedule",
                        schedule: "0 6 * * *"
                    }
                },
                {
                    id: "input-topics",
                    type: "input",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "News Topics",
                        inputName: "newsTopics",
                        inputVariable: "newsTopics",
                        inputType: "text",
                        defaultValue: "AI, machine learning, technology startups"
                    }
                },
                {
                    id: "llm-queries",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate News Queries",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Generate 5 news search queries for these topics: {{newsTopics}}\n\nFocus on recent news (last 24 hours). Return as JSON array.",
                        outputVariable: "newsQueries"
                    }
                },
                {
                    id: "loop-queries",
                    type: "loop",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Search Each Query",
                        loopType: "forEach",
                        collection: "{{newsQueries.text}}",
                        itemVariable: "query",
                        indexVariable: "queryIndex"
                    }
                },
                {
                    id: "http-news",
                    type: "http",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Fetch News",
                        method: "GET",
                        url: "https://newsapi.example.com/search",
                        queryParams: { q: "{{query}}", recent: "24h" },
                        outputVariable: "newsResults"
                    }
                },
                {
                    id: "embeddings-1",
                    type: "embeddings",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Embeddings",
                        provider: "openai",
                        model: "text-embedding-3-small",
                        input: "{{newsResults}}",
                        outputVariable: "articleEmbeddings"
                    }
                },
                {
                    id: "shared-memory-store",
                    type: "shared-memory",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Store Articles",
                        operation: "set",
                        key: "articles_{{queryIndex}}",
                        value: "{{newsResults}}"
                    }
                },
                {
                    id: "code-cluster",
                    type: "code",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Cluster Articles",
                        language: "javascript",
                        code: "// Cluster articles by embedding similarity\nconst clusters = {}; // Simplified clustering\nreturn { clusters: Object.keys(clusters), articleCount: inputs.articles?.length || 0 };",
                        outputVariable: "clusteredArticles"
                    }
                },
                {
                    id: "llm-digest",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate News Digest",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Create a news digest for {{newsTopics}}:\n\nArticles collected: {{clusteredArticles}}\n\nProvide:\n1. Top 5 stories with summaries\n2. Emerging trends\n3. Notable quotes\n4. What to watch this week\n\nFormat for Slack with emoji and clear sections.",
                        outputVariable: "newsDigest"
                    }
                },
                {
                    id: "integration-slack",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Send Digest",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#news-digest"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Digest",
                        outputName: "result",
                        value: "{{newsDigest}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "trigger-1", target: "input-topics" },
                { id: "e2", source: "input-topics", target: "llm-queries" },
                { id: "e3", source: "llm-queries", target: "loop-queries" },
                { id: "e4", source: "loop-queries", target: "http-news" },
                { id: "e5", source: "http-news", target: "embeddings-1" },
                { id: "e6", source: "embeddings-1", target: "shared-memory-store" },
                { id: "e7", source: "shared-memory-store", target: "code-cluster" },
                { id: "e8", source: "code-cluster", target: "llm-digest" },
                { id: "e9", source: "llm-digest", target: "integration-slack" },
                { id: "e10", source: "integration-slack", target: "output-1" }
            ]
        }
    },

    // Knowledge & Research 6: FAQ Auto-Generator
    {
        name: "FAQ Auto-Generator",
        description:
            "Automatically generate FAQs from your knowledge base. Analyzes documents to identify common topics and generates question-answer pairs.",
        category: "knowledge-research",
        tags: ["kb-query", "faq", "content", "automation", "documentation"],
        required_integrations: [],
        featured: false,
        definition: {
            name: "FAQ Auto-Generator",
            nodes: [
                {
                    id: "input-kb",
                    type: "input",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Knowledge Base ID",
                        inputName: "knowledgeBaseId",
                        inputVariable: "knowledgeBaseId",
                        inputType: "text"
                    }
                },
                {
                    id: "input-topic",
                    type: "input",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "FAQ Topic",
                        inputName: "faqTopic",
                        inputVariable: "faqTopic",
                        inputType: "text",
                        description: "What topic should the FAQ cover?"
                    }
                },
                {
                    id: "kb-query-1",
                    type: "knowledgeBaseQuery",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Sample KB Documents",
                        knowledgeBaseId: "{{knowledgeBaseId}}",
                        query: "{{faqTopic}}",
                        topK: 20,
                        outputVariable: "sampleDocs"
                    }
                },
                {
                    id: "llm-topics",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Identify FAQ Topics",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Analyze these knowledge base documents about {{faqTopic}}:\n\n{{sampleDocs}}\n\nIdentify 10-15 common questions users might ask. Consider:\n1. Basic concepts that need explaining\n2. Common confusion points\n3. How-to questions\n4. Troubleshooting questions\n5. Comparison questions\n\nReturn as JSON array of question strings.",
                        outputVariable: "faqQuestions"
                    }
                },
                {
                    id: "loop-questions",
                    type: "loop",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Each Answer",
                        loopType: "forEach",
                        collection: "{{faqQuestions.text}}",
                        itemVariable: "question",
                        indexVariable: "qIndex"
                    }
                },
                {
                    id: "kb-query-answer",
                    type: "knowledgeBaseQuery",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Find Answer Context",
                        knowledgeBaseId: "{{knowledgeBaseId}}",
                        query: "{{question}}",
                        topK: 3,
                        outputVariable: "answerContext"
                    }
                },
                {
                    id: "llm-answer",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Answer",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Answer this FAQ question using the provided context:\n\nQuestion: {{question}}\n\nContext: {{answerContext}}\n\nProvide a clear, helpful answer (100-200 words). Include any relevant links or references.",
                        outputVariable: "faqAnswer"
                    }
                },
                {
                    id: "shared-memory-store",
                    type: "shared-memory",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Store Q&A Pair",
                        operation: "set",
                        key: "faq_{{qIndex}}",
                        value: '{"q": "{{question}}", "a": "{{faqAnswer.text}}"}'
                    }
                },
                {
                    id: "transform-compile",
                    type: "transform",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Compile FAQ Document",
                        transformType: "template",
                        template:
                            "# Frequently Asked Questions: {{faqTopic}}\n\nGenerated from your knowledge base.\n\n{{faqQuestions.text}}",
                        outputVariable: "faqDocument"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "FAQ Document",
                        outputName: "result",
                        value: "{{faqDocument}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "input-kb", target: "kb-query-1" },
                { id: "e2", source: "input-topic", target: "kb-query-1" },
                { id: "e3", source: "kb-query-1", target: "llm-topics" },
                { id: "e4", source: "llm-topics", target: "loop-questions" },
                { id: "e5", source: "loop-questions", target: "kb-query-answer" },
                { id: "e6", source: "kb-query-answer", target: "llm-answer" },
                { id: "e7", source: "llm-answer", target: "shared-memory-store" },
                { id: "e8", source: "shared-memory-store", target: "transform-compile" },
                { id: "e9", source: "transform-compile", target: "output-1" }
            ]
        }
    },

    // Knowledge & Research 7: Citation Finder
    {
        name: "Citation Finder",
        description:
            "Find credible citations for claims or statements. Searches the web, evaluates source credibility, and returns verified citations with quotes.",
        category: "knowledge-research",
        tags: ["research", "citations", "verification", "fact-check", "academic"],
        required_integrations: [],
        featured: false,
        definition: {
            name: "Citation Finder",
            nodes: [
                {
                    id: "input-1",
                    type: "input",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Statement to Verify",
                        inputName: "statement",
                        inputVariable: "statement",
                        inputType: "text",
                        description: "Enter the claim or statement that needs citations"
                    }
                },
                {
                    id: "llm-queries",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Search Queries",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Generate 5 search queries to find credible sources for this statement:\n\n{{statement}}\n\nFocus on academic, government, and reputable news sources. Return as JSON array.",
                        outputVariable: "searchQueries"
                    }
                },
                {
                    id: "loop-search",
                    type: "loop",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Search Sources",
                        loopType: "forEach",
                        collection: "{{searchQueries.text}}",
                        itemVariable: "query",
                        indexVariable: "queryIndex",
                        maxIterations: 10
                    }
                },
                {
                    id: "http-search",
                    type: "http",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Web Search",
                        method: "GET",
                        url: "https://api.search.example.com/search",
                        queryParams: { q: "{{query}}" },
                        outputVariable: "searchResults"
                    }
                },
                {
                    id: "url-fetch",
                    type: "url",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Fetch Source",
                        urlVariable: "searchResults.url",
                        scrapingMode: "article",
                        outputVariable: "sourceContent"
                    }
                },
                {
                    id: "llm-extract",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Extract Citation",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Extract citation information from this source:\n\nSource: {{sourceContent.text}}\n\nFor the statement: {{statement}}\n\nProvide:\n1. Relevant quote that supports the statement\n2. Author and publication\n3. Date published\n4. Credibility score (1-10) with reasoning\n5. Citation in APA format\n\nIf this source doesn't support the statement, say so.",
                        outputVariable: "citation"
                    }
                },
                {
                    id: "shared-memory-store",
                    type: "shared-memory",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Store Citation",
                        operation: "set",
                        key: "citation_{{queryIndex}}",
                        value: "{{citation.text}}"
                    }
                },
                {
                    id: "llm-compile",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Compile Citations",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Compile and rank the citations found for: {{statement}}\n\nRank by credibility. Provide:\n1. Top 3 most credible citations with full details\n2. Summary of supporting evidence\n3. Any contradicting sources found\n4. Overall confidence level for the statement",
                        outputVariable: "citationReport"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Citations",
                        outputName: "result",
                        value: "{{citationReport}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "input-1", target: "llm-queries" },
                { id: "e2", source: "llm-queries", target: "loop-search" },
                { id: "e3", source: "loop-search", target: "http-search" },
                { id: "e4", source: "http-search", target: "url-fetch" },
                { id: "e5", source: "url-fetch", target: "llm-extract" },
                { id: "e6", source: "llm-extract", target: "shared-memory-store" },
                { id: "e7", source: "shared-memory-store", target: "llm-compile" },
                { id: "e8", source: "llm-compile", target: "output-1" }
            ]
        }
    },

    // Knowledge & Research 8: Knowledge Gap Analyzer
    {
        name: "Knowledge Gap Analyzer",
        description:
            "Identify gaps in your knowledge base coverage. Analyzes document embeddings to find sparse regions and suggests content to create.",
        category: "knowledge-research",
        tags: ["kb-query", "embeddings", "analysis", "content-strategy", "gaps"],
        required_integrations: [],
        featured: false,
        definition: {
            name: "Knowledge Gap Analyzer",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Monthly Analysis",
                        triggerType: "schedule",
                        schedule: "0 9 1 * *"
                    }
                },
                {
                    id: "input-kb",
                    type: "input",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Knowledge Base ID",
                        inputName: "knowledgeBaseId",
                        inputVariable: "knowledgeBaseId",
                        inputType: "text"
                    }
                },
                {
                    id: "input-domain",
                    type: "input",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Domain/Topic Area",
                        inputName: "domain",
                        inputVariable: "domain",
                        inputType: "text",
                        description:
                            "What domain should the KB cover? (e.g., Product Documentation)"
                    }
                },
                {
                    id: "llm-topics",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Define Expected Topics",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "For a knowledge base about '{{domain}}', list all topics that should ideally be covered.\n\nProvide 20-30 topics/subtopics organized by category. Return as JSON with category and topic fields.",
                        outputVariable: "expectedTopics"
                    }
                },
                {
                    id: "loop-topics",
                    type: "loop",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Check Each Topic",
                        loopType: "forEach",
                        collection: "{{expectedTopics.text}}",
                        itemVariable: "topic",
                        indexVariable: "topicIndex"
                    }
                },
                {
                    id: "kb-query-1",
                    type: "knowledgeBaseQuery",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Search for Topic",
                        knowledgeBaseId: "{{knowledgeBaseId}}",
                        query: "{{topic}}",
                        topK: 3,
                        outputVariable: "topicResults"
                    }
                },
                {
                    id: "llm-assess",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Assess Coverage",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: 'Assess knowledge base coverage for topic: {{topic}}\n\nResults found: {{topicResults}}\n\nRate coverage:\n- GOOD: Comprehensive content exists\n- PARTIAL: Some content, but gaps\n- MISSING: No relevant content\n\nReturn: {"topic": "{{topic}}", "coverage": "GOOD|PARTIAL|MISSING", "gap_description": "..."}',
                        outputVariable: "coverageAssessment"
                    }
                },
                {
                    id: "shared-memory-store",
                    type: "shared-memory",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Store Assessment",
                        operation: "set",
                        key: "coverage_{{topicIndex}}",
                        value: "{{coverageAssessment.text}}"
                    }
                },
                {
                    id: "llm-report",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Gap Report",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Create a knowledge gap analysis report for {{domain}}.\n\nAnalyze all coverage assessments and provide:\n1. Executive summary\n2. Coverage overview (% good, partial, missing)\n3. Critical gaps (missing topics that are essential)\n4. Partial coverage improvements\n5. Content creation priority list\n6. Suggested content outlines for top 5 gaps",
                        outputVariable: "gapReport"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Gap Analysis Report",
                        outputName: "result",
                        value: "{{gapReport}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "trigger-1", target: "input-kb" },
                { id: "e2", source: "input-kb", target: "input-domain" },
                { id: "e3", source: "input-domain", target: "llm-topics" },
                { id: "e4", source: "llm-topics", target: "loop-topics" },
                { id: "e5", source: "loop-topics", target: "kb-query-1" },
                { id: "e6", source: "kb-query-1", target: "llm-assess" },
                { id: "e7", source: "llm-assess", target: "shared-memory-store" },
                { id: "e8", source: "shared-memory-store", target: "llm-report" },
                { id: "e9", source: "llm-report", target: "output-1" }
            ]
        }
    },

    // Knowledge & Research 9: Patent Search Assistant
    {
        name: "Patent Search Assistant",
        description:
            "Search and analyze patents for prior art research. Generates search queries, fetches patent data, and provides landscape analysis.",
        category: "knowledge-research",
        tags: ["patents", "research", "legal", "prior-art", "ip"],
        required_integrations: [],
        featured: false,
        definition: {
            name: "Patent Search Assistant",
            nodes: [
                {
                    id: "input-1",
                    type: "input",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Invention Description",
                        inputName: "inventionDescription",
                        inputVariable: "inventionDescription",
                        inputType: "text",
                        description: "Describe your invention or technology"
                    }
                },
                {
                    id: "llm-queries",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Patent Queries",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Generate patent search queries for this invention:\n\n{{inventionDescription}}\n\nCreate:\n1. CPC classification codes to search\n2. Keyword combinations\n3. Key technical terms\n4. Alternative terminology\n\nReturn 10 search queries optimized for patent databases.",
                        outputVariable: "patentQueries"
                    }
                },
                {
                    id: "loop-search",
                    type: "loop",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Search Patents",
                        loopType: "forEach",
                        collection: "{{patentQueries.text}}",
                        itemVariable: "query",
                        indexVariable: "queryIndex"
                    }
                },
                {
                    id: "http-patent",
                    type: "http",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Query Patent API",
                        method: "GET",
                        url: "https://patents.example.com/api/search",
                        queryParams: { q: "{{query}}" },
                        outputVariable: "patentResults"
                    }
                },
                {
                    id: "llm-analyze",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Analyze Patent",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Analyze this patent relative to the invention:\n\nInvention: {{inventionDescription}}\nPatent: {{patentResults}}\n\nProvide:\n1. Patent number and title\n2. Key claims summary\n3. Similarity to invention (1-10)\n4. Overlapping features\n5. Distinguishing features\n6. Risk assessment (high/medium/low)",
                        outputVariable: "patentAnalysis"
                    }
                },
                {
                    id: "shared-memory-store",
                    type: "shared-memory",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Store Analysis",
                        operation: "set",
                        key: "patent_{{queryIndex}}",
                        value: "{{patentAnalysis.text}}"
                    }
                },
                {
                    id: "llm-landscape",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Patent Landscape",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Create a patent landscape report for:\n\n{{inventionDescription}}\n\nBased on the analyzed patents, provide:\n1. Executive summary\n2. Key players in the space\n3. Technology trends\n4. White space opportunities\n5. Freedom to operate assessment\n6. Recommended next steps",
                        outputVariable: "landscapeReport"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Patent Landscape",
                        outputName: "result",
                        value: "{{landscapeReport}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "input-1", target: "llm-queries" },
                { id: "e2", source: "llm-queries", target: "loop-search" },
                { id: "e3", source: "loop-search", target: "http-patent" },
                { id: "e4", source: "http-patent", target: "llm-analyze" },
                { id: "e5", source: "llm-analyze", target: "shared-memory-store" },
                { id: "e6", source: "shared-memory-store", target: "llm-landscape" },
                { id: "e7", source: "llm-landscape", target: "output-1" }
            ]
        }
    },

    // Knowledge & Research 10: Meeting Knowledge Extractor
    {
        name: "Meeting Knowledge Extractor",
        description:
            "Extract and store knowledge from meeting recordings. Transcribes audio, extracts decisions and action items, and stores insights in knowledge base.",
        category: "knowledge-research",
        tags: ["audio", "meetings", "transcription", "kb-query", "extraction"],
        required_integrations: ["slack", "notion"],
        featured: true,
        definition: {
            name: "Meeting Knowledge Extractor",
            nodes: [
                {
                    id: "files-1",
                    type: "files",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Meeting Recording",
                        inputVariable: "meetingAudio",
                        allowedTypes: ["audio/*", "video/*"],
                        description: "Upload meeting recording"
                    }
                },
                {
                    id: "input-context",
                    type: "input",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Meeting Context",
                        inputName: "meetingContext",
                        inputVariable: "meetingContext",
                        inputType: "text",
                        description: "Meeting type, attendees, agenda (optional)"
                    }
                },
                {
                    id: "audioInput-1",
                    type: "audioInput",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Transcribe Meeting",
                        provider: "openai",
                        model: "whisper-1",
                        inputVariable: "meetingAudio",
                        outputVariable: "transcript"
                    }
                },
                {
                    id: "llm-extract",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Extract Key Information",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Extract key information from this meeting transcript:\n\nContext: {{meetingContext}}\n\nTranscript:\n{{transcript.text}}\n\nExtract:\n1. Decisions made (with context and rationale)\n2. Action items (owner, due date, description)\n3. Key topics discussed\n4. Open questions/parking lot items\n5. Attendee contributions\n6. Follow-up meetings needed",
                        outputVariable: "extractedInfo"
                    }
                },
                {
                    id: "kb-query-1",
                    type: "knowledgeBaseQuery",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Find Related Decisions",
                        query: "{{extractedInfo.text}}",
                        topK: 5,
                        outputVariable: "relatedDecisions"
                    }
                },
                {
                    id: "llm-contextualize",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Contextualize with History",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Contextualize today's meeting decisions with historical context:\n\nNew decisions: {{extractedInfo.text}}\n\nRelated past decisions: {{relatedDecisions}}\n\nIdentify:\n1. How new decisions relate to past ones\n2. Any changes in direction\n3. Consistent themes\n4. Potential conflicts with past decisions",
                        outputVariable: "contextualizedInfo"
                    }
                },
                {
                    id: "integration-notion",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Save to Notion",
                        provider: "notion",
                        operation: "createPage",
                        database: "Meeting Notes"
                    }
                },
                {
                    id: "llm-summary",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Create Slack Summary",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Create a brief Slack summary of the meeting:\n\n{{extractedInfo.text}}\n\nFormat with emoji, keep under 500 characters. Focus on decisions and action items.",
                        outputVariable: "slackSummary"
                    }
                },
                {
                    id: "integration-slack",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Post Summary",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#team-updates"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Meeting Insights",
                        outputName: "result",
                        value: "{{contextualizedInfo}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "files-1", target: "audioInput-1" },
                { id: "e2", source: "input-context", target: "llm-extract" },
                { id: "e3", source: "audioInput-1", target: "llm-extract" },
                { id: "e4", source: "llm-extract", target: "kb-query-1" },
                { id: "e5", source: "kb-query-1", target: "llm-contextualize" },
                { id: "e6", source: "llm-contextualize", target: "integration-notion" },
                { id: "e7", source: "llm-extract", target: "llm-summary" },
                { id: "e8", source: "llm-summary", target: "integration-slack" },
                { id: "e9", source: "integration-notion", target: "output-1" },
                { id: "e10", source: "integration-slack", target: "output-1" }
            ]
        }
    },

    // ========================================================================
    // DOCUMENT PROCESSING (10 templates)
    // ========================================================================

    // Document Processing 1: Invoice Processor
    {
        name: "Invoice Processor",
        description:
            "Extract and validate invoice data automatically. Uses OCR and AI to parse invoices, validate amounts, and route for approval based on thresholds.",
        category: "finance",
        tags: ["ocr", "invoice", "finance", "extraction", "approval"],
        required_integrations: ["slack"],
        featured: true,
        definition: {
            name: "Invoice Processor",
            nodes: [
                {
                    id: "files-1",
                    type: "files",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Upload Invoices",
                        inputVariable: "invoices",
                        allowedTypes: ["image/*", "application/pdf"],
                        description: "Upload invoice images or PDFs"
                    }
                },
                {
                    id: "loop-invoices",
                    type: "loop",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Process Each Invoice",
                        loopType: "forEach",
                        collection: "{{invoices}}",
                        itemVariable: "currentInvoice",
                        indexVariable: "invoiceIndex"
                    }
                },
                {
                    id: "vision-ocr",
                    type: "vision",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Extract Invoice Data",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Extract all data from this invoice:\n\n1. Vendor name and address\n2. Invoice number\n3. Invoice date\n4. Due date\n5. Line items (description, quantity, unit price, total)\n6. Subtotal, tax, total amount\n7. Payment terms\n8. Bank details if present\n\nReturn as structured JSON.",
                        outputVariable: "invoiceData"
                    }
                },
                {
                    id: "llm-validate",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Validate Invoice",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: 'Validate this invoice data:\n\n{{invoiceData.text}}\n\nCheck:\n1. Math accuracy (line items = subtotal, subtotal + tax = total)\n2. Required fields present\n3. Date validity\n4. Suspicious patterns\n\nReturn: {"valid": true/false, "issues": [...], "totalAmount": number}',
                        outputVariable: "validation"
                    }
                },
                {
                    id: "code-parse",
                    type: "code",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Parse Amount",
                        language: "javascript",
                        code: "const data = JSON.parse(inputs.validation.text);\nreturn { amount: data.totalAmount, valid: data.valid };",
                        outputVariable: "parsedData"
                    }
                },
                {
                    id: "conditional-amount",
                    type: "conditional",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Amount > $10,000?",
                        condition: "parsedData.amount > 10000",
                        outputVariable: "needsApproval"
                    }
                },
                {
                    id: "humanReview-1",
                    type: "humanReview",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Manager Approval",
                        reviewPrompt:
                            "High-value invoice requires approval:\n\nAmount: ${{parsedData.amount}}\nVendor: {{invoiceData.text}}\n\nPlease approve or reject.",
                        outputVariable: "approvalDecision"
                    }
                },
                {
                    id: "integration-slack",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Notify Finance",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#finance-approvals"
                    }
                },
                {
                    id: "llm-log",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Auto-Approve Log",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Generate an auto-approval log entry for invoice:\n\n{{invoiceData.text}}\n\nAmount: ${{parsedData.amount}} (under threshold)",
                        outputVariable: "approvalLog"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Processed Invoice",
                        outputName: "result",
                        value: "{{invoiceData}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "files-1", target: "loop-invoices" },
                { id: "e2", source: "loop-invoices", target: "vision-ocr" },
                { id: "e3", source: "vision-ocr", target: "llm-validate" },
                { id: "e4", source: "llm-validate", target: "code-parse" },
                { id: "e5", source: "code-parse", target: "conditional-amount" },
                {
                    id: "e6",
                    source: "conditional-amount",
                    target: "humanReview-1",
                    sourceHandle: "true"
                },
                {
                    id: "e7",
                    source: "conditional-amount",
                    target: "llm-log",
                    sourceHandle: "false"
                },
                { id: "e8", source: "humanReview-1", target: "integration-slack" },
                { id: "e9", source: "integration-slack", target: "output-1" },
                { id: "e10", source: "llm-log", target: "output-1" }
            ]
        }
    },

    // Document Processing 2: Contract Analyzer
    {
        name: "Contract Analyzer",
        description:
            "Analyze contracts for key terms, risks, and obligations. Extracts content, classifies contract type, and performs type-specific analysis.",
        category: "document-processing",
        tags: ["pdf", "contract", "legal", "analysis", "switch"],
        required_integrations: [],
        featured: true,
        definition: {
            name: "Contract Analyzer",
            nodes: [
                {
                    id: "files-1",
                    type: "files",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Upload Contract",
                        inputVariable: "contractFile",
                        allowedTypes: ["application/pdf"],
                        description: "Upload contract PDF"
                    }
                },
                {
                    id: "llm-extract",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Extract Contract Text",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Extract all text from this contract PDF, preserving structure:\n\n1. Parties involved\n2. Effective date\n3. All sections and clauses\n4. Signatures\n\nMaintain section numbering and formatting.",
                        outputVariable: "contractText"
                    }
                },
                {
                    id: "llm-classify",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Classify Contract Type",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Classify this contract type:\n\n{{contractText.text}}\n\nReturn one of: NDA, MSA, SOW, EMPLOYMENT, LEASE, SALES, OTHER\n\nReturn only the classification word.",
                        outputVariable: "contractType"
                    }
                },
                {
                    id: "switch-type",
                    type: "switch",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Route by Type",
                        expression: "{{contractType.text}}",
                        cases: [
                            { value: "NDA", label: "NDA" },
                            { value: "MSA", label: "MSA" },
                            { value: "SOW", label: "SOW" },
                            { value: "EMPLOYMENT", label: "Employment" }
                        ],
                        defaultCase: "OTHER"
                    }
                },
                {
                    id: "llm-nda",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Analyze NDA",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Analyze this NDA:\n\n{{contractText.text}}\n\nExtract:\n1. Confidentiality scope\n2. Duration\n3. Permitted disclosures\n4. Return of materials clause\n5. Jurisdiction\n6. Risk assessment",
                        outputVariable: "ndaAnalysis"
                    }
                },
                {
                    id: "llm-msa",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Analyze MSA",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Analyze this Master Service Agreement:\n\n{{contractText.text}}\n\nExtract:\n1. Service descriptions\n2. Payment terms\n3. SLAs\n4. Liability limitations\n5. Termination clauses\n6. IP ownership\n7. Risk assessment",
                        outputVariable: "msaAnalysis"
                    }
                },
                {
                    id: "llm-sow",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Analyze SOW",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Analyze this Statement of Work:\n\n{{contractText.text}}\n\nExtract:\n1. Deliverables\n2. Timeline/milestones\n3. Acceptance criteria\n4. Pricing structure\n5. Change management process\n6. Risk assessment",
                        outputVariable: "sowAnalysis"
                    }
                },
                {
                    id: "llm-general",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "General Analysis",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Analyze this contract:\n\n{{contractText.text}}\n\nProvide:\n1. Key terms summary\n2. Obligations by party\n3. Important dates\n4. Termination conditions\n5. Risk assessment\n6. Unusual clauses",
                        outputVariable: "generalAnalysis"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Contract Analysis",
                        outputName: "result",
                        value: "{{contractType}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "files-1", target: "llm-extract" },
                { id: "e2", source: "llm-extract", target: "llm-classify" },
                { id: "e3", source: "llm-classify", target: "switch-type" },
                { id: "e4", source: "switch-type", target: "llm-nda", sourceHandle: "NDA" },
                { id: "e5", source: "switch-type", target: "llm-msa", sourceHandle: "MSA" },
                { id: "e6", source: "switch-type", target: "llm-sow", sourceHandle: "SOW" },
                { id: "e7", source: "switch-type", target: "llm-general", sourceHandle: "default" },
                { id: "e8", source: "llm-nda", target: "output-1" },
                { id: "e9", source: "llm-msa", target: "output-1" },
                { id: "e10", source: "llm-sow", target: "output-1" },
                { id: "e11", source: "llm-general", target: "output-1" }
            ]
        }
    },

    // Document Processing 3: Resume Screener
    {
        name: "Resume Screener",
        description:
            "Screen resumes against job requirements. Batch processes resumes, scores candidates, and generates a ranked screening report.",
        category: "hr",
        tags: ["hr", "resume", "screening", "loop", "scoring"],
        required_integrations: [],
        featured: false,
        definition: {
            name: "Resume Screener",
            nodes: [
                {
                    id: "files-1",
                    type: "files",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Upload Resumes",
                        inputVariable: "resumes",
                        allowedTypes: ["application/pdf", "image/*"],
                        description: "Upload resume batch"
                    }
                },
                {
                    id: "input-jd",
                    type: "input",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Job Description",
                        inputName: "jobDescription",
                        inputVariable: "jobDescription",
                        inputType: "text",
                        description: "Paste the job description and requirements"
                    }
                },
                {
                    id: "llm-criteria",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Extract Scoring Criteria",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "From this job description, extract scoring criteria:\n\n{{jobDescription}}\n\nCreate a rubric with:\n1. Required skills (must-have, weight: 40%)\n2. Preferred skills (nice-to-have, weight: 20%)\n3. Experience level (weight: 25%)\n4. Education requirements (weight: 15%)\n\nReturn as JSON with criteria and weights.",
                        outputVariable: "scoringCriteria"
                    }
                },
                {
                    id: "loop-resumes",
                    type: "loop",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Screen Each Resume",
                        loopType: "forEach",
                        collection: "{{resumes}}",
                        itemVariable: "currentResume",
                        indexVariable: "resumeIndex"
                    }
                },
                {
                    id: "vision-extract",
                    type: "vision",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Extract Resume Content",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Extract all information from this resume:\n\n1. Name and contact info\n2. Summary/objective\n3. Work experience (company, role, dates, achievements)\n4. Education\n5. Skills\n6. Certifications",
                        outputVariable: "resumeContent"
                    }
                },
                {
                    id: "llm-score",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Score Candidate",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Score this candidate against the criteria:\n\nResume: {{resumeContent.text}}\n\nCriteria: {{scoringCriteria.text}}\n\nProvide:\n1. Overall score (0-100)\n2. Score breakdown by category\n3. Matching qualifications\n4. Missing qualifications\n5. Red flags\n6. Interview recommendation (yes/maybe/no)",
                        outputVariable: "candidateScore"
                    }
                },
                {
                    id: "shared-memory-store",
                    type: "shared-memory",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Store Score",
                        operation: "set",
                        key: "candidate_{{resumeIndex}}",
                        value: "{{candidateScore.text}}"
                    }
                },
                {
                    id: "llm-rank",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Rank Candidates",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Compile a screening report ranking all candidates.\n\nProvide:\n1. Top candidates (interview recommended)\n2. Maybe pile (conditional interview)\n3. Not recommended\n4. Summary statistics\n5. Hiring recommendations",
                        outputVariable: "screeningReport"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Screening Report",
                        outputName: "result",
                        value: "{{screeningReport}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "files-1", target: "loop-resumes" },
                { id: "e2", source: "input-jd", target: "llm-criteria" },
                { id: "e3", source: "llm-criteria", target: "loop-resumes" },
                { id: "e4", source: "loop-resumes", target: "vision-extract" },
                { id: "e5", source: "vision-extract", target: "llm-score" },
                { id: "e6", source: "llm-score", target: "shared-memory-store" },
                { id: "e7", source: "shared-memory-store", target: "llm-rank" },
                { id: "e8", source: "llm-rank", target: "output-1" }
            ]
        }
    },

    // Document Processing 4: Form Digitizer
    {
        name: "Form Digitizer",
        description:
            "Convert paper forms into structured digital data. Uses OCR to extract form fields, parses into structured data, and validates with human review for low-confidence results.",
        category: "document-processing",
        tags: ["ocr", "forms", "digitization", "extraction", "validation"],
        required_integrations: [],
        featured: false,
        definition: {
            name: "Form Digitizer",
            nodes: [
                {
                    id: "files-1",
                    type: "files",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Upload Scanned Forms",
                        inputVariable: "scannedForms",
                        allowedTypes: ["image/*", "application/pdf"],
                        description: "Upload scanned paper forms"
                    }
                },
                {
                    id: "input-formtype",
                    type: "input",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Form Type",
                        inputName: "formType",
                        inputVariable: "formType",
                        inputType: "text",
                        description:
                            "What type of form is this? (e.g., Application, Survey, Registration)"
                    }
                },
                {
                    id: "loop-forms",
                    type: "loop",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Process Each Form",
                        loopType: "forEach",
                        collection: "{{scannedForms}}",
                        itemVariable: "currentForm",
                        indexVariable: "formIndex"
                    }
                },
                {
                    id: "vision-ocr",
                    type: "vision",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "OCR Extract Text",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Extract all text from this {{formType}} form. Identify:\n\n1. All form field labels\n2. Filled-in values (handwritten or typed)\n3. Checkboxes/radio buttons (checked or unchecked)\n4. Signatures (describe location)\n5. Dates\n\nFor handwritten text, indicate confidence level.",
                        outputVariable: "ocrText"
                    }
                },
                {
                    id: "llm-parse",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Parse Into Structure",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: 'Parse this OCR output into structured JSON:\n\n{{ocrText.text}}\n\nFor a {{formType}} form, create a JSON object with:\n1. All fields and their values\n2. Confidence score for each field (0-100)\n3. Any fields that couldn\'t be read\n\nReturn: {"fields": {...}, "confidence": {...}, "issues": [...]}',
                        outputVariable: "structuredData"
                    }
                },
                {
                    id: "code-check",
                    type: "code",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Check Confidence",
                        language: "javascript",
                        code: "const data = JSON.parse(inputs.structuredData.text);\nconst avgConfidence = Object.values(data.confidence).reduce((a,b) => a+b, 0) / Object.values(data.confidence).length;\nreturn { averageConfidence: avgConfidence, needsReview: avgConfidence < 90 };",
                        outputVariable: "confidenceCheck"
                    }
                },
                {
                    id: "conditional-review",
                    type: "conditional",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Needs Review?",
                        condition: "confidenceCheck.needsReview === true",
                        outputVariable: "reviewRequired"
                    }
                },
                {
                    id: "humanReview-1",
                    type: "humanReview",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Verify Extraction",
                        reviewPrompt:
                            "Low confidence OCR result. Please verify:\n\nExtracted data: {{structuredData.text}}\n\nConfidence: {{confidenceCheck.averageConfidence}}%\n\nCorrect any errors.",
                        outputVariable: "verifiedData"
                    }
                },
                {
                    id: "shared-memory-store",
                    type: "shared-memory",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Store Form Data",
                        operation: "set",
                        key: "form_{{formIndex}}",
                        value: "{{structuredData.text}}"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Digitized Forms",
                        outputName: "result",
                        value: "{{structuredData}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "files-1", target: "loop-forms" },
                { id: "e2", source: "input-formtype", target: "vision-ocr" },
                { id: "e3", source: "loop-forms", target: "vision-ocr" },
                { id: "e4", source: "vision-ocr", target: "llm-parse" },
                { id: "e5", source: "llm-parse", target: "code-check" },
                { id: "e6", source: "code-check", target: "conditional-review" },
                {
                    id: "e7",
                    source: "conditional-review",
                    target: "humanReview-1",
                    sourceHandle: "true"
                },
                {
                    id: "e8",
                    source: "conditional-review",
                    target: "shared-memory-store",
                    sourceHandle: "false"
                },
                { id: "e9", source: "humanReview-1", target: "shared-memory-store" },
                { id: "e10", source: "shared-memory-store", target: "output-1" }
            ]
        }
    },

    // Document Processing 5: Multi-Document Merger
    {
        name: "Multi-Document Merger",
        description:
            "Merge and synthesize multiple documents into a unified report. Extracts content from all documents, identifies themes, and generates a comprehensive merged document.",
        category: "document-processing",
        tags: ["pdf", "merge", "synthesis", "documents", "report"],
        required_integrations: [],
        featured: false,
        definition: {
            name: "Multi-Document Merger",
            nodes: [
                {
                    id: "files-1",
                    type: "files",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Upload Documents",
                        inputVariable: "documents",
                        allowedTypes: ["application/pdf", "text/*"],
                        description: "Upload multiple documents to merge"
                    }
                },
                {
                    id: "input-purpose",
                    type: "input",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Merge Purpose",
                        inputName: "mergePurpose",
                        inputVariable: "mergePurpose",
                        inputType: "text",
                        description: "What is the purpose of this merged document?"
                    }
                },
                {
                    id: "loop-docs",
                    type: "loop",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Extract Each Document",
                        loopType: "forEach",
                        collection: "{{documents}}",
                        itemVariable: "currentDoc",
                        indexVariable: "docIndex"
                    }
                },
                {
                    id: "llm-extract",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Extract Content",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Extract the full content from this document. Preserve:\n1. Structure (headings, sections)\n2. Key points\n3. Data/statistics\n4. Quotes\n5. Source attribution",
                        outputVariable: "docContent"
                    }
                },
                {
                    id: "shared-memory-store",
                    type: "shared-memory",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Store Content",
                        operation: "set",
                        key: "doc_{{docIndex}}",
                        value: "{{docContent.text}}"
                    }
                },
                {
                    id: "llm-themes",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Identify Themes",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Analyze all extracted documents and identify:\n\n1. Common themes across documents\n2. Unique points from each document\n3. Contradictions or conflicts\n4. Recommended structure for merged document\n\nPurpose: {{mergePurpose}}",
                        outputVariable: "themeAnalysis"
                    }
                },
                {
                    id: "llm-synthesize",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Synthesize Documents",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Create a unified document merging all sources for: {{mergePurpose}}\n\nTheme analysis: {{themeAnalysis.text}}\n\nCreate:\n1. Executive summary\n2. Table of contents\n3. Main content organized by theme\n4. Source attributions\n5. Appendix with source documents\n\nMaintain academic rigor with proper citations.",
                        outputVariable: "mergedDocument"
                    }
                },
                {
                    id: "templateOutput-1",
                    type: "templateOutput",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Format as PDF-Ready",
                        templateType: "markdown",
                        template: "# {{mergePurpose}}\n\n{{mergedDocument.text}}",
                        outputVariable: "formattedDoc"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Merged Document",
                        outputName: "result",
                        value: "{{formattedDoc}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "files-1", target: "loop-docs" },
                { id: "e2", source: "input-purpose", target: "llm-synthesize" },
                { id: "e3", source: "loop-docs", target: "llm-extract" },
                { id: "e4", source: "llm-extract", target: "shared-memory-store" },
                { id: "e5", source: "shared-memory-store", target: "llm-themes" },
                { id: "e6", source: "llm-themes", target: "llm-synthesize" },
                { id: "e7", source: "llm-synthesize", target: "templateOutput-1" },
                { id: "e8", source: "templateOutput-1", target: "output-1" }
            ]
        }
    },

    // Document Processing 6: Report Template Filler
    {
        name: "Report Template Filler",
        description:
            "Auto-fill report templates with data from multiple sources. Fetches data, generates narrative sections, and fills templates for consistent reporting.",
        category: "document-processing",
        tags: ["templates", "reports", "automation", "data", "generation"],
        required_integrations: [],
        featured: false,
        definition: {
            name: "Report Template Filler",
            nodes: [
                {
                    id: "input-params",
                    type: "input",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Report Parameters",
                        inputName: "reportParams",
                        inputVariable: "reportParams",
                        inputType: "text",
                        description: "Report period, department, or other parameters"
                    }
                },
                {
                    id: "input-template",
                    type: "input",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Report Template",
                        inputName: "reportTemplate",
                        inputVariable: "reportTemplate",
                        inputType: "text",
                        description: "Paste the report template with {{placeholders}}"
                    }
                },
                {
                    id: "http-data1",
                    type: "http",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Fetch Sales Data",
                        method: "GET",
                        url: "https://api.example.com/sales",
                        queryParams: { period: "{{reportParams}}" },
                        outputVariable: "salesData"
                    }
                },
                {
                    id: "http-data2",
                    type: "http",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Fetch Metrics",
                        method: "GET",
                        url: "https://api.example.com/metrics",
                        queryParams: { period: "{{reportParams}}" },
                        outputVariable: "metricsData"
                    }
                },
                {
                    id: "transform-aggregate",
                    type: "transform",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Aggregate Data",
                        transformType: "merge",
                        sources: ["{{salesData}}", "{{metricsData}}"],
                        outputVariable: "aggregatedData"
                    }
                },
                {
                    id: "llm-narrative",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Narrative",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Generate narrative sections for this report based on the data:\n\nData: {{aggregatedData}}\nPeriod: {{reportParams}}\n\nWrite:\n1. Executive summary (1 paragraph)\n2. Key highlights (3-5 points)\n3. Performance analysis\n4. Recommendations\n\nUse a professional, data-driven tone.",
                        outputVariable: "narrativeSections"
                    }
                },
                {
                    id: "templateOutput-1",
                    type: "templateOutput",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Fill Template",
                        templateType: "handlebars",
                        template: "{{reportTemplate}}",
                        variables: {
                            data: "{{aggregatedData}}",
                            narrative: "{{narrativeSections.text}}",
                            period: "{{reportParams}}"
                        },
                        outputVariable: "filledReport"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Completed Report",
                        outputName: "result",
                        value: "{{filledReport}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "input-params", target: "http-data1" },
                { id: "e2", source: "input-params", target: "http-data2" },
                { id: "e3", source: "http-data1", target: "transform-aggregate" },
                { id: "e4", source: "http-data2", target: "transform-aggregate" },
                { id: "e5", source: "transform-aggregate", target: "llm-narrative" },
                { id: "e6", source: "llm-narrative", target: "templateOutput-1" },
                { id: "e7", source: "input-template", target: "templateOutput-1" },
                { id: "e8", source: "templateOutput-1", target: "output-1" }
            ]
        }
    },

    // Document Processing 7: Receipt Expense Reporter
    {
        name: "Receipt Expense Reporter",
        description:
            "Process receipt images into expense reports. OCR extracts receipt data, categorizes expenses, and compiles into a formatted expense report.",
        category: "document-processing",
        tags: ["ocr", "receipts", "expenses", "finance", "reporting"],
        required_integrations: [],
        featured: false,
        definition: {
            name: "Receipt Expense Reporter",
            nodes: [
                {
                    id: "files-1",
                    type: "files",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Upload Receipts",
                        inputVariable: "receipts",
                        allowedTypes: ["image/*"],
                        description: "Upload receipt images"
                    }
                },
                {
                    id: "input-trip",
                    type: "input",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Trip/Project Name",
                        inputName: "tripName",
                        inputVariable: "tripName",
                        inputType: "text",
                        description: "Name of trip or project for this expense report"
                    }
                },
                {
                    id: "loop-receipts",
                    type: "loop",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Process Each Receipt",
                        loopType: "forEach",
                        collection: "{{receipts}}",
                        itemVariable: "currentReceipt",
                        indexVariable: "receiptIndex"
                    }
                },
                {
                    id: "vision-ocr",
                    type: "vision",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Extract Receipt Data",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Extract data from this receipt:\n\n1. Merchant name\n2. Date\n3. Items purchased (if visible)\n4. Subtotal\n5. Tax\n6. Total amount\n7. Payment method\n8. Currency\n\nReturn as JSON.",
                        outputVariable: "receiptData"
                    }
                },
                {
                    id: "llm-categorize",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Categorize Expense",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: 'Categorize this expense:\n\n{{receiptData.text}}\n\nCategories: Travel, Meals, Lodging, Transportation, Supplies, Entertainment, Other\n\nReturn: {"category": "...", "isReimbursable": true/false, "notes": "..."}',
                        outputVariable: "expenseCategory"
                    }
                },
                {
                    id: "shared-memory-store",
                    type: "shared-memory",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Store Expense",
                        operation: "set",
                        key: "expense_{{receiptIndex}}",
                        value: '{"receipt": {{receiptData.text}}, "category": {{expenseCategory.text}}}'
                    }
                },
                {
                    id: "llm-compile",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Compile Expense Report",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Create an expense report for: {{tripName}}\n\nCompile all stored expenses into a formatted report with:\n1. Summary by category\n2. Total reimbursable amount\n3. Non-reimbursable items\n4. Itemized list with dates and merchants\n5. Any missing documentation notes",
                        outputVariable: "expenseReport"
                    }
                },
                {
                    id: "templateOutput-1",
                    type: "templateOutput",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Format Report",
                        templateType: "markdown",
                        template: "# Expense Report: {{tripName}}\n\n{{expenseReport.text}}",
                        outputVariable: "formattedReport"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Expense Report",
                        outputName: "result",
                        value: "{{formattedReport}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "files-1", target: "loop-receipts" },
                { id: "e2", source: "input-trip", target: "llm-compile" },
                { id: "e3", source: "loop-receipts", target: "vision-ocr" },
                { id: "e4", source: "vision-ocr", target: "llm-categorize" },
                { id: "e5", source: "llm-categorize", target: "shared-memory-store" },
                { id: "e6", source: "shared-memory-store", target: "llm-compile" },
                { id: "e7", source: "llm-compile", target: "templateOutput-1" },
                { id: "e8", source: "templateOutput-1", target: "output-1" }
            ]
        }
    },

    // Document Processing 8: Technical Doc Translator
    {
        name: "Technical Doc Translator",
        description:
            "Translate technical documentation while preserving formatting and technical terms. Extracts content, translates with context, and maintains document structure.",
        category: "document-processing",
        tags: ["translation", "technical", "documentation", "localization", "pdf"],
        required_integrations: [],
        featured: false,
        definition: {
            name: "Technical Doc Translator",
            nodes: [
                {
                    id: "files-1",
                    type: "files",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Upload Document",
                        inputVariable: "sourceDoc",
                        allowedTypes: ["application/pdf", "text/*"],
                        description: "Upload technical document to translate"
                    }
                },
                {
                    id: "input-lang",
                    type: "input",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Target Languages",
                        inputName: "targetLanguages",
                        inputVariable: "targetLanguages",
                        inputType: "text",
                        description:
                            "Comma-separated list of target languages (e.g., Spanish, French, German)"
                    }
                },
                {
                    id: "input-glossary",
                    type: "input",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Technical Glossary",
                        inputName: "glossary",
                        inputVariable: "glossary",
                        inputType: "text",
                        description:
                            "Optional: Terms that should not be translated or have specific translations"
                    }
                },
                {
                    id: "llm-extract",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Extract Document Content",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Extract the full content from this technical document, preserving:\n1. All headings and structure\n2. Code blocks (mark as [CODE]...[/CODE])\n3. Tables (preserve structure)\n4. Technical terms\n5. Formatting markers",
                        outputVariable: "docContent"
                    }
                },
                {
                    id: "llm-terms",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Identify Technical Terms",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Identify technical terms in this document that may need special handling during translation:\n\n{{docContent.text}}\n\nGlossary provided: {{glossary}}\n\nList terms with recommended handling (keep original, translate, use specific translation).",
                        outputVariable: "termsList"
                    }
                },
                {
                    id: "loop-languages",
                    type: "loop",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Translate to Each Language",
                        loopType: "forEach",
                        collection: "{{targetLanguages}}",
                        itemVariable: "targetLang",
                        indexVariable: "langIndex"
                    }
                },
                {
                    id: "llm-translate",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Translate Document",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Translate this technical document to {{targetLang}}:\n\n{{docContent.text}}\n\nTechnical terms handling:\n{{termsList.text}}\n\nRules:\n1. Preserve code blocks unchanged\n2. Maintain all formatting\n3. Keep technical terms as specified\n4. Ensure natural flow in target language\n5. Preserve section numbering",
                        outputVariable: "translatedDoc"
                    }
                },
                {
                    id: "shared-memory-store",
                    type: "shared-memory",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Store Translation",
                        operation: "set",
                        key: "translation_{{targetLang}}",
                        value: "{{translatedDoc.text}}"
                    }
                },
                {
                    id: "transform-compile",
                    type: "transform",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Compile All Translations",
                        transformType: "template",
                        template:
                            "# Translations Complete\n\nLanguages: {{targetLanguages}}\n\nTranslated documents have been stored.",
                        outputVariable: "compiledTranslations"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Translated Documents",
                        outputName: "result",
                        value: "{{compiledTranslations}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "files-1", target: "llm-extract" },
                { id: "e2", source: "llm-extract", target: "llm-terms" },
                { id: "e3", source: "input-glossary", target: "llm-terms" },
                { id: "e4", source: "llm-terms", target: "loop-languages" },
                { id: "e5", source: "input-lang", target: "loop-languages" },
                { id: "e6", source: "loop-languages", target: "llm-translate" },
                { id: "e7", source: "llm-translate", target: "shared-memory-store" },
                { id: "e8", source: "shared-memory-store", target: "transform-compile" },
                { id: "e9", source: "transform-compile", target: "output-1" }
            ]
        }
    },

    // Document Processing 9: Data Room Organizer
    {
        name: "Data Room Organizer",
        description:
            "Auto-categorize and organize due diligence documents. Analyzes content, classifies documents by type, and creates an organized index.",
        category: "document-processing",
        tags: ["due-diligence", "organization", "classification", "legal", "finance"],
        required_integrations: ["google-drive"],
        featured: false,
        definition: {
            name: "Data Room Organizer",
            nodes: [
                {
                    id: "files-1",
                    type: "files",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Upload Documents",
                        inputVariable: "documents",
                        allowedTypes: ["application/pdf", "image/*", "text/*"],
                        description: "Upload due diligence documents to organize"
                    }
                },
                {
                    id: "loop-docs",
                    type: "loop",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Process Each Document",
                        loopType: "forEach",
                        collection: "{{documents}}",
                        itemVariable: "currentDoc",
                        indexVariable: "docIndex"
                    }
                },
                {
                    id: "llm-extract",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Extract & Summarize",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Extract key information from this document:\n\n1. Document title/type\n2. Date\n3. Parties involved\n4. Key terms or values\n5. One-paragraph summary",
                        outputVariable: "docSummary"
                    }
                },
                {
                    id: "llm-classify",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Classify Document",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: 'Classify this document into a data room category:\n\n{{docSummary.text}}\n\nCategories:\n- Corporate: Formation docs, bylaws, board minutes\n- Financial: Statements, audits, projections\n- Legal: Contracts, litigation, IP\n- HR: Employee agreements, benefits, org charts\n- Technical: Patents, technical specs, security audits\n- Commercial: Customer contracts, partnerships\n- Regulatory: Licenses, compliance, permits\n\nReturn: {"category": "...", "subcategory": "...", "priority": "high/medium/low"}',
                        outputVariable: "classification"
                    }
                },
                {
                    id: "integration-gdrive",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Move to Folder",
                        provider: "google-drive",
                        operation: "moveFile",
                        folder: "{{classification.category}}/{{classification.subcategory}}"
                    }
                },
                {
                    id: "shared-memory-store",
                    type: "shared-memory",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Log Organization",
                        operation: "set",
                        key: "organized_{{docIndex}}",
                        value: '{"summary": "{{docSummary.text}}", "classification": {{classification.text}}}'
                    }
                },
                {
                    id: "llm-index",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Data Room Index",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Create a data room index from all organized documents.\n\nFormat as a professional index with:\n1. Category sections\n2. Document listings with summaries\n3. Cross-references\n4. Missing document checklist\n5. Priority items highlighted",
                        outputVariable: "dataRoomIndex"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Data Room Index",
                        outputName: "result",
                        value: "{{dataRoomIndex}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "files-1", target: "loop-docs" },
                { id: "e2", source: "loop-docs", target: "llm-extract" },
                { id: "e3", source: "llm-extract", target: "llm-classify" },
                { id: "e4", source: "llm-classify", target: "integration-gdrive" },
                { id: "e5", source: "integration-gdrive", target: "shared-memory-store" },
                { id: "e6", source: "shared-memory-store", target: "llm-index" },
                { id: "e7", source: "llm-index", target: "output-1" }
            ]
        }
    },

    // Document Processing 10: Proposal Generator
    {
        name: "Proposal Generator",
        description:
            "Generate professional proposals from requirements. Analyzes client needs, pulls relevant case studies, and creates customized proposals.",
        category: "document-processing",
        tags: ["proposals", "sales", "generation", "templates", "customization"],
        required_integrations: [],
        featured: true,
        definition: {
            name: "Proposal Generator",
            nodes: [
                {
                    id: "input-client",
                    type: "input",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Client Information",
                        inputName: "clientInfo",
                        inputVariable: "clientInfo",
                        inputType: "text",
                        description: "Client name, industry, size, and key contacts"
                    }
                },
                {
                    id: "input-requirements",
                    type: "input",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Project Requirements",
                        inputName: "requirements",
                        inputVariable: "requirements",
                        inputType: "text",
                        description: "Detailed project requirements and scope"
                    }
                },
                {
                    id: "input-pricing",
                    type: "input",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Pricing Parameters",
                        inputName: "pricing",
                        inputVariable: "pricing",
                        inputType: "text",
                        description: "Budget range, pricing model, payment terms"
                    }
                },
                {
                    id: "kb-query-1",
                    type: "knowledgeBaseQuery",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Find Case Studies",
                        query: "{{clientInfo}} {{requirements}}",
                        topK: 3,
                        outputVariable: "caseStudies"
                    }
                },
                {
                    id: "llm-analyze",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Analyze Requirements",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Analyze these project requirements:\n\nClient: {{clientInfo}}\nRequirements: {{requirements}}\n\nIdentify:\n1. Key deliverables\n2. Potential challenges\n3. Success metrics\n4. Timeline implications\n5. Resource needs",
                        outputVariable: "requirementAnalysis"
                    }
                },
                {
                    id: "llm-solution",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Design Solution",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Design a solution for:\n\nAnalysis: {{requirementAnalysis.text}}\nRelevant case studies: {{caseStudies}}\n\nPropose:\n1. Approach and methodology\n2. Phase breakdown\n3. Deliverables per phase\n4. Timeline\n5. Team composition",
                        outputVariable: "solutionDesign"
                    }
                },
                {
                    id: "llm-pricing",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Pricing",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Generate pricing for this proposal:\n\nSolution: {{solutionDesign.text}}\nPricing parameters: {{pricing}}\n\nCreate:\n1. Pricing breakdown by phase\n2. Optional add-ons\n3. Payment schedule\n4. Terms and conditions summary",
                        outputVariable: "pricingSection"
                    }
                },
                {
                    id: "llm-proposal",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Write Proposal",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Write a professional proposal for {{clientInfo}}:\n\nRequirements: {{requirements}}\nSolution: {{solutionDesign.text}}\nPricing: {{pricingSection.text}}\nCase Studies: {{caseStudies}}\n\nStructure:\n1. Executive Summary\n2. Understanding of Needs\n3. Proposed Solution\n4. Methodology\n5. Timeline & Milestones\n6. Team\n7. Investment\n8. Case Studies\n9. Why Choose Us\n10. Next Steps",
                        outputVariable: "proposal"
                    }
                },
                {
                    id: "templateOutput-1",
                    type: "templateOutput",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Format Proposal",
                        templateType: "markdown",
                        template: "# Proposal for {{clientInfo}}\n\n{{proposal.text}}",
                        outputVariable: "formattedProposal"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Completed Proposal",
                        outputName: "result",
                        value: "{{formattedProposal}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "input-client", target: "kb-query-1" },
                { id: "e2", source: "input-requirements", target: "kb-query-1" },
                { id: "e3", source: "input-requirements", target: "llm-analyze" },
                { id: "e4", source: "input-client", target: "llm-analyze" },
                { id: "e5", source: "llm-analyze", target: "llm-solution" },
                { id: "e6", source: "kb-query-1", target: "llm-solution" },
                { id: "e7", source: "llm-solution", target: "llm-pricing" },
                { id: "e8", source: "input-pricing", target: "llm-pricing" },
                { id: "e9", source: "llm-pricing", target: "llm-proposal" },
                { id: "e10", source: "llm-solution", target: "llm-proposal" },
                { id: "e11", source: "kb-query-1", target: "llm-proposal" },
                { id: "e12", source: "llm-proposal", target: "templateOutput-1" },
                { id: "e13", source: "templateOutput-1", target: "output-1" }
            ]
        }
    },

    // ========================================================================
    // DATA & ANALYTICS (10 templates)
    // ========================================================================

    // Data & Analytics 1: Metrics Dashboard Builder
    {
        name: "Metrics Dashboard Builder",
        description:
            "Build visual dashboards from multiple data sources. Fetches metrics, generates charts, and compiles into an interactive dashboard.",
        category: "data-analytics",
        tags: ["dashboard", "charts", "metrics", "visualization", "reporting"],
        required_integrations: [],
        featured: true,
        definition: {
            name: "Metrics Dashboard Builder",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Hourly Update",
                        triggerType: "schedule",
                        schedule: "0 * * * *"
                    }
                },
                {
                    id: "http-sales",
                    type: "http",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Fetch Sales Metrics",
                        method: "GET",
                        url: "https://api.example.com/metrics/sales",
                        outputVariable: "salesMetrics"
                    }
                },
                {
                    id: "http-traffic",
                    type: "http",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Fetch Traffic Metrics",
                        method: "GET",
                        url: "https://api.example.com/metrics/traffic",
                        outputVariable: "trafficMetrics"
                    }
                },
                {
                    id: "http-conversion",
                    type: "http",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Fetch Conversion Metrics",
                        method: "GET",
                        url: "https://api.example.com/metrics/conversion",
                        outputVariable: "conversionMetrics"
                    }
                },
                {
                    id: "transform-aggregate",
                    type: "transform",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Aggregate Metrics",
                        transformType: "merge",
                        sources: [
                            "{{salesMetrics}}",
                            "{{trafficMetrics}}",
                            "{{conversionMetrics}}"
                        ],
                        outputVariable: "allMetrics"
                    }
                },
                {
                    id: "llm-charts",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Chart Configs",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Based on these metrics:\n\n{{allMetrics}}\n\nGenerate chart configurations for:\n1. Revenue trend (line chart)\n2. Traffic sources (pie chart)\n3. Conversion funnel (funnel chart)\n4. Top products (bar chart)\n\nReturn as JSON array with chart type, data, and options.",
                        outputVariable: "chartConfigs"
                    }
                },
                {
                    id: "loop-charts",
                    type: "loop",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Each Chart",
                        loopType: "forEach",
                        collection: "{{chartConfigs.text}}",
                        itemVariable: "chartConfig",
                        indexVariable: "chartIndex"
                    }
                },
                {
                    id: "shared-memory-chart",
                    type: "shared-memory",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Store Chart",
                        operation: "set",
                        key: "chart_{{chartIndex}}",
                        value: "{{chartConfig}}"
                    }
                },
                {
                    id: "templateOutput-1",
                    type: "templateOutput",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Dashboard HTML",
                        templateType: "html",
                        template:
                            "<html><head><title>Metrics Dashboard</title></head><body><div id='dashboard'>{{chartConfigs.text}}</div></body></html>",
                        outputVariable: "dashboardHtml"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Dashboard",
                        outputName: "result",
                        value: "{{dashboardHtml}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "trigger-1", target: "http-sales" },
                { id: "e2", source: "trigger-1", target: "http-traffic" },
                { id: "e3", source: "trigger-1", target: "http-conversion" },
                { id: "e4", source: "http-sales", target: "transform-aggregate" },
                { id: "e5", source: "http-traffic", target: "transform-aggregate" },
                { id: "e6", source: "http-conversion", target: "transform-aggregate" },
                { id: "e7", source: "transform-aggregate", target: "llm-charts" },
                { id: "e8", source: "llm-charts", target: "loop-charts" },
                { id: "e9", source: "loop-charts", target: "shared-memory-chart" },
                { id: "e10", source: "shared-memory-chart", target: "templateOutput-1" },
                { id: "e11", source: "templateOutput-1", target: "output-1" }
            ]
        }
    },

    // Data & Analytics 2: Sales Pipeline Analyzer
    {
        name: "Sales Pipeline Analyzer",
        description:
            "Analyze sales pipeline with predictive insights. Fetches CRM data, calculates metrics, generates visualizations, and provides recommendations.",
        category: "data-analytics",
        tags: ["sales", "pipeline", "crm", "predictions", "charts"],
        required_integrations: ["slack"],
        featured: false,
        definition: {
            name: "Sales Pipeline Analyzer",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Weekly Analysis",
                        triggerType: "schedule",
                        schedule: "0 9 * * 1"
                    }
                },
                {
                    id: "http-crm",
                    type: "http",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Fetch Pipeline Data",
                        method: "GET",
                        url: "https://api.crm.example.com/pipeline",
                        outputVariable: "pipelineData"
                    }
                },
                {
                    id: "code-metrics",
                    type: "code",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Calculate Metrics",
                        language: "javascript",
                        code: "const data = inputs.pipelineData;\nconst totalValue = data.deals?.reduce((sum, d) => sum + d.value, 0) || 0;\nconst avgDealSize = totalValue / (data.deals?.length || 1);\nconst conversionRate = data.won / (data.total || 1);\nreturn { totalValue, avgDealSize, conversionRate, velocity: data.avgDaysToClose };",
                        outputVariable: "pipelineMetrics"
                    }
                },
                {
                    id: "llm-predict",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Predictions",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Analyze this sales pipeline data and generate predictions:\n\nPipeline: {{pipelineData}}\nMetrics: {{pipelineMetrics}}\n\nProvide:\n1. Expected close rate this month\n2. Revenue forecast\n3. Deals at risk\n4. Top opportunities\n5. Recommended actions",
                        outputVariable: "predictions"
                    }
                },
                {
                    id: "llm-chart",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Chart Specs",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Create chart specifications for:\n\nMetrics: {{pipelineMetrics}}\n\nGenerate:\n1. Pipeline funnel chart\n2. Deal velocity trend\n3. Stage distribution\n\nReturn as JSON.",
                        outputVariable: "chartSpecs"
                    }
                },
                {
                    id: "llm-report",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Report",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Create a weekly sales pipeline report:\n\nMetrics: {{pipelineMetrics}}\nPredictions: {{predictions.text}}\n\nFormat for Slack with:\n1. Key metrics summary\n2. Week-over-week changes\n3. Top deals to watch\n4. Action items",
                        outputVariable: "weeklyReport"
                    }
                },
                {
                    id: "integration-slack",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Post to Sales Channel",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#sales-pipeline"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Pipeline Report",
                        outputName: "result",
                        value: "{{weeklyReport}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "trigger-1", target: "http-crm" },
                { id: "e2", source: "http-crm", target: "code-metrics" },
                { id: "e3", source: "code-metrics", target: "llm-predict" },
                { id: "e4", source: "code-metrics", target: "llm-chart" },
                { id: "e5", source: "llm-predict", target: "llm-report" },
                { id: "e6", source: "llm-chart", target: "llm-report" },
                { id: "e7", source: "llm-report", target: "integration-slack" },
                { id: "e8", source: "integration-slack", target: "output-1" }
            ]
        }
    },

    // Data & Analytics 3: A/B Test Results Analyzer
    {
        name: "A/B Test Results Analyzer",
        description:
            "Analyze A/B test results with statistical rigor. Calculates significance, generates visualizations, and interprets results with recommendations.",
        category: "data-analytics",
        tags: ["ab-testing", "statistics", "experiments", "analysis", "optimization"],
        required_integrations: [],
        featured: true,
        definition: {
            name: "A/B Test Results Analyzer",
            nodes: [
                {
                    id: "input-experiment",
                    type: "input",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Experiment ID",
                        inputName: "experimentId",
                        inputVariable: "experimentId",
                        inputType: "text",
                        description: "Enter the A/B test experiment ID"
                    }
                },
                {
                    id: "http-data",
                    type: "http",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Fetch Experiment Data",
                        method: "GET",
                        url: "https://api.analytics.example.com/experiments/{{experimentId}}",
                        outputVariable: "experimentData"
                    }
                },
                {
                    id: "code-stats",
                    type: "code",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Calculate Statistics",
                        language: "javascript",
                        code: "const data = inputs.experimentData;\n// Calculate conversion rates, confidence intervals, p-value\nconst controlRate = data.control.conversions / data.control.visitors;\nconst variantRate = data.variant.conversions / data.variant.visitors;\nconst lift = (variantRate - controlRate) / controlRate * 100;\nconst significant = data.pValue < 0.05;\nreturn { controlRate, variantRate, lift, pValue: data.pValue, significant, sampleSize: data.control.visitors + data.variant.visitors };",
                        outputVariable: "stats"
                    }
                },
                {
                    id: "conditional-significant",
                    type: "conditional",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Statistically Significant?",
                        condition: "stats.significant === true",
                        outputVariable: "isSignificant"
                    }
                },
                {
                    id: "llm-interpret-sig",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Interpret Significant Result",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Interpret this statistically significant A/B test result:\n\nStats: {{stats}}\nExperiment: {{experimentData}}\n\nProvide:\n1. Clear winner declaration\n2. Business impact estimate\n3. Confidence level explanation\n4. Recommended action (roll out, iterate, etc.)\n5. Caveats to consider",
                        outputVariable: "interpretation"
                    }
                },
                {
                    id: "llm-interpret-insig",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Interpret Insufficient Data",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Interpret this non-significant A/B test result:\n\nStats: {{stats}}\nExperiment: {{experimentData}}\n\nProvide:\n1. Current status (no winner yet)\n2. Sample size needed for significance\n3. Estimated time to reach significance\n4. Recommendation (continue, stop, modify)",
                        outputVariable: "interpretation"
                    }
                },
                {
                    id: "llm-chart",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Visualization",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Create chart specifications to visualize:\n\nStats: {{stats}}\n\nGenerate:\n1. Conversion rate comparison (bar chart)\n2. Confidence interval visualization\n3. Sample accumulation over time",
                        outputVariable: "chartSpecs"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Analysis Results",
                        outputName: "result",
                        value: "{{interpretation}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "input-experiment", target: "http-data" },
                { id: "e2", source: "http-data", target: "code-stats" },
                { id: "e3", source: "code-stats", target: "conditional-significant" },
                {
                    id: "e4",
                    source: "conditional-significant",
                    target: "llm-interpret-sig",
                    sourceHandle: "true"
                },
                {
                    id: "e5",
                    source: "conditional-significant",
                    target: "llm-interpret-insig",
                    sourceHandle: "false"
                },
                { id: "e6", source: "code-stats", target: "llm-chart" },
                { id: "e7", source: "llm-interpret-sig", target: "output-1" },
                { id: "e8", source: "llm-interpret-insig", target: "output-1" },
                { id: "e9", source: "llm-chart", target: "output-1" }
            ]
        }
    },

    // Data & Analytics 4: Log Analyzer & Alerter
    {
        name: "Log Analyzer & Alerter",
        description:
            "Analyze application logs for errors and anomalies. Parses logs, detects patterns, and alerts on critical issues with suggested fixes.",
        category: "data-analytics",
        tags: ["logs", "monitoring", "alerts", "devops", "anomaly-detection"],
        required_integrations: ["slack"],
        featured: false,
        definition: {
            name: "Log Analyzer & Alerter",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Every 5 Minutes",
                        triggerType: "schedule",
                        schedule: "*/5 * * * *"
                    }
                },
                {
                    id: "http-logs",
                    type: "http",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Fetch Recent Logs",
                        method: "GET",
                        url: "https://logs.example.com/api/recent?minutes=5",
                        outputVariable: "recentLogs"
                    }
                },
                {
                    id: "code-parse",
                    type: "code",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Parse & Categorize Logs",
                        language: "javascript",
                        code: "const logs = inputs.recentLogs.entries || [];\nconst errors = logs.filter(l => l.level === 'ERROR');\nconst warnings = logs.filter(l => l.level === 'WARN');\nconst errorRate = errors.length / logs.length * 100;\nreturn { totalLogs: logs.length, errors: errors.length, warnings: warnings.length, errorRate, topErrors: errors.slice(0, 10) };",
                        outputVariable: "logStats"
                    }
                },
                {
                    id: "conditional-threshold",
                    type: "conditional",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Error Rate > 5%?",
                        condition: "logStats.errorRate > 5",
                        outputVariable: "thresholdExceeded"
                    }
                },
                {
                    id: "llm-analyze",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Analyze Error Patterns",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Analyze these application errors:\n\n{{logStats.topErrors}}\n\nIdentify:\n1. Root cause patterns\n2. Affected services/components\n3. Potential impact\n4. Suggested fixes\n5. Priority level (P1-P4)",
                        outputVariable: "errorAnalysis"
                    }
                },
                {
                    id: "integration-slack-alert",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Send Alert",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#engineering-alerts"
                    }
                },
                {
                    id: "shared-memory-log",
                    type: "shared-memory",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Store Metrics",
                        operation: "set",
                        key: "log_metrics_{{timestamp}}",
                        value: "{{logStats}}"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Log Analysis",
                        outputName: "result",
                        value: "{{logStats}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "trigger-1", target: "http-logs" },
                { id: "e2", source: "http-logs", target: "code-parse" },
                { id: "e3", source: "code-parse", target: "conditional-threshold" },
                {
                    id: "e4",
                    source: "conditional-threshold",
                    target: "llm-analyze",
                    sourceHandle: "true"
                },
                {
                    id: "e5",
                    source: "conditional-threshold",
                    target: "shared-memory-log",
                    sourceHandle: "false"
                },
                { id: "e6", source: "llm-analyze", target: "integration-slack-alert" },
                { id: "e7", source: "integration-slack-alert", target: "shared-memory-log" },
                { id: "e8", source: "shared-memory-log", target: "output-1" }
            ]
        }
    },

    // Data & Analytics 5: Survey Results Processor
    {
        name: "Survey Results Processor",
        description:
            "Process survey responses into actionable insights. Calculates NPS, analyzes sentiment, identifies themes, and generates reports.",
        category: "data-analytics",
        tags: ["surveys", "nps", "sentiment", "analysis", "feedback"],
        required_integrations: [],
        featured: false,
        definition: {
            name: "Survey Results Processor",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Survey Complete Webhook",
                        triggerType: "webhook",
                        description: "Triggered when a survey closes"
                    }
                },
                {
                    id: "http-responses",
                    type: "http",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Fetch All Responses",
                        method: "GET",
                        url: "https://api.survey.example.com/responses",
                        outputVariable: "surveyResponses"
                    }
                },
                {
                    id: "transform-clean",
                    type: "transform",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Clean & Normalize",
                        transformType: "map",
                        expression: "item.responses",
                        outputVariable: "cleanedResponses"
                    }
                },
                {
                    id: "code-nps",
                    type: "code",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Calculate NPS",
                        language: "javascript",
                        code: "const responses = inputs.cleanedResponses || [];\nconst scores = responses.map(r => r.npsScore).filter(s => s !== undefined);\nconst promoters = scores.filter(s => s >= 9).length;\nconst detractors = scores.filter(s => s <= 6).length;\nconst nps = Math.round((promoters - detractors) / scores.length * 100);\nreturn { nps, promoters, detractors, passives: scores.length - promoters - detractors, totalResponses: responses.length };",
                        outputVariable: "npsMetrics"
                    }
                },
                {
                    id: "llm-sentiment",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Analyze Open Responses",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Analyze these survey open-ended responses:\n\n{{cleanedResponses}}\n\nIdentify:\n1. Overall sentiment distribution\n2. Top 5 positive themes\n3. Top 5 negative themes\n4. Common suggestions\n5. Unexpected insights\n\nProvide specific quotes as examples.",
                        outputVariable: "sentimentAnalysis"
                    }
                },
                {
                    id: "llm-chart",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Charts",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Create chart configurations for:\n\nNPS: {{npsMetrics}}\n\nGenerate:\n1. NPS gauge chart\n2. Response distribution\n3. Sentiment breakdown\n4. Theme word cloud data",
                        outputVariable: "chartConfigs"
                    }
                },
                {
                    id: "llm-report",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Survey Report",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Create a comprehensive survey report:\n\nNPS: {{npsMetrics}}\nSentiment: {{sentimentAnalysis.text}}\n\nStructure:\n1. Executive summary\n2. Key metrics dashboard\n3. Detailed findings\n4. Recommendations\n5. Appendix with quotes",
                        outputVariable: "surveyReport"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Survey Report",
                        outputName: "result",
                        value: "{{surveyReport}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "trigger-1", target: "http-responses" },
                { id: "e2", source: "http-responses", target: "transform-clean" },
                { id: "e3", source: "transform-clean", target: "code-nps" },
                { id: "e4", source: "transform-clean", target: "llm-sentiment" },
                { id: "e5", source: "code-nps", target: "llm-chart" },
                { id: "e6", source: "llm-sentiment", target: "llm-report" },
                { id: "e7", source: "code-nps", target: "llm-report" },
                { id: "e8", source: "llm-chart", target: "llm-report" },
                { id: "e9", source: "llm-report", target: "output-1" }
            ]
        }
    },

    // Data & Analytics 6: Financial Reconciliation
    {
        name: "Financial Reconciliation",
        description:
            "Reconcile transactions across multiple systems. Matches records, flags discrepancies, and generates reconciliation reports.",
        category: "finance",
        tags: ["finance", "reconciliation", "accounting", "matching", "audit"],
        required_integrations: ["slack"],
        featured: false,
        definition: {
            name: "Financial Reconciliation",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Daily Reconciliation",
                        triggerType: "schedule",
                        schedule: "0 6 * * *"
                    }
                },
                {
                    id: "http-system-a",
                    type: "http",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Fetch System A Transactions",
                        method: "GET",
                        url: "https://api.erp.example.com/transactions/yesterday",
                        outputVariable: "systemAData"
                    }
                },
                {
                    id: "http-system-b",
                    type: "http",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Fetch System B Transactions",
                        method: "GET",
                        url: "https://api.bank.example.com/transactions/yesterday",
                        outputVariable: "systemBData"
                    }
                },
                {
                    id: "code-match",
                    type: "code",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Match Transactions",
                        language: "javascript",
                        code: "const a = inputs.systemAData.transactions || [];\nconst b = inputs.systemBData.transactions || [];\nconst matched = [];\nconst unmatchedA = [];\nconst unmatchedB = [...b];\n\na.forEach(txA => {\n  const matchIdx = unmatchedB.findIndex(txB => txB.amount === txA.amount && txB.date === txA.date);\n  if (matchIdx >= 0) {\n    matched.push({ a: txA, b: unmatchedB[matchIdx] });\n    unmatchedB.splice(matchIdx, 1);\n  } else {\n    unmatchedA.push(txA);\n  }\n});\n\nreturn { matched: matched.length, discrepancies: unmatchedA.length + unmatchedB.length, unmatchedA, unmatchedB };",
                        outputVariable: "reconciliation"
                    }
                },
                {
                    id: "conditional-discrepancies",
                    type: "conditional",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Discrepancies Found?",
                        condition: "reconciliation.discrepancies > 0",
                        outputVariable: "hasDiscrepancies"
                    }
                },
                {
                    id: "llm-analyze",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Analyze Discrepancies",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Analyze these reconciliation discrepancies:\n\nUnmatched in System A: {{reconciliation.unmatchedA}}\nUnmatched in System B: {{reconciliation.unmatchedB}}\n\nIdentify:\n1. Potential causes for each\n2. Timing differences\n3. Possible duplicates\n4. Recommended actions",
                        outputVariable: "discrepancyAnalysis"
                    }
                },
                {
                    id: "integration-slack",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Alert Finance Team",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#finance-alerts"
                    }
                },
                {
                    id: "llm-log",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Log Success",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Generate a brief reconciliation success log:\n\nMatched: {{reconciliation.matched}} transactions\nNo discrepancies found.",
                        outputVariable: "successLog"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Reconciliation Result",
                        outputName: "result",
                        value: "{{reconciliation}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "trigger-1", target: "http-system-a" },
                { id: "e2", source: "trigger-1", target: "http-system-b" },
                { id: "e3", source: "http-system-a", target: "code-match" },
                { id: "e4", source: "http-system-b", target: "code-match" },
                { id: "e5", source: "code-match", target: "conditional-discrepancies" },
                {
                    id: "e6",
                    source: "conditional-discrepancies",
                    target: "llm-analyze",
                    sourceHandle: "true"
                },
                {
                    id: "e7",
                    source: "conditional-discrepancies",
                    target: "llm-log",
                    sourceHandle: "false"
                },
                { id: "e8", source: "llm-analyze", target: "integration-slack" },
                { id: "e9", source: "integration-slack", target: "output-1" },
                { id: "e10", source: "llm-log", target: "output-1" }
            ]
        }
    },

    // Data & Analytics 7: Inventory Optimizer
    {
        name: "Inventory Optimizer",
        description:
            "Optimize inventory levels with demand forecasting. Analyzes sales patterns, predicts demand, and generates reorder recommendations.",
        category: "data-analytics",
        tags: ["inventory", "forecasting", "supply-chain", "optimization", "ecommerce"],
        required_integrations: ["slack"],
        featured: false,
        definition: {
            name: "Inventory Optimizer",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Weekly Analysis",
                        triggerType: "schedule",
                        schedule: "0 8 * * 1"
                    }
                },
                {
                    id: "http-inventory",
                    type: "http",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Fetch Inventory Levels",
                        method: "GET",
                        url: "https://api.inventory.example.com/current",
                        outputVariable: "inventoryData"
                    }
                },
                {
                    id: "http-sales",
                    type: "http",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Fetch Sales History",
                        method: "GET",
                        url: "https://api.sales.example.com/history?months=6",
                        outputVariable: "salesHistory"
                    }
                },
                {
                    id: "code-analyze",
                    type: "code",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Calculate Metrics",
                        language: "javascript",
                        code: "const inventory = inputs.inventoryData.items || [];\nconst sales = inputs.salesHistory.items || [];\n\nreturn inventory.map(item => {\n  const itemSales = sales.filter(s => s.sku === item.sku);\n  const avgDaily = itemSales.reduce((sum, s) => sum + s.quantity, 0) / 180;\n  const daysOfStock = item.quantity / avgDaily;\n  return { ...item, avgDailySales: avgDaily, daysOfStock, reorderNeeded: daysOfStock < 14 };\n});",
                        outputVariable: "inventoryMetrics"
                    }
                },
                {
                    id: "llm-forecast",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Demand Forecast",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Analyze inventory metrics and generate demand forecast:\n\n{{inventoryMetrics}}\n\nConsider:\n1. Seasonal patterns\n2. Trend direction\n3. Lead times\n4. Safety stock levels\n\nProvide 4-week demand forecast per item.",
                        outputVariable: "demandForecast"
                    }
                },
                {
                    id: "llm-recommendations",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Recommendations",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Based on metrics and forecast:\n\nMetrics: {{inventoryMetrics}}\nForecast: {{demandForecast.text}}\n\nGenerate:\n1. Urgent reorders (< 7 days stock)\n2. Standard reorders (< 14 days stock)\n3. Overstock items to discount\n4. Optimal reorder quantities\n5. Total reorder value estimate",
                        outputVariable: "recommendations"
                    }
                },
                {
                    id: "conditional-urgent",
                    type: "conditional",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Urgent Items?",
                        condition: "recommendations.text.includes('Urgent')",
                        outputVariable: "hasUrgent"
                    }
                },
                {
                    id: "integration-slack",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Alert Procurement",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#procurement-urgent"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Inventory Report",
                        outputName: "result",
                        value: "{{recommendations}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "trigger-1", target: "http-inventory" },
                { id: "e2", source: "trigger-1", target: "http-sales" },
                { id: "e3", source: "http-inventory", target: "code-analyze" },
                { id: "e4", source: "http-sales", target: "code-analyze" },
                { id: "e5", source: "code-analyze", target: "llm-forecast" },
                { id: "e6", source: "llm-forecast", target: "llm-recommendations" },
                { id: "e7", source: "llm-recommendations", target: "conditional-urgent" },
                {
                    id: "e8",
                    source: "conditional-urgent",
                    target: "integration-slack",
                    sourceHandle: "true"
                },
                {
                    id: "e9",
                    source: "conditional-urgent",
                    target: "output-1",
                    sourceHandle: "false"
                },
                { id: "e10", source: "integration-slack", target: "output-1" }
            ]
        }
    },

    // Data & Analytics 8: Marketing Attribution Analyzer
    {
        name: "Marketing Attribution Analyzer",
        description:
            "Analyze marketing attribution across channels. Runs multiple attribution models, compares results, and recommends budget allocation.",
        category: "data-analytics",
        tags: ["marketing", "attribution", "analytics", "roi", "optimization"],
        required_integrations: [],
        featured: true,
        definition: {
            name: "Marketing Attribution Analyzer",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Weekly Attribution",
                        triggerType: "schedule",
                        schedule: "0 9 * * 1"
                    }
                },
                {
                    id: "http-conversions",
                    type: "http",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Fetch Conversion Data",
                        method: "GET",
                        url: "https://api.analytics.example.com/conversions?days=30",
                        outputVariable: "conversionData"
                    }
                },
                {
                    id: "http-touchpoints",
                    type: "http",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Fetch Touchpoint Data",
                        method: "GET",
                        url: "https://api.analytics.example.com/touchpoints?days=30",
                        outputVariable: "touchpointData"
                    }
                },
                {
                    id: "code-first-touch",
                    type: "code",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "First-Touch Attribution",
                        language: "javascript",
                        code: "const conversions = inputs.conversionData.conversions || [];\nconst attribution = {};\nconversions.forEach(c => {\n  const firstTouch = c.touchpoints[0]?.channel;\n  if (firstTouch) attribution[firstTouch] = (attribution[firstTouch] || 0) + c.value;\n});\nreturn { model: 'first-touch', attribution };",
                        outputVariable: "firstTouchModel"
                    }
                },
                {
                    id: "code-last-touch",
                    type: "code",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Last-Touch Attribution",
                        language: "javascript",
                        code: "const conversions = inputs.conversionData.conversions || [];\nconst attribution = {};\nconversions.forEach(c => {\n  const lastTouch = c.touchpoints[c.touchpoints.length - 1]?.channel;\n  if (lastTouch) attribution[lastTouch] = (attribution[lastTouch] || 0) + c.value;\n});\nreturn { model: 'last-touch', attribution };",
                        outputVariable: "lastTouchModel"
                    }
                },
                {
                    id: "code-linear",
                    type: "code",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Linear Attribution",
                        language: "javascript",
                        code: "const conversions = inputs.conversionData.conversions || [];\nconst attribution = {};\nconversions.forEach(c => {\n  const touchCount = c.touchpoints.length;\n  const valuePerTouch = c.value / touchCount;\n  c.touchpoints.forEach(t => {\n    attribution[t.channel] = (attribution[t.channel] || 0) + valuePerTouch;\n  });\n});\nreturn { model: 'linear', attribution };",
                        outputVariable: "linearModel"
                    }
                },
                {
                    id: "llm-compare",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Compare Models",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Compare these attribution models:\n\nFirst-Touch: {{firstTouchModel}}\nLast-Touch: {{lastTouchModel}}\nLinear: {{linearModel}}\n\nAnalyze:\n1. Which channels look best in each model\n2. Channels that are undervalued\n3. Model recommendations by business type\n4. Budget allocation suggestions\n5. Channel synergies observed",
                        outputVariable: "modelComparison"
                    }
                },
                {
                    id: "llm-budget",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Budget Recommendation",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Based on this attribution analysis:\n\n{{modelComparison.text}}\n\nProvide:\n1. Recommended budget allocation %\n2. Channels to increase spend\n3. Channels to decrease spend\n4. Expected ROI impact\n5. Testing recommendations",
                        outputVariable: "budgetRecommendation"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Attribution Report",
                        outputName: "result",
                        value: "{{budgetRecommendation}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "trigger-1", target: "http-conversions" },
                { id: "e2", source: "trigger-1", target: "http-touchpoints" },
                { id: "e3", source: "http-conversions", target: "code-first-touch" },
                { id: "e4", source: "http-conversions", target: "code-last-touch" },
                { id: "e5", source: "http-conversions", target: "code-linear" },
                { id: "e6", source: "code-first-touch", target: "llm-compare" },
                { id: "e7", source: "code-last-touch", target: "llm-compare" },
                { id: "e8", source: "code-linear", target: "llm-compare" },
                { id: "e9", source: "llm-compare", target: "llm-budget" },
                { id: "e10", source: "llm-budget", target: "output-1" }
            ]
        }
    },

    // Data & Analytics 9: Customer Cohort Analyzer
    {
        name: "Customer Cohort Analyzer",
        description:
            "Analyze customer behavior by acquisition cohort. Calculates retention, LTV, and engagement patterns across cohorts.",
        category: "data-analytics",
        tags: ["cohorts", "retention", "ltv", "analytics", "customers"],
        required_integrations: [],
        featured: false,
        definition: {
            name: "Customer Cohort Analyzer",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Monthly Analysis",
                        triggerType: "schedule",
                        schedule: "0 9 1 * *"
                    }
                },
                {
                    id: "http-customers",
                    type: "http",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Fetch Customer Data",
                        method: "GET",
                        url: "https://api.crm.example.com/customers",
                        outputVariable: "customerData"
                    }
                },
                {
                    id: "code-segment",
                    type: "code",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Segment Into Cohorts",
                        language: "javascript",
                        code: "const customers = inputs.customerData.customers || [];\nconst cohorts = {};\ncustomers.forEach(c => {\n  const cohortMonth = c.createdAt.substring(0, 7);\n  if (!cohorts[cohortMonth]) cohorts[cohortMonth] = [];\n  cohorts[cohortMonth].push(c);\n});\nreturn { cohorts: Object.keys(cohorts), cohortSizes: Object.fromEntries(Object.entries(cohorts).map(([k, v]) => [k, v.length])) };",
                        outputVariable: "cohortSegments"
                    }
                },
                {
                    id: "loop-cohorts",
                    type: "loop",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Analyze Each Cohort",
                        loopType: "forEach",
                        collection: "{{cohortSegments.cohorts}}",
                        itemVariable: "cohort",
                        indexVariable: "cohortIndex"
                    }
                },
                {
                    id: "llm-analyze",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Analyze Cohort Metrics",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Analyze this customer cohort: {{cohort}}\n\nCalculate and report:\n1. Retention rates by month (1-12)\n2. Average LTV\n3. Engagement score\n4. Churn points\n5. Comparison to overall average",
                        outputVariable: "cohortAnalysis"
                    }
                },
                {
                    id: "shared-memory-store",
                    type: "shared-memory",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Store Cohort Analysis",
                        operation: "set",
                        key: "cohort_{{cohort}}",
                        value: "{{cohortAnalysis.text}}"
                    }
                },
                {
                    id: "llm-report",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Cohort Report",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Create a comprehensive cohort analysis report.\n\nCohorts: {{cohortSegments}}\n\nProvide:\n1. Cohort comparison matrix\n2. Best and worst performing cohorts\n3. Retention trends over time\n4. LTV trends\n5. Recommendations for improving retention",
                        outputVariable: "cohortReport"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Cohort Report",
                        outputName: "result",
                        value: "{{cohortReport}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "trigger-1", target: "http-customers" },
                { id: "e2", source: "http-customers", target: "code-segment" },
                { id: "e3", source: "code-segment", target: "loop-cohorts" },
                { id: "e4", source: "loop-cohorts", target: "llm-analyze" },
                { id: "e5", source: "llm-analyze", target: "shared-memory-store" },
                { id: "e6", source: "shared-memory-store", target: "llm-report" },
                { id: "e7", source: "llm-report", target: "output-1" }
            ]
        }
    },

    // Data & Analytics 10: Batch Data Processor
    {
        name: "Batch Data Processor",
        description:
            "Process large data files in batches. Chunks data, applies transformations, aggregates results, and exports processed output.",
        category: "data-analytics",
        tags: ["batch", "etl", "processing", "transform", "data"],
        required_integrations: [],
        featured: false,
        definition: {
            name: "Batch Data Processor",
            nodes: [
                {
                    id: "files-1",
                    type: "files",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Upload Data File",
                        inputVariable: "dataFile",
                        allowedTypes: ["text/csv", "application/json"],
                        description: "Upload large CSV or JSON file"
                    }
                },
                {
                    id: "input-config",
                    type: "input",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Processing Config",
                        inputName: "processingConfig",
                        inputVariable: "processingConfig",
                        inputType: "text",
                        description:
                            "Describe the transformations needed (filter, map, aggregate, etc.)"
                    }
                },
                {
                    id: "code-chunk",
                    type: "code",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Chunk Data",
                        language: "javascript",
                        code: "const data = inputs.dataFile.content || [];\nconst chunkSize = 1000;\nconst chunks = [];\nfor (let i = 0; i < data.length; i += chunkSize) {\n  chunks.push(data.slice(i, i + chunkSize));\n}\nreturn { chunks, totalRecords: data.length, chunkCount: chunks.length };",
                        outputVariable: "chunkedData"
                    }
                },
                {
                    id: "loop-chunks",
                    type: "loop",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Process Each Chunk",
                        loopType: "forEach",
                        collection: "{{chunkedData.chunks}}",
                        itemVariable: "chunk",
                        indexVariable: "chunkIndex"
                    }
                },
                {
                    id: "llm-transform",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Transform Code",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Generate JavaScript code to transform this data chunk according to the config:\n\nConfig: {{processingConfig}}\nSample data: {{chunk}}\n\nReturn only the transformation code that processes an array and returns the transformed array.",
                        outputVariable: "transformCode"
                    }
                },
                {
                    id: "code-apply",
                    type: "code",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Apply Transformation",
                        language: "javascript",
                        code: "const chunk = inputs.chunk;\n// Apply basic transformations\nconst transformed = chunk.map(item => {\n  // Clean and normalize\n  return { ...item, processed: true };\n});\nreturn { processed: transformed.length, results: transformed };",
                        outputVariable: "chunkResult"
                    }
                },
                {
                    id: "shared-memory-store",
                    type: "shared-memory",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Accumulate Results",
                        operation: "append",
                        key: "processed_data",
                        value: "{{chunkResult.results}}"
                    }
                },
                {
                    id: "transform-merge",
                    type: "transform",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Merge All Results",
                        transformType: "flatten",
                        outputVariable: "mergedResults"
                    }
                },
                {
                    id: "llm-summary",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Summary",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Summarize this batch processing job:\n\nOriginal records: {{chunkedData.totalRecords}}\nChunks processed: {{chunkedData.chunkCount}}\n\nProvide processing statistics and any data quality observations.",
                        outputVariable: "processSummary"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Processed Data",
                        outputName: "result",
                        value: "{{mergedResults}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "files-1", target: "code-chunk" },
                { id: "e2", source: "input-config", target: "llm-transform" },
                { id: "e3", source: "code-chunk", target: "loop-chunks" },
                { id: "e4", source: "loop-chunks", target: "llm-transform" },
                { id: "e5", source: "llm-transform", target: "code-apply" },
                { id: "e6", source: "code-apply", target: "shared-memory-store" },
                { id: "e7", source: "shared-memory-store", target: "transform-merge" },
                { id: "e8", source: "transform-merge", target: "llm-summary" },
                { id: "e9", source: "llm-summary", target: "output-1" }
            ]
        }
    },

    // ========================================================================
    // VOICE & AUDIO (8 templates)
    // ========================================================================

    // Voice & Audio 1: Meeting Transcription Pipeline
    {
        name: "Meeting Transcription Pipeline",
        description:
            "Transcribe and summarize meeting recordings. Converts speech to text, generates summaries, extracts action items, and distributes notes.",
        category: "voice-audio",
        tags: ["transcription", "meetings", "summary", "action-items", "speech-to-text"],
        required_integrations: ["slack", "notion"],
        featured: true,
        definition: {
            name: "Meeting Transcription Pipeline",
            nodes: [
                {
                    id: "files-1",
                    type: "files",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Meeting Recording",
                        inputVariable: "meetingRecording",
                        allowedTypes: ["audio/*", "video/*"],
                        description: "Upload meeting recording"
                    }
                },
                {
                    id: "input-context",
                    type: "input",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Meeting Context",
                        inputName: "meetingContext",
                        inputVariable: "meetingContext",
                        inputType: "text",
                        description: "Meeting title, attendees, agenda (optional)"
                    }
                },
                {
                    id: "audioInput-1",
                    type: "audioInput",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Transcribe Audio",
                        provider: "openai",
                        model: "whisper-1",
                        inputVariable: "meetingRecording",
                        outputVariable: "transcript"
                    }
                },
                {
                    id: "llm-summary",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Summary",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Summarize this meeting transcript:\n\nContext: {{meetingContext}}\n\nTranscript:\n{{transcript.text}}\n\nProvide:\n1. Meeting summary (2-3 paragraphs)\n2. Key discussion points\n3. Decisions made\n4. Action items with owners\n5. Next steps\n6. Open questions",
                        outputVariable: "meetingSummary"
                    }
                },
                {
                    id: "llm-actions",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Extract Action Items",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Extract action items from this transcript:\n\n{{transcript.text}}\n\nFor each action item, identify:\n1. Task description\n2. Owner (if mentioned)\n3. Due date (if mentioned)\n4. Priority (based on context)\n\nReturn as JSON array.",
                        outputVariable: "actionItems"
                    }
                },
                {
                    id: "integration-notion",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Save to Notion",
                        provider: "notion",
                        operation: "createPage",
                        database: "Meeting Notes"
                    }
                },
                {
                    id: "llm-slack",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Format for Slack",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Format this meeting summary for Slack:\n\n{{meetingSummary.text}}\n\nUse emoji, keep concise, highlight action items.",
                        outputVariable: "slackMessage"
                    }
                },
                {
                    id: "integration-slack",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Post to Slack",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#meeting-notes"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Meeting Notes",
                        outputName: "result",
                        value: "{{meetingSummary}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "files-1", target: "audioInput-1" },
                { id: "e2", source: "input-context", target: "llm-summary" },
                { id: "e3", source: "audioInput-1", target: "llm-summary" },
                { id: "e4", source: "audioInput-1", target: "llm-actions" },
                { id: "e5", source: "llm-summary", target: "integration-notion" },
                { id: "e6", source: "llm-actions", target: "integration-notion" },
                { id: "e7", source: "llm-summary", target: "llm-slack" },
                { id: "e8", source: "llm-slack", target: "integration-slack" },
                { id: "e9", source: "integration-slack", target: "output-1" }
            ]
        }
    },

    // Voice & Audio 2: Podcast Production Suite
    {
        name: "Podcast Production Suite",
        description:
            "Full podcast post-production workflow. Transcribes episodes, generates show notes, creates social clips, and prepares distribution assets.",
        category: "voice-audio",
        tags: ["podcast", "transcription", "show-notes", "social-media", "content"],
        required_integrations: [],
        featured: true,
        definition: {
            name: "Podcast Production Suite",
            nodes: [
                {
                    id: "files-1",
                    type: "files",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Podcast Episode",
                        inputVariable: "podcastAudio",
                        allowedTypes: ["audio/*"],
                        description: "Upload raw podcast recording"
                    }
                },
                {
                    id: "input-meta",
                    type: "input",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Episode Metadata",
                        inputName: "episodeMeta",
                        inputVariable: "episodeMeta",
                        inputType: "text",
                        description: "Episode title, guest name, topic"
                    }
                },
                {
                    id: "audioInput-1",
                    type: "audioInput",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Transcribe Episode",
                        provider: "openai",
                        model: "whisper-1",
                        inputVariable: "podcastAudio",
                        outputVariable: "transcript"
                    }
                },
                {
                    id: "llm-timestamps",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Timestamps",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Create chapter timestamps from this podcast transcript:\n\n{{transcript.text}}\n\nIdentify major topic changes and create timestamps in format:\n00:00 - Introduction\n02:30 - Topic 1\netc.",
                        outputVariable: "timestamps"
                    }
                },
                {
                    id: "llm-shownotes",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Show Notes",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Create comprehensive show notes for this podcast:\n\nMetadata: {{episodeMeta}}\nTranscript: {{transcript.text}}\nTimestamps: {{timestamps.text}}\n\nInclude:\n1. Episode summary\n2. Key takeaways\n3. Resources mentioned\n4. Guest bio\n5. Links\n6. Timestamps",
                        outputVariable: "showNotes"
                    }
                },
                {
                    id: "llm-clips",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Identify Social Clips",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Identify 3-5 compelling segments from this transcript that would make great social media clips:\n\n{{transcript.text}}\n\nFor each clip:\n1. Start/end timestamps (approximate)\n2. Quote or summary\n3. Why it's shareable\n4. Suggested caption\n5. Best platform (Twitter, LinkedIn, TikTok)",
                        outputVariable: "socialClips"
                    }
                },
                {
                    id: "llm-seo",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate SEO Content",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Generate SEO-optimized content for this podcast:\n\nMetadata: {{episodeMeta}}\nSummary: {{showNotes.text}}\n\nCreate:\n1. Episode title (with keywords)\n2. Meta description\n3. Keywords/tags\n4. Blog post version",
                        outputVariable: "seoContent"
                    }
                },
                {
                    id: "transform-package",
                    type: "transform",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Compile Production Package",
                        transformType: "template",
                        template:
                            "# Podcast Production Package\n\n## Episode: {{episodeMeta}}\n\n## Show Notes\n{{showNotes.text}}\n\n## Social Clips\n{{socialClips.text}}\n\n## SEO Content\n{{seoContent.text}}",
                        outputVariable: "productionPackage"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Production Package",
                        outputName: "result",
                        value: "{{productionPackage}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "files-1", target: "audioInput-1" },
                { id: "e2", source: "input-meta", target: "llm-shownotes" },
                { id: "e3", source: "audioInput-1", target: "llm-timestamps" },
                { id: "e4", source: "llm-timestamps", target: "llm-shownotes" },
                { id: "e5", source: "audioInput-1", target: "llm-clips" },
                { id: "e6", source: "llm-shownotes", target: "llm-seo" },
                { id: "e7", source: "llm-shownotes", target: "transform-package" },
                { id: "e8", source: "llm-clips", target: "transform-package" },
                { id: "e9", source: "llm-seo", target: "transform-package" },
                { id: "e10", source: "transform-package", target: "output-1" }
            ]
        }
    },

    // Voice & Audio 3: Voice Message Responder
    {
        name: "Voice Message Responder",
        description:
            "Auto-respond to voice messages with AI-generated voice replies. Transcribes incoming messages, generates responses, and converts to speech.",
        category: "voice-audio",
        tags: ["voice", "response", "tts", "automation", "communication"],
        required_integrations: [],
        featured: false,
        definition: {
            name: "Voice Message Responder",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Voice Message Received",
                        triggerType: "webhook",
                        description: "Triggered when a voice message is received"
                    }
                },
                {
                    id: "audioInput-1",
                    type: "audioInput",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Transcribe Message",
                        provider: "openai",
                        model: "whisper-1",
                        outputVariable: "incomingTranscript"
                    }
                },
                {
                    id: "llm-classify",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Classify Intent",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: 'Classify this voice message intent:\n\n{{incomingTranscript.text}}\n\nCategories: Question, Request, Complaint, FeedbackPositive, Greeting, Other\n\nReturn: {"intent": "...", "urgency": "low/medium/high", "sentiment": "positive/neutral/negative"}',
                        outputVariable: "classification"
                    }
                },
                {
                    id: "llm-response",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Response",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Generate a voice response to this message:\n\nOriginal: {{incomingTranscript.text}}\nIntent: {{classification.text}}\n\nWrite a conversational, helpful response that:\n1. Acknowledges their message\n2. Addresses their need\n3. Is appropriate for text-to-speech (no special characters)\n4. Is under 150 words",
                        outputVariable: "responseText"
                    }
                },
                {
                    id: "audioOutput-1",
                    type: "audioOutput",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Voice Response",
                        provider: "openai",
                        model: "tts-1",
                        voice: "alloy",
                        input: "{{responseText.text}}",
                        outputVariable: "voiceResponse"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Voice Response",
                        outputName: "result",
                        value: "{{voiceResponse}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "trigger-1", target: "audioInput-1" },
                { id: "e2", source: "audioInput-1", target: "llm-classify" },
                { id: "e3", source: "llm-classify", target: "llm-response" },
                { id: "e4", source: "llm-response", target: "audioOutput-1" },
                { id: "e5", source: "audioOutput-1", target: "output-1" }
            ]
        }
    },

    // Voice & Audio 4: Call Center Analytics
    {
        name: "Call Center Analytics",
        description:
            "Analyze support call recordings for quality and insights. Batch processes calls, extracts metrics, and generates performance reports.",
        category: "voice-audio",
        tags: ["call-center", "analytics", "support", "quality", "batch"],
        required_integrations: [],
        featured: false,
        definition: {
            name: "Call Center Analytics",
            nodes: [
                {
                    id: "files-1",
                    type: "files",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Call Recordings",
                        inputVariable: "callRecordings",
                        allowedTypes: ["audio/*"],
                        description: "Upload batch of call recordings"
                    }
                },
                {
                    id: "loop-calls",
                    type: "loop",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Process Each Call",
                        loopType: "forEach",
                        collection: "{{callRecordings}}",
                        itemVariable: "currentCall",
                        indexVariable: "callIndex"
                    }
                },
                {
                    id: "audioInput-1",
                    type: "audioInput",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Transcribe Call",
                        provider: "openai",
                        model: "whisper-1",
                        inputVariable: "currentCall",
                        outputVariable: "callTranscript"
                    }
                },
                {
                    id: "llm-analyze",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Analyze Call",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Analyze this support call transcript:\n\n{{callTranscript.text}}\n\nProvide:\n1. Call sentiment (customer satisfaction 1-10)\n2. Issue category\n3. Resolution status (resolved/escalated/pending)\n4. Agent performance score\n5. Key moments (positive/negative)\n6. Improvement suggestions\n7. Call duration estimate\n8. Customer effort score",
                        outputVariable: "callAnalysis"
                    }
                },
                {
                    id: "shared-memory-store",
                    type: "shared-memory",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Store Analysis",
                        operation: "set",
                        key: "call_{{callIndex}}",
                        value: "{{callAnalysis.text}}"
                    }
                },
                {
                    id: "llm-aggregate",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Aggregate Metrics",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Aggregate call center analytics from all analyzed calls.\n\nProvide:\n1. Average satisfaction score\n2. Resolution rate\n3. Top issue categories\n4. Agent performance ranking\n5. Common improvement areas\n6. Trends and patterns\n7. Recommendations",
                        outputVariable: "aggregateMetrics"
                    }
                },
                {
                    id: "llm-report",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Report",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Create a call center analytics report:\n\n{{aggregateMetrics.text}}\n\nFormat as executive summary with charts data and actionable insights.",
                        outputVariable: "analyticsReport"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Analytics Report",
                        outputName: "result",
                        value: "{{analyticsReport}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "files-1", target: "loop-calls" },
                { id: "e2", source: "loop-calls", target: "audioInput-1" },
                { id: "e3", source: "audioInput-1", target: "llm-analyze" },
                { id: "e4", source: "llm-analyze", target: "shared-memory-store" },
                { id: "e5", source: "shared-memory-store", target: "llm-aggregate" },
                { id: "e6", source: "llm-aggregate", target: "llm-report" },
                { id: "e7", source: "llm-report", target: "output-1" }
            ]
        }
    },

    // Voice & Audio 5: Voice-to-Task Creator
    {
        name: "Voice-to-Task Creator",
        description:
            "Create tasks from voice notes. Transcribes voice input, extracts tasks with details, and creates them in project management tools.",
        category: "voice-audio",
        tags: ["voice", "tasks", "productivity", "automation", "project-management"],
        required_integrations: ["notion"],
        featured: false,
        definition: {
            name: "Voice-to-Task Creator",
            nodes: [
                {
                    id: "files-1",
                    type: "files",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Voice Note",
                        inputVariable: "voiceNote",
                        allowedTypes: ["audio/*"],
                        description: "Record or upload voice note with tasks"
                    }
                },
                {
                    id: "audioInput-1",
                    type: "audioInput",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Transcribe Voice",
                        provider: "openai",
                        model: "whisper-1",
                        inputVariable: "voiceNote",
                        outputVariable: "transcript"
                    }
                },
                {
                    id: "llm-extract",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Extract Tasks",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Extract tasks from this voice note:\n\n{{transcript.text}}\n\nFor each task, identify:\n1. Task title (clear, actionable)\n2. Description (if any context given)\n3. Due date (if mentioned, otherwise null)\n4. Priority (high/medium/low based on language)\n5. Assignee (if mentioned)\n6. Project/category (if mentioned)\n\nReturn as JSON array.",
                        outputVariable: "extractedTasks"
                    }
                },
                {
                    id: "loop-tasks",
                    type: "loop",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Create Each Task",
                        loopType: "forEach",
                        collection: "{{extractedTasks.text}}",
                        itemVariable: "task",
                        indexVariable: "taskIndex"
                    }
                },
                {
                    id: "integration-notion",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Create in Notion",
                        provider: "notion",
                        operation: "createPage",
                        database: "Tasks"
                    }
                },
                {
                    id: "shared-memory-log",
                    type: "shared-memory",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Log Created Task",
                        operation: "append",
                        key: "created_tasks",
                        value: "{{task}}"
                    }
                },
                {
                    id: "audioOutput-1",
                    type: "audioOutput",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Confirm Creation",
                        provider: "openai",
                        model: "tts-1",
                        voice: "alloy",
                        input: "Created {{extractedTasks.length}} tasks from your voice note.",
                        outputVariable: "confirmation"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Created Tasks",
                        outputName: "result",
                        value: "{{extractedTasks}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "files-1", target: "audioInput-1" },
                { id: "e2", source: "audioInput-1", target: "llm-extract" },
                { id: "e3", source: "llm-extract", target: "loop-tasks" },
                { id: "e4", source: "loop-tasks", target: "integration-notion" },
                { id: "e5", source: "integration-notion", target: "shared-memory-log" },
                { id: "e6", source: "shared-memory-log", target: "audioOutput-1" },
                { id: "e7", source: "audioOutput-1", target: "output-1" }
            ]
        }
    },

    // Voice & Audio 6: Interview Analyzer
    {
        name: "Interview Analyzer",
        description:
            "Analyze interview recordings for hiring decisions. Transcribes with speaker diarization, evaluates candidates, and generates structured feedback.",
        category: "voice-audio",
        tags: ["interview", "hiring", "analysis", "hr", "evaluation"],
        required_integrations: [],
        featured: false,
        definition: {
            name: "Interview Analyzer",
            nodes: [
                {
                    id: "files-1",
                    type: "files",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Interview Recording",
                        inputVariable: "interviewRecording",
                        allowedTypes: ["audio/*", "video/*"],
                        description: "Upload interview recording"
                    }
                },
                {
                    id: "input-jd",
                    type: "input",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Job Requirements",
                        inputName: "jobRequirements",
                        inputVariable: "jobRequirements",
                        inputType: "text",
                        description: "Role requirements and evaluation criteria"
                    }
                },
                {
                    id: "audioInput-1",
                    type: "audioInput",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Transcribe Interview",
                        provider: "openai",
                        model: "whisper-1",
                        inputVariable: "interviewRecording",
                        outputVariable: "transcript"
                    }
                },
                {
                    id: "llm-identify",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Identify Speakers",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Analyze this interview transcript and identify speakers:\n\n{{transcript.text}}\n\nLabel as:\n- Interviewer: questions, probing\n- Candidate: answers, responses\n\nReturn transcript with speaker labels.",
                        outputVariable: "labeledTranscript"
                    }
                },
                {
                    id: "llm-evaluate",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Evaluate Candidate",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Evaluate this candidate based on the interview:\n\nJob Requirements: {{jobRequirements}}\n\nTranscript: {{labeledTranscript.text}}\n\nEvaluate:\n1. Technical competence (1-10)\n2. Communication skills (1-10)\n3. Problem-solving ability (1-10)\n4. Cultural fit indicators\n5. Red flags\n6. Strengths demonstrated\n7. Areas of concern\n8. Overall recommendation (strong yes/yes/maybe/no)",
                        outputVariable: "evaluation"
                    }
                },
                {
                    id: "llm-questions",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Suggest Follow-ups",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Based on this interview evaluation:\n\n{{evaluation.text}}\n\nSuggest:\n1. Follow-up questions for next round\n2. Areas to probe deeper\n3. Reference check questions",
                        outputVariable: "followUpQuestions"
                    }
                },
                {
                    id: "transform-report",
                    type: "transform",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Compile Report",
                        transformType: "template",
                        template:
                            "# Interview Analysis Report\n\n## Evaluation\n{{evaluation.text}}\n\n## Follow-up Recommendations\n{{followUpQuestions.text}}",
                        outputVariable: "interviewReport"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Interview Report",
                        outputName: "result",
                        value: "{{interviewReport}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "files-1", target: "audioInput-1" },
                { id: "e2", source: "input-jd", target: "llm-evaluate" },
                { id: "e3", source: "audioInput-1", target: "llm-identify" },
                { id: "e4", source: "llm-identify", target: "llm-evaluate" },
                { id: "e5", source: "llm-evaluate", target: "llm-questions" },
                { id: "e6", source: "llm-evaluate", target: "transform-report" },
                { id: "e7", source: "llm-questions", target: "transform-report" },
                { id: "e8", source: "transform-report", target: "output-1" }
            ]
        }
    },

    // Voice & Audio 7: Audiobook Narrator
    {
        name: "Audiobook Narrator",
        description:
            "Convert documents into audiobooks. Extracts text, optimizes for narration, generates chapter-by-chapter audio, and combines into final audiobook.",
        category: "voice-audio",
        tags: ["audiobook", "tts", "narration", "content", "accessibility"],
        required_integrations: [],
        featured: false,
        definition: {
            name: "Audiobook Narrator",
            nodes: [
                {
                    id: "files-1",
                    type: "files",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Upload Document",
                        inputVariable: "document",
                        allowedTypes: ["application/pdf", "text/*"],
                        description: "Upload book or document to narrate"
                    }
                },
                {
                    id: "input-voice",
                    type: "input",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Voice Settings",
                        inputName: "voiceSettings",
                        inputVariable: "voiceSettings",
                        inputType: "text",
                        description: "Voice preference: alloy, echo, fable, onyx, nova, shimmer"
                    }
                },
                {
                    id: "llm-extract",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Extract & Structure",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Extract text from this document and structure for audiobook narration:\n\n1. Identify chapters/sections\n2. Remove non-narration elements (page numbers, headers)\n3. Add natural pauses (paragraph breaks)\n4. Mark emphasis points\n5. Handle abbreviations (spell out for speech)\n\nReturn as JSON with chapters array.",
                        outputVariable: "structuredText"
                    }
                },
                {
                    id: "llm-optimize",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Optimize for Narration",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Optimize this text for text-to-speech narration:\n\n{{structuredText.text}}\n\n1. Replace symbols with words\n2. Expand abbreviations\n3. Add SSML-style pauses\n4. Simplify complex punctuation\n5. Note pronunciation for unusual words",
                        outputVariable: "narratableText"
                    }
                },
                {
                    id: "loop-chapters",
                    type: "loop",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Narrate Each Chapter",
                        loopType: "forEach",
                        collection: "{{narratableText.text}}",
                        itemVariable: "chapter",
                        indexVariable: "chapterIndex"
                    }
                },
                {
                    id: "audioOutput-1",
                    type: "audioOutput",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Chapter Audio",
                        provider: "openai",
                        model: "tts-1-hd",
                        voice: "{{voiceSettings}}",
                        input: "{{chapter}}",
                        outputVariable: "chapterAudio"
                    }
                },
                {
                    id: "shared-memory-store",
                    type: "shared-memory",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Store Chapter Audio",
                        operation: "set",
                        key: "chapter_{{chapterIndex}}",
                        value: "{{chapterAudio}}"
                    }
                },
                {
                    id: "transform-compile",
                    type: "transform",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Compile Audiobook",
                        transformType: "template",
                        template: "Audiobook generated with {{chapterIndex}} chapters.",
                        outputVariable: "audiobookInfo"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Audiobook",
                        outputName: "result",
                        value: "{{audiobookInfo}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "files-1", target: "llm-extract" },
                { id: "e2", source: "llm-extract", target: "llm-optimize" },
                { id: "e3", source: "llm-optimize", target: "loop-chapters" },
                { id: "e4", source: "input-voice", target: "audioOutput-1" },
                { id: "e5", source: "loop-chapters", target: "audioOutput-1" },
                { id: "e6", source: "audioOutput-1", target: "shared-memory-store" },
                { id: "e7", source: "shared-memory-store", target: "transform-compile" },
                { id: "e8", source: "transform-compile", target: "output-1" }
            ]
        }
    },

    // Voice & Audio 8: Pronunciation Guide Generator
    {
        name: "Pronunciation Guide Generator",
        description:
            "Create audio pronunciation guides for terminology. Takes term lists, generates phonetic guides, and creates audio samples for each term.",
        category: "voice-audio",
        tags: ["pronunciation", "guide", "tts", "learning", "terminology"],
        required_integrations: [],
        featured: false,
        definition: {
            name: "Pronunciation Guide Generator",
            nodes: [
                {
                    id: "input-terms",
                    type: "input",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Terms List",
                        inputName: "termsList",
                        inputVariable: "termsList",
                        inputType: "text",
                        description: "List of terms/names needing pronunciation (one per line)"
                    }
                },
                {
                    id: "input-context",
                    type: "input",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Context",
                        inputName: "context",
                        inputVariable: "context",
                        inputType: "text",
                        description: "Domain context (medical, legal, names, etc.)"
                    }
                },
                {
                    id: "llm-phonetics",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Phonetics",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Create pronunciation guide for these terms:\n\nContext: {{context}}\nTerms:\n{{termsList}}\n\nFor each term provide:\n1. IPA pronunciation\n2. Simplified phonetic spelling\n3. Syllable breakdown\n4. Common mispronunciations to avoid\n5. Usage context/example sentence\n\nReturn as JSON array.",
                        outputVariable: "phoneticGuide"
                    }
                },
                {
                    id: "loop-terms",
                    type: "loop",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Each Audio",
                        loopType: "forEach",
                        collection: "{{phoneticGuide.text}}",
                        itemVariable: "term",
                        indexVariable: "termIndex"
                    }
                },
                {
                    id: "llm-script",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Create Audio Script",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Create a pronunciation audio script for: {{term}}\n\nFormat: '[Term]. [Pause] [Slow pronunciation]. [Pause] [Normal speed]. [Pause] [Example sentence].'\n\nReturn just the script text.",
                        outputVariable: "audioScript"
                    }
                },
                {
                    id: "audioOutput-1",
                    type: "audioOutput",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Audio",
                        provider: "openai",
                        model: "tts-1-hd",
                        voice: "onyx",
                        input: "{{audioScript.text}}",
                        outputVariable: "termAudio"
                    }
                },
                {
                    id: "shared-memory-store",
                    type: "shared-memory",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Store Audio",
                        operation: "set",
                        key: "pronunciation_{{termIndex}}",
                        value: "{{termAudio}}"
                    }
                },
                {
                    id: "transform-guide",
                    type: "transform",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Compile Guide",
                        transformType: "template",
                        template:
                            "# Pronunciation Guide\n\nContext: {{context}}\n\n## Terms\n{{phoneticGuide.text}}\n\nAudio files generated for each term.",
                        outputVariable: "pronunciationGuide"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Pronunciation Guide",
                        outputName: "result",
                        value: "{{pronunciationGuide}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "input-terms", target: "llm-phonetics" },
                { id: "e2", source: "input-context", target: "llm-phonetics" },
                { id: "e3", source: "llm-phonetics", target: "loop-terms" },
                { id: "e4", source: "loop-terms", target: "llm-script" },
                { id: "e5", source: "llm-script", target: "audioOutput-1" },
                { id: "e6", source: "audioOutput-1", target: "shared-memory-store" },
                { id: "e7", source: "shared-memory-store", target: "transform-guide" },
                { id: "e8", source: "transform-guide", target: "output-1" }
            ]
        }
    },

    // ========================================================================
    // ADVANCED LOGIC (8 templates)
    // ========================================================================

    // Advanced Logic 1: Multi-Stage Approval Workflow
    {
        name: "Multi-Stage Approval Workflow",
        description:
            "Handle complex multi-level approvals with dynamic routing. Supports sequential approvers, escalation, and parallel approval tracks.",
        category: "advanced-logic",
        tags: ["approval", "workflow", "routing", "human-in-loop", "enterprise"],
        required_integrations: ["slack"],
        featured: true,
        definition: {
            name: "Multi-Stage Approval Workflow",
            nodes: [
                {
                    id: "input-request",
                    type: "input",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Approval Request",
                        inputName: "approvalRequest",
                        inputVariable: "approvalRequest",
                        inputType: "text",
                        description: "What needs approval? Include amount/details."
                    }
                },
                {
                    id: "llm-determine",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Determine Approval Chain",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: 'Determine the approval chain for this request:\n\n{{approvalRequest}}\n\nBased on the request type and amount, define:\n1. Required approvers (in order)\n2. Approval thresholds\n3. Escalation rules\n4. Timeout actions\n\nReturn as JSON: {"approvers": [...], "thresholds": {...}, "escalation": {...}}',
                        outputVariable: "approvalChain"
                    }
                },
                {
                    id: "shared-memory-init",
                    type: "shared-memory",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Initialize State",
                        operation: "set",
                        key: "approval_state",
                        value: '{"currentLevel": 0, "approvals": [], "status": "pending"}'
                    }
                },
                {
                    id: "loop-approvers",
                    type: "loop",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Process Approval Levels",
                        loopType: "forEach",
                        collection: "{{approvalChain.text}}",
                        itemVariable: "approver",
                        indexVariable: "level"
                    }
                },
                {
                    id: "humanReview-1",
                    type: "humanReview",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Request Approval",
                        reviewPrompt:
                            "Approval Request Level {{level}}:\n\n{{approvalRequest}}\n\nApprover: {{approver}}\n\nPrevious approvals: Check state\n\nOptions: Approve, Reject, Escalate",
                        outputVariable: "approvalDecision"
                    }
                },
                {
                    id: "switch-decision",
                    type: "switch",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Route by Decision",
                        expression: "{{approvalDecision.decision}}",
                        cases: [
                            { value: "approve", label: "Approved" },
                            { value: "reject", label: "Rejected" },
                            { value: "escalate", label: "Escalate" }
                        ],
                        defaultCase: "approve"
                    }
                },
                {
                    id: "shared-memory-approve",
                    type: "shared-memory",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Record Approval",
                        operation: "set",
                        key: "approval_{{level}}",
                        value: '{"approved": true, "by": "{{approver}}", "timestamp": "now"}'
                    }
                },
                {
                    id: "integration-slack-reject",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Notify Rejection",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#approvals"
                    }
                },
                {
                    id: "llm-escalate",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Determine Escalation",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Escalation requested for approval. Current chain: {{approvalChain.text}}\n\nDetermine next level escalation approver.",
                        outputVariable: "escalationPath"
                    }
                },
                {
                    id: "integration-slack-complete",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Notify Completion",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#approvals"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Approval Result",
                        outputName: "result",
                        value: "{{approvalDecision}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "input-request", target: "llm-determine" },
                { id: "e2", source: "llm-determine", target: "shared-memory-init" },
                { id: "e3", source: "shared-memory-init", target: "loop-approvers" },
                { id: "e4", source: "loop-approvers", target: "humanReview-1" },
                { id: "e5", source: "humanReview-1", target: "switch-decision" },
                {
                    id: "e6",
                    source: "switch-decision",
                    target: "shared-memory-approve",
                    sourceHandle: "approve"
                },
                {
                    id: "e7",
                    source: "switch-decision",
                    target: "integration-slack-reject",
                    sourceHandle: "reject"
                },
                {
                    id: "e8",
                    source: "switch-decision",
                    target: "llm-escalate",
                    sourceHandle: "escalate"
                },
                { id: "e9", source: "shared-memory-approve", target: "integration-slack-complete" },
                { id: "e10", source: "integration-slack-complete", target: "output-1" },
                { id: "e11", source: "integration-slack-reject", target: "output-1" },
                { id: "e12", source: "llm-escalate", target: "humanReview-1" }
            ]
        }
    },

    // Advanced Logic 2: Retry with Exponential Backoff
    {
        name: "Retry with Exponential Backoff",
        description:
            "Robust API integration with automatic retries. Implements exponential backoff for failed requests with configurable retry limits.",
        category: "advanced-logic",
        tags: ["retry", "backoff", "api", "resilience", "error-handling"],
        required_integrations: [],
        featured: false,
        definition: {
            name: "Retry with Exponential Backoff",
            nodes: [
                {
                    id: "input-request",
                    type: "input",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "API Request",
                        inputName: "apiRequest",
                        inputVariable: "apiRequest",
                        inputType: "text",
                        description: "API endpoint and parameters (JSON)"
                    }
                },
                {
                    id: "code-init",
                    type: "code",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Initialize Retry State",
                        language: "javascript",
                        code: "return { attempt: 0, maxAttempts: 5, baseDelay: 1000, lastError: null };",
                        outputVariable: "retryState"
                    }
                },
                {
                    id: "loop-retry",
                    type: "loop",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Retry Loop",
                        loopType: "while",
                        condition: "retryState.attempt < retryState.maxAttempts",
                        itemVariable: "iteration"
                    }
                },
                {
                    id: "http-call",
                    type: "http",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Make API Call",
                        method: "POST",
                        url: "{{apiRequest.url}}",
                        body: "{{apiRequest.body}}",
                        outputVariable: "apiResponse"
                    }
                },
                {
                    id: "conditional-success",
                    type: "conditional",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Call Successful?",
                        condition: "apiResponse.status >= 200 && apiResponse.status < 300",
                        outputVariable: "isSuccess"
                    }
                },
                {
                    id: "output-success",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Success Response",
                        outputName: "result",
                        value: "{{apiResponse}}"
                    }
                },
                {
                    id: "code-backoff",
                    type: "code",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Calculate Backoff",
                        language: "javascript",
                        code: "const state = inputs.retryState;\nconst delay = state.baseDelay * Math.pow(2, state.attempt);\nstate.attempt++;\nstate.lastError = inputs.apiResponse.error;\nreturn { ...state, nextDelay: delay };",
                        outputVariable: "retryState"
                    }
                },
                {
                    id: "wait-backoff",
                    type: "wait",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Wait Before Retry",
                        duration: "{{retryState.nextDelay}}",
                        description: "Exponential backoff wait"
                    }
                },
                {
                    id: "conditional-max",
                    type: "conditional",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Max Retries Reached?",
                        condition: "retryState.attempt >= retryState.maxAttempts",
                        outputVariable: "maxReached"
                    }
                },
                {
                    id: "output-failure",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "All Retries Failed",
                        outputName: "error",
                        value: "{{retryState}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "input-request", target: "code-init" },
                { id: "e2", source: "code-init", target: "loop-retry" },
                { id: "e3", source: "loop-retry", target: "http-call" },
                { id: "e4", source: "http-call", target: "conditional-success" },
                {
                    id: "e5",
                    source: "conditional-success",
                    target: "output-success",
                    sourceHandle: "true"
                },
                {
                    id: "e6",
                    source: "conditional-success",
                    target: "code-backoff",
                    sourceHandle: "false"
                },
                { id: "e7", source: "code-backoff", target: "wait-backoff" },
                { id: "e8", source: "wait-backoff", target: "conditional-max" },
                {
                    id: "e9",
                    source: "conditional-max",
                    target: "loop-retry",
                    sourceHandle: "false"
                },
                {
                    id: "e10",
                    source: "conditional-max",
                    target: "output-failure",
                    sourceHandle: "true"
                }
            ]
        }
    },

    // Advanced Logic 3: Dynamic Workflow Router
    {
        name: "Dynamic Workflow Router",
        description:
            "AI-driven workflow path selection. Classifies incoming requests and routes to appropriate sub-workflows based on intent.",
        category: "advanced-logic",
        tags: ["router", "classification", "dynamic", "ai-routing", "intent"],
        required_integrations: [],
        featured: true,
        definition: {
            name: "Dynamic Workflow Router",
            nodes: [
                {
                    id: "input-request",
                    type: "input",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "User Request",
                        inputName: "userRequest",
                        inputVariable: "userRequest",
                        inputType: "text",
                        description: "Enter the user request to route"
                    }
                },
                {
                    id: "router-classify",
                    type: "router",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Classify & Route",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Classify this request and route to the appropriate handler:\n\n{{userRequest}}\n\nCategories:\n- support: Technical issues, bugs, how-to questions\n- sales: Pricing, demo requests, enterprise inquiries\n- billing: Payment issues, invoices, refunds\n- feedback: Feature requests, complaints, praise\n- other: Anything that doesn't fit",
                        routes: [
                            { value: "support", label: "Support" },
                            { value: "sales", label: "Sales" },
                            { value: "billing", label: "Billing" },
                            { value: "feedback", label: "Feedback" }
                        ],
                        defaultRoute: "other",
                        outputVariable: "routeDecision"
                    }
                },
                {
                    id: "llm-support",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Handle Support",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Handle this support request:\n\n{{userRequest}}\n\nProvide:\n1. Immediate troubleshooting steps\n2. Relevant documentation links\n3. Escalation criteria if needed",
                        outputVariable: "supportResponse"
                    }
                },
                {
                    id: "llm-sales",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Handle Sales",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Handle this sales inquiry:\n\n{{userRequest}}\n\nProvide:\n1. Product information\n2. Pricing overview\n3. Next steps (demo, trial, contact)",
                        outputVariable: "salesResponse"
                    }
                },
                {
                    id: "llm-billing",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Handle Billing",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Handle this billing inquiry:\n\n{{userRequest}}\n\nProvide:\n1. Billing policy information\n2. Steps to resolve\n3. Contact for complex issues",
                        outputVariable: "billingResponse"
                    }
                },
                {
                    id: "llm-feedback",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Handle Feedback",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Acknowledge this feedback:\n\n{{userRequest}}\n\nProvide:\n1. Thank the user\n2. Summarize their feedback\n3. Set expectations for follow-up",
                        outputVariable: "feedbackResponse"
                    }
                },
                {
                    id: "humanReview-other",
                    type: "humanReview",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Manual Routing",
                        reviewPrompt:
                            "This request needs manual routing:\n\n{{userRequest}}\n\nPlease route to appropriate team.",
                        outputVariable: "manualRoute"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Response",
                        outputName: "result",
                        value: "{{routeDecision}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "input-request", target: "router-classify" },
                {
                    id: "e2",
                    source: "router-classify",
                    target: "llm-support",
                    sourceHandle: "support"
                },
                { id: "e3", source: "router-classify", target: "llm-sales", sourceHandle: "sales" },
                {
                    id: "e4",
                    source: "router-classify",
                    target: "llm-billing",
                    sourceHandle: "billing"
                },
                {
                    id: "e5",
                    source: "router-classify",
                    target: "llm-feedback",
                    sourceHandle: "feedback"
                },
                {
                    id: "e6",
                    source: "router-classify",
                    target: "humanReview-other",
                    sourceHandle: "default"
                },
                { id: "e7", source: "llm-support", target: "output-1" },
                { id: "e8", source: "llm-sales", target: "output-1" },
                { id: "e9", source: "llm-billing", target: "output-1" },
                { id: "e10", source: "llm-feedback", target: "output-1" },
                { id: "e11", source: "humanReview-other", target: "output-1" }
            ]
        }
    },

    // Advanced Logic 4: Scheduled Task Orchestrator
    {
        name: "Scheduled Task Orchestrator",
        description:
            "Run different tasks based on time and schedule. Routes to hourly, daily, weekly, or monthly tasks based on current time.",
        category: "advanced-logic",
        tags: ["schedule", "orchestration", "cron", "automation", "tasks"],
        required_integrations: [],
        featured: false,
        definition: {
            name: "Scheduled Task Orchestrator",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Hourly Check",
                        triggerType: "schedule",
                        schedule: "0 * * * *"
                    }
                },
                {
                    id: "code-time",
                    type: "code",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Determine Task Type",
                        language: "javascript",
                        code: "const now = new Date();\nconst hour = now.getHours();\nconst day = now.getDay();\nconst date = now.getDate();\n\nlet taskType = 'hourly';\nif (date === 1 && hour === 9) taskType = 'monthly';\nelse if (day === 1 && hour === 9) taskType = 'weekly';\nelse if (hour === 9) taskType = 'daily-morning';\nelse if (hour === 18) taskType = 'daily-evening';\n\nreturn { taskType, hour, day, date };",
                        outputVariable: "timeContext"
                    }
                },
                {
                    id: "switch-task",
                    type: "switch",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Route by Task Type",
                        expression: "{{timeContext.taskType}}",
                        cases: [
                            { value: "hourly", label: "Hourly Tasks" },
                            { value: "daily-morning", label: "Morning Tasks" },
                            { value: "daily-evening", label: "Evening Tasks" },
                            { value: "weekly", label: "Weekly Tasks" },
                            { value: "monthly", label: "Monthly Tasks" }
                        ],
                        defaultCase: "hourly"
                    }
                },
                {
                    id: "llm-hourly",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Run Hourly Tasks",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Execute hourly tasks:\n1. Health checks\n2. Cache refresh\n3. Metrics collection\n\nReturn task results summary.",
                        outputVariable: "hourlyResult"
                    }
                },
                {
                    id: "llm-morning",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Run Morning Tasks",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Execute morning daily tasks:\n1. Generate daily digest\n2. Check overnight alerts\n3. Prepare day's schedule\n\nReturn task results.",
                        outputVariable: "morningResult"
                    }
                },
                {
                    id: "llm-evening",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Run Evening Tasks",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Execute evening daily tasks:\n1. Daily summary report\n2. Log aggregation\n3. Next day preparation\n\nReturn task results.",
                        outputVariable: "eveningResult"
                    }
                },
                {
                    id: "llm-weekly",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Run Weekly Tasks",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Execute weekly tasks:\n1. Weekly analytics report\n2. Trend analysis\n3. Performance review\n4. Cleanup operations\n\nReturn task results.",
                        outputVariable: "weeklyResult"
                    }
                },
                {
                    id: "llm-monthly",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Run Monthly Tasks",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Execute monthly tasks:\n1. Monthly report generation\n2. Invoice processing\n3. Usage analysis\n4. Compliance checks\n5. Archive old data\n\nReturn task results.",
                        outputVariable: "monthlyResult"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Task Results",
                        outputName: "result",
                        value: "{{timeContext}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "trigger-1", target: "code-time" },
                { id: "e2", source: "code-time", target: "switch-task" },
                { id: "e3", source: "switch-task", target: "llm-hourly", sourceHandle: "hourly" },
                {
                    id: "e4",
                    source: "switch-task",
                    target: "llm-morning",
                    sourceHandle: "daily-morning"
                },
                {
                    id: "e5",
                    source: "switch-task",
                    target: "llm-evening",
                    sourceHandle: "daily-evening"
                },
                { id: "e6", source: "switch-task", target: "llm-weekly", sourceHandle: "weekly" },
                { id: "e7", source: "switch-task", target: "llm-monthly", sourceHandle: "monthly" },
                { id: "e8", source: "llm-hourly", target: "output-1" },
                { id: "e9", source: "llm-morning", target: "output-1" },
                { id: "e10", source: "llm-evening", target: "output-1" },
                { id: "e11", source: "llm-weekly", target: "output-1" },
                { id: "e12", source: "llm-monthly", target: "output-1" }
            ]
        }
    },

    // Advanced Logic 5: Saga Pattern (Compensating Transactions)
    {
        name: "Saga Pattern Workflow",
        description:
            "Multi-step transactions with automatic rollback on failure. Implements the saga pattern with compensating transactions for each step.",
        category: "advanced-logic",
        tags: ["saga", "transactions", "rollback", "compensation", "reliability"],
        required_integrations: [],
        featured: false,
        definition: {
            name: "Saga Pattern Workflow",
            nodes: [
                {
                    id: "input-transaction",
                    type: "input",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Transaction Request",
                        inputName: "transactionRequest",
                        inputVariable: "transactionRequest",
                        inputType: "text",
                        description: "Multi-step transaction details"
                    }
                },
                {
                    id: "code-init",
                    type: "code",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Initialize Saga",
                        language: "javascript",
                        code: "return {\n  sagaId: 'saga_' + Date.now(),\n  steps: [\n    { name: 'reserve_inventory', status: 'pending', compensation: 'release_inventory' },\n    { name: 'charge_payment', status: 'pending', compensation: 'refund_payment' },\n    { name: 'create_order', status: 'pending', compensation: 'cancel_order' },\n    { name: 'send_notification', status: 'pending', compensation: 'none' }\n  ],\n  completedSteps: [],\n  currentStep: 0\n};",
                        outputVariable: "sagaState"
                    }
                },
                {
                    id: "loop-steps",
                    type: "loop",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Execute Saga Steps",
                        loopType: "forEach",
                        collection: "{{sagaState.steps}}",
                        itemVariable: "step",
                        indexVariable: "stepIndex"
                    }
                },
                {
                    id: "llm-execute",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Execute Step",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: 'Execute saga step: {{step.name}}\n\nTransaction: {{transactionRequest}}\n\nSimulate execution and return: {"success": true/false, "result": "...", "error": null/"..."}',
                        outputVariable: "stepResult"
                    }
                },
                {
                    id: "conditional-success",
                    type: "conditional",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Step Successful?",
                        condition: "stepResult.text.includes('\"success\": true')",
                        outputVariable: "stepSuccess"
                    }
                },
                {
                    id: "shared-memory-log",
                    type: "shared-memory",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Log Completed Step",
                        operation: "append",
                        key: "completed_steps",
                        value: "{{step}}"
                    }
                },
                {
                    id: "loop-compensate",
                    type: "loop",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Execute Compensations",
                        loopType: "forEach",
                        collection: "{{sagaState.completedSteps}}",
                        itemVariable: "completedStep",
                        indexVariable: "compIndex"
                    }
                },
                {
                    id: "llm-compensate",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Execute Compensation",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Execute compensation action: {{completedStep.compensation}}\n\nOriginal step: {{completedStep.name}}\n\nReturn compensation result.",
                        outputVariable: "compensationResult"
                    }
                },
                {
                    id: "output-success",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Transaction Complete",
                        outputName: "result",
                        value: "{{sagaState}}"
                    }
                },
                {
                    id: "output-failure",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Transaction Rolled Back",
                        outputName: "error",
                        value: "{{sagaState}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "input-transaction", target: "code-init" },
                { id: "e2", source: "code-init", target: "loop-steps" },
                { id: "e3", source: "loop-steps", target: "llm-execute" },
                { id: "e4", source: "llm-execute", target: "conditional-success" },
                {
                    id: "e5",
                    source: "conditional-success",
                    target: "shared-memory-log",
                    sourceHandle: "true"
                },
                {
                    id: "e6",
                    source: "conditional-success",
                    target: "loop-compensate",
                    sourceHandle: "false"
                },
                { id: "e7", source: "shared-memory-log", target: "output-success" },
                { id: "e8", source: "loop-compensate", target: "llm-compensate" },
                { id: "e9", source: "llm-compensate", target: "output-failure" }
            ]
        }
    },

    // Advanced Logic 6: Rate-Limited Batch Processor
    {
        name: "Rate-Limited Batch Processor",
        description:
            "Process items while respecting API rate limits. Tracks request rates and waits when approaching limits.",
        category: "advanced-logic",
        tags: ["rate-limit", "batch", "api", "throttling", "processing"],
        required_integrations: [],
        featured: false,
        definition: {
            name: "Rate-Limited Batch Processor",
            nodes: [
                {
                    id: "input-items",
                    type: "input",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Items to Process",
                        inputName: "items",
                        inputVariable: "items",
                        inputType: "text",
                        description: "JSON array of items to process"
                    }
                },
                {
                    id: "input-ratelimit",
                    type: "input",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Rate Limit Config",
                        inputName: "rateLimit",
                        inputVariable: "rateLimit",
                        inputType: "text",
                        defaultValue: '{"maxPerMinute": 60, "maxPerHour": 1000}'
                    }
                },
                {
                    id: "code-init",
                    type: "code",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Initialize Rate Tracker",
                        language: "javascript",
                        code: "const config = JSON.parse(inputs.rateLimit);\nreturn {\n  processed: 0,\n  minuteCount: 0,\n  hourCount: 0,\n  lastMinuteReset: Date.now(),\n  lastHourReset: Date.now(),\n  maxPerMinute: config.maxPerMinute,\n  maxPerHour: config.maxPerHour\n};",
                        outputVariable: "rateTracker"
                    }
                },
                {
                    id: "loop-items",
                    type: "loop",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Process Each Item",
                        loopType: "forEach",
                        collection: "{{items}}",
                        itemVariable: "currentItem",
                        indexVariable: "itemIndex"
                    }
                },
                {
                    id: "code-check-rate",
                    type: "code",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Check Rate Limit",
                        language: "javascript",
                        code: "const tracker = inputs.rateTracker;\nconst now = Date.now();\n\n// Reset counters if time windows passed\nif (now - tracker.lastMinuteReset > 60000) {\n  tracker.minuteCount = 0;\n  tracker.lastMinuteReset = now;\n}\nif (now - tracker.lastHourReset > 3600000) {\n  tracker.hourCount = 0;\n  tracker.lastHourReset = now;\n}\n\nconst nearMinuteLimit = tracker.minuteCount >= tracker.maxPerMinute * 0.9;\nconst nearHourLimit = tracker.hourCount >= tracker.maxPerHour * 0.9;\nconst waitTime = nearMinuteLimit ? 60000 - (now - tracker.lastMinuteReset) : 0;\n\nreturn { ...tracker, needsWait: nearMinuteLimit, waitTime };",
                        outputVariable: "rateTracker"
                    }
                },
                {
                    id: "conditional-wait",
                    type: "conditional",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Needs Wait?",
                        condition: "rateTracker.needsWait === true",
                        outputVariable: "shouldWait"
                    }
                },
                {
                    id: "wait-rate",
                    type: "wait",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Wait for Rate Reset",
                        duration: "{{rateTracker.waitTime}}",
                        description: "Wait until rate limit window resets"
                    }
                },
                {
                    id: "llm-process",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Process Item",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Process this item:\n\n{{currentItem}}\n\nReturn processing result.",
                        outputVariable: "itemResult"
                    }
                },
                {
                    id: "code-update",
                    type: "code",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Update Counters",
                        language: "javascript",
                        code: "const tracker = inputs.rateTracker;\ntracker.processed++;\ntracker.minuteCount++;\ntracker.hourCount++;\nreturn tracker;",
                        outputVariable: "rateTracker"
                    }
                },
                {
                    id: "shared-memory-progress",
                    type: "shared-memory",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Log Progress",
                        operation: "set",
                        key: "progress",
                        value: "{{rateTracker}}"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Processing Complete",
                        outputName: "result",
                        value: "{{rateTracker}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "input-items", target: "code-init" },
                { id: "e2", source: "input-ratelimit", target: "code-init" },
                { id: "e3", source: "code-init", target: "loop-items" },
                { id: "e4", source: "loop-items", target: "code-check-rate" },
                { id: "e5", source: "code-check-rate", target: "conditional-wait" },
                { id: "e6", source: "conditional-wait", target: "wait-rate", sourceHandle: "true" },
                {
                    id: "e7",
                    source: "conditional-wait",
                    target: "llm-process",
                    sourceHandle: "false"
                },
                { id: "e8", source: "wait-rate", target: "llm-process" },
                { id: "e9", source: "llm-process", target: "code-update" },
                { id: "e10", source: "code-update", target: "shared-memory-progress" },
                { id: "e11", source: "shared-memory-progress", target: "output-1" }
            ]
        }
    },

    // Advanced Logic 7: State Machine Workflow
    {
        name: "State Machine Workflow",
        description:
            "Implement complex state machines with persistent state. Manages entity state transitions with validation and history tracking.",
        category: "advanced-logic",
        tags: ["state-machine", "fsm", "transitions", "persistence", "workflow"],
        required_integrations: [],
        featured: true,
        definition: {
            name: "State Machine Workflow",
            nodes: [
                {
                    id: "input-event",
                    type: "input",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Event",
                        inputName: "event",
                        inputVariable: "event",
                        inputType: "text",
                        description: "Event type and entity ID (JSON)"
                    }
                },
                {
                    id: "shared-memory-get",
                    type: "shared-memory",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get Current State",
                        operation: "get",
                        key: "state_{{event.entityId}}",
                        outputVariable: "currentState"
                    }
                },
                {
                    id: "code-default",
                    type: "code",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Apply Default State",
                        language: "javascript",
                        code: "const current = inputs.currentState || { state: 'draft', history: [] };\nreturn current;",
                        outputVariable: "stateData"
                    }
                },
                {
                    id: "switch-state",
                    type: "switch",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Current State",
                        expression: "{{stateData.state}}",
                        cases: [
                            { value: "draft", label: "Draft" },
                            { value: "pending_review", label: "Pending Review" },
                            { value: "approved", label: "Approved" },
                            { value: "rejected", label: "Rejected" },
                            { value: "published", label: "Published" }
                        ],
                        defaultCase: "draft"
                    }
                },
                {
                    id: "llm-draft",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Handle Draft State",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: 'Entity in DRAFT state received event: {{event}}\n\nValid transitions: submit -> pending_review\n\nReturn: {"newState": "...", "valid": true/false, "message": "..."}',
                        outputVariable: "draftTransition"
                    }
                },
                {
                    id: "llm-pending",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Handle Pending Review",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: 'Entity in PENDING_REVIEW state received event: {{event}}\n\nValid transitions: approve -> approved, reject -> rejected, revise -> draft\n\nReturn: {"newState": "...", "valid": true/false, "message": "..."}',
                        outputVariable: "pendingTransition"
                    }
                },
                {
                    id: "llm-approved",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Handle Approved State",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: 'Entity in APPROVED state received event: {{event}}\n\nValid transitions: publish -> published, revoke -> draft\n\nReturn: {"newState": "...", "valid": true/false, "message": "..."}',
                        outputVariable: "approvedTransition"
                    }
                },
                {
                    id: "code-update-state",
                    type: "code",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Update State",
                        language: "javascript",
                        code: "const transition = inputs.transition;\nconst stateData = inputs.stateData;\nif (transition.valid) {\n  stateData.state = transition.newState;\n  stateData.history.push({ from: stateData.state, to: transition.newState, at: new Date().toISOString(), event: inputs.event });\n}\nreturn { ...stateData, lastTransition: transition };",
                        outputVariable: "newStateData"
                    }
                },
                {
                    id: "shared-memory-set",
                    type: "shared-memory",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Persist State",
                        operation: "set",
                        key: "state_{{event.entityId}}",
                        value: "{{newStateData}}"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "State Result",
                        outputName: "result",
                        value: "{{newStateData}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "input-event", target: "shared-memory-get" },
                { id: "e2", source: "shared-memory-get", target: "code-default" },
                { id: "e3", source: "code-default", target: "switch-state" },
                { id: "e4", source: "switch-state", target: "llm-draft", sourceHandle: "draft" },
                {
                    id: "e5",
                    source: "switch-state",
                    target: "llm-pending",
                    sourceHandle: "pending_review"
                },
                {
                    id: "e6",
                    source: "switch-state",
                    target: "llm-approved",
                    sourceHandle: "approved"
                },
                { id: "e7", source: "llm-draft", target: "code-update-state" },
                { id: "e8", source: "llm-pending", target: "code-update-state" },
                { id: "e9", source: "llm-approved", target: "code-update-state" },
                { id: "e10", source: "code-update-state", target: "shared-memory-set" },
                { id: "e11", source: "shared-memory-set", target: "output-1" }
            ]
        }
    },

    // Advanced Logic 8: Parallel Processing with Aggregation
    {
        name: "Parallel Processing with Aggregation",
        description:
            "Process items in parallel batches and aggregate results. Splits work into parallel tracks and combines results at the end.",
        category: "advanced-logic",
        tags: ["parallel", "batch", "aggregation", "performance", "processing"],
        required_integrations: [],
        featured: false,
        definition: {
            name: "Parallel Processing with Aggregation",
            nodes: [
                {
                    id: "input-items",
                    type: "input",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Items to Process",
                        inputName: "items",
                        inputVariable: "items",
                        inputType: "text",
                        description: "Large list of items to process in parallel"
                    }
                },
                {
                    id: "code-split",
                    type: "code",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Split Into Batches",
                        language: "javascript",
                        code: "const items = JSON.parse(inputs.items);\nconst batchSize = 10;\nconst batches = [];\nfor (let i = 0; i < items.length; i += batchSize) {\n  batches.push(items.slice(i, i + batchSize));\n}\nreturn { batches, totalItems: items.length, batchCount: batches.length };",
                        outputVariable: "batchedItems"
                    }
                },
                {
                    id: "llm-batch1",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Process Batch 1",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Process this batch of items:\n\n{{batchedItems.batches[0]}}\n\nReturn processing results as JSON array.",
                        outputVariable: "batch1Result"
                    }
                },
                {
                    id: "llm-batch2",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Process Batch 2",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Process this batch of items:\n\n{{batchedItems.batches[1]}}\n\nReturn processing results as JSON array.",
                        outputVariable: "batch2Result"
                    }
                },
                {
                    id: "llm-batch3",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Process Batch 3",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Process this batch of items:\n\n{{batchedItems.batches[2]}}\n\nReturn processing results as JSON array.",
                        outputVariable: "batch3Result"
                    }
                },
                {
                    id: "transform-aggregate",
                    type: "transform",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Aggregate Results",
                        transformType: "merge",
                        sources: ["{{batch1Result}}", "{{batch2Result}}", "{{batch3Result}}"],
                        outputVariable: "aggregatedResults"
                    }
                },
                {
                    id: "llm-summarize",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Summarize Processing",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Summarize the parallel processing results:\n\nTotal items: {{batchedItems.totalItems}}\nBatches: {{batchedItems.batchCount}}\nResults: {{aggregatedResults}}\n\nProvide:\n1. Success count\n2. Failure count\n3. Processing patterns\n4. Recommendations",
                        outputVariable: "processSummary"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Processing Results",
                        outputName: "result",
                        value: "{{processSummary}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "input-items", target: "code-split" },
                { id: "e2", source: "code-split", target: "llm-batch1" },
                { id: "e3", source: "code-split", target: "llm-batch2" },
                { id: "e4", source: "code-split", target: "llm-batch3" },
                { id: "e5", source: "llm-batch1", target: "transform-aggregate" },
                { id: "e6", source: "llm-batch2", target: "transform-aggregate" },
                { id: "e7", source: "llm-batch3", target: "transform-aggregate" },
                { id: "e8", source: "transform-aggregate", target: "llm-summarize" },
                { id: "e9", source: "llm-summarize", target: "output-1" }
            ]
        }
    },

    // ========================================================================
    // NEW TEMPLATES - BATCH 1: Using underutilized node types
    // ========================================================================

    // Support: Ticket Classification Engine (+1)
    {
        name: "Ticket Classification Engine",
        description:
            "Automatically classify support tickets by category, priority, and sentiment using AI analysis. Routes tickets to appropriate teams and tracks resolution metrics.",
        category: "support",
        tags: ["classification", "routing", "AI", "automation", "analytics"],
        required_integrations: ["zendesk", "slack"],
        featured: false,
        definition: {
            name: "Ticket Classification Engine",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "New Ticket Received",
                        triggerType: "webhook",
                        description: "Triggers when a new support ticket is created"
                    }
                },
                {
                    id: "integration-zendesk-get",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get Ticket Details",
                        provider: "zendesk",
                        operation: "getTicket"
                    }
                },
                {
                    id: "llm-classify",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Classify Ticket",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Analyze this support ticket and classify it:\n\nSubject: {{ticket.subject}}\nDescription: {{ticket.description}}\n\nProvide:\n1. Category (billing, technical, general, feature-request)\n2. Priority (urgent, high, medium, low)\n3. Sentiment (positive, neutral, negative)\n4. Suggested team assignment",
                        outputVariable: "classification"
                    }
                },
                {
                    id: "router-team",
                    type: "router",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Route to Team",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Based on classification: {{classification.text}}, determine the best team.",
                        routes: [
                            {
                                value: "billing",
                                label: "Billing Team",
                                description: "Payment and subscription issues"
                            },
                            {
                                value: "technical",
                                label: "Technical Support",
                                description: "Technical problems"
                            },
                            {
                                value: "success",
                                label: "Customer Success",
                                description: "General inquiries"
                            }
                        ],
                        defaultRoute: "success",
                        outputVariable: "teamRoute"
                    }
                },
                {
                    id: "database-log",
                    type: "database",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Log Classification",
                        provider: "postgresql",
                        operation: "insert",
                        query: "INSERT INTO ticket_classifications (ticket_id, category, priority, sentiment, team) VALUES ($1, $2, $3, $4, $5)",
                        outputVariable: "logResult"
                    }
                },
                {
                    id: "integration-zendesk-update",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Update Ticket Tags",
                        provider: "zendesk",
                        operation: "updateTicket"
                    }
                },
                {
                    id: "integration-slack",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Notify Team",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#support-routing"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Classification Complete",
                        outputName: "result",
                        value: "{{classification}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "trigger-1", target: "integration-zendesk-get" },
                { id: "e2", source: "integration-zendesk-get", target: "llm-classify" },
                { id: "e3", source: "llm-classify", target: "router-team" },
                { id: "e4", source: "router-team", target: "database-log" },
                { id: "e5", source: "database-log", target: "integration-zendesk-update" },
                { id: "e6", source: "integration-zendesk-update", target: "integration-slack" },
                { id: "e7", source: "integration-slack", target: "output-1" }
            ]
        }
    },

    // Sales: Lead Enrichment Pipeline (+1 of 4)
    {
        name: "Lead Enrichment Pipeline",
        description:
            "Automatically enrich leads with company data, social profiles, and buying signals from web sources. Scores leads and syncs enriched data to CRM.",
        category: "sales",
        tags: ["lead enrichment", "web scraping", "CRM", "automation"],
        required_integrations: ["salesforce", "slack"],
        featured: false,
        definition: {
            name: "Lead Enrichment Pipeline",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "New Lead Created",
                        triggerType: "webhook",
                        description: "Triggers when a new lead is added to CRM"
                    }
                },
                {
                    id: "webSearch-company",
                    type: "webSearch",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Search Company Info",
                        query: "{{lead.company}} company information funding employees",
                        maxResults: 5,
                        outputVariable: "companySearch"
                    }
                },
                {
                    id: "webBrowse-linkedin",
                    type: "webBrowse",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Browse LinkedIn Profile",
                        url: "{{lead.linkedinUrl}}",
                        extractType: "text",
                        outputVariable: "linkedinData"
                    }
                },
                {
                    id: "llm-analyze",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Analyze Lead Data",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Analyze this lead information:\n\nCompany Search Results: {{companySearch}}\nLinkedIn Data: {{linkedinData}}\n\nExtract:\n1. Company size and industry\n2. Recent funding/news\n3. Decision-maker indicators\n4. Buying signals\n5. Lead score (1-100)",
                        outputVariable: "enrichedData"
                    }
                },
                {
                    id: "database-store",
                    type: "database",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Store Enrichment Data",
                        provider: "postgresql",
                        operation: "insert",
                        query: "INSERT INTO lead_enrichments (lead_id, company_data, score, enriched_at) VALUES ($1, $2, $3, NOW())",
                        outputVariable: "storeResult"
                    }
                },
                {
                    id: "integration-salesforce",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Update Salesforce Lead",
                        provider: "salesforce",
                        operation: "updateLead"
                    }
                },
                {
                    id: "conditional-score",
                    type: "conditional",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Check Lead Score",
                        condition: "{{enrichedData.score}} >= 80",
                        outputVariable: "isHighScore"
                    }
                },
                {
                    id: "integration-slack",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Alert Sales Team",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#hot-leads"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Enrichment Complete",
                        outputName: "result",
                        value: "{{enrichedData}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "trigger-1", target: "webSearch-company" },
                { id: "e2", source: "trigger-1", target: "webBrowse-linkedin" },
                { id: "e3", source: "webSearch-company", target: "llm-analyze" },
                { id: "e4", source: "webBrowse-linkedin", target: "llm-analyze" },
                { id: "e5", source: "llm-analyze", target: "database-store" },
                { id: "e6", source: "database-store", target: "integration-salesforce" },
                { id: "e7", source: "integration-salesforce", target: "conditional-score" },
                {
                    id: "e8",
                    source: "conditional-score",
                    target: "integration-slack",
                    sourceHandle: "true"
                },
                {
                    id: "e9",
                    source: "conditional-score",
                    target: "output-1",
                    sourceHandle: "false"
                },
                { id: "e10", source: "integration-slack", target: "output-1" }
            ]
        }
    },

    // Sales: Proposal Generator (+2 of 4)
    {
        name: "AI Proposal Generator",
        description:
            "Generate professional sales proposals from opportunity data. Creates customized proposals with pricing, case studies, and implementation timelines as PDF documents.",
        category: "sales",
        tags: ["proposals", "PDF generation", "automation", "documents"],
        required_integrations: ["salesforce", "google-drive"],
        featured: false,
        definition: {
            name: "AI Proposal Generator",
            nodes: [
                {
                    id: "input-1",
                    type: "input",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Opportunity ID",
                        inputName: "opportunityId",
                        inputVariable: "opportunityId",
                        inputType: "text",
                        description: "Salesforce opportunity ID"
                    }
                },
                {
                    id: "integration-salesforce",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get Opportunity Details",
                        provider: "salesforce",
                        operation: "getOpportunity"
                    }
                },
                {
                    id: "database-cases",
                    type: "database",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get Relevant Case Studies",
                        provider: "postgresql",
                        operation: "select",
                        query: "SELECT * FROM case_studies WHERE industry = $1 ORDER BY success_score DESC LIMIT 3",
                        outputVariable: "caseStudies"
                    }
                },
                {
                    id: "llm-proposal",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Proposal Content",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Create a professional sales proposal based on:\n\nOpportunity: {{opportunity}}\nCase Studies: {{caseStudies}}\n\nInclude:\n1. Executive summary\n2. Solution overview\n3. Implementation timeline\n4. Pricing breakdown\n5. Success stories\n6. Next steps",
                        outputVariable: "proposalContent"
                    }
                },
                {
                    id: "pdfGeneration-1",
                    type: "pdfGeneration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Proposal PDF",
                        content: "{{proposalContent.text}}",
                        template: "sales-proposal",
                        outputVariable: "proposalPdf"
                    }
                },
                {
                    id: "integration-gdrive",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Upload to Google Drive",
                        provider: "google-drive",
                        operation: "uploadFile"
                    }
                },
                {
                    id: "integration-salesforce-attach",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Attach to Opportunity",
                        provider: "salesforce",
                        operation: "addAttachment"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Proposal Ready",
                        outputName: "result",
                        value: "{{proposalPdf}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "input-1", target: "integration-salesforce" },
                { id: "e2", source: "integration-salesforce", target: "database-cases" },
                { id: "e3", source: "database-cases", target: "llm-proposal" },
                { id: "e4", source: "llm-proposal", target: "pdfGeneration-1" },
                { id: "e5", source: "pdfGeneration-1", target: "integration-gdrive" },
                { id: "e6", source: "integration-gdrive", target: "integration-salesforce-attach" },
                { id: "e7", source: "integration-salesforce-attach", target: "output-1" }
            ]
        }
    },

    // Sales: Win/Loss Analyzer (+3 of 4)
    {
        name: "Win/Loss Analysis Dashboard",
        description:
            "Analyze closed deals to identify patterns in wins and losses. Generates charts showing key factors and provides actionable insights for sales improvement.",
        category: "sales",
        tags: ["analytics", "charts", "insights", "sales performance"],
        required_integrations: ["salesforce", "slack"],
        featured: false,
        definition: {
            name: "Win/Loss Analysis Dashboard",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Weekly Analysis",
                        triggerType: "schedule",
                        schedule: "0 9 * * 1",
                        description: "Run every Monday at 9am"
                    }
                },
                {
                    id: "database-closed",
                    type: "database",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get Closed Deals",
                        provider: "postgresql",
                        operation: "select",
                        query: "SELECT * FROM opportunities WHERE status IN ('won', 'lost') AND closed_at > NOW() - INTERVAL '30 days'",
                        outputVariable: "closedDeals"
                    }
                },
                {
                    id: "llm-analyze",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Analyze Patterns",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Analyze these closed deals and identify patterns:\n\n{{closedDeals}}\n\nProvide:\n1. Win rate by segment\n2. Common reasons for losses\n3. Successful tactics in wins\n4. Average deal cycle by outcome\n5. Recommendations for improvement",
                        outputVariable: "analysis"
                    }
                },
                {
                    id: "chartGeneration-winrate",
                    type: "chartGeneration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Create Win Rate Chart",
                        chartType: "bar",
                        data: "{{analysis.winRateBySegment}}",
                        title: "Win Rate by Segment",
                        outputVariable: "winRateChart"
                    }
                },
                {
                    id: "chartGeneration-reasons",
                    type: "chartGeneration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Create Loss Reasons Chart",
                        chartType: "pie",
                        data: "{{analysis.lossReasons}}",
                        title: "Loss Reasons Distribution",
                        outputVariable: "lossReasonsChart"
                    }
                },
                {
                    id: "spreadsheetGeneration-1",
                    type: "spreadsheetGeneration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Create Detailed Report",
                        data: "{{closedDeals}}",
                        format: "xlsx",
                        sheetName: "Win-Loss Analysis",
                        outputVariable: "reportSpreadsheet"
                    }
                },
                {
                    id: "integration-slack",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Share Analysis",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#sales-insights"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Analysis Complete",
                        outputName: "result",
                        value: "{{analysis}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "trigger-1", target: "database-closed" },
                { id: "e2", source: "database-closed", target: "llm-analyze" },
                { id: "e3", source: "llm-analyze", target: "chartGeneration-winrate" },
                { id: "e4", source: "llm-analyze", target: "chartGeneration-reasons" },
                { id: "e5", source: "llm-analyze", target: "spreadsheetGeneration-1" },
                { id: "e6", source: "chartGeneration-winrate", target: "integration-slack" },
                { id: "e7", source: "chartGeneration-reasons", target: "integration-slack" },
                { id: "e8", source: "spreadsheetGeneration-1", target: "integration-slack" },
                { id: "e9", source: "integration-slack", target: "output-1" }
            ]
        }
    },

    // Sales: Competitor Battlecard Creator (+4 of 4)
    {
        name: "Competitor Battlecard Creator",
        description:
            "Research competitors using web search and create sales battlecards with positioning, differentiators, and objection handling guides.",
        category: "sales",
        tags: ["competitive intel", "battlecards", "research", "sales enablement"],
        required_integrations: ["notion", "slack"],
        featured: false,
        definition: {
            name: "Competitor Battlecard Creator",
            nodes: [
                {
                    id: "input-1",
                    type: "input",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Competitor Name",
                        inputName: "competitorName",
                        inputVariable: "competitorName",
                        inputType: "text",
                        description: "Name of the competitor to research"
                    }
                },
                {
                    id: "webSearch-product",
                    type: "webSearch",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Search Product Info",
                        query: "{{competitorName}} product features pricing 2024",
                        maxResults: 10,
                        outputVariable: "productSearch"
                    }
                },
                {
                    id: "webSearch-reviews",
                    type: "webSearch",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Search Customer Reviews",
                        query: "{{competitorName}} reviews complaints customers",
                        maxResults: 10,
                        outputVariable: "reviewSearch"
                    }
                },
                {
                    id: "webBrowse-website",
                    type: "webBrowse",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Browse Competitor Website",
                        url: "https://{{competitorName}}.com",
                        extractType: "text",
                        outputVariable: "websiteContent"
                    }
                },
                {
                    id: "llm-battlecard",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Create Battlecard",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Create a sales battlecard for {{competitorName}} using:\n\nProduct Info: {{productSearch}}\nReviews: {{reviewSearch}}\nWebsite: {{websiteContent}}\n\nInclude:\n1. Company overview\n2. Product strengths/weaknesses\n3. Pricing comparison\n4. Common objections and responses\n5. Win themes against this competitor\n6. Questions to ask prospects",
                        outputVariable: "battlecard"
                    }
                },
                {
                    id: "pdfGeneration-1",
                    type: "pdfGeneration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Battlecard PDF",
                        content: "{{battlecard.text}}",
                        template: "battlecard",
                        outputVariable: "battlecardPdf"
                    }
                },
                {
                    id: "integration-notion",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Save to Notion",
                        provider: "notion",
                        operation: "createPage"
                    }
                },
                {
                    id: "integration-slack",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Notify Sales Team",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#competitive-intel"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Battlecard Created",
                        outputName: "result",
                        value: "{{battlecard}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "input-1", target: "webSearch-product" },
                { id: "e2", source: "input-1", target: "webSearch-reviews" },
                { id: "e3", source: "input-1", target: "webBrowse-website" },
                { id: "e4", source: "webSearch-product", target: "llm-battlecard" },
                { id: "e5", source: "webSearch-reviews", target: "llm-battlecard" },
                { id: "e6", source: "webBrowse-website", target: "llm-battlecard" },
                { id: "e7", source: "llm-battlecard", target: "pdfGeneration-1" },
                { id: "e8", source: "pdfGeneration-1", target: "integration-notion" },
                { id: "e9", source: "integration-notion", target: "integration-slack" },
                { id: "e10", source: "integration-slack", target: "output-1" }
            ]
        }
    },

    // SaaS: Churn Risk Predictor (+1 of 4)
    {
        name: "Churn Risk Predictor",
        description:
            "Analyze customer usage patterns and engagement data to predict churn risk. Triggers proactive outreach for at-risk accounts.",
        category: "saas",
        tags: ["churn prediction", "customer success", "analytics", "automation"],
        required_integrations: ["intercom", "slack"],
        featured: false,
        definition: {
            name: "Churn Risk Predictor",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Daily Analysis",
                        triggerType: "schedule",
                        schedule: "0 6 * * *",
                        description: "Run daily at 6am"
                    }
                },
                {
                    id: "database-usage",
                    type: "database",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get Usage Metrics",
                        provider: "postgresql",
                        operation: "select",
                        query: "SELECT customer_id, logins_30d, features_used, last_login, support_tickets FROM customer_metrics WHERE subscription_status = 'active'",
                        outputVariable: "usageData"
                    }
                },
                {
                    id: "llm-score",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Calculate Churn Risk",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Analyze customer usage data and calculate churn risk scores:\n\n{{usageData}}\n\nFor each customer, provide:\n1. Churn risk score (0-100)\n2. Key risk factors\n3. Recommended intervention\n\nReturn as JSON array sorted by risk score descending.",
                        outputVariable: "churnScores"
                    }
                },
                {
                    id: "loop-highrisk",
                    type: "loop",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Process High-Risk Customers",
                        items: "{{churnScores.highRisk}}",
                        itemVariable: "customer",
                        outputVariable: "processedCustomers"
                    }
                },
                {
                    id: "integration-intercom",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Create Intercom Task",
                        provider: "intercom",
                        operation: "createConversation"
                    }
                },
                {
                    id: "chartGeneration-1",
                    type: "chartGeneration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Create Risk Distribution Chart",
                        chartType: "histogram",
                        data: "{{churnScores}}",
                        title: "Churn Risk Distribution",
                        outputVariable: "riskChart"
                    }
                },
                {
                    id: "integration-slack",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Alert CS Team",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#customer-success"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Analysis Complete",
                        outputName: "result",
                        value: "{{churnScores}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "trigger-1", target: "database-usage" },
                { id: "e2", source: "database-usage", target: "llm-score" },
                { id: "e3", source: "llm-score", target: "loop-highrisk" },
                { id: "e4", source: "loop-highrisk", target: "integration-intercom" },
                { id: "e5", source: "llm-score", target: "chartGeneration-1" },
                { id: "e6", source: "integration-intercom", target: "integration-slack" },
                { id: "e7", source: "chartGeneration-1", target: "integration-slack" },
                { id: "e8", source: "integration-slack", target: "output-1" }
            ]
        }
    },

    // SaaS: Trial Conversion Workflow (+2 of 4)
    {
        name: "Trial Conversion Optimizer",
        description:
            "Monitor trial user behavior and trigger personalized outreach based on feature usage. Escalates to sales for high-value prospects.",
        category: "saas",
        tags: ["trial conversion", "automation", "personalization", "sales"],
        required_integrations: ["hubspot", "intercom", "slack"],
        featured: false,
        definition: {
            name: "Trial Conversion Optimizer",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Trial Day 7 Check",
                        triggerType: "schedule",
                        schedule: "0 10 * * *",
                        description: "Daily check for trials at day 7"
                    }
                },
                {
                    id: "database-trials",
                    type: "database",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get Day 7 Trials",
                        provider: "postgresql",
                        operation: "select",
                        query: "SELECT * FROM trials WHERE started_at = CURRENT_DATE - 7 AND status = 'active'",
                        outputVariable: "trials"
                    }
                },
                {
                    id: "loop-trials",
                    type: "loop",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Process Each Trial",
                        items: "{{trials}}",
                        itemVariable: "trial",
                        outputVariable: "processedTrials"
                    }
                },
                {
                    id: "llm-analyze",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Analyze Usage Pattern",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Analyze this trial user's behavior:\n\n{{trial}}\n\nDetermine:\n1. Engagement level (high/medium/low)\n2. Key features used\n3. Conversion likelihood\n4. Best messaging approach",
                        outputVariable: "trialAnalysis"
                    }
                },
                {
                    id: "router-engagement",
                    type: "router",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Route by Engagement",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Based on: {{trialAnalysis}}, determine the engagement level.",
                        routes: [
                            {
                                value: "high",
                                label: "High Engagement",
                                description: "Active users"
                            },
                            {
                                value: "medium",
                                label: "Medium Engagement",
                                description: "Some activity"
                            },
                            { value: "low", label: "Low Engagement", description: "Minimal usage" }
                        ],
                        defaultRoute: "medium",
                        outputVariable: "engagementRoute"
                    }
                },
                {
                    id: "integration-hubspot-high",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Create Sales Task",
                        provider: "hubspot",
                        operation: "createTask"
                    }
                },
                {
                    id: "integration-intercom-medium",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Send Feature Tips",
                        provider: "intercom",
                        operation: "sendMessage"
                    }
                },
                {
                    id: "integration-intercom-low",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Send Onboarding Help",
                        provider: "intercom",
                        operation: "sendMessage"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Outreach Complete",
                        outputName: "result",
                        value: "{{processedTrials}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "trigger-1", target: "database-trials" },
                { id: "e2", source: "database-trials", target: "loop-trials" },
                { id: "e3", source: "loop-trials", target: "llm-analyze" },
                { id: "e4", source: "llm-analyze", target: "router-engagement" },
                {
                    id: "e5",
                    source: "router-engagement",
                    target: "integration-hubspot-high",
                    sourceHandle: "high"
                },
                {
                    id: "e6",
                    source: "router-engagement",
                    target: "integration-intercom-medium",
                    sourceHandle: "medium"
                },
                {
                    id: "e7",
                    source: "router-engagement",
                    target: "integration-intercom-low",
                    sourceHandle: "low"
                },
                { id: "e8", source: "integration-hubspot-high", target: "output-1" },
                { id: "e9", source: "integration-intercom-medium", target: "output-1" },
                { id: "e10", source: "integration-intercom-low", target: "output-1" }
            ]
        }
    },

    // SaaS: API Usage Monitor (+3 of 4)
    {
        name: "API Usage Monitor & Alerter",
        description:
            "Monitor API usage patterns, detect anomalies, and alert when customers approach limits. Creates usage reports with charts.",
        category: "saas",
        tags: ["API monitoring", "alerts", "usage analytics", "charts"],
        required_integrations: ["pagerduty", "slack"],
        featured: false,
        definition: {
            name: "API Usage Monitor & Alerter",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Hourly Check",
                        triggerType: "schedule",
                        schedule: "0 * * * *",
                        description: "Run every hour"
                    }
                },
                {
                    id: "database-usage",
                    type: "database",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get API Usage",
                        provider: "postgresql",
                        operation: "select",
                        query: "SELECT customer_id, endpoint, request_count, error_count, avg_latency FROM api_usage_hourly WHERE hour = DATE_TRUNC('hour', NOW() - INTERVAL '1 hour')",
                        outputVariable: "usageData"
                    }
                },
                {
                    id: "database-limits",
                    type: "database",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get Customer Limits",
                        provider: "postgresql",
                        operation: "select",
                        query: "SELECT customer_id, monthly_limit, current_usage FROM customer_api_limits",
                        outputVariable: "limits"
                    }
                },
                {
                    id: "code-analyze",
                    type: "code",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Analyze Usage Patterns",
                        language: "javascript",
                        code: "const usage = JSON.parse(inputs.usageData);\nconst limits = JSON.parse(inputs.limits);\nconst alerts = [];\nfor (const customer of limits) {\n  const pct = (customer.current_usage / customer.monthly_limit) * 100;\n  if (pct >= 90) alerts.push({ customerId: customer.customer_id, usage: pct, level: 'critical' });\n  else if (pct >= 75) alerts.push({ customerId: customer.customer_id, usage: pct, level: 'warning' });\n}\nreturn { alerts, summary: { total: limits.length, critical: alerts.filter(a => a.level === 'critical').length } };",
                        outputVariable: "analysis"
                    }
                },
                {
                    id: "conditional-alerts",
                    type: "conditional",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Has Critical Alerts?",
                        condition: "{{analysis.summary.critical}} > 0",
                        outputVariable: "hasCritical"
                    }
                },
                {
                    id: "integration-pagerduty",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Create PagerDuty Incident",
                        provider: "pagerduty",
                        operation: "createIncident"
                    }
                },
                {
                    id: "chartGeneration-1",
                    type: "chartGeneration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Create Usage Chart",
                        chartType: "line",
                        data: "{{usageData}}",
                        title: "API Usage Trends",
                        outputVariable: "usageChart"
                    }
                },
                {
                    id: "integration-slack",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Send Usage Report",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#api-monitoring"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Monitoring Complete",
                        outputName: "result",
                        value: "{{analysis}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "trigger-1", target: "database-usage" },
                { id: "e2", source: "trigger-1", target: "database-limits" },
                { id: "e3", source: "database-usage", target: "code-analyze" },
                { id: "e4", source: "database-limits", target: "code-analyze" },
                { id: "e5", source: "code-analyze", target: "conditional-alerts" },
                {
                    id: "e6",
                    source: "conditional-alerts",
                    target: "integration-pagerduty",
                    sourceHandle: "true"
                },
                { id: "e7", source: "code-analyze", target: "chartGeneration-1" },
                {
                    id: "e8",
                    source: "conditional-alerts",
                    target: "chartGeneration-1",
                    sourceHandle: "false"
                },
                { id: "e9", source: "integration-pagerduty", target: "integration-slack" },
                { id: "e10", source: "chartGeneration-1", target: "integration-slack" },
                { id: "e11", source: "integration-slack", target: "output-1" }
            ]
        }
    },

    // SaaS: Customer Onboarding Tracker (+4 of 4)
    {
        name: "Onboarding Progress Tracker",
        description:
            "Track customer onboarding milestones and trigger automated follow-ups for stalled accounts. Generates progress reports.",
        category: "saas",
        tags: ["onboarding", "automation", "customer success", "tracking"],
        required_integrations: ["intercom", "slack"],
        featured: false,
        definition: {
            name: "Onboarding Progress Tracker",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Daily Onboarding Check",
                        triggerType: "schedule",
                        schedule: "0 9 * * *",
                        description: "Run daily at 9am"
                    }
                },
                {
                    id: "database-onboarding",
                    type: "database",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get Onboarding Status",
                        provider: "postgresql",
                        operation: "select",
                        query: "SELECT * FROM customer_onboarding WHERE status = 'in_progress' AND last_activity < NOW() - INTERVAL '3 days'",
                        outputVariable: "stalledAccounts"
                    }
                },
                {
                    id: "loop-stalled",
                    type: "loop",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Process Stalled Accounts",
                        items: "{{stalledAccounts}}",
                        itemVariable: "account",
                        outputVariable: "processedAccounts"
                    }
                },
                {
                    id: "llm-message",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Follow-up Message",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Create a friendly follow-up message for this stalled onboarding account:\n\n{{account}}\n\nIncomplete steps: {{account.incompleteSteps}}\n\nBe helpful and offer assistance with next steps.",
                        outputVariable: "followUpMessage"
                    }
                },
                {
                    id: "integration-intercom",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Send Follow-up",
                        provider: "intercom",
                        operation: "sendMessage"
                    }
                },
                {
                    id: "database-update",
                    type: "database",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Log Follow-up",
                        provider: "postgresql",
                        operation: "update",
                        query: "UPDATE customer_onboarding SET last_followup = NOW(), followup_count = followup_count + 1 WHERE id = $1",
                        outputVariable: "updateResult"
                    }
                },
                {
                    id: "spreadsheetGeneration-1",
                    type: "spreadsheetGeneration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Create Progress Report",
                        data: "{{stalledAccounts}}",
                        format: "xlsx",
                        sheetName: "Stalled Onboarding",
                        outputVariable: "progressReport"
                    }
                },
                {
                    id: "integration-slack",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Share Daily Summary",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#onboarding-alerts"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Tracking Complete",
                        outputName: "result",
                        value: "{{processedAccounts}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "trigger-1", target: "database-onboarding" },
                { id: "e2", source: "database-onboarding", target: "loop-stalled" },
                { id: "e3", source: "loop-stalled", target: "llm-message" },
                { id: "e4", source: "llm-message", target: "integration-intercom" },
                { id: "e5", source: "integration-intercom", target: "database-update" },
                { id: "e6", source: "database-onboarding", target: "spreadsheetGeneration-1" },
                { id: "e7", source: "database-update", target: "integration-slack" },
                { id: "e8", source: "spreadsheetGeneration-1", target: "integration-slack" },
                { id: "e9", source: "integration-slack", target: "output-1" }
            ]
        }
    },

    // ========================================================================
    // NEW TEMPLATES - BATCH 2: Marketing, Multimodal-AI, Knowledge-Research
    // ========================================================================

    // Marketing: Trend Research Automator (+1 of 4)
    {
        name: "Trend Research Automator",
        description:
            "Automatically research industry trends using web search. Analyzes findings and creates trend reports with visualizations.",
        category: "marketing",
        tags: ["trends", "research", "web search", "analytics"],
        required_integrations: ["slack", "notion"],
        featured: false,
        definition: {
            name: "Trend Research Automator",
            nodes: [
                {
                    id: "input-1",
                    type: "input",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Research Topic",
                        inputName: "topic",
                        inputVariable: "topic",
                        inputType: "text"
                    }
                },
                {
                    id: "webSearch-trends",
                    type: "webSearch",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Search Industry Trends",
                        query: "{{topic}} trends 2024 statistics",
                        maxResults: 10,
                        outputVariable: "trendSearch"
                    }
                },
                {
                    id: "webSearch-news",
                    type: "webSearch",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Search Recent News",
                        query: "{{topic}} news latest",
                        searchType: "news",
                        maxResults: 10,
                        outputVariable: "newsSearch"
                    }
                },
                {
                    id: "llm-analyze",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Analyze Trends",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Analyze trends for {{topic}}:\n\nTrends: {{trendSearch}}\nNews: {{newsSearch}}\n\nProvide top 5 trends, statistics, and recommendations.",
                        outputVariable: "trendAnalysis"
                    }
                },
                {
                    id: "chartGeneration-1",
                    type: "chartGeneration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Create Trend Chart",
                        chartType: "bar",
                        data: "{{trendAnalysis.trends}}",
                        title: "Top Trends",
                        outputVariable: "trendChart"
                    }
                },
                {
                    id: "pdfGeneration-1",
                    type: "pdfGeneration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Report",
                        content: "{{trendAnalysis.text}}",
                        template: "trend-report",
                        outputVariable: "trendReport"
                    }
                },
                {
                    id: "integration-slack",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Share Report",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#marketing"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: { label: "Complete", outputName: "result", value: "{{trendAnalysis}}" }
                }
            ],
            edges: [
                { id: "e1", source: "input-1", target: "webSearch-trends" },
                { id: "e2", source: "input-1", target: "webSearch-news" },
                { id: "e3", source: "webSearch-trends", target: "llm-analyze" },
                { id: "e4", source: "webSearch-news", target: "llm-analyze" },
                { id: "e5", source: "llm-analyze", target: "chartGeneration-1" },
                { id: "e6", source: "llm-analyze", target: "pdfGeneration-1" },
                { id: "e7", source: "chartGeneration-1", target: "integration-slack" },
                { id: "e8", source: "pdfGeneration-1", target: "integration-slack" },
                { id: "e9", source: "integration-slack", target: "output-1" }
            ]
        }
    },

    // Marketing: Visual Content Generator (+2 of 4)
    {
        name: "Visual Content Generator",
        description:
            "Generate marketing visuals using AI image generation. Creates social media graphics and promotional images.",
        category: "marketing",
        tags: ["image generation", "visuals", "social media", "AI"],
        required_integrations: ["google-drive", "slack"],
        featured: false,
        definition: {
            name: "Visual Content Generator",
            nodes: [
                {
                    id: "input-1",
                    type: "input",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Content Brief",
                        inputName: "brief",
                        inputVariable: "brief",
                        inputType: "text"
                    }
                },
                {
                    id: "llm-prompts",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Prompts",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Create 3 image prompts for: {{brief}}\n\n1. Social media (1080x1080)\n2. Blog header\n3. Banner",
                        outputVariable: "imagePrompts"
                    }
                },
                {
                    id: "imageGeneration-1",
                    type: "imageGeneration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Social Image",
                        provider: "openai",
                        model: "dall-e-3",
                        prompt: "{{imagePrompts.social}}",
                        size: "1024x1024",
                        outputVariable: "socialImage"
                    }
                },
                {
                    id: "imageGeneration-2",
                    type: "imageGeneration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Blog Header",
                        provider: "openai",
                        model: "dall-e-3",
                        prompt: "{{imagePrompts.blog}}",
                        size: "1792x1024",
                        outputVariable: "blogImage"
                    }
                },
                {
                    id: "integration-gdrive",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Upload to Drive",
                        provider: "google-drive",
                        operation: "uploadFile"
                    }
                },
                {
                    id: "integration-slack",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Share Preview",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#creative"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: { label: "Images Ready", outputName: "result", value: "Generated images" }
                }
            ],
            edges: [
                { id: "e1", source: "input-1", target: "llm-prompts" },
                { id: "e2", source: "llm-prompts", target: "imageGeneration-1" },
                { id: "e3", source: "llm-prompts", target: "imageGeneration-2" },
                { id: "e4", source: "imageGeneration-1", target: "integration-gdrive" },
                { id: "e5", source: "imageGeneration-2", target: "integration-gdrive" },
                { id: "e6", source: "integration-gdrive", target: "integration-slack" },
                { id: "e7", source: "integration-slack", target: "output-1" }
            ]
        }
    },

    // Marketing: Email A/B Test Analyzer (+3 of 4)
    {
        name: "Email A/B Test Analyzer",
        description: "Analyze email A/B test results with statistical analysis and charts.",
        category: "marketing",
        tags: ["email", "A/B testing", "analytics", "charts"],
        required_integrations: ["mailchimp", "slack"],
        featured: false,
        definition: {
            name: "Email A/B Test Analyzer",
            nodes: [
                {
                    id: "input-1",
                    type: "input",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Campaign ID",
                        inputName: "campaignId",
                        inputVariable: "campaignId",
                        inputType: "text"
                    }
                },
                {
                    id: "integration-mailchimp",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get Results",
                        provider: "mailchimp",
                        operation: "getCampaignReport"
                    }
                },
                {
                    id: "database-benchmarks",
                    type: "database",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get Benchmarks",
                        provider: "postgresql",
                        operation: "select",
                        query: "SELECT AVG(open_rate) as avg_open FROM campaign_results WHERE sent_at > NOW() - INTERVAL '90 days'",
                        outputVariable: "benchmarks"
                    }
                },
                {
                    id: "llm-analyze",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Analyze Results",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Analyze A/B test: {{campaignResults}}\nBenchmarks: {{benchmarks}}\n\nProvide statistical significance, winner, and insights.",
                        outputVariable: "analysis"
                    }
                },
                {
                    id: "chartGeneration-1",
                    type: "chartGeneration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Comparison Chart",
                        chartType: "bar",
                        data: "{{campaignResults}}",
                        title: "A/B Performance",
                        outputVariable: "chart"
                    }
                },
                {
                    id: "integration-slack",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Share Results",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#email-marketing"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Analysis Complete",
                        outputName: "result",
                        value: "{{analysis}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "input-1", target: "integration-mailchimp" },
                { id: "e2", source: "integration-mailchimp", target: "database-benchmarks" },
                { id: "e3", source: "database-benchmarks", target: "llm-analyze" },
                { id: "e4", source: "llm-analyze", target: "chartGeneration-1" },
                { id: "e5", source: "chartGeneration-1", target: "integration-slack" },
                { id: "e6", source: "integration-slack", target: "output-1" }
            ]
        }
    },

    // Marketing: Video Script Pipeline (+4 of 4)
    {
        name: "Video Script-to-Content Pipeline",
        description: "Transform video scripts into AI-generated video content.",
        category: "marketing",
        tags: ["video generation", "content", "AI", "automation"],
        required_integrations: ["slack"],
        featured: false,
        definition: {
            name: "Video Script-to-Content Pipeline",
            nodes: [
                {
                    id: "input-1",
                    type: "input",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Video Script",
                        inputName: "script",
                        inputVariable: "script",
                        inputType: "text"
                    }
                },
                {
                    id: "llm-scenes",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Parse Scenes",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Parse this script into scenes with video prompts: {{script}}",
                        outputVariable: "scenes"
                    }
                },
                {
                    id: "loop-scenes",
                    type: "loop",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Process Scenes",
                        items: "{{scenes.scenes}}",
                        itemVariable: "scene",
                        outputVariable: "generatedScenes"
                    }
                },
                {
                    id: "videoGeneration-1",
                    type: "videoGeneration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Video",
                        provider: "runway",
                        prompt: "{{scene.prompt}}",
                        duration: "{{scene.duration}}",
                        outputVariable: "sceneVideo"
                    }
                },
                {
                    id: "fileWrite-1",
                    type: "fileWrite",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Save Video",
                        path: "/outputs/videos/{{script.title}}.mp4",
                        content: "{{generatedScenes}}",
                        outputVariable: "savedVideo"
                    }
                },
                {
                    id: "integration-slack",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Notify Team",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#video"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: { label: "Video Created", outputName: "result", value: "{{savedVideo}}" }
                }
            ],
            edges: [
                { id: "e1", source: "input-1", target: "llm-scenes" },
                { id: "e2", source: "llm-scenes", target: "loop-scenes" },
                { id: "e3", source: "loop-scenes", target: "videoGeneration-1" },
                { id: "e4", source: "videoGeneration-1", target: "fileWrite-1" },
                { id: "e5", source: "fileWrite-1", target: "integration-slack" },
                { id: "e6", source: "integration-slack", target: "output-1" }
            ]
        }
    },

    // Multimodal-AI: Product Photo Analyzer Enhanced (+1 of 4)
    {
        name: "Product Photo Quality Analyzer",
        description:
            "Analyze product photos for quality issues using vision AI and generate improvement recommendations.",
        category: "multimodal-ai",
        tags: ["vision AI", "product photos", "quality", "analysis"],
        required_integrations: ["slack"],
        featured: false,
        definition: {
            name: "Product Photo Quality Analyzer",
            nodes: [
                {
                    id: "files-1",
                    type: "files",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Upload Photos",
                        acceptedTypes: ["image"],
                        multiple: true,
                        outputVariable: "photos"
                    }
                },
                {
                    id: "loop-photos",
                    type: "loop",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Analyze Each Photo",
                        items: "{{photos}}",
                        itemVariable: "photo",
                        outputVariable: "analyzedPhotos"
                    }
                },
                {
                    id: "vision-analyze",
                    type: "vision",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "AI Photo Analysis",
                        provider: "openai",
                        model: "gpt-4o",
                        image: "{{photo}}",
                        prompt: "Analyze this product photo for: lighting quality, background, composition, focus, and e-commerce readiness. Score each aspect 1-10.",
                        outputVariable: "photoAnalysis"
                    }
                },
                {
                    id: "llm-report",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Report",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Create a photo quality report from: {{analyzedPhotos}}\n\nInclude overall score, issues found, and improvement recommendations.",
                        outputVariable: "qualityReport"
                    }
                },
                {
                    id: "chartGeneration-1",
                    type: "chartGeneration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Quality Score Chart",
                        chartType: "radar",
                        data: "{{qualityReport.scores}}",
                        title: "Photo Quality Scores",
                        outputVariable: "scoreChart"
                    }
                },
                {
                    id: "integration-slack",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Share Report",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#photography"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Analysis Complete",
                        outputName: "result",
                        value: "{{qualityReport}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "files-1", target: "loop-photos" },
                { id: "e2", source: "loop-photos", target: "vision-analyze" },
                { id: "e3", source: "vision-analyze", target: "llm-report" },
                { id: "e4", source: "llm-report", target: "chartGeneration-1" },
                { id: "e5", source: "chartGeneration-1", target: "integration-slack" },
                { id: "e6", source: "integration-slack", target: "output-1" }
            ]
        }
    },

    // Multimodal-AI: Screenshot Diff Monitor (+2 of 4)
    {
        name: "Screenshot Diff Monitor",
        description: "Monitor websites for visual changes using screenshot capture and comparison.",
        category: "multimodal-ai",
        tags: ["screenshots", "monitoring", "visual diff", "automation"],
        required_integrations: ["slack"],
        featured: false,
        definition: {
            name: "Screenshot Diff Monitor",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: { label: "Hourly Check", triggerType: "schedule", schedule: "0 * * * *" }
                },
                {
                    id: "database-urls",
                    type: "database",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get URLs to Monitor",
                        provider: "postgresql",
                        operation: "select",
                        query: "SELECT url, last_screenshot FROM monitored_pages WHERE active = true",
                        outputVariable: "urls"
                    }
                },
                {
                    id: "loop-urls",
                    type: "loop",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Check Each URL",
                        items: "{{urls}}",
                        itemVariable: "page",
                        outputVariable: "screenshots"
                    }
                },
                {
                    id: "screenshotCapture-1",
                    type: "screenshotCapture",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Capture Screenshot",
                        url: "{{page.url}}",
                        fullPage: true,
                        outputVariable: "screenshot"
                    }
                },
                {
                    id: "vision-compare",
                    type: "vision",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Compare Screenshots",
                        provider: "openai",
                        model: "gpt-4o",
                        image: "{{screenshot}}",
                        prompt: "Compare to previous screenshot and identify any visual changes in layout, content, or styling.",
                        outputVariable: "comparison"
                    }
                },
                {
                    id: "conditional-changes",
                    type: "conditional",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Has Changes?",
                        condition: "{{comparison.hasChanges}} == true",
                        outputVariable: "hasChanges"
                    }
                },
                {
                    id: "integration-slack",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Alert Changes",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#monitoring"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Check Complete",
                        outputName: "result",
                        value: "{{screenshots}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "trigger-1", target: "database-urls" },
                { id: "e2", source: "database-urls", target: "loop-urls" },
                { id: "e3", source: "loop-urls", target: "screenshotCapture-1" },
                { id: "e4", source: "screenshotCapture-1", target: "vision-compare" },
                { id: "e5", source: "vision-compare", target: "conditional-changes" },
                {
                    id: "e6",
                    source: "conditional-changes",
                    target: "integration-slack",
                    sourceHandle: "true"
                },
                {
                    id: "e7",
                    source: "conditional-changes",
                    target: "output-1",
                    sourceHandle: "false"
                },
                { id: "e8", source: "integration-slack", target: "output-1" }
            ]
        }
    },

    // Multimodal-AI: Document OCR Pipeline (+3 of 4)
    {
        name: "Multi-Language Document OCR",
        description:
            "Extract text from documents in multiple languages using OCR with AI enhancement.",
        category: "multimodal-ai",
        tags: ["OCR", "multilingual", "document processing", "AI"],
        required_integrations: ["google-drive"],
        featured: false,
        definition: {
            name: "Multi-Language Document OCR",
            nodes: [
                {
                    id: "files-1",
                    type: "files",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Upload Documents",
                        acceptedTypes: ["pdf", "image"],
                        multiple: true,
                        outputVariable: "documents"
                    }
                },
                {
                    id: "loop-docs",
                    type: "loop",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Process Each Document",
                        items: "{{documents}}",
                        itemVariable: "doc",
                        outputVariable: "processedDocs"
                    }
                },
                {
                    id: "ocrExtraction-1",
                    type: "ocrExtraction",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Extract Text",
                        image: "{{doc}}",
                        language: "auto",
                        outputVariable: "ocrText"
                    }
                },
                {
                    id: "llm-enhance",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Enhance & Translate",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Clean up this OCR text, fix errors, and translate to English if needed:\n\n{{ocrText}}",
                        outputVariable: "enhancedText"
                    }
                },
                {
                    id: "fileWrite-1",
                    type: "fileWrite",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Save Extracted Text",
                        path: "/outputs/ocr/{{doc.filename}}.txt",
                        content: "{{enhancedText.text}}",
                        outputVariable: "savedFile"
                    }
                },
                {
                    id: "spreadsheetGeneration-1",
                    type: "spreadsheetGeneration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Create Summary",
                        data: "{{processedDocs}}",
                        format: "xlsx",
                        sheetName: "OCR Results",
                        outputVariable: "summary"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: { label: "OCR Complete", outputName: "result", value: "{{summary}}" }
                }
            ],
            edges: [
                { id: "e1", source: "files-1", target: "loop-docs" },
                { id: "e2", source: "loop-docs", target: "ocrExtraction-1" },
                { id: "e3", source: "ocrExtraction-1", target: "llm-enhance" },
                { id: "e4", source: "llm-enhance", target: "fileWrite-1" },
                { id: "e5", source: "fileWrite-1", target: "spreadsheetGeneration-1" },
                { id: "e6", source: "spreadsheetGeneration-1", target: "output-1" }
            ]
        }
    },

    // Multimodal-AI: AI Presentation Builder (+4 of 4)
    {
        name: "AI Presentation Builder",
        description:
            "Generate complete presentations with AI-created images and content from a topic brief.",
        category: "multimodal-ai",
        tags: ["presentations", "image generation", "content", "AI"],
        required_integrations: ["google-drive", "slack"],
        featured: false,
        definition: {
            name: "AI Presentation Builder",
            nodes: [
                {
                    id: "input-1",
                    type: "input",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Presentation Topic",
                        inputName: "topic",
                        inputVariable: "topic",
                        inputType: "text"
                    }
                },
                {
                    id: "llm-outline",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Create Outline",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Create a 10-slide presentation outline for: {{topic}}\n\nFor each slide provide: title, key points, and image prompt.",
                        outputVariable: "outline"
                    }
                },
                {
                    id: "loop-slides",
                    type: "loop",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Slide Images",
                        items: "{{outline.slides}}",
                        itemVariable: "slide",
                        outputVariable: "slideImages"
                    }
                },
                {
                    id: "imageGeneration-1",
                    type: "imageGeneration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Slide Image",
                        provider: "openai",
                        model: "dall-e-3",
                        prompt: "{{slide.imagePrompt}}",
                        size: "1792x1024",
                        outputVariable: "slideImage"
                    }
                },
                {
                    id: "llm-content",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Slide Content",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Write detailed content for each slide: {{outline}}",
                        outputVariable: "slideContent"
                    }
                },
                {
                    id: "pdfGeneration-1",
                    type: "pdfGeneration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Presentation PDF",
                        content: "{{slideContent.text}}",
                        template: "presentation",
                        outputVariable: "presentationPdf"
                    }
                },
                {
                    id: "integration-gdrive",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Save to Drive",
                        provider: "google-drive",
                        operation: "uploadFile"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Presentation Ready",
                        outputName: "result",
                        value: "{{presentationPdf}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "input-1", target: "llm-outline" },
                { id: "e2", source: "llm-outline", target: "loop-slides" },
                { id: "e3", source: "loop-slides", target: "imageGeneration-1" },
                { id: "e4", source: "llm-outline", target: "llm-content" },
                { id: "e5", source: "imageGeneration-1", target: "pdfGeneration-1" },
                { id: "e6", source: "llm-content", target: "pdfGeneration-1" },
                { id: "e7", source: "pdfGeneration-1", target: "integration-gdrive" },
                { id: "e8", source: "integration-gdrive", target: "output-1" }
            ]
        }
    },

    // Knowledge-Research: Academic Paper Summarizer (+1 of 4)
    {
        name: "Academic Paper Summarizer",
        description: "Extract and summarize key findings from academic papers with PDF extraction.",
        category: "knowledge-research",
        tags: ["academic", "research", "PDF extraction", "summarization"],
        required_integrations: ["notion"],
        featured: false,
        definition: {
            name: "Academic Paper Summarizer",
            nodes: [
                {
                    id: "files-1",
                    type: "files",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Upload Papers",
                        acceptedTypes: ["pdf"],
                        multiple: true,
                        outputVariable: "papers"
                    }
                },
                {
                    id: "loop-papers",
                    type: "loop",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Process Each Paper",
                        items: "{{papers}}",
                        itemVariable: "paper",
                        outputVariable: "summaries"
                    }
                },
                {
                    id: "pdfExtract-1",
                    type: "pdfExtract",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Extract Paper Content",
                        file: "{{paper}}",
                        extractText: true,
                        outputVariable: "paperContent"
                    }
                },
                {
                    id: "llm-summarize",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Summarize Paper",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Summarize this academic paper:\n\n{{paperContent}}\n\nProvide: abstract summary, methodology, key findings, conclusions, and limitations.",
                        outputVariable: "summary"
                    }
                },
                {
                    id: "knowledgeBaseQuery-1",
                    type: "knowledgeBaseQuery",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Find Related Papers",
                        query: "{{summary.keywords}}",
                        knowledgeBaseId: "research-kb",
                        outputVariable: "relatedPapers"
                    }
                },
                {
                    id: "integration-notion",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: { label: "Save to Notion", provider: "notion", operation: "createPage" }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: { label: "Summaries Ready", outputName: "result", value: "{{summaries}}" }
                }
            ],
            edges: [
                { id: "e1", source: "files-1", target: "loop-papers" },
                { id: "e2", source: "loop-papers", target: "pdfExtract-1" },
                { id: "e3", source: "pdfExtract-1", target: "llm-summarize" },
                { id: "e4", source: "llm-summarize", target: "knowledgeBaseQuery-1" },
                { id: "e5", source: "knowledgeBaseQuery-1", target: "integration-notion" },
                { id: "e6", source: "integration-notion", target: "output-1" }
            ]
        }
    },

    // Knowledge-Research: Competitive Intelligence Bot (+2 of 4)
    {
        name: "Competitive Intelligence Bot",
        description:
            "Research competitors using web search and browsing to create intelligence reports.",
        category: "knowledge-research",
        tags: ["competitive intel", "research", "web search", "analysis"],
        required_integrations: ["slack", "notion"],
        featured: false,
        definition: {
            name: "Competitive Intelligence Bot",
            nodes: [
                {
                    id: "input-1",
                    type: "input",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Competitor Name",
                        inputName: "competitor",
                        inputVariable: "competitor",
                        inputType: "text"
                    }
                },
                {
                    id: "webSearch-news",
                    type: "webSearch",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Search News",
                        query: "{{competitor}} news announcements",
                        searchType: "news",
                        maxResults: 15,
                        outputVariable: "newsResults"
                    }
                },
                {
                    id: "webSearch-product",
                    type: "webSearch",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Search Products",
                        query: "{{competitor}} products features pricing",
                        maxResults: 10,
                        outputVariable: "productResults"
                    }
                },
                {
                    id: "webBrowse-website",
                    type: "webBrowse",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Browse Website",
                        url: "https://{{competitor}}.com",
                        extractType: "text",
                        outputVariable: "websiteContent"
                    }
                },
                {
                    id: "llm-analyze",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Analyze Intel",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Create competitive intelligence report for {{competitor}}:\n\nNews: {{newsResults}}\nProducts: {{productResults}}\nWebsite: {{websiteContent}}\n\nProvide: SWOT analysis, recent moves, product comparison, and strategic implications.",
                        outputVariable: "intelReport"
                    }
                },
                {
                    id: "pdfGeneration-1",
                    type: "pdfGeneration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Report",
                        content: "{{intelReport.text}}",
                        template: "competitive-intel",
                        outputVariable: "reportPdf"
                    }
                },
                {
                    id: "integration-notion",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: { label: "Save to Notion", provider: "notion", operation: "createPage" }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: { label: "Report Ready", outputName: "result", value: "{{intelReport}}" }
                }
            ],
            edges: [
                { id: "e1", source: "input-1", target: "webSearch-news" },
                { id: "e2", source: "input-1", target: "webSearch-product" },
                { id: "e3", source: "input-1", target: "webBrowse-website" },
                { id: "e4", source: "webSearch-news", target: "llm-analyze" },
                { id: "e5", source: "webSearch-product", target: "llm-analyze" },
                { id: "e6", source: "webBrowse-website", target: "llm-analyze" },
                { id: "e7", source: "llm-analyze", target: "pdfGeneration-1" },
                { id: "e8", source: "pdfGeneration-1", target: "integration-notion" },
                { id: "e9", source: "integration-notion", target: "output-1" }
            ]
        }
    },

    // Knowledge-Research: Patent Search Assistant (+3 of 4)
    {
        name: "Patent Search Assistant",
        description: "Search and analyze patents using web search and PDF extraction.",
        category: "knowledge-research",
        tags: ["patents", "research", "legal", "analysis"],
        required_integrations: ["slack"],
        featured: false,
        definition: {
            name: "Patent Search Assistant",
            nodes: [
                {
                    id: "input-1",
                    type: "input",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Search Query",
                        inputName: "query",
                        inputVariable: "query",
                        inputType: "text"
                    }
                },
                {
                    id: "webSearch-patents",
                    type: "webSearch",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Search Patents",
                        query: "{{query}} patent site:patents.google.com",
                        maxResults: 20,
                        outputVariable: "patentResults"
                    }
                },
                {
                    id: "llm-filter",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Filter Relevant Patents",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Filter these patent search results for relevance to: {{query}}\n\n{{patentResults}}\n\nReturn the top 5 most relevant patents with summaries.",
                        outputVariable: "filteredPatents"
                    }
                },
                {
                    id: "loop-patents",
                    type: "loop",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Analyze Each Patent",
                        items: "{{filteredPatents.patents}}",
                        itemVariable: "patent",
                        outputVariable: "analyzedPatents"
                    }
                },
                {
                    id: "fileDownload-1",
                    type: "fileDownload",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Download Patent PDF",
                        url: "{{patent.pdfUrl}}",
                        outputVariable: "patentPdf"
                    }
                },
                {
                    id: "pdfExtract-1",
                    type: "pdfExtract",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Extract Claims",
                        file: "{{patentPdf}}",
                        extractText: true,
                        outputVariable: "patentClaims"
                    }
                },
                {
                    id: "llm-summary",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Summarize Patents",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Create a patent landscape summary from: {{analyzedPatents}}\n\nInclude: key claims, assignees, filing dates, and implications.",
                        outputVariable: "patentSummary"
                    }
                },
                {
                    id: "spreadsheetGeneration-1",
                    type: "spreadsheetGeneration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Create Patent Report",
                        data: "{{analyzedPatents}}",
                        format: "xlsx",
                        sheetName: "Patent Analysis",
                        outputVariable: "patentReport"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Search Complete",
                        outputName: "result",
                        value: "{{patentSummary}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "input-1", target: "webSearch-patents" },
                { id: "e2", source: "webSearch-patents", target: "llm-filter" },
                { id: "e3", source: "llm-filter", target: "loop-patents" },
                { id: "e4", source: "loop-patents", target: "fileDownload-1" },
                { id: "e5", source: "fileDownload-1", target: "pdfExtract-1" },
                { id: "e6", source: "pdfExtract-1", target: "llm-summary" },
                { id: "e7", source: "llm-summary", target: "spreadsheetGeneration-1" },
                { id: "e8", source: "spreadsheetGeneration-1", target: "output-1" }
            ]
        }
    },

    // Knowledge-Research: Industry Report Generator (+4 of 4)
    {
        name: "Industry Report Generator",
        description: "Generate comprehensive industry reports from web research and data analysis.",
        category: "knowledge-research",
        tags: ["industry analysis", "research", "reports", "charts"],
        required_integrations: ["slack", "google-drive"],
        featured: false,
        definition: {
            name: "Industry Report Generator",
            nodes: [
                {
                    id: "input-1",
                    type: "input",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Industry Name",
                        inputName: "industry",
                        inputVariable: "industry",
                        inputType: "text"
                    }
                },
                {
                    id: "webSearch-market",
                    type: "webSearch",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Search Market Data",
                        query: "{{industry}} market size growth statistics 2024",
                        maxResults: 15,
                        outputVariable: "marketData"
                    }
                },
                {
                    id: "webSearch-trends",
                    type: "webSearch",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Search Trends",
                        query: "{{industry}} trends forecast future",
                        maxResults: 15,
                        outputVariable: "trendData"
                    }
                },
                {
                    id: "webSearch-players",
                    type: "webSearch",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Search Key Players",
                        query: "{{industry}} top companies market share leaders",
                        maxResults: 10,
                        outputVariable: "playerData"
                    }
                },
                {
                    id: "llm-analyze",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Analyze Industry",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Create comprehensive industry analysis for {{industry}}:\n\nMarket: {{marketData}}\nTrends: {{trendData}}\nPlayers: {{playerData}}\n\nProvide: market overview, size/growth, trends, competitive landscape, and outlook.",
                        outputVariable: "analysis"
                    }
                },
                {
                    id: "chartGeneration-market",
                    type: "chartGeneration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Market Size Chart",
                        chartType: "line",
                        data: "{{analysis.marketGrowth}}",
                        title: "Market Size Growth",
                        outputVariable: "marketChart"
                    }
                },
                {
                    id: "chartGeneration-share",
                    type: "chartGeneration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Market Share Chart",
                        chartType: "pie",
                        data: "{{analysis.marketShare}}",
                        title: "Market Share",
                        outputVariable: "shareChart"
                    }
                },
                {
                    id: "pdfGeneration-1",
                    type: "pdfGeneration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Report PDF",
                        content: "{{analysis.text}}",
                        template: "industry-report",
                        outputVariable: "reportPdf"
                    }
                },
                {
                    id: "integration-gdrive",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Save to Drive",
                        provider: "google-drive",
                        operation: "uploadFile"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: { label: "Report Ready", outputName: "result", value: "{{reportPdf}}" }
                }
            ],
            edges: [
                { id: "e1", source: "input-1", target: "webSearch-market" },
                { id: "e2", source: "input-1", target: "webSearch-trends" },
                { id: "e3", source: "input-1", target: "webSearch-players" },
                { id: "e4", source: "webSearch-market", target: "llm-analyze" },
                { id: "e5", source: "webSearch-trends", target: "llm-analyze" },
                { id: "e6", source: "webSearch-players", target: "llm-analyze" },
                { id: "e7", source: "llm-analyze", target: "chartGeneration-market" },
                { id: "e8", source: "llm-analyze", target: "chartGeneration-share" },
                { id: "e9", source: "llm-analyze", target: "pdfGeneration-1" },
                { id: "e10", source: "chartGeneration-market", target: "integration-gdrive" },
                { id: "e11", source: "chartGeneration-share", target: "integration-gdrive" },
                { id: "e12", source: "pdfGeneration-1", target: "integration-gdrive" },
                { id: "e13", source: "integration-gdrive", target: "output-1" }
            ]
        }
    },

    // ========================================================================
    // NEW TEMPLATES - BATCH 3: Healthcare, E-commerce, Document Processing
    // ========================================================================

    // Healthcare: Patient Intake Automator (+1 of 4)
    {
        name: "Patient Intake Automator",
        description:
            "Process patient intake forms with PDF/OCR extraction and create patient records.",
        category: "healthcare",
        tags: ["patient intake", "forms", "OCR", "automation"],
        required_integrations: ["slack"],
        featured: false,
        definition: {
            name: "Patient Intake Automator",
            nodes: [
                {
                    id: "files-1",
                    type: "files",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Upload Intake Form",
                        acceptedTypes: ["pdf", "image"],
                        outputVariable: "intakeForm"
                    }
                },
                {
                    id: "pdfExtract-1",
                    type: "pdfExtract",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Extract Form Data",
                        file: "{{intakeForm}}",
                        extractText: true,
                        outputVariable: "extractedData"
                    }
                },
                {
                    id: "ocrExtraction-1",
                    type: "ocrExtraction",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "OCR Handwritten Fields",
                        image: "{{intakeForm}}",
                        language: "eng",
                        outputVariable: "ocrData"
                    }
                },
                {
                    id: "llm-parse",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Parse Patient Info",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Extract patient information from:\n\nPDF: {{extractedData}}\nOCR: {{ocrData}}\n\nProvide: demographics, medical history, insurance, emergency contacts.",
                        outputVariable: "patientInfo"
                    }
                },
                {
                    id: "database-insert",
                    type: "database",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Create Patient Record",
                        provider: "postgresql",
                        operation: "insert",
                        query: "INSERT INTO patients (name, dob, insurance_id, medical_history) VALUES ($1, $2, $3, $4) RETURNING id",
                        outputVariable: "patientRecord"
                    }
                },
                {
                    id: "pdfGeneration-1",
                    type: "pdfGeneration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Summary",
                        content: "{{patientInfo}}",
                        template: "patient-intake",
                        outputVariable: "intakeSummary"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Intake Complete",
                        outputName: "result",
                        value: "{{patientRecord}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "files-1", target: "pdfExtract-1" },
                { id: "e2", source: "files-1", target: "ocrExtraction-1" },
                { id: "e3", source: "pdfExtract-1", target: "llm-parse" },
                { id: "e4", source: "ocrExtraction-1", target: "llm-parse" },
                { id: "e5", source: "llm-parse", target: "database-insert" },
                { id: "e6", source: "database-insert", target: "pdfGeneration-1" },
                { id: "e7", source: "pdfGeneration-1", target: "output-1" }
            ]
        }
    },

    // Healthcare: Medical Records Summarizer (+2 of 4)
    {
        name: "Medical Records Summarizer",
        description: "Extract and summarize medical records PDFs for physician review.",
        category: "healthcare",
        tags: ["medical records", "summarization", "PDF", "healthcare"],
        required_integrations: ["slack"],
        featured: false,
        definition: {
            name: "Medical Records Summarizer",
            nodes: [
                {
                    id: "files-1",
                    type: "files",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Upload Records",
                        acceptedTypes: ["pdf"],
                        multiple: true,
                        outputVariable: "records"
                    }
                },
                {
                    id: "loop-records",
                    type: "loop",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Process Each Record",
                        items: "{{records}}",
                        itemVariable: "record",
                        outputVariable: "summaries"
                    }
                },
                {
                    id: "pdfExtract-1",
                    type: "pdfExtract",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Extract Content",
                        file: "{{record}}",
                        extractText: true,
                        outputVariable: "recordContent"
                    }
                },
                {
                    id: "llm-summarize",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Summarize Record",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Summarize this medical record:\n\n{{recordContent}}\n\nProvide: diagnoses, medications, lab results, treatment history.",
                        outputVariable: "summary"
                    }
                },
                {
                    id: "knowledgeBaseQuery-1",
                    type: "knowledgeBaseQuery",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Check Interactions",
                        query: "{{summary.medications}} drug interactions",
                        knowledgeBaseId: "medical-kb",
                        outputVariable: "interactions"
                    }
                },
                {
                    id: "pdfGeneration-1",
                    type: "pdfGeneration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Summary PDF",
                        content: "{{summaries}}",
                        template: "medical-summary",
                        outputVariable: "summaryPdf"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: { label: "Summary Ready", outputName: "result", value: "{{summaryPdf}}" }
                }
            ],
            edges: [
                { id: "e1", source: "files-1", target: "loop-records" },
                { id: "e2", source: "loop-records", target: "pdfExtract-1" },
                { id: "e3", source: "pdfExtract-1", target: "llm-summarize" },
                { id: "e4", source: "llm-summarize", target: "knowledgeBaseQuery-1" },
                { id: "e5", source: "knowledgeBaseQuery-1", target: "pdfGeneration-1" },
                { id: "e6", source: "pdfGeneration-1", target: "output-1" }
            ]
        }
    },

    // Healthcare: Insurance Claim Processor (+3 of 4)
    {
        name: "Insurance Claim Processor",
        description: "Automate insurance claim processing with OCR and validation.",
        category: "healthcare",
        tags: ["insurance", "claims", "OCR", "automation"],
        required_integrations: ["slack"],
        featured: false,
        definition: {
            name: "Insurance Claim Processor",
            nodes: [
                {
                    id: "files-1",
                    type: "files",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Upload Claims",
                        acceptedTypes: ["pdf", "image"],
                        multiple: true,
                        outputVariable: "claimDocs"
                    }
                },
                {
                    id: "ocrExtraction-1",
                    type: "ocrExtraction",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Extract Claim Data",
                        image: "{{claimDocs}}",
                        language: "eng",
                        outputVariable: "claimData"
                    }
                },
                {
                    id: "llm-validate",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Validate Claim",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Validate this insurance claim:\n\n{{claimData}}\n\nCheck: required fields, procedure codes, diagnosis codes, coverage.",
                        outputVariable: "validation"
                    }
                },
                {
                    id: "conditional-valid",
                    type: "conditional",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Is Valid?",
                        condition: "{{validation.isValid}} == true",
                        outputVariable: "isValid"
                    }
                },
                {
                    id: "database-submit",
                    type: "database",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Submit Claim",
                        provider: "postgresql",
                        operation: "insert",
                        query: "INSERT INTO claims (patient_id, amount, status) VALUES ($1, $2, 'submitted') RETURNING id",
                        outputVariable: "claimRecord"
                    }
                },
                {
                    id: "humanReview-1",
                    type: "humanReview",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Review Invalid",
                        reviewPrompt: "Claim has issues: {{validation.issues}}",
                        outputVariable: "reviewed"
                    }
                },
                {
                    id: "spreadsheetGeneration-1",
                    type: "spreadsheetGeneration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Claims Report",
                        data: "{{claimRecord}}",
                        format: "xlsx",
                        sheetName: "Claims",
                        outputVariable: "report"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Processing Complete",
                        outputName: "result",
                        value: "{{claimRecord}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "files-1", target: "ocrExtraction-1" },
                { id: "e2", source: "ocrExtraction-1", target: "llm-validate" },
                { id: "e3", source: "llm-validate", target: "conditional-valid" },
                {
                    id: "e4",
                    source: "conditional-valid",
                    target: "database-submit",
                    sourceHandle: "true"
                },
                {
                    id: "e5",
                    source: "conditional-valid",
                    target: "humanReview-1",
                    sourceHandle: "false"
                },
                { id: "e6", source: "humanReview-1", target: "database-submit" },
                { id: "e7", source: "database-submit", target: "spreadsheetGeneration-1" },
                { id: "e8", source: "spreadsheetGeneration-1", target: "output-1" }
            ]
        }
    },

    // Healthcare: Medical Image Analyzer (+4 of 4)
    {
        name: "Medical Image Analyzer",
        description: "Analyze medical images using vision AI for preliminary findings.",
        category: "healthcare",
        tags: ["medical imaging", "vision AI", "radiology", "analysis"],
        required_integrations: ["slack"],
        featured: false,
        definition: {
            name: "Medical Image Analyzer",
            nodes: [
                {
                    id: "files-1",
                    type: "files",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Upload Images",
                        acceptedTypes: ["image"],
                        multiple: true,
                        outputVariable: "images"
                    }
                },
                {
                    id: "loop-images",
                    type: "loop",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Analyze Each",
                        items: "{{images}}",
                        itemVariable: "image",
                        outputVariable: "analyzed"
                    }
                },
                {
                    id: "vision-analyze",
                    type: "vision",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "AI Analysis",
                        provider: "openai",
                        model: "gpt-4o",
                        image: "{{image}}",
                        prompt: "Analyze this medical image. Identify abnormalities, measurements, and preliminary findings.",
                        outputVariable: "analysis"
                    }
                },
                {
                    id: "llm-report",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Findings",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Create radiology findings report from: {{analyzed}}\n\nFormat for physician review.",
                        outputVariable: "findings"
                    }
                },
                {
                    id: "pdfGeneration-1",
                    type: "pdfGeneration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Report",
                        content: "{{findings.text}}",
                        template: "radiology-report",
                        outputVariable: "report"
                    }
                },
                {
                    id: "humanReview-1",
                    type: "humanReview",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Radiologist Review",
                        reviewPrompt: "Review AI-generated preliminary findings.",
                        outputVariable: "reviewed"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: { label: "Analysis Complete", outputName: "result", value: "{{report}}" }
                }
            ],
            edges: [
                { id: "e1", source: "files-1", target: "loop-images" },
                { id: "e2", source: "loop-images", target: "vision-analyze" },
                { id: "e3", source: "vision-analyze", target: "llm-report" },
                { id: "e4", source: "llm-report", target: "pdfGeneration-1" },
                { id: "e5", source: "pdfGeneration-1", target: "humanReview-1" },
                { id: "e6", source: "humanReview-1", target: "output-1" }
            ]
        }
    },

    // E-commerce: Product Catalog Enricher (+1 of 4)
    {
        name: "Product Catalog Enricher",
        description: "Enrich product listings with AI descriptions and image analysis.",
        category: "ecommerce",
        tags: ["product catalog", "AI content", "SEO", "automation"],
        required_integrations: ["shopify"],
        featured: false,
        definition: {
            name: "Product Catalog Enricher",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: { label: "New Product", triggerType: "webhook" }
                },
                {
                    id: "integration-shopify",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: { label: "Get Product", provider: "shopify", operation: "getProduct" }
                },
                {
                    id: "vision-product",
                    type: "vision",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Analyze Image",
                        provider: "openai",
                        model: "gpt-4o",
                        image: "{{product.images[0]}}",
                        prompt: "Describe this product: color, material, style, features.",
                        outputVariable: "imageAnalysis"
                    }
                },
                {
                    id: "llm-description",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Description",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Create product description for {{product.title}}:\n\nImage: {{imageAnalysis}}\n\nProvide: short description, long description, key features, SEO meta.",
                        outputVariable: "content"
                    }
                },
                {
                    id: "database-store",
                    type: "database",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Store Enrichment",
                        provider: "postgresql",
                        operation: "insert",
                        query: "INSERT INTO product_enrichments (product_id, description, enriched_at) VALUES ($1, $2, NOW())",
                        outputVariable: "enrichment"
                    }
                },
                {
                    id: "integration-shopify-update",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Update Product",
                        provider: "shopify",
                        operation: "updateProduct"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Enrichment Complete",
                        outputName: "result",
                        value: "{{content}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "trigger-1", target: "integration-shopify" },
                { id: "e2", source: "integration-shopify", target: "vision-product" },
                { id: "e3", source: "vision-product", target: "llm-description" },
                { id: "e4", source: "llm-description", target: "database-store" },
                { id: "e5", source: "database-store", target: "integration-shopify-update" },
                { id: "e6", source: "integration-shopify-update", target: "output-1" }
            ]
        }
    },

    // E-commerce: Competitor Price Monitor (+2 of 4)
    {
        name: "Competitor Price Monitor",
        description: "Monitor competitor pricing using web scraping and analysis.",
        category: "ecommerce",
        tags: ["pricing", "web scraping", "analytics", "competition"],
        required_integrations: ["slack"],
        featured: false,
        definition: {
            name: "Competitor Price Monitor",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: { label: "Daily Check", triggerType: "schedule", schedule: "0 8 * * *" }
                },
                {
                    id: "database-products",
                    type: "database",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get Products",
                        provider: "postgresql",
                        operation: "select",
                        query: "SELECT product_id, our_price, competitor_url FROM price_monitoring WHERE active = true",
                        outputVariable: "products"
                    }
                },
                {
                    id: "loop-products",
                    type: "loop",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Check Each",
                        items: "{{products}}",
                        itemVariable: "product",
                        outputVariable: "priceChecks"
                    }
                },
                {
                    id: "webBrowse-1",
                    type: "webBrowse",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Scrape Price",
                        url: "{{product.competitor_url}}",
                        extractType: "text",
                        outputVariable: "competitorPage"
                    }
                },
                {
                    id: "llm-extract",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Extract Price",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Extract product price from:\n\n{{competitorPage}}\n\nReturn numeric price only.",
                        outputVariable: "price"
                    }
                },
                {
                    id: "database-store",
                    type: "database",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Store Price",
                        provider: "postgresql",
                        operation: "insert",
                        query: "INSERT INTO price_history (product_id, competitor_price, checked_at) VALUES ($1, $2, NOW())",
                        outputVariable: "stored"
                    }
                },
                {
                    id: "chartGeneration-1",
                    type: "chartGeneration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Price Chart",
                        chartType: "bar",
                        data: "{{priceChecks}}",
                        title: "Price Comparison",
                        outputVariable: "chart"
                    }
                },
                {
                    id: "integration-slack",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Alert",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#pricing"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: { label: "Complete", outputName: "result", value: "{{priceChecks}}" }
                }
            ],
            edges: [
                { id: "e1", source: "trigger-1", target: "database-products" },
                { id: "e2", source: "database-products", target: "loop-products" },
                { id: "e3", source: "loop-products", target: "webBrowse-1" },
                { id: "e4", source: "webBrowse-1", target: "llm-extract" },
                { id: "e5", source: "llm-extract", target: "database-store" },
                { id: "e6", source: "database-store", target: "chartGeneration-1" },
                { id: "e7", source: "chartGeneration-1", target: "integration-slack" },
                { id: "e8", source: "integration-slack", target: "output-1" }
            ]
        }
    },

    // E-commerce: Product Image Generator (+3 of 4)
    {
        name: "AI Product Image Generator",
        description: "Generate product images using AI for different use cases.",
        category: "ecommerce",
        tags: ["image generation", "product photos", "AI", "automation"],
        required_integrations: ["shopify", "google-drive"],
        featured: false,
        definition: {
            name: "AI Product Image Generator",
            nodes: [
                {
                    id: "input-1",
                    type: "input",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Product Details",
                        inputName: "product",
                        inputVariable: "product",
                        inputType: "json"
                    }
                },
                {
                    id: "llm-prompts",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Prompts",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Create image prompts for {{product}}:\n\n1. White background\n2. Lifestyle shot\n3. Detail close-up",
                        outputVariable: "prompts"
                    }
                },
                {
                    id: "imageGeneration-1",
                    type: "imageGeneration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "White BG Image",
                        provider: "openai",
                        model: "dall-e-3",
                        prompt: "{{prompts.whiteBg}}",
                        size: "1024x1024",
                        outputVariable: "whiteBgImage"
                    }
                },
                {
                    id: "imageGeneration-2",
                    type: "imageGeneration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Lifestyle Image",
                        provider: "openai",
                        model: "dall-e-3",
                        prompt: "{{prompts.lifestyle}}",
                        size: "1024x1024",
                        outputVariable: "lifestyleImage"
                    }
                },
                {
                    id: "integration-gdrive",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Upload to Drive",
                        provider: "google-drive",
                        operation: "uploadFile"
                    }
                },
                {
                    id: "integration-shopify",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Add to Product",
                        provider: "shopify",
                        operation: "addProductImage"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: { label: "Images Ready", outputName: "result", value: "Generated images" }
                }
            ],
            edges: [
                { id: "e1", source: "input-1", target: "llm-prompts" },
                { id: "e2", source: "llm-prompts", target: "imageGeneration-1" },
                { id: "e3", source: "llm-prompts", target: "imageGeneration-2" },
                { id: "e4", source: "imageGeneration-1", target: "integration-gdrive" },
                { id: "e5", source: "imageGeneration-2", target: "integration-gdrive" },
                { id: "e6", source: "integration-gdrive", target: "integration-shopify" },
                { id: "e7", source: "integration-shopify", target: "output-1" }
            ]
        }
    },

    // E-commerce: SKU Performance Reporter (+4 of 4)
    {
        name: "SKU Performance Reporter",
        description: "Analyze SKU-level performance and generate inventory recommendations.",
        category: "ecommerce",
        tags: ["SKU analysis", "inventory", "reporting", "analytics"],
        required_integrations: ["shopify", "slack"],
        featured: false,
        definition: {
            name: "SKU Performance Reporter",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: { label: "Weekly Report", triggerType: "schedule", schedule: "0 9 * * 1" }
                },
                {
                    id: "database-sales",
                    type: "database",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get Sales",
                        provider: "postgresql",
                        operation: "select",
                        query: "SELECT sku, units_sold, revenue, inventory FROM sku_metrics WHERE period = 'last_7_days'",
                        outputVariable: "sales"
                    }
                },
                {
                    id: "llm-analyze",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Analyze Performance",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Analyze SKU performance:\n\n{{sales}}\n\nProvide: top performers, underperformers, inventory risks, recommendations.",
                        outputVariable: "analysis"
                    }
                },
                {
                    id: "chartGeneration-1",
                    type: "chartGeneration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Revenue Chart",
                        chartType: "bar",
                        data: "{{analysis.top}}",
                        title: "Top SKUs",
                        outputVariable: "chart"
                    }
                },
                {
                    id: "spreadsheetGeneration-1",
                    type: "spreadsheetGeneration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Create Report",
                        data: "{{sales}}",
                        format: "xlsx",
                        sheetName: "SKU Performance",
                        outputVariable: "report"
                    }
                },
                {
                    id: "integration-slack",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Share Report",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#ecommerce"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: { label: "Report Complete", outputName: "result", value: "{{analysis}}" }
                }
            ],
            edges: [
                { id: "e1", source: "trigger-1", target: "database-sales" },
                { id: "e2", source: "database-sales", target: "llm-analyze" },
                { id: "e3", source: "llm-analyze", target: "chartGeneration-1" },
                { id: "e4", source: "llm-analyze", target: "spreadsheetGeneration-1" },
                { id: "e5", source: "chartGeneration-1", target: "integration-slack" },
                { id: "e6", source: "spreadsheetGeneration-1", target: "integration-slack" },
                { id: "e7", source: "integration-slack", target: "output-1" }
            ]
        }
    },

    // Document Processing: Multi-format Converter (+1 of 4)
    {
        name: "Multi-format Document Converter",
        description: "Convert documents between formats with PDF extraction and OCR support.",
        category: "document-processing",
        tags: ["conversion", "PDF", "OCR", "automation"],
        required_integrations: ["google-drive"],
        featured: false,
        definition: {
            name: "Multi-format Document Converter",
            nodes: [
                {
                    id: "files-1",
                    type: "files",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Upload Document",
                        acceptedTypes: ["pdf", "image", "docx"],
                        outputVariable: "inputDoc"
                    }
                },
                {
                    id: "router-format",
                    type: "router",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Detect Format",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Determine file type: {{inputDoc.filename}}",
                        routes: [
                            { value: "pdf", label: "PDF" },
                            { value: "image", label: "Image" },
                            { value: "docx", label: "Word" }
                        ],
                        defaultRoute: "pdf",
                        outputVariable: "format"
                    }
                },
                {
                    id: "pdfExtract-1",
                    type: "pdfExtract",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Extract PDF",
                        file: "{{inputDoc}}",
                        extractText: true,
                        outputVariable: "pdfContent"
                    }
                },
                {
                    id: "ocrExtraction-1",
                    type: "ocrExtraction",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "OCR Image",
                        image: "{{inputDoc}}",
                        language: "eng",
                        outputVariable: "ocrContent"
                    }
                },
                {
                    id: "fileRead-1",
                    type: "fileRead",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Read Word",
                        path: "{{inputDoc.path}}",
                        outputVariable: "wordContent"
                    }
                },
                {
                    id: "llm-standardize",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Standardize",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Clean and standardize this content:\n\n{{extractedContent}}",
                        outputVariable: "standardized"
                    }
                },
                {
                    id: "pdfGeneration-1",
                    type: "pdfGeneration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate PDF",
                        content: "{{standardized.text}}",
                        template: "document",
                        outputVariable: "outputPdf"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Conversion Complete",
                        outputName: "result",
                        value: "{{outputPdf}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "files-1", target: "router-format" },
                { id: "e2", source: "router-format", target: "pdfExtract-1", sourceHandle: "pdf" },
                {
                    id: "e3",
                    source: "router-format",
                    target: "ocrExtraction-1",
                    sourceHandle: "image"
                },
                { id: "e4", source: "router-format", target: "fileRead-1", sourceHandle: "docx" },
                { id: "e5", source: "pdfExtract-1", target: "llm-standardize" },
                { id: "e6", source: "ocrExtraction-1", target: "llm-standardize" },
                { id: "e7", source: "fileRead-1", target: "llm-standardize" },
                { id: "e8", source: "llm-standardize", target: "pdfGeneration-1" },
                { id: "e9", source: "pdfGeneration-1", target: "output-1" }
            ]
        }
    },

    // Document Processing: Invoice Data Extractor (+2 of 4)
    {
        name: "Invoice Data Extractor",
        description: "Extract structured data from invoices using OCR and AI.",
        category: "finance",
        tags: ["invoice", "OCR", "data extraction", "accounting"],
        required_integrations: ["quickbooks", "slack"],
        featured: false,
        definition: {
            name: "Invoice Data Extractor",
            nodes: [
                {
                    id: "files-1",
                    type: "files",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Upload Invoices",
                        acceptedTypes: ["pdf", "image"],
                        multiple: true,
                        outputVariable: "invoices"
                    }
                },
                {
                    id: "loop-invoices",
                    type: "loop",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Process Each",
                        items: "{{invoices}}",
                        itemVariable: "invoice",
                        outputVariable: "processed"
                    }
                },
                {
                    id: "ocrExtraction-1",
                    type: "ocrExtraction",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "OCR Invoice",
                        image: "{{invoice}}",
                        language: "eng",
                        outputVariable: "invoiceText"
                    }
                },
                {
                    id: "llm-extract",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Extract Data",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Extract invoice data:\n\n{{invoiceText}}\n\nReturn JSON with: vendor, invoice_number, date, line_items, total.",
                        outputVariable: "invoiceData"
                    }
                },
                {
                    id: "database-store",
                    type: "database",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Store Invoice",
                        provider: "postgresql",
                        operation: "insert",
                        query: "INSERT INTO invoices (vendor, invoice_number, amount, data) VALUES ($1, $2, $3, $4)",
                        outputVariable: "stored"
                    }
                },
                {
                    id: "spreadsheetGeneration-1",
                    type: "spreadsheetGeneration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Create Report",
                        data: "{{processed}}",
                        format: "xlsx",
                        sheetName: "Invoices",
                        outputVariable: "report"
                    }
                },
                {
                    id: "integration-quickbooks",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: { label: "Create Bill", provider: "quickbooks", operation: "createBill" }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Processing Complete",
                        outputName: "result",
                        value: "{{processed}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "files-1", target: "loop-invoices" },
                { id: "e2", source: "loop-invoices", target: "ocrExtraction-1" },
                { id: "e3", source: "ocrExtraction-1", target: "llm-extract" },
                { id: "e4", source: "llm-extract", target: "database-store" },
                { id: "e5", source: "database-store", target: "integration-quickbooks" },
                { id: "e6", source: "integration-quickbooks", target: "spreadsheetGeneration-1" },
                { id: "e7", source: "spreadsheetGeneration-1", target: "output-1" }
            ]
        }
    },

    // Document Processing: Report Template Filler (+3 of 4)
    {
        name: "Report Template Filler",
        description: "Automatically fill report templates with database data.",
        category: "document-processing",
        tags: ["reports", "templates", "PDF", "automation"],
        required_integrations: ["google-drive", "slack"],
        featured: false,
        definition: {
            name: "Report Template Filler",
            nodes: [
                {
                    id: "input-1",
                    type: "input",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Report Params",
                        inputName: "params",
                        inputVariable: "params",
                        inputType: "json"
                    }
                },
                {
                    id: "database-data",
                    type: "database",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Fetch Data",
                        provider: "postgresql",
                        operation: "select",
                        query: "SELECT * FROM {{params.table}} WHERE date BETWEEN $1 AND $2",
                        outputVariable: "data"
                    }
                },
                {
                    id: "llm-analysis",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Analysis",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Analyze data for {{params.reportType}}:\n\n{{data}}\n\nProvide: summary, metrics, trends, recommendations.",
                        outputVariable: "analysis"
                    }
                },
                {
                    id: "chartGeneration-1",
                    type: "chartGeneration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Charts",
                        chartType: "{{params.chartType}}",
                        data: "{{data}}",
                        title: "{{params.title}}",
                        outputVariable: "charts"
                    }
                },
                {
                    id: "pdfGeneration-1",
                    type: "pdfGeneration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate PDF",
                        content: "{{analysis.text}}",
                        template: "{{params.template}}",
                        outputVariable: "report"
                    }
                },
                {
                    id: "integration-gdrive",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Save to Drive",
                        provider: "google-drive",
                        operation: "uploadFile"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: { label: "Report Generated", outputName: "result", value: "{{report}}" }
                }
            ],
            edges: [
                { id: "e1", source: "input-1", target: "database-data" },
                { id: "e2", source: "database-data", target: "llm-analysis" },
                { id: "e3", source: "database-data", target: "chartGeneration-1" },
                { id: "e4", source: "llm-analysis", target: "pdfGeneration-1" },
                { id: "e5", source: "chartGeneration-1", target: "pdfGeneration-1" },
                { id: "e6", source: "pdfGeneration-1", target: "integration-gdrive" },
                { id: "e7", source: "integration-gdrive", target: "output-1" }
            ]
        }
    },

    // Document Processing: Contract Clause Analyzer (+4 of 4)
    {
        name: "Contract Clause Analyzer",
        description: "Extract and analyze contract clauses for risks and key terms.",
        category: "document-processing",
        tags: ["contract", "legal", "PDF", "risk assessment"],
        required_integrations: ["slack", "notion"],
        featured: false,
        definition: {
            name: "Contract Clause Analyzer",
            nodes: [
                {
                    id: "files-1",
                    type: "files",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Upload Contract",
                        acceptedTypes: ["pdf"],
                        outputVariable: "contract"
                    }
                },
                {
                    id: "pdfExtract-1",
                    type: "pdfExtract",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Extract Text",
                        file: "{{contract}}",
                        extractText: true,
                        outputVariable: "contractText"
                    }
                },
                {
                    id: "llm-clauses",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Identify Clauses",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Extract key clauses:\n\n{{contractText}}\n\nFind: termination, liability, payment, confidentiality, IP, governing law.",
                        outputVariable: "clauses"
                    }
                },
                {
                    id: "llm-risk",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Assess Risks",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Analyze risks in:\n\n{{clauses}}\n\nFor each: risk level, concerns, suggested modifications.",
                        outputVariable: "risks"
                    }
                },
                {
                    id: "database-store",
                    type: "database",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Store Analysis",
                        provider: "postgresql",
                        operation: "insert",
                        query: "INSERT INTO contract_analyses (contract_name, clauses, risks, analyzed_at) VALUES ($1, $2, $3, NOW())",
                        outputVariable: "stored"
                    }
                },
                {
                    id: "pdfGeneration-1",
                    type: "pdfGeneration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Report",
                        content: "{{risks.text}}",
                        template: "contract-analysis",
                        outputVariable: "report"
                    }
                },
                {
                    id: "integration-notion",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: { label: "Save to Notion", provider: "notion", operation: "createPage" }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: { label: "Analysis Complete", outputName: "result", value: "{{risks}}" }
                }
            ],
            edges: [
                { id: "e1", source: "files-1", target: "pdfExtract-1" },
                { id: "e2", source: "pdfExtract-1", target: "llm-clauses" },
                { id: "e3", source: "llm-clauses", target: "llm-risk" },
                { id: "e4", source: "llm-risk", target: "database-store" },
                { id: "e5", source: "database-store", target: "pdfGeneration-1" },
                { id: "e6", source: "pdfGeneration-1", target: "integration-notion" },
                { id: "e7", source: "integration-notion", target: "output-1" }
            ]
        }
    },

    // Data-Analytics: ETL Pipeline Monitor (+1 of 3)
    {
        name: "ETL Pipeline Monitor",
        description: "Monitor ETL pipelines and alert on failures or data quality issues.",
        category: "data-analytics",
        tags: ["ETL", "monitoring", "data quality", "alerts"],
        required_integrations: ["slack", "pagerduty"],
        featured: false,
        definition: {
            name: "ETL Pipeline Monitor",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: { label: "Hourly Check", triggerType: "schedule", schedule: "0 * * * *" }
                },
                {
                    id: "database-status",
                    type: "database",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get Pipeline Status",
                        provider: "postgresql",
                        operation: "select",
                        query: "SELECT pipeline_name, last_run, status, rows_processed, errors FROM etl_pipelines",
                        outputVariable: "pipelines"
                    }
                },
                {
                    id: "code-analyze",
                    type: "code",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Analyze Status",
                        language: "javascript",
                        code: "const pipelines = JSON.parse(inputs.pipelines);\nconst failed = pipelines.filter(p => p.status === 'failed');\nconst stale = pipelines.filter(p => Date.now() - new Date(p.last_run) > 3600000);\nreturn { failed, stale, healthy: pipelines.length - failed.length - stale.length };",
                        outputVariable: "analysis"
                    }
                },
                {
                    id: "conditional-issues",
                    type: "conditional",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Has Issues?",
                        condition:
                            "{{analysis.failed.length}} > 0 || {{analysis.stale.length}} > 0",
                        outputVariable: "hasIssues"
                    }
                },
                {
                    id: "integration-pagerduty",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Create Incident",
                        provider: "pagerduty",
                        operation: "createIncident"
                    }
                },
                {
                    id: "chartGeneration-1",
                    type: "chartGeneration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Status Chart",
                        chartType: "pie",
                        data: "{{analysis}}",
                        title: "Pipeline Status",
                        outputVariable: "chart"
                    }
                },
                {
                    id: "integration-slack",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Send Report",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#data-ops"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Monitoring Complete",
                        outputName: "result",
                        value: "{{analysis}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "trigger-1", target: "database-status" },
                { id: "e2", source: "database-status", target: "code-analyze" },
                { id: "e3", source: "code-analyze", target: "conditional-issues" },
                {
                    id: "e4",
                    source: "conditional-issues",
                    target: "integration-pagerduty",
                    sourceHandle: "true"
                },
                { id: "e5", source: "code-analyze", target: "chartGeneration-1" },
                {
                    id: "e6",
                    source: "conditional-issues",
                    target: "chartGeneration-1",
                    sourceHandle: "false"
                },
                { id: "e7", source: "integration-pagerduty", target: "integration-slack" },
                { id: "e8", source: "chartGeneration-1", target: "integration-slack" },
                { id: "e9", source: "integration-slack", target: "output-1" }
            ]
        }
    },

    // Data-Analytics: Data Quality Validator (+2 of 3)
    {
        name: "Data Quality Validator",
        description: "Validate data quality across databases with automated checks and reports.",
        category: "data-analytics",
        tags: ["data quality", "validation", "monitoring", "charts"],
        required_integrations: ["slack"],
        featured: false,
        definition: {
            name: "Data Quality Validator",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: { label: "Daily Check", triggerType: "schedule", schedule: "0 6 * * *" }
                },
                {
                    id: "database-metrics",
                    type: "database",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get Quality Metrics",
                        provider: "postgresql",
                        operation: "select",
                        query: "SELECT table_name, null_count, duplicate_count, outlier_count, freshness_hours FROM data_quality_metrics",
                        outputVariable: "metrics"
                    }
                },
                {
                    id: "llm-analyze",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Analyze Quality",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Analyze data quality metrics:\n\n{{metrics}}\n\nProvide: overall score, critical issues, recommendations.",
                        outputVariable: "analysis"
                    }
                },
                {
                    id: "chartGeneration-quality",
                    type: "chartGeneration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Quality Score Chart",
                        chartType: "gauge",
                        data: "{{analysis.scores}}",
                        title: "Data Quality Score",
                        outputVariable: "qualityChart"
                    }
                },
                {
                    id: "chartGeneration-issues",
                    type: "chartGeneration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Issues Chart",
                        chartType: "bar",
                        data: "{{analysis.issues}}",
                        title: "Data Issues by Table",
                        outputVariable: "issuesChart"
                    }
                },
                {
                    id: "spreadsheetGeneration-1",
                    type: "spreadsheetGeneration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Create Report",
                        data: "{{metrics}}",
                        format: "xlsx",
                        sheetName: "Data Quality",
                        outputVariable: "report"
                    }
                },
                {
                    id: "integration-slack",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Share Report",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#data-quality"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Validation Complete",
                        outputName: "result",
                        value: "{{analysis}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "trigger-1", target: "database-metrics" },
                { id: "e2", source: "database-metrics", target: "llm-analyze" },
                { id: "e3", source: "llm-analyze", target: "chartGeneration-quality" },
                { id: "e4", source: "llm-analyze", target: "chartGeneration-issues" },
                { id: "e5", source: "llm-analyze", target: "spreadsheetGeneration-1" },
                { id: "e6", source: "chartGeneration-quality", target: "integration-slack" },
                { id: "e7", source: "chartGeneration-issues", target: "integration-slack" },
                { id: "e8", source: "spreadsheetGeneration-1", target: "integration-slack" },
                { id: "e9", source: "integration-slack", target: "output-1" }
            ]
        }
    },

    // Data-Analytics: Cross-Platform Data Sync (+3 of 3)
    {
        name: "Cross-Platform Data Sync",
        description: "Sync data between databases with validation and file export.",
        category: "data-analytics",
        tags: ["data sync", "ETL", "export", "automation"],
        required_integrations: ["slack"],
        featured: false,
        definition: {
            name: "Cross-Platform Data Sync",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Scheduled Sync",
                        triggerType: "schedule",
                        schedule: "0 2 * * *"
                    }
                },
                {
                    id: "database-source",
                    type: "database",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get Source Data",
                        provider: "postgresql",
                        operation: "select",
                        query: "SELECT * FROM source_table WHERE updated_at > $1",
                        outputVariable: "sourceData"
                    }
                },
                {
                    id: "llm-transform",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Transform Data",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Transform this data for the target schema:\n\n{{sourceData}}\n\nMap fields and format appropriately.",
                        outputVariable: "transformed"
                    }
                },
                {
                    id: "database-target",
                    type: "database",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Write to Target",
                        provider: "postgresql",
                        operation: "insert",
                        query: "INSERT INTO target_table (data) VALUES ($1) ON CONFLICT DO UPDATE",
                        outputVariable: "synced"
                    }
                },
                {
                    id: "fileWrite-1",
                    type: "fileWrite",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Write Backup",
                        path: "/backups/sync_{{date}}.json",
                        content: "{{sourceData}}",
                        outputVariable: "backup"
                    }
                },
                {
                    id: "spreadsheetGeneration-1",
                    type: "spreadsheetGeneration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Create Sync Log",
                        data: "{{synced}}",
                        format: "xlsx",
                        sheetName: "Sync Log",
                        outputVariable: "syncLog"
                    }
                },
                {
                    id: "integration-slack",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Notify Complete",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#data-sync"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: { label: "Sync Complete", outputName: "result", value: "{{synced}}" }
                }
            ],
            edges: [
                { id: "e1", source: "trigger-1", target: "database-source" },
                { id: "e2", source: "database-source", target: "llm-transform" },
                { id: "e3", source: "llm-transform", target: "database-target" },
                { id: "e4", source: "database-source", target: "fileWrite-1" },
                { id: "e5", source: "database-target", target: "spreadsheetGeneration-1" },
                { id: "e6", source: "spreadsheetGeneration-1", target: "integration-slack" },
                { id: "e7", source: "fileWrite-1", target: "integration-slack" },
                { id: "e8", source: "integration-slack", target: "output-1" }
            ]
        }
    },

    // Voice-Audio: Meeting Transcription Pipeline (+1 of 6)
    {
        name: "Meeting Transcription Pipeline",
        description: "Transcribe meeting recordings and extract action items and summaries.",
        category: "voice-audio",
        tags: ["transcription", "meetings", "audio", "action items"],
        required_integrations: ["slack", "notion"],
        featured: false,
        definition: {
            name: "Meeting Transcription Pipeline",
            nodes: [
                {
                    id: "audioInput-1",
                    type: "audioInput",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Upload Recording",
                        acceptedFormats: ["mp3", "wav", "m4a"],
                        outputVariable: "audioFile"
                    }
                },
                {
                    id: "audioTranscription-1",
                    type: "audioTranscription",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Transcribe Audio",
                        provider: "openai",
                        model: "whisper-1",
                        audioFile: "{{audioFile}}",
                        outputVariable: "transcript"
                    }
                },
                {
                    id: "llm-summarize",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Summarize Meeting",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Summarize this meeting transcript:\n\n{{transcript}}\n\nProvide: summary, key decisions, action items with owners, next steps.",
                        outputVariable: "summary"
                    }
                },
                {
                    id: "pdfGeneration-1",
                    type: "pdfGeneration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Notes PDF",
                        content: "{{summary.text}}",
                        template: "meeting-notes",
                        outputVariable: "notesPdf"
                    }
                },
                {
                    id: "integration-notion",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: { label: "Save to Notion", provider: "notion", operation: "createPage" }
                },
                {
                    id: "integration-slack",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Share Summary",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#meetings"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Transcription Complete",
                        outputName: "result",
                        value: "{{summary}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "audioInput-1", target: "audioTranscription-1" },
                { id: "e2", source: "audioTranscription-1", target: "llm-summarize" },
                { id: "e3", source: "llm-summarize", target: "pdfGeneration-1" },
                { id: "e4", source: "pdfGeneration-1", target: "integration-notion" },
                { id: "e5", source: "integration-notion", target: "integration-slack" },
                { id: "e6", source: "integration-slack", target: "output-1" }
            ]
        }
    },

    // Voice-Audio: Voice Message Responder (+2 of 6)
    {
        name: "Voice Message Responder",
        description:
            "Process voice messages, transcribe, generate responses, and reply with audio.",
        category: "voice-audio",
        tags: ["voice", "transcription", "audio output", "automation"],
        required_integrations: ["slack"],
        featured: false,
        definition: {
            name: "Voice Message Responder",
            nodes: [
                {
                    id: "audioInput-1",
                    type: "audioInput",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Voice Message",
                        acceptedFormats: ["mp3", "wav"],
                        outputVariable: "voiceMessage"
                    }
                },
                {
                    id: "audioTranscription-1",
                    type: "audioTranscription",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Transcribe",
                        provider: "openai",
                        model: "whisper-1",
                        audioFile: "{{voiceMessage}}",
                        outputVariable: "transcript"
                    }
                },
                {
                    id: "llm-respond",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Response",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Respond to this voice message:\n\n{{transcript}}\n\nProvide a helpful, conversational response.",
                        outputVariable: "response"
                    }
                },
                {
                    id: "audioOutput-1",
                    type: "audioOutput",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Audio Reply",
                        provider: "openai",
                        model: "tts-1",
                        text: "{{response.text}}",
                        voice: "alloy",
                        outputVariable: "audioReply"
                    }
                },
                {
                    id: "fileWrite-1",
                    type: "fileWrite",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Save Audio",
                        path: "/outputs/voice_replies/{{timestamp}}.mp3",
                        content: "{{audioReply}}",
                        outputVariable: "savedAudio"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: { label: "Reply Ready", outputName: "result", value: "{{audioReply}}" }
                }
            ],
            edges: [
                { id: "e1", source: "audioInput-1", target: "audioTranscription-1" },
                { id: "e2", source: "audioTranscription-1", target: "llm-respond" },
                { id: "e3", source: "llm-respond", target: "audioOutput-1" },
                { id: "e4", source: "audioOutput-1", target: "fileWrite-1" },
                { id: "e5", source: "fileWrite-1", target: "output-1" }
            ]
        }
    },

    // Voice-Audio: Podcast Production Suite (+3 of 6)
    {
        name: "Podcast Production Suite",
        description: "Process podcast recordings with transcription, show notes, and clips.",
        category: "voice-audio",
        tags: ["podcast", "transcription", "content", "production"],
        required_integrations: ["slack"],
        featured: false,
        definition: {
            name: "Podcast Production Suite",
            nodes: [
                {
                    id: "audioInput-1",
                    type: "audioInput",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Upload Episode",
                        acceptedFormats: ["mp3", "wav"],
                        outputVariable: "episode"
                    }
                },
                {
                    id: "audioTranscription-1",
                    type: "audioTranscription",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Transcribe Episode",
                        provider: "openai",
                        model: "whisper-1",
                        audioFile: "{{episode}}",
                        outputVariable: "transcript"
                    }
                },
                {
                    id: "llm-shownotes",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Show Notes",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Create podcast show notes from:\n\n{{transcript}}\n\nInclude: episode summary, key topics, timestamps, guest quotes, links mentioned.",
                        outputVariable: "showNotes"
                    }
                },
                {
                    id: "llm-clips",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Identify Clip Moments",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Identify 3-5 best clip moments from:\n\n{{transcript}}\n\nProvide timestamps and why each would make a good clip.",
                        outputVariable: "clipMoments"
                    }
                },
                {
                    id: "pdfGeneration-1",
                    type: "pdfGeneration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Show Notes PDF",
                        content: "{{showNotes.text}}",
                        template: "podcast-shownotes",
                        outputVariable: "notesPdf"
                    }
                },
                {
                    id: "integration-slack",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Share with Team",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#podcast"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Production Complete",
                        outputName: "result",
                        value: "{{showNotes}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "audioInput-1", target: "audioTranscription-1" },
                { id: "e2", source: "audioTranscription-1", target: "llm-shownotes" },
                { id: "e3", source: "audioTranscription-1", target: "llm-clips" },
                { id: "e4", source: "llm-shownotes", target: "pdfGeneration-1" },
                { id: "e5", source: "llm-clips", target: "integration-slack" },
                { id: "e6", source: "pdfGeneration-1", target: "integration-slack" },
                { id: "e7", source: "integration-slack", target: "output-1" }
            ]
        }
    },

    // Voice-Audio: Call Center Analytics (+4 of 6)
    {
        name: "Call Center Analytics",
        description: "Analyze call recordings for sentiment, quality, and insights.",
        category: "voice-audio",
        tags: ["call center", "analytics", "sentiment", "quality"],
        required_integrations: ["slack"],
        featured: false,
        definition: {
            name: "Call Center Analytics",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: { label: "New Call Recording", triggerType: "webhook" }
                },
                {
                    id: "fileDownload-1",
                    type: "fileDownload",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Download Recording",
                        url: "{{call.recordingUrl}}",
                        outputVariable: "recording"
                    }
                },
                {
                    id: "audioTranscription-1",
                    type: "audioTranscription",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Transcribe Call",
                        provider: "openai",
                        model: "whisper-1",
                        audioFile: "{{recording}}",
                        outputVariable: "transcript"
                    }
                },
                {
                    id: "llm-analyze",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Analyze Call",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Analyze this support call:\n\n{{transcript}}\n\nProvide: sentiment, issue category, resolution status, agent quality score, improvement suggestions.",
                        outputVariable: "analysis"
                    }
                },
                {
                    id: "database-store",
                    type: "database",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Store Analysis",
                        provider: "postgresql",
                        operation: "insert",
                        query: "INSERT INTO call_analytics (call_id, sentiment, category, quality_score, analysis) VALUES ($1, $2, $3, $4, $5)",
                        outputVariable: "stored"
                    }
                },
                {
                    id: "chartGeneration-1",
                    type: "chartGeneration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Quality Chart",
                        chartType: "gauge",
                        data: "{{analysis.qualityScore}}",
                        title: "Call Quality",
                        outputVariable: "chart"
                    }
                },
                {
                    id: "conditional-lowscore",
                    type: "conditional",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Low Score?",
                        condition: "{{analysis.qualityScore}} < 7",
                        outputVariable: "isLowScore"
                    }
                },
                {
                    id: "integration-slack",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Alert Manager",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#call-quality"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Analysis Complete",
                        outputName: "result",
                        value: "{{analysis}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "trigger-1", target: "fileDownload-1" },
                { id: "e2", source: "fileDownload-1", target: "audioTranscription-1" },
                { id: "e3", source: "audioTranscription-1", target: "llm-analyze" },
                { id: "e4", source: "llm-analyze", target: "database-store" },
                { id: "e5", source: "database-store", target: "chartGeneration-1" },
                { id: "e6", source: "chartGeneration-1", target: "conditional-lowscore" },
                {
                    id: "e7",
                    source: "conditional-lowscore",
                    target: "integration-slack",
                    sourceHandle: "true"
                },
                {
                    id: "e8",
                    source: "conditional-lowscore",
                    target: "output-1",
                    sourceHandle: "false"
                },
                { id: "e9", source: "integration-slack", target: "output-1" }
            ]
        }
    },

    // Voice-Audio: Voice-to-Task Creator (+5 of 6)
    {
        name: "Voice-to-Task Creator",
        description: "Convert voice notes into structured tasks and calendar events.",
        category: "voice-audio",
        tags: ["voice", "tasks", "productivity", "automation"],
        required_integrations: ["asana", "google-calendar"],
        featured: false,
        definition: {
            name: "Voice-to-Task Creator",
            nodes: [
                {
                    id: "audioInput-1",
                    type: "audioInput",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Voice Note",
                        acceptedFormats: ["mp3", "wav"],
                        outputVariable: "voiceNote"
                    }
                },
                {
                    id: "audioTranscription-1",
                    type: "audioTranscription",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Transcribe",
                        provider: "openai",
                        model: "whisper-1",
                        audioFile: "{{voiceNote}}",
                        outputVariable: "transcript"
                    }
                },
                {
                    id: "llm-extract",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Extract Tasks & Events",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Extract actionable items from:\n\n{{transcript}}\n\nReturn JSON with: tasks (title, description, due_date, priority) and events (title, date, time, duration).",
                        outputVariable: "extracted"
                    }
                },
                {
                    id: "loop-tasks",
                    type: "loop",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Create Tasks",
                        items: "{{extracted.tasks}}",
                        itemVariable: "task",
                        outputVariable: "createdTasks"
                    }
                },
                {
                    id: "integration-asana",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: { label: "Create Asana Task", provider: "asana", operation: "createTask" }
                },
                {
                    id: "loop-events",
                    type: "loop",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Create Events",
                        items: "{{extracted.events}}",
                        itemVariable: "event",
                        outputVariable: "createdEvents"
                    }
                },
                {
                    id: "integration-gcal",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Create Calendar Event",
                        provider: "google-calendar",
                        operation: "createEvent"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Items Created",
                        outputName: "result",
                        value: "Created {{createdTasks.length}} tasks and {{createdEvents.length}} events"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "audioInput-1", target: "audioTranscription-1" },
                { id: "e2", source: "audioTranscription-1", target: "llm-extract" },
                { id: "e3", source: "llm-extract", target: "loop-tasks" },
                { id: "e4", source: "loop-tasks", target: "integration-asana" },
                { id: "e5", source: "llm-extract", target: "loop-events" },
                { id: "e6", source: "loop-events", target: "integration-gcal" },
                { id: "e7", source: "integration-asana", target: "output-1" },
                { id: "e8", source: "integration-gcal", target: "output-1" }
            ]
        }
    },

    // Voice-Audio: Interview Analyzer (+6 of 6)
    {
        name: "Interview Analyzer",
        description: "Analyze interview recordings for candidate evaluation and insights.",
        category: "voice-audio",
        tags: ["interviews", "HR", "analysis", "transcription"],
        required_integrations: ["slack"],
        featured: false,
        definition: {
            name: "Interview Analyzer",
            nodes: [
                {
                    id: "audioInput-1",
                    type: "audioInput",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Upload Interview",
                        acceptedFormats: ["mp3", "wav", "m4a"],
                        outputVariable: "interview"
                    }
                },
                {
                    id: "audioTranscription-1",
                    type: "audioTranscription",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Transcribe Interview",
                        provider: "openai",
                        model: "whisper-1",
                        audioFile: "{{interview}}",
                        outputVariable: "transcript"
                    }
                },
                {
                    id: "llm-analyze",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Analyze Interview",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Analyze this interview transcript:\n\n{{transcript}}\n\nProvide: candidate strengths, areas of concern, communication skills rating, technical knowledge assessment, culture fit indicators, follow-up questions needed.",
                        outputVariable: "analysis"
                    }
                },
                {
                    id: "llm-summary",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Summary",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Create a concise hiring manager summary from:\n\n{{analysis}}\n\nFormat for quick review with recommendation.",
                        outputVariable: "summary"
                    }
                },
                {
                    id: "pdfGeneration-1",
                    type: "pdfGeneration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Generate Report",
                        content: "{{summary.text}}",
                        template: "interview-report",
                        outputVariable: "report"
                    }
                },
                {
                    id: "database-store",
                    type: "database",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Store Analysis",
                        provider: "postgresql",
                        operation: "insert",
                        query: "INSERT INTO interview_analyses (candidate_id, analysis, summary, analyzed_at) VALUES ($1, $2, $3, NOW())",
                        outputVariable: "stored"
                    }
                },
                {
                    id: "integration-slack",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Notify Hiring Team",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#hiring"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: { label: "Analysis Complete", outputName: "result", value: "{{summary}}" }
                }
            ],
            edges: [
                { id: "e1", source: "audioInput-1", target: "audioTranscription-1" },
                { id: "e2", source: "audioTranscription-1", target: "llm-analyze" },
                { id: "e3", source: "llm-analyze", target: "llm-summary" },
                { id: "e4", source: "llm-summary", target: "pdfGeneration-1" },
                { id: "e5", source: "llm-summary", target: "database-store" },
                { id: "e6", source: "pdfGeneration-1", target: "integration-slack" },
                { id: "e7", source: "database-store", target: "integration-slack" },
                { id: "e8", source: "integration-slack", target: "output-1" }
            ]
        }
    },

    // Advanced-Logic: Dynamic Workflow Router (+1 of 6)
    {
        name: "Dynamic Workflow Router",
        description: "Route workflows dynamically based on multiple conditions using switch logic.",
        category: "advanced-logic",
        tags: ["routing", "switch", "conditional", "dynamic"],
        required_integrations: ["slack"],
        featured: false,
        definition: {
            name: "Dynamic Workflow Router",
            nodes: [
                {
                    id: "input-1",
                    type: "input",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Request Data",
                        inputName: "request",
                        inputVariable: "request",
                        inputType: "json"
                    }
                },
                {
                    id: "switch-priority",
                    type: "switch",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Priority Switch",
                        switchVariable: "{{request.priority}}",
                        cases: [
                            { value: "urgent", label: "Urgent" },
                            { value: "high", label: "High" },
                            { value: "medium", label: "Medium" },
                            { value: "low", label: "Low" }
                        ],
                        defaultCase: "medium",
                        outputVariable: "priorityCase"
                    }
                },
                {
                    id: "conditional-type",
                    type: "conditional",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Check Type",
                        condition: "{{request.type}} == 'automated'",
                        outputVariable: "isAutomated"
                    }
                },
                {
                    id: "router-team",
                    type: "router",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Team Router",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Route this request to the appropriate team:\n\n{{request}}",
                        routes: [
                            { value: "engineering", label: "Engineering" },
                            { value: "support", label: "Support" },
                            { value: "sales", label: "Sales" }
                        ],
                        defaultRoute: "support",
                        outputVariable: "teamRoute"
                    }
                },
                {
                    id: "llm-process",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Process Request",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Process this {{request.type}} request with {{request.priority}} priority:\n\n{{request}}",
                        outputVariable: "processed"
                    }
                },
                {
                    id: "integration-slack",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Notify Team",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#{{teamRoute}}"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Routing Complete",
                        outputName: "result",
                        value: "{{processed}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "input-1", target: "switch-priority" },
                { id: "e2", source: "switch-priority", target: "conditional-type" },
                {
                    id: "e3",
                    source: "conditional-type",
                    target: "router-team",
                    sourceHandle: "true"
                },
                {
                    id: "e4",
                    source: "conditional-type",
                    target: "llm-process",
                    sourceHandle: "false"
                },
                { id: "e5", source: "router-team", target: "llm-process" },
                { id: "e6", source: "llm-process", target: "integration-slack" },
                { id: "e7", source: "integration-slack", target: "output-1" }
            ]
        }
    },

    // Advanced-Logic: Retry with Backoff (+2 of 6)
    {
        name: "Retry with Exponential Backoff",
        description: "Implement retry logic with exponential backoff for resilient workflows.",
        category: "advanced-logic",
        tags: ["retry", "backoff", "resilience", "error handling"],
        required_integrations: ["slack"],
        featured: false,
        definition: {
            name: "Retry with Exponential Backoff",
            nodes: [
                {
                    id: "input-1",
                    type: "input",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "API Request",
                        inputName: "apiRequest",
                        inputVariable: "apiRequest",
                        inputType: "json"
                    }
                },
                {
                    id: "shared-memory-1",
                    type: "shared-memory",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Init Retry Counter",
                        key: "retryCount",
                        value: "0",
                        operation: "set",
                        outputVariable: "counter"
                    }
                },
                {
                    id: "http-1",
                    type: "http",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Make API Call",
                        method: "{{apiRequest.method}}",
                        url: "{{apiRequest.url}}",
                        headers: "{{apiRequest.headers}}",
                        body: "{{apiRequest.body}}",
                        outputVariable: "response"
                    }
                },
                {
                    id: "conditional-success",
                    type: "conditional",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Check Success",
                        condition: "{{response.status}} < 400",
                        outputVariable: "isSuccess"
                    }
                },
                {
                    id: "code-backoff",
                    type: "code",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Calculate Backoff",
                        language: "javascript",
                        code: "const retry = parseInt(inputs.retryCount) || 0;\nconst maxRetries = 3;\nconst baseDelay = 1000;\nif (retry >= maxRetries) return { shouldRetry: false, delay: 0 };\nconst delay = baseDelay * Math.pow(2, retry);\nreturn { shouldRetry: true, delay, nextRetry: retry + 1 };",
                        outputVariable: "backoff"
                    }
                },
                {
                    id: "conditional-retry",
                    type: "conditional",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Should Retry?",
                        condition: "{{backoff.shouldRetry}} == true",
                        outputVariable: "shouldRetry"
                    }
                },
                {
                    id: "wait-1",
                    type: "wait",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Wait Before Retry",
                        waitType: "duration",
                        duration: "{{backoff.delay}}",
                        outputVariable: "waited"
                    }
                },
                {
                    id: "shared-memory-2",
                    type: "shared-memory",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Increment Counter",
                        key: "retryCount",
                        value: "{{backoff.nextRetry}}",
                        operation: "set",
                        outputVariable: "updated"
                    }
                },
                {
                    id: "integration-slack",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Alert Failure",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#alerts"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: { label: "Request Complete", outputName: "result", value: "{{response}}" }
                }
            ],
            edges: [
                { id: "e1", source: "input-1", target: "shared-memory-1" },
                { id: "e2", source: "shared-memory-1", target: "http-1" },
                { id: "e3", source: "http-1", target: "conditional-success" },
                {
                    id: "e4",
                    source: "conditional-success",
                    target: "output-1",
                    sourceHandle: "true"
                },
                {
                    id: "e5",
                    source: "conditional-success",
                    target: "code-backoff",
                    sourceHandle: "false"
                },
                { id: "e6", source: "code-backoff", target: "conditional-retry" },
                { id: "e7", source: "conditional-retry", target: "wait-1", sourceHandle: "true" },
                {
                    id: "e8",
                    source: "conditional-retry",
                    target: "integration-slack",
                    sourceHandle: "false"
                },
                { id: "e9", source: "wait-1", target: "shared-memory-2" },
                { id: "e10", source: "shared-memory-2", target: "http-1" },
                { id: "e11", source: "integration-slack", target: "output-1" }
            ]
        }
    },

    // Advanced-Logic: State Machine Workflow (+3 of 6)
    {
        name: "State Machine Workflow",
        description: "Implement a state machine with transitions and guards.",
        category: "advanced-logic",
        tags: ["state machine", "transitions", "workflow", "logic"],
        required_integrations: ["slack"],
        featured: false,
        definition: {
            name: "State Machine Workflow",
            nodes: [
                {
                    id: "input-1",
                    type: "input",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "State Input",
                        inputName: "stateInput",
                        inputVariable: "stateInput",
                        inputType: "json"
                    }
                },
                {
                    id: "shared-memory-1",
                    type: "shared-memory",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get Current State",
                        key: "currentState",
                        operation: "get",
                        outputVariable: "currentState"
                    }
                },
                {
                    id: "code-transition",
                    type: "code",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Calculate Transition",
                        language: "javascript",
                        code: "const states = { draft: ['review'], review: ['approved', 'rejected'], approved: ['published'], rejected: ['draft'], published: [] };\nconst current = inputs.currentState || 'draft';\nconst action = inputs.action;\nconst validTransitions = states[current] || [];\nconst canTransition = validTransitions.includes(action);\nreturn { current, action, canTransition, nextState: canTransition ? action : current };",
                        outputVariable: "transition"
                    }
                },
                {
                    id: "conditional-valid",
                    type: "conditional",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Valid Transition?",
                        condition: "{{transition.canTransition}} == true",
                        outputVariable: "isValid"
                    }
                },
                {
                    id: "shared-memory-2",
                    type: "shared-memory",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Update State",
                        key: "currentState",
                        value: "{{transition.nextState}}",
                        operation: "set",
                        outputVariable: "updated"
                    }
                },
                {
                    id: "llm-action",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Execute State Action",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Execute action for state transition from {{transition.current}} to {{transition.nextState}}.",
                        outputVariable: "actionResult"
                    }
                },
                {
                    id: "integration-slack",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Notify State Change",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#workflow"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Transition Complete",
                        outputName: "result",
                        value: "{{transition}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "input-1", target: "shared-memory-1" },
                { id: "e2", source: "shared-memory-1", target: "code-transition" },
                { id: "e3", source: "code-transition", target: "conditional-valid" },
                {
                    id: "e4",
                    source: "conditional-valid",
                    target: "shared-memory-2",
                    sourceHandle: "true"
                },
                {
                    id: "e5",
                    source: "conditional-valid",
                    target: "output-1",
                    sourceHandle: "false"
                },
                { id: "e6", source: "shared-memory-2", target: "llm-action" },
                { id: "e7", source: "llm-action", target: "integration-slack" },
                { id: "e8", source: "integration-slack", target: "output-1" }
            ]
        }
    },

    // Advanced-Logic: Approval Chain Manager (+4 of 6)
    {
        name: "Multi-Level Approval Chain",
        description: "Manage multi-level approval workflows with escalation.",
        category: "advanced-logic",
        tags: ["approval", "workflow", "escalation", "human review"],
        required_integrations: ["slack"],
        featured: false,
        definition: {
            name: "Multi-Level Approval Chain",
            nodes: [
                {
                    id: "input-1",
                    type: "input",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Approval Request",
                        inputName: "request",
                        inputVariable: "request",
                        inputType: "json"
                    }
                },
                {
                    id: "code-level",
                    type: "code",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Determine Approval Level",
                        language: "javascript",
                        code: "const amount = inputs.request.amount;\nif (amount > 100000) return { level: 3, approvers: ['ceo', 'cfo'] };\nif (amount > 10000) return { level: 2, approvers: ['director'] };\nreturn { level: 1, approvers: ['manager'] };",
                        outputVariable: "approvalLevel"
                    }
                },
                {
                    id: "loop-approvers",
                    type: "loop",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Request Approvals",
                        items: "{{approvalLevel.approvers}}",
                        itemVariable: "approver",
                        outputVariable: "approvalResults"
                    }
                },
                {
                    id: "humanReview-1",
                    type: "humanReview",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Request Approval",
                        reviewPrompt: "Please review and approve this request:\n\n{{request}}",
                        outputVariable: "approval"
                    }
                },
                {
                    id: "conditional-approved",
                    type: "conditional",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "All Approved?",
                        condition: "{{approvalResults.allApproved}} == true",
                        outputVariable: "isApproved"
                    }
                },
                {
                    id: "wait-1",
                    type: "wait",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Wait for Escalation",
                        waitType: "duration",
                        duration: 86400,
                        outputVariable: "waited"
                    }
                },
                {
                    id: "integration-slack-approved",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Notify Approved",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#approvals"
                    }
                },
                {
                    id: "integration-slack-rejected",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Notify Rejected",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#approvals"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Approval Complete",
                        outputName: "result",
                        value: "{{approvalResults}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "input-1", target: "code-level" },
                { id: "e2", source: "code-level", target: "loop-approvers" },
                { id: "e3", source: "loop-approvers", target: "humanReview-1" },
                { id: "e4", source: "humanReview-1", target: "conditional-approved" },
                {
                    id: "e5",
                    source: "conditional-approved",
                    target: "integration-slack-approved",
                    sourceHandle: "true"
                },
                {
                    id: "e6",
                    source: "conditional-approved",
                    target: "wait-1",
                    sourceHandle: "false"
                },
                { id: "e7", source: "wait-1", target: "integration-slack-rejected" },
                { id: "e8", source: "integration-slack-approved", target: "output-1" },
                { id: "e9", source: "integration-slack-rejected", target: "output-1" }
            ]
        }
    },

    // Advanced-Logic: Parallel Processing with Aggregation (+5 of 6)
    {
        name: "Parallel Processing with Aggregation",
        description: "Process items in parallel branches and aggregate results.",
        category: "advanced-logic",
        tags: ["parallel", "aggregation", "processing", "performance"],
        required_integrations: ["slack"],
        featured: false,
        definition: {
            name: "Parallel Processing with Aggregation",
            nodes: [
                {
                    id: "input-1",
                    type: "input",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Data Items",
                        inputName: "items",
                        inputVariable: "items",
                        inputType: "json"
                    }
                },
                {
                    id: "code-split",
                    type: "code",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Split into Batches",
                        language: "javascript",
                        code: "const items = JSON.parse(inputs.items);\nconst batchSize = 5;\nconst batches = [];\nfor (let i = 0; i < items.length; i += batchSize) {\n  batches.push(items.slice(i, i + batchSize));\n}\nreturn { batches, totalItems: items.length, batchCount: batches.length };",
                        outputVariable: "batched"
                    }
                },
                {
                    id: "llm-batch1",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Process Batch 1",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Process: {{batched.batches[0]}}",
                        outputVariable: "batch1"
                    }
                },
                {
                    id: "llm-batch2",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Process Batch 2",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Process: {{batched.batches[1]}}",
                        outputVariable: "batch2"
                    }
                },
                {
                    id: "llm-batch3",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Process Batch 3",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Process: {{batched.batches[2]}}",
                        outputVariable: "batch3"
                    }
                },
                {
                    id: "transform-aggregate",
                    type: "transform",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Aggregate Results",
                        transformType: "merge",
                        sources: ["{{batch1}}", "{{batch2}}", "{{batch3}}"],
                        outputVariable: "aggregated"
                    }
                },
                {
                    id: "llm-summarize",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Summarize Results",
                        provider: "openai",
                        model: "gpt-4o",
                        prompt: "Summarize parallel processing results:\n\n{{aggregated}}\n\nProvide: success count, failures, patterns, recommendations.",
                        outputVariable: "summary"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Processing Complete",
                        outputName: "result",
                        value: "{{summary}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "input-1", target: "code-split" },
                { id: "e2", source: "code-split", target: "llm-batch1" },
                { id: "e3", source: "code-split", target: "llm-batch2" },
                { id: "e4", source: "code-split", target: "llm-batch3" },
                { id: "e5", source: "llm-batch1", target: "transform-aggregate" },
                { id: "e6", source: "llm-batch2", target: "transform-aggregate" },
                { id: "e7", source: "llm-batch3", target: "transform-aggregate" },
                { id: "e8", source: "transform-aggregate", target: "llm-summarize" },
                { id: "e9", source: "llm-summarize", target: "output-1" }
            ]
        }
    },

    // Advanced-Logic: Scheduled Task Orchestrator (+6 of 6)
    {
        name: "Scheduled Task Orchestrator",
        description: "Orchestrate scheduled tasks with dependencies and timing.",
        category: "advanced-logic",
        tags: ["scheduling", "orchestration", "tasks", "automation"],
        required_integrations: ["slack"],
        featured: false,
        definition: {
            name: "Scheduled Task Orchestrator",
            nodes: [
                {
                    id: "trigger-1",
                    type: "trigger",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Daily Orchestration",
                        triggerType: "schedule",
                        schedule: "0 1 * * *"
                    }
                },
                {
                    id: "database-tasks",
                    type: "database",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Get Scheduled Tasks",
                        provider: "postgresql",
                        operation: "select",
                        query: "SELECT id, name, dependencies, schedule FROM scheduled_tasks WHERE next_run <= NOW() ORDER BY priority",
                        outputVariable: "tasks"
                    }
                },
                {
                    id: "code-order",
                    type: "code",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Topological Sort",
                        language: "javascript",
                        code: "const tasks = JSON.parse(inputs.tasks);\n// Sort by dependencies\nconst sorted = [];\nconst visited = new Set();\nfunction visit(task) {\n  if (visited.has(task.id)) return;\n  visited.add(task.id);\n  (task.dependencies || []).forEach(d => {\n    const dep = tasks.find(t => t.id === d);\n    if (dep) visit(dep);\n  });\n  sorted.push(task);\n}\ntasks.forEach(visit);\nreturn { orderedTasks: sorted };",
                        outputVariable: "ordered"
                    }
                },
                {
                    id: "loop-tasks",
                    type: "loop",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Execute Tasks",
                        items: "{{ordered.orderedTasks}}",
                        itemVariable: "task",
                        outputVariable: "results"
                    }
                },
                {
                    id: "llm-execute",
                    type: "llm",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Execute Task",
                        provider: "openai",
                        model: "gpt-4o-mini",
                        prompt: "Execute scheduled task:\n\n{{task}}",
                        outputVariable: "taskResult"
                    }
                },
                {
                    id: "database-update",
                    type: "database",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Update Task Status",
                        provider: "postgresql",
                        operation: "update",
                        query: "UPDATE scheduled_tasks SET last_run = NOW(), next_run = next_run + interval WHERE id = $1",
                        outputVariable: "updated"
                    }
                },
                {
                    id: "spreadsheetGeneration-1",
                    type: "spreadsheetGeneration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Create Execution Log",
                        data: "{{results}}",
                        format: "xlsx",
                        sheetName: "Task Execution",
                        outputVariable: "log"
                    }
                },
                {
                    id: "integration-slack",
                    type: "integration",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Report Completion",
                        provider: "slack",
                        operation: "sendMessage",
                        channel: "#scheduled-tasks"
                    }
                },
                {
                    id: "output-1",
                    type: "output",
                    position: { x: 0, y: 0 },
                    data: {
                        label: "Orchestration Complete",
                        outputName: "result",
                        value: "{{results}}"
                    }
                }
            ],
            edges: [
                { id: "e1", source: "trigger-1", target: "database-tasks" },
                { id: "e2", source: "database-tasks", target: "code-order" },
                { id: "e3", source: "code-order", target: "loop-tasks" },
                { id: "e4", source: "loop-tasks", target: "llm-execute" },
                { id: "e5", source: "llm-execute", target: "database-update" },
                { id: "e6", source: "database-update", target: "spreadsheetGeneration-1" },
                { id: "e7", source: "spreadsheetGeneration-1", target: "integration-slack" },
                { id: "e8", source: "integration-slack", target: "output-1" }
            ]
        }
    }
];

// ============================================================================
// SEED FUNCTION
// ============================================================================

async function seedTemplates() {
    const pool = new Pool({
        host: process.env.POSTGRES_HOST || "localhost",
        port: parseInt(process.env.POSTGRES_PORT || "5432"),
        database: process.env.POSTGRES_DB || "flowmaestro",
        user: process.env.POSTGRES_USER || "flowmaestro",
        password: process.env.POSTGRES_PASSWORD || "flowmaestro_dev_password",
        max: 3
    });

    console.log("Starting template seed...\n");

    try {
        // Check if templates already exist
        const existingResult = await pool.query("SELECT COUNT(*) FROM workflow_templates");
        const existingCount = parseInt(existingResult.rows[0].count);

        if (existingCount > 0) {
            console.log(`Found ${existingCount} existing templates.`);
            console.log("Clearing existing templates before seeding...\n");
            await pool.query("DELETE FROM workflow_templates");
        }

        // Insert all templates
        let successCount = 0;
        let errorCount = 0;

        for (const template of templates) {
            try {
                // Deep clone the definition to avoid mutating original
                const definition = JSON.parse(JSON.stringify(template.definition));

                // Apply improved auto-layout for consistent, visually appealing layouts
                applyAutoLayout(definition.nodes, definition.edges);

                await pool.query(
                    `INSERT INTO workflow_templates (
                        name, description, definition, category, tags,
                        required_integrations, featured, version, status
                    ) VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9)`,
                    [
                        template.name,
                        template.description,
                        JSON.stringify(definition),
                        template.category,
                        template.tags,
                        template.required_integrations,
                        template.featured || false,
                        "1.0.0",
                        "active"
                    ]
                );
                console.log(` Seeded: ${template.name}`);
                successCount++;
            } catch (error) {
                console.error(` Failed: ${template.name}`);
                console.error(`  Error: ${error instanceof Error ? error.message : String(error)}`);
                errorCount++;
            }
        }

        console.log("\n========================================");
        console.log("Seed complete!");
        console.log(`  Successful: ${successCount}`);
        console.log(`  Failed: ${errorCount}`);
        console.log(`  Total templates: ${templates.length}`);
        console.log("========================================\n");

        // Show category breakdown
        const categoryResult = await pool.query(
            "SELECT category, COUNT(*) as count FROM workflow_templates GROUP BY category ORDER BY count DESC"
        );
        console.log("Templates by category:");
        for (const row of categoryResult.rows) {
            console.log(`  ${row.category}: ${row.count}`);
        }

        // Show featured templates
        const featuredResult = await pool.query(
            "SELECT name, category FROM workflow_templates WHERE featured = true ORDER BY category, name"
        );
        console.log("\nFeatured templates:");
        for (const row of featuredResult.rows) {
            console.log(`  [${row.category}] ${row.name}`);
        }
    } catch (error) {
        console.error("Seed failed:", error);
        process.exit(1);
    } finally {
        await pool.end();
    }
}

// Run the seed
seedTemplates();
